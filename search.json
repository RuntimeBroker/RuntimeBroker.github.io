[{"title":"windbgå¸¸ç”¨å‘½ä»¤","path":"/p/86acdf67/","content":"äºŒï¼šå¸¸è§éæ‰˜ç®¡å‘½ä»¤1.å·¥å…·å’Œç³»ç»Ÿçº§åˆ«ç±» .restart &#x2F;&#x2F; é‡å¯å¹¶è°ƒè¯• .kill &#x2F;&#x2F; å¼ºåˆ¶ç»“æŸå½“å‰è°ƒè¯• q &#x2F;&#x2F; ç»“æŸå½“å‰è°ƒè¯•ä¼šè¯ï¼Œå›åˆ°åŸºç¡€å·¥ä½œç©ºé—´ï¼Œå¹¶ç»“æŸè°ƒè¯•è¿›ç¨‹ qd &#x2F;&#x2F; ç»“æŸå½“å‰è°ƒè¯•ä¼šè¯ï¼Œå›åˆ°åŸºç¡€å·¥ä½œç©ºé—´ï¼Œä½†ä¸ç»“æŸè°ƒè¯•è¿›ç¨‹ vertarget &#x2F;&#x2F; osä¿¡æ¯ !cpuid &#x2F;&#x2F; cpuä¿¡æ¯ .time &#x2F;&#x2F; è·å–dumpæŠ“å–æ—¶é—´ ? &#x2F;&#x2F; æ‰“å°å‡ºæ‰€æœ‰æ ‡å‡†å‘½ä»¤ .help &#x2F;&#x2F; æ‰“å°å‡ºæ‰€æœ‰å…ƒå‘½ä»¤ .hh &#x2F;&#x2F; æ‰“å¼€windbgçš„chmå¸®åŠ©æ–‡ä»¶ .cls &#x2F;&#x2F; æ¸…ç©ºæ§åˆ¶å° !analyze -v &#x2F;&#x2F; å¯¹å†…å­˜è½¬å‚¨æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œå¹¶æ˜¾ç¤ºè¯¦ç»†çš„ç»“æœ 2.è¿›ç¨‹å’Œçº¿ç¨‹ç±» | &#x2F;&#x2F; åˆ—å‡ºè°ƒè¯•è¿›ç¨‹ |* &#x2F;&#x2F; åˆ—å‡ºè°ƒè¯•è¿›ç¨‹ ~ &#x2F;&#x2F; åˆ—å‡ºçº¿ç¨‹ ~* &#x2F;&#x2F; æ‰€æœ‰çº¿ç¨‹ ~* k &#x2F;&#x2F; æ‰€æœ‰çº¿ç¨‹å †æ ˆä¿¡æ¯ ~* r &#x2F;&#x2F; æ‰€æœ‰çº¿ç¨‹å¯„å­˜å™¨ä¿¡æ¯ ~. &#x2F;&#x2F; æŸ¥çœ‹å½“å‰çº¿ç¨‹ ~0s &#x2F;&#x2F; æŸ¥çœ‹ä¸»çº¿ç¨‹ ~N &#x2F;&#x2F; æŸ¥çœ‹åºæ•°ä¸ºNçš„çº¿ç¨‹ ~~[n] &#x2F;&#x2F; æŸ¥çœ‹çº¿ç¨‹IDä¸ºnçš„çº¿ç¨‹ ~N f &#x2F;&#x2F; å†»ç»“åºæ•°ä¸ºNçš„çº¿ç¨‹ ~N u &#x2F;&#x2F; è§£å†»åºæ•°ä¸ºNçš„çº¿ç¨‹ ~N n &#x2F;&#x2F; Suspendåºæ•°ä¸ºNçš„çº¿ç¨‹ ~N m &#x2F;&#x2F; Resumeåºæ•°ä¸ºNçš„çº¿ç¨‹ ~* e !gle &#x2F;&#x2F; æ˜¾ç¤ºæ‰€æœ‰çº¿ç¨‹æœ€åçš„ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ eåå¯ä»¥ä¸ºä»»æ„windbgå‘½ä»¤ !runaway &#x2F;&#x2F;æ˜¾ç¤ºå½“å‰è¿›ç¨‹çš„æ‰€æœ‰çº¿ç¨‹æ—¶é—´ä¿¡æ¯ 3. æ–­ç‚¹ç±» bl &#x2F;&#x2F; åˆ—å‡ºæ‰€æœ‰æ–­ç‚¹ bc * &#x2F;&#x2F; æ¸…é™¤æ‰€æœ‰æ–­ç‚¹ bc 1 &#x2F;&#x2F; æ¸…é™¤1å·æ–­ç‚¹ bc 1 2 5 &#x2F;&#x2F; æ¸…é™¤1å·ã€2å·ã€5å·æ–­ç‚¹ be * &#x2F;&#x2F; å¯ç”¨æ‰€æœ‰æ–­ç‚¹ be 1 &#x2F;&#x2F; å¯ç”¨1å·æ–­ç‚¹ bd * &#x2F;&#x2F; ç¦ç”¨æ‰€æœ‰æ–­ç‚¹ bd 1 &#x2F;&#x2F; ç¦ç”¨1å·æ–­ç‚¹ bp bc701a00 &#x2F;&#x2F; åœ¨bc701a00åœ°å€å¤„æ”¾ç½®ä¸€ä¸ªæ–­ç‚¹ bp Test.cpp:36 &#x2F;&#x2F; åœ¨Test.cppçš„36è¡Œå¤„æ”¾ç½®ä¸€ä¸ªæ–­ç‚¹ bp main &#x2F;&#x2F; åœ¨mainå‡½æ•°çš„èµ·å§‹å¤„æ”¾ç½®ä¸€ä¸ªæ–­ç‚¹ bp Test.cpp:40 â€œ.if (poi(pVar)&gt;5) {}; {g}â€ &#x2F;&#x2F; â€œ.if (Condition) {Optional Commands}; {g}â€ &#x2F;&#x2F; æ¡ä»¶æ–­ç‚¹ pVaræŒ‡é’ˆæŒ‡å‘çš„å€¼&gt;5ï¼Œæ‰§è¡Œç©ºè¯­å¥ï¼ˆ;ï¼‰ï¼Œæ–­ä½ å¦åˆ™ç»§ç»­æ‰§è¡Œ 4. è°ƒè¯•æ§åˆ¶ç±» g &#x2F;&#x2F; Go(F5) gN &#x2F;&#x2F;ã€Go with Exception Not Handledã€‘æ‰§è¡ŒgNå‘½ä»¤å¼ºåˆ¶è®©è°ƒè¯•å™¨è¿”å›æ²¡æœ‰å¤„ç†äº†è¿™ä¸ªå¼‚å¸¸ï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šè¿›ä¸€æ­¥åˆ†å‘è¯¥å¼‚å¸¸ï¼Œ gu &#x2F;&#x2F; æ‰§è¡Œåˆ°å½“å‰å‡½æ•°å®Œæˆæ—¶åœä¸‹ ã€Go Upã€‘ Ctrl+Break &#x2F;&#x2F; æš‚åœæ­£åœ¨è¿è¡Œçš„ç¨‹åº p &#x2F;&#x2F; å•æ­¥æ‰§è¡Œ(F10) ã€Stepã€‘ p 2 &#x2F;&#x2F; 2ä¸ºæ­¥è¿›æ•°ç›® pc &#x2F;&#x2F; æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªå‡½æ•°è°ƒç”¨å¤„åœä¸‹ ã€Step to Nextã€€Callã€‘ pa 7c801b0b &#x2F;&#x2F; æ‰§è¡Œåˆ°7c801b0båœ°å€å¤„åœä¸‹ ã€Step to Adressã€‘ t &#x2F;&#x2F; Step into(F11)ã€€ã€Traceã€‘ tc &#x2F;&#x2F; æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªè¿›å…¥ç‚¹å¤„åœä¸‹ã€€ã€Trace to Next Callã€‘ ta 7c801b12 &#x2F;&#x2F; æ‰§è¡Œåˆ°7c801b12åœ°å€å¤„åœä¸‹ ã€Trace to Adressã€‘ 5. æŸ¥çœ‹å¥æŸ„ç±» !handle &#x2F;&#x2F; æŸ¥çœ‹æ‰€æœ‰å¥æŸ„çš„ID !handle 000007f8 1 &#x2F;&#x2F; æŸ¥çœ‹IDä¸º000007f8çš„å¥æŸ„çš„ç±»å‹ !handle 000007f8 4 &#x2F;&#x2F; æŸ¥çœ‹IDä¸º000007f8çš„å¥æŸ„çš„åç§° !handle 0 5 &#x2F;&#x2F; æŸ¥çœ‹æ‰€æœ‰å¥æŸ„çš„ç±»å‹å’Œåç§° 6. çº¿ç¨‹æ ˆç±» kb 5 &#x2F;&#x2F; åªæ˜¾ç¤ºæœ€ä¸Šçš„5å±‚è°ƒç”¨å †æ ˆ kv &#x2F;&#x2F; åœ¨kbçš„åŸºç¡€ä¸Šå¢åŠ äº†å‡½æ•°è°ƒç”¨çº¦å®šç­‰ä¿¡æ¯ kp &#x2F;&#x2F; æ˜¾ç¤ºæ¯ä¸€å±‚å‡½æ•°è°ƒç”¨çš„å®Œæ•´å‚æ•°ï¼ŒåŒ…æ‹¬å‚æ•°ç±»å‹ã€åå­—ã€å–å€¼ï¼ˆå¿…é¡»æ˜¯å®Œæ•´ç¬¦å·çš„æƒ…å†µä¸‹ï¼Œprivate symbolsï¼‰ï¼›æ³¨æ„ï¼šè‹¥ç¨‹åºè¢«ä¼˜åŒ–ï¼Œè¿™äº›å€¼ä¸ä¸€å®šå¯¹ kd &#x2F;&#x2F; æ‰“å°å †æ ˆçš„åœ°å€ .frame &#x2F;&#x2F; æ˜¾ç¤ºå½“å‰æ ˆå¸§ .frame n &#x2F;&#x2F; è®¾ç½®ç¼–å·nçš„æ ˆå¸§ä¸ºå½“å‰æ ˆå¸§ï¼ˆnä¸º16è¿›åˆ¶æ•°ï¼‰ .frame &#x2F;r n &#x2F;&#x2F; è®¾ç½®ç¼–å·nçš„æ ˆå¸§ä¸ºå½“å‰æ ˆå¸§ï¼ˆnä¸º16è¿›åˆ¶æ•°ï¼‰ å¹¶æ˜¾ç¤ºå¯„å­˜å™¨å˜é‡ !uniqstack &#x2F;&#x2F; æ˜¾ç¤ºæ‰€æœ‰çº¿ç¨‹çš„è°ƒç”¨å †æ ˆ 7. æ±‡ç¼–å’Œå¯„å­˜å™¨ç±» u . &#x2F;&#x2F; åæ±‡ç¼–å½“å‰ipå¯„å­˜å™¨åœ°å€çš„å8æ¡æŒ‡ä»¤ u $ip &#x2F;&#x2F; åæ±‡ç¼–å½“å‰ipå¯„å­˜å™¨åœ°å€çš„å8æ¡æŒ‡ä»¤ ub . &#x2F;&#x2F; åæ±‡ç¼–å½“å‰ipå¯„å­˜å™¨åœ°å€çš„å‰8æ¡æŒ‡ä»¤ ub $ip &#x2F;&#x2F; åæ±‡ç¼–å½“å‰ipå¯„å­˜å™¨åœ°å€çš„å‰8æ¡æŒ‡ä»¤ u main+0x29 L30 &#x2F;&#x2F; åæ±‡ç¼–main+0x29åœ°å€çš„å30æ¡æŒ‡ä»¤ u &#x2F;&#x2F; åç¼–è¯‘ä¸‹8æ¡æŒ‡ä»¤ uf CTest::add &#x2F;&#x2F; åæ±‡ç¼–CTestç±»çš„addå‡½æ•° uf &#x2F;c main &#x2F;&#x2F; åæ±‡ç¼–mainå‡½æ•°ï¼Œé€šè¿‡&#x2F;cå¯ä»¥æŸ¥çœ‹mainå‡½æ•°ä¸­çš„å‡½æ•°è°ƒç”¨(call)éƒ½æœ‰å“ªäº› ub 000c135d L20 &#x2F;&#x2F; æŸ¥çœ‹åœ°å€ä¸º000c135dæŒ‡ä»¤å‰çš„20æ¡æŒ‡ä»¤å†…å®¹ r &#x2F;&#x2F; æ˜¾ç¤ºæ‰€æœ‰å¯„å­˜å™¨ä¿¡æ¯åŠå‘ç”Ÿcoreæ‰€åœ¨çš„æŒ‡ä»¤ r eax, edx &#x2F;&#x2F; æ˜¾ç¤ºeaxï¼Œedxå¯„å­˜å™¨ä¿¡æ¯ r eax&#x3D;5, edx&#x3D;6 &#x2F;&#x2F; å¯¹å¯„å­˜å™¨eaxèµ‹å€¼ä¸º5ï¼Œedxèµ‹å€¼ä¸º6 6. åœ°å€å’Œè¿›åˆ¶è¡¨ç¤ºç±» dt &#x2F;&#x2F; æ˜¾ç¤ºæ•°æ®ç»“æ„ä¿¡æ¯ï¼Œå¯ä»¥ç”¨æ¥æŸ¥çœ‹ç‰¹å®šå†…å­˜åœ°å€å¤„çš„æ•°æ®ç»“æ„ã€‚ hi(x) &#x2F;&#x2F; é«˜16 bits low(x) &#x2F;&#x2F; ä½16 bits by(x) &#x2F;&#x2F; è¿”å›ç¬¬ä¸€ä¸ªbyte wo(x) &#x2F;&#x2F; è¿”å›ç¬¬ä¸€ä¸ªword dwo(x) &#x2F;&#x2F; è¿”å›ç¬¬ä¸€ä¸ªdword qwo(x) &#x2F;&#x2F; è¿”å›ç¬¬ä¸€ä¸ª4 word(Quad-word) poi(x) &#x2F;&#x2F; è¿”å›ç¬¬ä¸€ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„å€¼ 0nï¼ˆåè¿›åˆ¶ï¼‰ 0x (åå…­è¿›åˆ¶ï¼‰0t (8è¿›åˆ¶) 0y (2è¿›åˆ¶) 7. ç¬¦å·æ¨¡å— .sympath &#x2F;&#x2F; æŸ¥çœ‹å½“å‰ç¬¦å·æŸ¥æ‰¾è·¯å¾„ .sympath SRVC:\\mysymbolshttp://msdl.microsoft.com/download/symbols &#x2F;&#x2F; è®¾ç½®æœ¬åœ°å’Œè¿œç¨‹çš„ç¬¦å·è·¯å¾„ !sym noisy &#x2F;&#x2F; æ¿€æ´»è¯¦ç»†ç¬¦å·åŠ è½½(noisy symbol loading)æ˜¾ç¤º .reload &#x2F;&#x2F; ä¸ºæ‰€æœ‰å·²åŠ è½½æ¨¡å—è½½å…¥ç¬¦å·ä¿¡æ¯ ld * &#x2F;&#x2F; ä¸ºæ‰€æœ‰æ¨¡å—åŠ è½½ç¬¦å· ld kernel32 &#x2F;&#x2F; åŠ è½½kernel32.dllçš„ç¬¦å· lm &#x2F;&#x2F; åˆ—å‡ºæ‰€æœ‰æ¨¡å—ï¼ˆåŠ è½½å’ŒæœªåŠ è½½ï¼‰å¯¹åº”çš„ç¬¦å·ä¿¡æ¯ lmv &#x2F;&#x2F; åˆ—å‡ºæ‰€æœ‰æ¨¡å—ï¼ˆåŠ è½½å’ŒæœªåŠ è½½ï¼‰å¯¹åº”çš„ç¬¦å·ä¿¡æ¯ äºŒï¼šå¸¸è§æ‰˜ç®¡å‘½ä»¤1. å¸¸ç”¨å‘½ä»¤ !threadpool &#x2F;&#x2F; æŸ¥çœ‹çº¿ç¨‹æ± CPUä½¿ç”¨é‡ !threads &#x2F;&#x2F; æŸ¥çœ‹æ‰€æœ‰æ‰˜ç®¡çº¿ç¨‹æƒ…å†µ !clrstack &#x2F;&#x2F; æŸä¸ªçº¿ç¨‹æ‰˜ç®¡ä»£ç çš„è°ƒç”¨æ ˆæƒ…å†µ ~*e!clrstack &#x2F;&#x2F; æ‰€æœ‰çº¿ç¨‹æ‰˜ç®¡ä»£ç çš„è°ƒç”¨æ ˆæƒ…å†µ !runaway &#x2F;&#x2F; æŸ¥çœ‹çº¿ç¨‹å ç”¨CPUæ—¶é—´ !dumpstackobjectsï¼ˆ!dsoï¼‰ &#x2F;&#x2F; æœ¬çº¿ç¨‹è°ƒç”¨æ ˆæ‰€æœ‰å¯¹è±¡å®ä¾‹ !dumpdomain &#x2F;&#x2F; æ˜¾ç¤ºæ‰€æœ‰åŸŸé‡Œçš„ç¨‹åºé›†ï¼Œæˆ–è€…æ ¹æ®å‚æ•°è·å–æŒ‡å®šåŸŸã€‚ !savemodule &#x2F;&#x2F; æ ¹æ®å…·ä½“ç¨‹åºé›†åœ°å€ï¼ŒæŠŠå½“å‰ç¨‹åºé›†çš„ä»£ç ç”Ÿæˆåˆ°æŒ‡å®šæ–‡ä»¶ !PrintExceptionï¼ˆ!peï¼‰ &#x2F;&#x2F; æ˜¾ç¤ºåœ¨å½“å‰çº¿ç¨‹ä¸Šå¼•å‘çš„æœ€åä¸€ä¸ªå¼‚å¸¸é”™è¯¯ä¿¡æ¯ !VerifyHeap &#x2F;&#x2F; æ£€æŸ¥åƒåœ¾å›æ”¶å™¨å †ä¸­æ˜¯å¦æœ‰æŸåè¿¹è±¡ï¼Œå¹¶æ˜¾ç¤ºæ‰¾åˆ°ä»»ä½•é”™è¯¯ !syncblk &#x2F;&#x2F; æ˜¾ç¤ºåŒæ­¥å—è¡¨ä¿¡æ¯ 2.æŸ¥çœ‹å†…å­˜ !eeheap -gc &#x2F;&#x2F; æŸ¥çœ‹GCå †,æŸ¥çœ‹GCå †ä¸Šçš„å†…å­˜å ç”¨æ˜¯å¤šå¤§ !eeheap â€“loader &#x2F;&#x2F; æŸ¥çœ‹Loaderå † !dumpheap â€“stat &#x2F;&#x2F; GCå †ä¸Šçš„ç»Ÿè®¡,çœ‹GCå †ä¸Šå­˜æ´»çš„å¯¹è±¡æ˜¯é‚£äº› !dumpheap -mt 000c135d &#x2F;&#x2F; æŸ¥çœ‹æ‰˜ç®¡å †ä¸Šçš„æ­¤classçš„å®ä¾‹è¯¦ç»†åˆ—è¡¨ !dumpheap â€“type 000c135d &#x2F;&#x2F; åœ¨æ‰˜ç®¡å †ä¸Šæ¨¡ç³Šæœç´¢ç±»å !gcroot 000c135d &#x2F;&#x2F; å¾—åˆ°è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨â€æ ¹â€ !objsize 000c135d &#x2F;&#x2F; æŸ¥çœ‹å¯¹è±¡å ç”¨å¤šå¤§çš„å†…å­˜ !name2ee TestClass.exeTestClass.Program.test &#x2F;&#x2F; æ˜¾ç¤ºtestæ–¹æ³•ä¿¡æ¯ !dumpmt -md 00976d48 &#x2F;&#x2F; å¾—åˆ°ç±»çš„æˆå‘˜å‡½æ•°è¯¦ç»†ä¿¡æ¯ !dumpmt xxx &#x2F;&#x2F; æ‰¾åˆ°ç›¸å…³MethodTableå¤„çš„æœ‰å…³ä¿¡æ¯ !dumpmd xxx &#x2F;&#x2F; æ ¹æ®MethodDescæ‰¾åˆ°ç›¸å…³æ¨¡å—ä¿¡æ¯ï¼Œæ¯”å¦‚MethodTable. !dumpdomain &#x2F;&#x2F; æ˜¾ç¤ºæ‰€æœ‰åŸŸé‡Œçš„ç¨‹åºé›†ï¼Œæˆ–è€…æ ¹æ®å‚æ•°è·å–æŒ‡å®šåŸŸã€‚ !dumpil 00973028 &#x2F;&#x2F; æ˜¾ç¤ºè¿™ä¸ªæ–¹æ³•è¢«ç¼–è¯‘å™¨ç¼–è¯‘ä¹‹åçš„ILä»£ç  !dumpmodule 1ee30010 &#x2F;&#x2F; æŸ¥çœ‹æŸä¸ªæ¨¡å—çš„è¯¦ç»†ä¿¡æ¯ !finalizeQueue &#x2F;&#x2F; æ˜¾ç¤ºä¸ºç»ˆç»“(finalization)è€Œç™»è®°çš„æ‰€æœ‰å¯¹è±¡ã€‚ ä¸‰ï¼šæ‰€æœ‰å‘½ä»¤å‚è€ƒï¼š ä¸­æ–‡ç‰ˆï¼šhttps://learn.microsoft.com/zh-cn/windows-hardware/drivers/debuggercmds/commands è‹±æ–‡ç‰ˆï¼šwindbg ä¸­ä½¿ç”¨ .hh å‘½ä»¤è°ƒå‡º xxx.chm çš„å¸®åŠ©æ–‡æ¡£","tags":["windbg"],"categories":["é€†å‘"]},{"title":"PHPä»£ç å®¡è®¡ç¯å¢ƒè°ƒè¯•å‘ç‚¹æ±‡æ€»","path":"/p/7a303294/","content":"ä»£ç å®¡è®¡ç¯å¢ƒæ­å»ºæ³¨æ„ç»†èŠ‚1 php.iniå‚æ•°é—®é¢˜ï¼šğŸ’¡ 1.åœ¨phpç‰ˆæœ¬å°äº5.3æ—¶ï¼Œphp.inié‡Œé¢é…ç½®xdebugéœ€è¦å…ˆå…³é—­ZendOptimizerå’ŒZendDebuggerï¼Œåœ¨å‚æ•°æ–¹é¢æ³¨æ„çš„ç»†èŠ‚å°±æ˜¯php5.3ä¹‹åä½¿ç”¨è¯¥zend_extensionå‚æ•°ï¼Œphp5.3ä¹‹å‰åˆ™ä½¿ç”¨zend_extension_tså‚æ•°ã€‚ å…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516171819;php5.2å¦‚è¦å¯ç”¨Xdebugè¦å…ˆå…³é—­ZendOptimizerå’ŒZendDebuggerxdebug.profiler_append = 0xdebug.profiler_enable = 1xdebug.profiler_enable_trigger = 0xdebug.profiler_output_dir = &quot;../tmp&quot;xdebug.trace_output_dir = &quot;../tmp&quot;xdebug.profiler_output_name = &quot;cache.out.%t-%s&quot;xdebug.remote_enable = 1xdebug.remote_autostart = 1xdebug.remote_handler = &quot;dbgp&quot;xdebug.remote_host = &quot;127.0.0.1&quot;xdebug.remote_port = 9000xdebug.idekey = PHPSTORMzend_extension_ts=&quot;ä½ çš„PHPstudyè·¯å¾„\\PhpStudy\\PHPTutorial\\php\\php-5.2.17\\ext\\xdebug.dll&quot;[ZendDebugger];å…¨éƒ¨åˆ é™¤æˆ–è€…æ³¨é‡Šæ‰[Zend];ä»…ä¿ç•™ä¸‹é¢è¿™ä¸€è¡Œxdebug.zend_extension_ts=&quot;ä½ çš„PHPstudyè·¯å¾„\\PhpStudy\\PHPTutorial\\php\\php-5.2.17\\ext\\xdebug.dll&quot; æ³¨æ„ï¼šå› ä¸ºctrl+shift+få·²ç»è¢«å ç”¨äº†ï¼Œå¦‚æœæœ‰è¾“å…¥æ³•çš„è¯å°±æ‰“ä¸å¼€ï¼Œå°¤å…¶æ˜¯win10è‡ªå¸¦çš„ä¸­æ–‡è¾“å…¥æ³•ï¼Œctrl+shift+fæ˜¯ç®€ç¹ä½“çš„è½¬åŒ–ã€‚è¦æ‰“å¼€è‹±æ–‡çš„åŸè£…è¾“å…¥æ³•æ‰è¡Œã€‚å†æŒ‰ctrl+shift+få°±èƒ½å¤Ÿæ‰“å¼€å…¨å±€æœç´¢äº†ã€‚ 2 IDEA debugæ–­ç‚¹è°ƒè¯•å¸¸ç”¨å¿«æ·é”®F8ï¼šStep Over è·³è¿‡ï¼Œä¸€è¡Œä¸€è¡Œçš„å‘ä¸‹èµ°ï¼Œå¦‚æœå½“å‰è¡Œæœ‰æ–¹æ³•ä¸è¿›å…¥æ–¹æ³•ã€‚&#96; F7ï¼šStep Into è·³å…¥ï¼Œå¦‚æœå½“å‰æœ‰æ–¹æ³•ï¼Œè¿›å…¥æ–¹æ³•å†…éƒ¨ï¼Œä¸€èˆ¬ç”¨äºè¿›å…¥è‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œä¸ä¼šjdkç±»åº“çš„æ–¹æ³•ã€‚ F9ï¼šè·³åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„ã€‚ Shift+ F8ï¼šStep Out è·³å‡ºï¼Œä»è·³å…¥çš„æ–¹æ³•å†…é€€å‡ºåˆ°æ–¹æ³•è°ƒç”¨å¤„ï¼Œè¿™ä¸ªæ—¶å€™æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œåªæ˜¯è¿˜æ²¡æœ‰å®Œæˆèµ‹å€¼ Alt+ F8ï¼šEvaluate Expression,è®¡ç®—è¡¨è¾¾å¼çš„å€¼ã€‚ Alt+ F9ï¼šRun to Cursor:è¿è¡Œåˆ°å…‰æ ‡å¤„ï¼Œä½ å¯ä»¥å°†å…‰æ ‡å®šä½åˆ°ä½ éœ€è¦æŸ¥çœ‹çš„è¡Œï¼Œç„¶åä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œä»£ç ä¼šè¿è¡Œåˆ°å…‰æ ‡å¤„ï¼Œä¸éœ€è¦æ‰“æ–­ç‚¹ Alt+ F10ï¼šShow Exception Point:å¦‚æœä½ çš„å…‰æ ‡åœ¨å…¶å®ƒè¡Œæˆ–è€…å…¶å®ƒçš„é¡µé¢ï¼Œç‚¹å‡»è¿™ä¸ªæŒ‰é’®å¯è·³è½¬åˆ°å½“å‰ä»£ç æ‰§è¡Œçš„è¡Œ","tags":["PHP","è°ƒè¯•","debug"],"categories":["ä»£ç å®¡è®¡"]},{"title":"MVCè®¾è®¡æ¨¡å¼-1","path":"/p/988d33e4/","content":"1 MVCä»‹ç»1ã€MVCæ˜¯ä¸€ä¸ªç¼–ç¨‹æ€æƒ³ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ 2ã€æ€æƒ³ï¼šå°†ä¸€ä¸ªåŠŸèƒ½åˆ†è§£æˆ3ä¸ªéƒ¨åˆ†ï¼ŒM V C Modelï¼ˆæ¨¡å‹ï¼‰:å¤„ç†ä¸æ•°æ®æœ‰å…³çš„é€»è¾‘ Viewï¼ˆè§†å›¾ï¼‰:æ˜¾ç¤ºé¡µé¢ Controllerï¼ˆæ§åˆ¶å™¨ï¼‰:å¤„ç†ä¸šåŠ¡é€»è¾‘ å°ç»“ï¼š 1ã€æ§åˆ¶å™¨ç”¨æ¥æ¥æ”¶è¯·æ±‚ 2ã€ä»¥åä¸èƒ½ç›´æ¥è¯·æ±‚æ¨¡å‹å’Œè§†å›¾ 2 MVCæ¼”åŒ–2.1 æ˜¾ç¤ºå•†å“1ã€å¯¼å…¥productsè¡¨çš„æ•°æ® 2ã€å°†ä¸Šä¸€è®²çš„MyPDOç±»æ‹·è´åˆ°ç«™ç‚¹ä¸‹ï¼Œæ”¹åä¸ºMyPDO.class.phpï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­åªå­˜æ”¾MyPDOç±» 3ã€åœ¨ç«™ç‚¹ä¸‹åˆ›å»ºindex.phpï¼Œä»£ç å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637&lt;?php//è‡ªåŠ¨åŠ è½½ç±»spl_autoload_register(function($class_name)&#123; require &quot;./&#123;$class_name&#125;.class.php&quot;;&#125;);//è¿æ¥æ•°æ®åº“$param=array( &#x27;user&#x27; =&gt; &#x27;root&#x27;, &#x27;pwd&#x27; =&gt; &#x27;root&#x27;);$mypdo= MyPDO::getInstance($param);//è·å–å•†å“æ•°æ®$list=$mypdo-&gt;fetchAll(&#x27;select * from products&#x27;);?&gt;&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;title&gt;æ— æ ‡é¢˜æ–‡æ¡£&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;table border=&#x27;1&#x27; width=&#x27;980&#x27; bordercolor=&#x27;#000&#x27;&gt; &lt;tr&gt; &lt;th&gt;ç¼–å·&lt;/th&gt; &lt;th&gt;åç§°&lt;/th&gt; &lt;th&gt;ä»·æ ¼&lt;/th&gt; &lt;th&gt;åˆ é™¤&lt;/th&gt; &lt;/tr&gt; &lt;?php foreach($list as $rows):?&gt; &lt;tr&gt; &lt;td&gt;&lt;?=$rows[&#x27;proID&#x27;]?&gt;&lt;/td&gt; &lt;td&gt;&lt;?=$rows[&#x27;proname&#x27;]?&gt;&lt;/td&gt; &lt;td&gt;&lt;?=$rows[&#x27;proprice&#x27;]?&gt;&lt;/td&gt; &lt;td&gt;&lt;a href=&quot;&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt; &lt;?php endforeach;?&gt; &lt;/table&gt;&lt;/body&gt;&lt;/html&gt; 2.2 æ¼”åŒ–ä¸€ï¼šåˆ†ç¦»è§†å›¾1ã€åˆ›å»ºproducts_list.htmlé¡µé¢ï¼ˆè§†å›¾é¡µé¢ï¼‰,å°†æ˜¾ç¤ºéƒ¨åˆ†çš„ä»£ç æ‹·è´åˆ°è§†å›¾é¡µé¢ä¸Š 1234567891011121314151617181920212223&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;title&gt;æ— æ ‡é¢˜æ–‡æ¡£&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;table border=&#x27;1&#x27; width=&#x27;980&#x27; bordercolor=&#x27;#000&#x27;&gt; &lt;tr&gt; &lt;th&gt;ç¼–å·&lt;/th&gt; &lt;th&gt;åç§°&lt;/th&gt; &lt;th&gt;ä»·æ ¼&lt;/th&gt; &lt;th&gt;åˆ é™¤&lt;/th&gt; &lt;/tr&gt; &lt;?php foreach($list as $rows):?&gt; &lt;tr&gt; &lt;td&gt;&lt;?=$rows[&#x27;proID&#x27;]?&gt;&lt;/td&gt; &lt;td&gt;&lt;?=$rows[&#x27;proname&#x27;]?&gt;&lt;/td&gt; &lt;td&gt;&lt;?=$rows[&#x27;proprice&#x27;]?&gt;&lt;/td&gt; &lt;td&gt;&lt;a href=&quot;&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt; &lt;?php endforeach;?&gt; &lt;/table&gt;&lt;/body&gt;&lt;/html&gt; 2ã€åœ¨index.phpé¡µé¢ä¸ŠåŠ è½½è§†å›¾ 123456789101112131415&lt;?php//è‡ªåŠ¨åŠ è½½ç±»spl_autoload_register(function($class_name)&#123; require &quot;./&#123;$class_name&#125;.class.php&quot;;&#125;);//è¿æ¥æ•°æ®åº“$param=array( &#x27;user&#x27; =&gt; &#x27;root&#x27;, &#x27;pwd&#x27; =&gt; &#x27;root&#x27;);$mypdo= MyPDO::getInstance($param);//è·å–å•†å“æ•°æ®$list=$mypdo-&gt;fetchAll(&#x27;select * from products&#x27;);//åŠ è½½è§†å›¾require &#x27;./products_list.html&#x27;; 2.3 æ¼”åŒ–äºŒï¼šåˆ†ç¦»æ¨¡å‹æ¨¡å‹çš„è§„åˆ™ 1ã€ä¸€ä¸ªè¡¨å¯¹åº”ä¸€ä¸ªæ¨¡å‹ï¼Œè¡¨åå’Œæ¨¡å‹åä¸€è‡´ï¼ˆå¿…é¡»çš„ï¼‰ 2ã€æ¨¡å‹ä»¥Modelç»“å°¾ï¼ˆä¸æ˜¯å¿…é¡»çš„ï¼‰ ä»£ç å®ç°: 1ã€åœ¨ç«™ç‚¹ä¸‹åˆ›å»ºProductsModel.class.phpé¡µé¢ 123456789101112131415&lt;?php//productsæ¨¡å‹ç”¨æ¥æ“ä½œproductsè¡¨class ProductsModel &#123; //è·å–productsè¡¨çš„æ•°æ® public function getList() &#123; //è¿æ¥æ•°æ®åº“ $param=array( &#x27;user&#x27; =&gt; &#x27;root&#x27;, &#x27;pwd&#x27; =&gt; &#x27;root&#x27; ); $mypdo= MyPDO::getInstance($param); //è·å–å•†å“æ•°æ® return $mypdo-&gt;fetchAll(&#x27;select * from products&#x27;); &#125;&#125; 2ã€åœ¨index.phpé¡µé¢ä¸­è°ƒç”¨æ¨¡å‹çš„getList() 12345678910&lt;?php//è‡ªåŠ¨åŠ è½½ç±»spl_autoload_register(function($class_name)&#123; require &quot;./&#123;$class_name&#125;.class.php&quot;;&#125;);//å®ä¾‹åŒ–æ¨¡å‹$model=new ProductsModel();$list=$model-&gt;getList();//åŠ è½½è§†å›¾require &#x27;./products_list.html&#x27;; 2.4 æ¼”åŒ–ä¸‰ï¼šåˆ†ç¦»åŸºç¡€æ¨¡å‹è¿æ¥æ•°æ®åº“çš„ä»£ç æ¯ä¸ªæ¨¡å‹éƒ½è¦ä½¿ç”¨ï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦å°†è¿æ¥æ•°æ®åº“çš„ä»£ç å°è£…åˆ°åŸºç¡€æ¨¡å‹ç±»ä¸­ï¼ˆModelï¼‰ ç¬¬ä¸€æ­¥ï¼šåœ¨ç«™ç‚¹ä¸‹åˆ›å»ºModel.class.phpé¡µé¢ï¼ˆåŸºç¡€æ¨¡å‹ï¼‰ 12345678910111213141516&lt;?php//åŸºç¡€æ¨¡å‹class Model &#123; protected $mypdo; public function __construct() &#123; $this-&gt;initMyPDO(); &#125; //è¿æ¥æ•°æ®åº“ private function initMyPDO() &#123; $param=array( &#x27;user&#x27; =&gt; &#x27;root&#x27;, &#x27;pwd&#x27; =&gt; &#x27;root&#x27; ); $this-&gt;mypdo= MyPDO::getInstance($param); &#125;&#125; ç¬¬äºŒæ­¥ï¼šProductsModelç»§æ‰¿åŸºç¡€æ¨¡å‹ç±» 12345678&lt;?php//productsæ¨¡å‹ç”¨æ¥æ“ä½œproductsè¡¨class ProductsModel extends Model&#123; //è·å–productsè¡¨çš„æ•°æ® public function getList() &#123; return $this-&gt;mypdo-&gt;fetchAll(&#x27;select * from products&#x27;); &#125;&#125; 2.5 æ¼”åŒ–å››ï¼šåˆ†ç¦»æ§åˆ¶å™¨æ§åˆ¶å™¨ä»£ç æ”¾åœ¨index.phpé¡µé¢ä¸­æ˜¯ä¸åˆç†çš„ï¼Œå› ä¸ºé¡¹ç›®ä¸­çš„æ§åˆ¶å™¨ä¼šå¾ˆå¤šï¼Œè€Œindex.phpåªæœ‰ä¸€ä¸ªã€‚æ‰€ä»¥éœ€è¦å°†æ§åˆ¶å™¨åˆ†ç¦»å¼€æ¥ æ§åˆ¶å™¨çš„è§„åˆ™ï¼š 1ã€ä¸€ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆå¿…é¡»çš„ï¼‰ 2ã€æ§åˆ¶å™¨ä»¥Controllerç»“å°¾ï¼ˆä¸æ˜¯å¿…é¡»çš„ï¼‰ 3ã€æ§åˆ¶å™¨ä¸­çš„æ–¹æ³•ä»¥Actionç»“å°¾ï¼ˆä¸æ˜¯å¿…é¡»çš„ï¼‰,ç›®çš„é˜²æ­¢æ–¹æ³•åæ˜¯PHPå…³é”®å­— åˆ›å»ºProductsController.class.php 123456789101112&lt;?php//å•†å“æ¨¡å—class ProductsController &#123; //è·å–å•†å“åˆ—è¡¨ public function listAction() &#123; //å®ä¾‹åŒ–æ¨¡å‹ $model=new ProductsModel(); $list=$model-&gt;getList(); //åŠ è½½è§†å›¾ require &#x27;./products_list.html&#x27;; &#125;&#125; index.phpé¡µé¢ 123456789101112131415&lt;?php//è‡ªåŠ¨åŠ è½½ç±»spl_autoload_register(function($class_name)&#123; require &quot;./&#123;$class_name&#125;.class.php&quot;;&#125;);//ç¡®å®šè·¯ç”±$c=$_GET[&#x27;c&#x27;]??&#x27;Products&#x27;; //æ§åˆ¶å™¨$a=$_GET[&#x27;a&#x27;]??&#x27;list&#x27;; //æ–¹æ³•$c=ucfirst(strtolower($c)); //é¦–å­—æ¯å¤§å†™$a=strtolower($a); //è½¬æˆå°å†™$controller_name=$c.&#x27;Controller&#x27;; //æ‹¼æ¥æ§åˆ¶å™¨ç±»å$action_name=$a.&#x27;Action&#x27;; //æ‹¼æ¥æ–¹æ³•å//è¯·æ±‚åˆ†å‘$obj=new $controller_name();$obj-&gt;$action_name(); aï¼šæ–¹æ³• cï¼šæ§åˆ¶å™¨ é€šè¿‡åœ¨urlåœ°å€ä¸Šä¼ é€’å‚æ•°æ¥å¯»å€ã€‚ 3 åˆ é™¤å•†å“å°ç»“ï¼š æ³¨æ„ï¼šæ¯æ¬¡è¯·æ±‚éƒ½è¦ä»index.phpè¿›å…¥ã€‚æ‰€ä»¥index.phpåˆå«å…¥å£æ–‡ä»¶ã€‚ å…¥å£(products_list.html) 12&lt;td&gt;&lt;a href=&quot;index.php?c=Products&amp;a=del&amp;proid=&lt;?=$rows[&#x27;proID&#x27;]?&gt;&quot; onclick=&quot;return confirm(&#x27;ç¡®å®šè¦åˆ é™¤å—&#x27;)&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt; æ§åˆ¶å™¨ï¼ˆProductsControllerï¼‰ 1234567891011121314151617&lt;?php//å•†å“æ¨¡å—class ProductsController &#123;\t..\t//åˆ é™¤å•†å“\tpublic function delAction() &#123; $id=(int)$_GET[&#x27;proid&#x27;];\t//å¦‚æœå‚æ•°æ˜ç¡®æ˜¯æ•´æ•°ï¼Œè¦å¼ºåˆ¶è½¬æˆæ•´å½¢ $model=new ProductsModel(); if($model-&gt;del($id)) header(&#x27;location:index.php?c=Products&amp;a=list&#x27;); else &#123; echo &#x27;åˆ é™¤å¤±è´¥&#x27;; exit; &#125;\t&#125;&#125; æ¨¡å‹ï¼ˆProductsModelï¼‰ 12345678910&lt;?php//productsæ¨¡å‹ç”¨æ¥æ“ä½œproductsè¡¨class ProductsModel extends Model&#123;\t...\t//åˆ é™¤å•†å“\tpublic function del($proid) &#123; return $this-&gt;mypdo-&gt;exec(&quot;delete from products where proid=$proid&quot;);\t&#125;&#125;","tags":["PHP"],"categories":["Language"]},{"title":"MVCè®¾è®¡æ¨¡å¼-2","path":"/p/184625e/","content":"1 æ¡†æ¶ç›®å½•1.1 åˆ›å»ºç›®å½•ç»“æ„ 1.2 æ–‡ä»¶åˆ†ç±»å­˜æ”¾ å°†æ–‡ä»¶å­˜æ”¾åˆ°ä¸åŒçš„ç›®å½•ä»¥åï¼Œç”±äºç±»æ–‡ä»¶åœ°å€å‘ç”Ÿäº†å˜åŒ–ï¼Œæ‰€ä»¥æ— æ³•å®Œæˆè‡ªåŠ¨åŠ è½½ç±»ï¼Œé‚£ä¹ˆä»Šå¤©çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯å›´ç»•å¦‚ä½•å®ç°ç±»çš„è‡ªåŠ¨åŠ è½½å±•å¼€ã€‚ ç”±äºæ¯æ¬¡éƒ½è¯·æ±‚å…¥å£æ–‡ä»¶ï¼Œæ‰€ä»¥â€.â€œè¡¨ç¤ºå…¥å£æ–‡ä»¶æ‰€åœ¨çš„ç›®å½• 2 æ·»åŠ å‘½åç©ºé—´é€šè¿‡æ–‡ä»¶ç›®å½•åœ°å€åšå‘½åç©ºé—´ï¼Œè¿™æ ·è·å–äº†å‘½åç©ºé—´å°±èƒ½çŸ¥é“æ–‡ä»¶å­˜æ”¾çš„åœ°å€ã€‚ Model.class.php 123namespace Core;class Model &#123; ... MyPDO.class.php 123namespace Core;class MyPDO&#123; ... ProductsModel.class.php 12345&lt;?phpnamespace Model;//productsæ¨¡å‹ç”¨æ¥æ“ä½œproductsè¡¨class ProductsModel extends Model&#123; ... ProductsController.class.php 12345&lt;?phpnamespace Controller\\Admin;//å•†å“æ¨¡å—class ProductsController &#123; ... 3 æ¡†æ¶ç±»å®ç°3.1 å®šä¹‰è·¯å¾„å¸¸é‡ç”±äºæ–‡ä»¶è·¯å¾„ä½¿ç”¨é¢‘ç‡å¾ˆé«˜ï¼Œè€Œä¸”è·¯å¾„æ¯”è¾ƒé•¿ï¼Œæ‰€ä»¥å°†å›ºå®šä¸å˜çš„è·¯å¾„å®šä¹‰æˆè·¯å¾„å¸¸é‡ çŸ¥è¯†ç‚¹ 121ã€getcwd()ï¼šå…¥å£æ–‡ä»¶çš„ç»å¯¹è·¯å¾„2ã€windowsä¸‹é»˜è®¤çš„ç›®å½•åˆ†éš”ç¬¦æ˜¯`\\`ï¼ŒLinuxä¸‹é»˜è®¤çš„ç›®å½•åˆ†éš”ç¬¦æ˜¯`/`ã€‚DIRECTORY_SEPARATORå¸¸é‡æ ¹æ®ä¸åŒçš„æ“ä½œç³»ç»Ÿè¿”å›ä¸åŒçš„ç›®å½•åˆ†éš”ç¬¦ã€‚ ä»£ç å®ç° åœ¨Coreæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºFramework.class.php 12345678910111213private static function initConst()&#123; define(&#x27;DS&#x27;, DIRECTORY_SEPARATOR); //å®šä¹‰ç›®å½•åˆ†éš”ç¬¦ define(&#x27;ROOT_PATH&#x27;, getcwd().DS); //å…¥å£æ–‡ä»¶æ‰€åœ¨çš„ç›®å½• define(&#x27;APP_PATH&#x27;, ROOT_PATH.&#x27;Application&#x27;.DS); //applicationç›®å½• define(&#x27;CONFIG_PATH&#x27;, APP_PATH.&#x27;Config&#x27;.DS); define(&#x27;CONTROLLER_PATH&#x27;, APP_PATH.&#x27;Controller&#x27;.DS); define(&#x27;MODEL_PATH&#x27;, APP_PATH.&#x27;Model&#x27;.DS); define(&#x27;VIEW_PATH&#x27;, APP_PATH.&#x27;View&#x27;.DS); define(&#x27;FRAMEWORK_PATH&#x27;, ROOT_PATH.&#x27;Framework&#x27;.DS); define(&#x27;CORE_PATH&#x27;, FRAMEWORK_PATH.&#x27;Core&#x27;.DS); define(&#x27;LIB_PATH&#x27;, FRAMEWORK_PATH.&#x27;Lib&#x27;.DS); define(&#x27;TRAITS_PATH&#x27;, ROOT_PATH.&#x27;Traits&#x27;.DS);&#125; 3.2 å¼•å…¥é…ç½®æ–‡ä»¶1ã€åœ¨configç›®å½•ä¸‹åˆ›å»ºconfig.php 1234567891011&lt;?phpreturn array( //æ•°æ®åº“é…ç½® &#x27;database&#x27;=&gt;array(), //åº”ç”¨ç¨‹åºé…ç½® &#x27;app&#x27; =&gt;array( &#x27;dp&#x27; =&gt; &#x27;Admin&#x27;, //é»˜è®¤å¹³å° &#x27;dc&#x27; =&gt; &#x27;Products&#x27;, //é»˜è®¤æ§åˆ¶å™¨ &#x27;da&#x27; =&gt; &#x27;list&#x27; //é»˜è®¤æ–¹æ³• ),); 2ã€åœ¨æ¡†æ¶ç±»ä¸­å¼•å…¥é…ç½®æ–‡ä»¶ 123private static function initConfig()&#123; $GLOBALS[&#x27;config&#x27;]=require CONFIG_PATH.&#x27;config.php&#x27;;&#125; æ€è€ƒï¼šé…ç½®æ–‡ä»¶ä¸ºä»€ä¹ˆä¸ä¿å­˜åœ¨å¸¸é‡ä¸­ï¼Ÿ ç­”ï¼šå› ä¸º7.0ä¹‹å‰ï¼Œå¸¸é‡ä¸èƒ½ä¿å­˜æ•°ç»„å’Œå¯¹è±¡ã€‚ 3.3 ç¡®å®šè·¯ç”±pï¼šã€platformã€‘å¹³å° cï¼šã€controllerã€‘æ§åˆ¶å™¨ aï¼šã€actionã€‘æ–¹æ³• 12345678910111213private static function initRoutes()&#123; $p=$_GET[&#x27;p&#x27;]??$GLOBALS[&#x27;config&#x27;][&#x27;app&#x27;][&#x27;dp&#x27;]; $c=$_GET[&#x27;c&#x27;]??$GLOBALS[&#x27;config&#x27;][&#x27;app&#x27;][&#x27;dc&#x27;]; $a=$_GET[&#x27;a&#x27;]??$GLOBALS[&#x27;config&#x27;][&#x27;app&#x27;][&#x27;da&#x27;]; $p=ucfirst(strtolower($p)); $c=ucfirst(strtolower($c)); //é¦–å­—æ¯å¤§å†™ $a=strtolower($a); //è½¬æˆå°å†™ define(&#x27;PLATFROM_NAME&#x27;, $p); //å¹³å°åå¸¸é‡ define(&#x27;CONTROLLER_NAME&#x27;, $c); //æ§åˆ¶å™¨åå¸¸é‡ define(&#x27;ACTION_NAME&#x27;, $a); //æ–¹æ³•åå¸¸é‡ define(&#x27;__URL__&#x27;, CONTROLLER_PATH.$p.DS); //å½“å‰è¯·æ±‚æ§åˆ¶å™¨çš„ç›®å½•åœ°å€ define(&#x27;__VIEW__&#x27;,VIEW_PATH.$p.DS); //å½“å‰è§†å›¾çš„ç›®å½•åœ°å€&#125; 3.4 è‡ªåŠ¨åŠ è½½ç±»12345678910111213141516private static function initAutoLoad()&#123; spl_autoload_register(function($class_name)&#123; $namespace= dirname($class_name); //å‘½åç©ºé—´ $class_name= basename($class_name); //ç±»å if(in_array($namespace, array(&#x27;Core&#x27;,&#x27;Lib&#x27;))) //å‘½åç©ºé—´åœ¨Coreå’ŒLibä¸‹ $path= FRAMEWORK_PATH.$namespace.DS.$class_name.&#x27;.class.php&#x27;; elseif($namespace==&#x27;Model&#x27;) //æ–‡ä»¶åœ¨Modelä¸‹ $path=MODEL_PATH.$class_name.&#x27;.class.php&#x27;; elseif($namespace==&#x27;Traits&#x27;) //æ–‡ä»¶åœ¨Traitsä¸‹ $path=TRAITS_PATH.$class_name.&#x27;.class.php&#x27;; else //æ§åˆ¶å™¨ $path=CONTROLLER_PATH.PLATFROM_NAME.DS.$class_name.&#x27;.class.php&#x27;; if(file_exists($path) &amp;&amp; is_file($path)) require $path; &#125;);&#125; 3.5 è¯·æ±‚åˆ†å‘123456private static function initDispatch()&#123; $controller_name=&#x27;\\Controller\\\\&#x27;.PLATFROM_NAME.&#x27;\\\\&#x27;.CONTROLLER_NAME.&#x27;Controller&#x27;;\t//æ‹¼æ¥æ§åˆ¶å™¨ç±»å $action_name=ACTION_NAME.&#x27;Action&#x27;;\t//æ‹¼æ¥æ–¹æ³•å $obj=new $controller_name(); $obj-&gt;$action_name();&#125; 3.6 å°è£…run()æ–¹æ³•12345678910class Framework&#123; //å¯åŠ¨æ¡†æ¶ public static function run()&#123; self::initConst(); self::initConfig(); self::initRoutes(); self::initAutoLoad(); self::initDispatch(); &#125; ... 3.7 åœ¨å…¥å£ä¸­è°ƒç”¨run()æ–¹æ³•123&lt;?phprequire &#x27;./Framework/Core/Framework.class.php&#x27;;Framework::run(); run()æ–¹æ³•è°ƒç”¨åå°±å¯åŠ¨äº†æ¡†æ¶ 4 è¿è¡Œé¡¹ç›®1ã€è¿æ¥æ•°æ®åº“çš„å‚æ•°ä»é…ç½®æ–‡ä»¶ä¸­è·å– 1234567class Model &#123; ... //è¿æ¥æ•°æ®åº“ private function initMyPDO() &#123; $this-&gt;mypdo= MyPDO::getInstance($GLOBALS[&#x27;config&#x27;][&#x27;database&#x27;]); &#125;&#125; 2ã€æ›´æ”¹ProductsControlelleræ§åˆ¶å™¨ 12345678910111213141516171819&lt;?phpnamespace Controller\\Admin;//å•†å“æ¨¡å—class ProductsController &#123; //è·å–å•†å“åˆ—è¡¨ public function listAction() &#123; //å®ä¾‹åŒ–æ¨¡å‹ $model=new \\Model\\ProductsModel(); $list=$model-&gt;getList(); //åŠ è½½è§†å›¾ require __VIEW__.&#x27;products_list.html&#x27;; &#125; //åˆ é™¤å•†å“ public function delAction() &#123; ... $model=new \\Model\\ProductsModel(); ... &#125;&#125; 3ã€æ›´æ”¹ProductsModelç±» 12345&lt;?phpnamespace Model;class ProductsModel extends \\Core\\Model&#123;&#125; 4ã€æ›´æ”¹MyPDOç±» 123456789101112131415...private function fetchType($type)&#123; switch ($type)&#123; case &#x27;num&#x27;: return \\PDO::FETCH_NUM; case &#x27;both&#x27;: return \\PDO::FETCH_BOTH; case &#x27;obj&#x27;: return \\PDO::FETCH_OBJ; default: return \\PDO::FETCH_ASSOC; &#125;&#125;...//æ‰€æœ‰çš„å†…ç½®ç±»éƒ½åœ¨å…¬å…±çš„å‘½åç©ºé—´ä¸‹ã€‚ æµ‹è¯•ï¼šæˆåŠŸ 5 traitsä»£ç å¤ç”¨æœ‰çš„æ§åˆ¶å™¨æ“ä½œå®Œæ¯•åè¦è·³è½¬ï¼Œæœ‰çš„ä¸éœ€è¦ï¼Œ è§£å†³ï¼šå°†è·³è½¬çš„æ–¹æ³•å°è£…åˆ°traitsä¸­ã€‚ ä»£ç å®ç° 1ã€å°†å‡†å¤‡å¥½çš„å›¾ç‰‡æ‹·è´åˆ°Publicç›®å½•ä¸‹ 2ã€åœ¨Traitsç›®å½•ä¸­åˆ›å»ºJump.class.php 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;?php//è·³è½¬çš„æ’ä»¶namespace Traits;trait Jump&#123; //å°è£…æˆåŠŸçš„è·³è½¬ public function success($url,$info=&#x27;&#x27;,$time=1)&#123; $this-&gt;redirect($url, $info, $time, &#x27;success&#x27;); &#125; //å°è£…å¤±è´¥è·³è½¬ public function error($url,$info=&#x27;&#x27;,$time=3)&#123; $this-&gt;redirect($url, $info, $time, &#x27;error&#x27;); &#125; /* * ä½œç”¨ï¼šè·³è½¬çš„æ–¹æ³• * @param $url string è·³è½¬çš„åœ°å€ * @param $info string æ˜¾ç¤ºä¿¡æ¯ * @param $time int åœç•™æ—¶é—´ * @param $flag string æ˜¾ç¤ºæ¨¡å¼ success|error */ private function redirect($url,$info,$time,$flag)&#123; if($info==&#x27;&#x27;) header (&quot;location:&#123;$url&#125;&quot;); else&#123; echo &lt;&lt;&lt;str&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;!-- &lt;meta http-equiv=&quot;refresh&quot; content=&quot;3;http://www.php.com&quot;/&gt; --&gt; &lt;title&gt;Document&lt;/title&gt;&lt;style&gt;body&#123; text-align: center; font-family: &#x27;å¾®è½¯é›…é»‘&#x27;; font-size: 18px;&#125;#success,#error&#123; font-size: 36px; margin: 10px auto;&#125;#success&#123; color: #090;&#125;#error&#123; color: #F00;&#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;img src=&quot;/Public/images/&#123;$flag&#125;.fw.png&quot;&gt; &lt;div id=&#x27;&#123;$flag&#125;&#x27;&gt;&#123;$info&#125;&lt;/div&gt; &lt;div&gt;&lt;span id=&#x27;t&#x27;&gt;&#123;$time&#125;&lt;/span&gt;ç§’ä»¥åè·³è½¬&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;script&gt;window.onload=function()&#123; var t=&#123;$time&#125;; setInterval(function()&#123; document.getElementById(&#x27;t&#x27;).innerHTML=--t; if(t==0) location.href=&#x27;index.php&#x27;; &#125;,1000)&#125;&lt;/script&gt;str; exit; &#125; &#125;&#125; åœ¨ProductsControlleræ§åˆ¶å™¨ä¸­ä½¿ç”¨åŸå‹ 12345namespace Controller\\Admin;//å•†å“æ¨¡å—class ProductsController&#123; use \\Traits\\Jump; //å¤ç”¨ä»£ç  ... 6 åˆ é™¤åŠŸèƒ½å…¥å£ 1&lt;a href=&quot;index.php?p=Admin&amp;c=Products&amp;a=del&amp;proid=&lt;?=$rows[&#x27;proID&#x27;]?&gt;&quot; onclick=&quot;return confirm(&#x27;ç¡®å®šè¦åˆ é™¤å—&#x27;)&quot;&gt;åˆ é™¤&lt;/a&gt; æ§åˆ¶å™¨ï¼ˆProductsControllerï¼‰ 12345678public function delAction() &#123; $id=(int)$_GET[&#x27;proid&#x27;];\t//å¦‚æœå‚æ•°æ˜ç¡®æ˜¯æ•´æ•°ï¼Œè¦å¼ºåˆ¶è½¬æˆæ•´å½¢ $model=new \\\\Model\\\\ProductsModel(); if($model-&gt;del($id)) $this-&gt;success(&#x27;index.php?p=Admin&amp;c=Products&amp;a=list&#x27;, &#x27;åˆ é™¤æˆåŠŸ&#x27;); else $this-&gt;error(&#x27;index.php?p=admin&amp;c=Products&amp;a=list&#x27;, &#x27;åˆ é™¤å¤±è´¥&#x27;);&#125; æ¨¡å‹ã€è§†å›¾ 1æ— æ”¹å˜","tags":["PHP"],"categories":["Language"]},{"title":"PHP-PDO&PDOç±»&PDOæ ¸å¿ƒç±»&å°è£…PDOå•ä¾‹","path":"/p/cf780ffd/","content":"1 PDOä»‹ç»æ–¹æ³•ä¸€ï¼šmysqlæ‰©å±•ã€è¿™ç§æ–¹å¼php7å·²ç»æ·˜æ±°ã€‘æ–¹æ³•äºŒï¼šmysqliæ‰©å±•æ–¹æ³•ä¸‰ï¼šPDOæ‰©å±• 1.1 è¿æ¥æ•°æ®åº“æ–¹å¼1.2 PDOä»‹ç»PDOï¼ˆPHP Data Objectï¼‰æ‰©å±•ä¸ºPHPè®¿é—®å„ç§æ•°æ®åº“æä¾›äº†ä¸€ä¸ªè½»é‡çº§ï¼Œä¸€è‡´æ€§çš„æ¥å£ã€‚æ— è®ºè®¿é—®ä»€ä¹ˆæ•°æ®åº“ï¼Œéƒ½å¯ä»¥é€šè¿‡ä¸€è‡´æ€§çš„æ¥å£å»æ“ä½œã€‚ 1.3 å¼€å¯PDOæ‰©å±•å¼€å¯PDOè¿æ¥MySQLæ‰©å±• 1extension=php_pdo_mysql.dll 2 PDOæ ¸å¿ƒç±»1ã€PDOç±»ï¼šè¡¨ç¤ºPHPå’Œæ•°æ®åº“ä¹‹é—´çš„ä¸€ä¸ªè¿æ¥2ã€PDOStatement ç±» ç¬¬ä¸€ï¼šè¡¨ç¤ºæ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥ï¼ˆselect ,showï¼‰åçš„ç›¸å…³ç»“æœé›† ç¬¬äºŒï¼šé¢„å¤„ç†å¯¹è±¡3ã€PDOExceptionç±»ï¼šè¡¨ç¤ºPDOçš„å¼‚å¸¸ 3 å®ä¾‹åŒ–PDOå¯¹è±¡è¯­æ³• 1__construct($dsn,ç”¨æˆ·å,å¯†ç ) 3.1 DSNDSNï¼šdata source nameï¼Œæ•°æ®æºåç§°ï¼ŒåŒ…å«çš„æ˜¯è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š 1dsn=æ•°æ®åº“ç±»å‹:host=ä¸»æœºåœ°å€;port=ç«¯å£å·;dbname=æ•°æ®åº“åç§°;charset=å­—ç¬¦é›† æ•°æ®åº“ç±»å‹ï¼š 1234MySQLæ•°æ®åº“ =&gt; mysql:oracleæ•°æ®åº“ =&gt; oci:SQL Server =&gt;sqlsrv:å…·ä½“é©±åŠ¨ç±»å‹å‚è§æ‰‹å†Œâ€œPDOé©±åŠ¨â€ 3.2 å®ä¾‹åŒ–PDOå®ä¾‹åŒ–PDOçš„è¿‡ç¨‹å°±æ˜¯è¿æ¥æ•°æ®åº“çš„è¿‡ç¨‹ 1234&lt;?php$dsn=&#x27;mysql:host=localhost;port=3306;dbname=data;charset=utf8&#x27;;$pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;);var_dump($pdo); //object(PDO)#1 (0) &#123; &#125; 3.3 æ³¨æ„äº‹é¡¹1ã€å¦‚æœè¿æ¥çš„æ˜¯æœ¬åœ°æ•°æ®åº“ï¼Œhostå¯ä»¥çœç•¥ 1234&lt;?php$dsn=&#x27;mysql:port=3306;dbname=data;charset=utf8&#x27;;$pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;);var_dump($pdo); //object(PDO)#1 (0) &#123; &#125; 2ã€å¦‚æœä½¿ç”¨çš„æ˜¯3306ç«¯å£ï¼Œportå¯ä»¥çœç•¥ 1234&lt;?php$dsn=&#x27;mysql:dbname=data;charset=utf8&#x27;;$pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;);var_dump($pdo); //object(PDO)#1 (0) &#123; &#125; 3ã€charsetä¹Ÿçœç•¥ï¼Œå¦‚æœçœç•¥ï¼Œä½¿ç”¨çš„æ˜¯é»˜è®¤å­—ç¬¦ç¼–ç  1234&lt;?php$dsn=&#x27;mysql:dbname=data&#x27;;$pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;);var_dump($pdo); 4ã€dbnameä¹Ÿå¯ä»¥çœç•¥ï¼Œå¦‚æœçœç•¥å°±æ²¡æœ‰é€‰æ‹©æ•°æ®åº“ 1234&lt;?php$dsn=&#x27;mysql:&#x27;;$pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;);var_dump($pdo); 5ã€hostã€portã€dbnameã€charsetä¸åŒºåˆ†å¤§å°å†™ï¼Œæ²¡æœ‰å…ˆåé¡ºåº 6ã€é©±åŠ¨åç§°ä¸èƒ½çœç•¥ï¼Œå†’å·ä¸èƒ½çœç•¥ï¼ˆå› ä¸ºå†’å·æ˜¯é©±åŠ¨åç»„æˆéƒ¨åˆ†ï¼‰ï¼Œæ•°æ®åº“é©±åŠ¨åªèƒ½å°å†™ 4 ä½¿ç”¨PDO4.1 æ‰§è¡Œæ•°æ®æ“ä½œè¯­å¥æ–¹æ³•:$pdo-&gt;exec($sql)ï¼Œæ‰§è¡Œæ•°æ®å¢ã€åˆ ã€æ”¹è¯­å¥ï¼Œæ‰§è¡ŒæˆåŠŸè¿”å›å—å½±å“çš„è®°å½•æ•°ï¼Œå¦‚æœSQLè¯­å¥é”™è¯¯è¿”å›falseã€‚ 12345678910111213141516171819202122232425262728293031&lt;?php//1ã€å®ä¾‹åŒ–PDO$dsn=&#x27;mysql:host=localhost;port=3306;dbname=data;charset=utf8&#x27;;$pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;);//2æ‰§è¡Œæ•°æ®æ“ä½œè¯­å¥//2.1 æ‰§è¡Œå¢åŠ /*if($pdo-&gt;exec(&quot;insert into news values (null,&#x27;bb&#x27;,&#x27;bbbbbb&#x27;,unix_timestamp())&quot;)) echo &#x27;è‡ªåŠ¨å¢é•¿çš„ç¼–å·æ˜¯ï¼š&#x27;.$pdo-&gt;lastInsertId (),&#x27;&lt;br&gt;&#x27;;*///2.2 æ‰§è¡Œä¿®æ”¹//echo $pdo-&gt;exec(&quot;update news set title=&#x27;é™å¤œæ€&#x27; where id in (3,4)&quot;);//2.3 æ‰§è¡Œåˆ é™¤//echo $pdo-&gt;exec(&#x27;delete from news where id=5&#x27;);\\//2.4 å®Œå–„$sql=&quot;update news set title=&#x27;é™å¤œæ€1&#x27; where ids in (3,4)&quot;;$rs=$pdo-&gt;exec($sql);if($rs)&#123; echo &#x27;SQLè¯­å¥æ‰§è¡ŒæˆåŠŸ&lt;br&gt;&#x27;; if(substr($sql, 0,6)==&#x27;insert&#x27;) echo &#x27;è‡ªåŠ¨å¢é•¿çš„ç¼–å·æ˜¯ï¼š&#x27;.$pdo-&gt;lastInsertId (),&#x27;&lt;br&gt;&#x27;; else echo &#x27;å—åˆ°å½±å“çš„è®°å½•æ•°æ˜¯ï¼š&#x27;.$rs,&#x27;&lt;br&gt;&#x27;;&#125;elseif($rs===0)&#123; echo &#x27;æ•°æ®æ²¡æœ‰å˜åŒ–&lt;br&gt;&#x27;;&#125;elseif($rs===false)&#123; echo &#x27;SQLè¯­å¥æ‰§è¡Œå¤±è´¥&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ç¼–å·ï¼š&#x27;.$pdo-&gt;errorCode(),&#x27;&lt;br&gt;&#x27;; //var_dump($pdo-&gt;errorInfo()); echo &#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;.$pdo-&gt;errorInfo()[2];&#125; 4.2 æ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥æ–¹æ³•ï¼š$pdo-&gt;query($sql)ï¼Œè¿”å›çš„æ˜¯PDOStatementå¯¹è±¡ 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?php$dsn=&#x27;mysql:dbname=data;charset=utf8&#x27;;$pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;);//1ã€æ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥$stmt=$pdo-&gt;query(&#x27;select * from products&#x27;);//var_dump($stmt); //object(PDOStatement)//2ã€è·å–æ•°æ®//2.1 è·å–äºŒç»´æ•°ç»„//$rs=$stmt-&gt;fetchAll(); //é»˜è®¤è¿”å›å…³è”å’Œç´¢å¼•æ•°ç»„//$rs=$stmt-&gt;fetchAll(PDO::FETCH_BOTH); //è¿”å›å…³è”å’Œç´¢å¼•æ•°ç»„//$rs=$stmt-&gt;fetchAll(PDO::FETCH_NUM); //è¿”å›ç´¢å¼•æ•°ç»„//$rs=$stmt-&gt;fetchAll(PDO::FETCH_ASSOC); //è¿”å›å…³è”æ•°ç»„//$rs=$stmt-&gt;fetchAll(PDO::FETCH_OBJ); //è¿”å›å¯¹è±¡æ•°ç»„//2.2 è·å–ä¸€ç»´æ•°ç»„,åŒ¹é…å®ŒæˆåæŒ‡é’ˆä¸‹ç§»ä¸€æ¡//$rs=$stmt-&gt;fetch(); //å…³è”å’Œç´¢å¼•æ•°ç»„//$rs=$stmt-&gt;fetch(PDO::FETCH_NUM); //ç´¢å¼•æ•°ç»„//ä¾‹é¢˜ï¼šé€šè¿‡whileå¾ªç¯è·å–æ‰€æœ‰æ•°æ®/*while($row=$stmt-&gt;fetch(PDO::FETCH_ASSOC))&#123; $rs[]=$row;&#125;echo &#x27;&lt;pre&gt;&#x27;;var_dump($rs); *///3.3 åŒ¹é…åˆ—ï¼šåŒ¹é…å½“å‰è¡Œçš„ç¬¬nåˆ—ï¼Œåˆ—çš„ç¼–å·ä»0å¼€å§‹ï¼ŒåŒ¹é…å®Œæ¯•åæŒ‡é’ˆä¸‹ç§»ä¸€æ¡//echo $stmt-&gt;fetchColumn(); //è·å–å½“å‰è¡Œçš„ç¬¬0åˆ—//echo $stmt-&gt;fetchColumn(1); //è·å–å½“å‰è¡Œçš„ç¬¬1åˆ—//3.4 æ€»è¡Œæ•°ï¼Œæ€»åˆ—æ•°/*echo &#x27;æ€»è¡Œæ•°ï¼š&#x27;.$stmt-&gt;rowCount(),&#x27;&lt;br&gt;&#x27;;echo &#x27;æ€»åˆ—æ•°ï¼š&#x27;.$stmt-&gt;columnCount();*///3.5 éå†PDOStatementå¯¹è±¡ï¼ˆPDOStatementå¯¹è±¡æ˜¯æœ‰è¿­ä»£å™¨çš„ï¼‰foreach($stmt as $row)&#123; echo $row[&#x27;proname&#x27;],&#x27;-&#x27;,$row[&#x27;proprice&#x27;],&#x27;&lt;br&gt;&#x27;;&#125; 1stdClassç±»æ˜¯æ‰€æœ‰PHPç±»çš„çˆ¶ç±» 4.3 PDOæ“ä½œäº‹åŠ¡äº‹åŠ¡ï¼šæ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œè¦ä¹ˆä¸€èµ·æ‰§è¡Œï¼Œè¦ä¹ˆä¸€èµ·å›æ»š äº‹åŠ¡çš„ç‰¹æ€§ï¼šåŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§ï¼Œæ°¸ä¹…æ€§ éœ€è¦å°†å¤šä¸ªSQLè¯­å¥ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°äº‹åŠ¡ è¯­æ³• 123start transaction æˆ– begin å¼€å¯äº‹åŠ¡commit æäº¤äº‹åŠ¡rollback å›æ»šäº‹åŠ¡ å°ç»“ï¼š 123$pdo-&gt;beginTransaction() å¼€å¯äº‹åŠ¡$pdo-&gt;commit () æäº¤äº‹åŠ¡$pdo-&gt;rollBack() å›æ»šäº‹åŠ¡ 4.4 PDOæ“ä½œé¢„å¤„ç†5 PDOå¼‚å¸¸å¤„ç†123456789101112&lt;?phptry&#123; $dsn=&#x27;mysql:dbname=data;charset=utf8&#x27;; $pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;); //è¿™æ˜¯PDOé”™è¯¯æ¨¡å¼å±æ€§ï¼ŒPDOè‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸ $pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); $pdo-&gt;query(&#x27;select * from newsssssss&#x27;); //è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸&#125; catch (PDOException $ex) &#123; echo &#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;.$ex-&gt;getMessage(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯æ–‡ä»¶ï¼š&#x27;.$ex-&gt;getFile(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯è¡Œå·ï¼š&#x27;.$ex-&gt;getLine();&#125; å°ç»“ï¼š 1ã€PDOExceptionæ˜¯PDOçš„å¼‚å¸¸ç±» 2ã€å®ä¾‹åŒ–PDOä¼šè‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸ 3ã€å…¶ä»–æ“ä½œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œéœ€è¦è®¾ç½®PDOçš„å¼‚å¸¸æ¨¡å¼ 4ã€PDOå¼‚å¸¸æ¨¡å¼ 1234PDO::ERRMODE_EXCEPTION\tæŠ›å‡ºå¼‚å¸¸PDO::ERRMODE_SILENT ä¸­æ–­PDO::ERRMODE_WARNING\tè­¦å‘Š 6 å•ä¾‹æ¨¡å¼å°è£…MyPDOç±»6.1 æ­¥éª¤1ã€å•ä¾‹æ¨¡å¼ 2ã€åˆå§‹åŒ–å‚æ•° 3ã€è¿æ¥æ•°æ®åº“ 4ã€æ‰§è¡Œå¢åˆ æ”¹ 5ã€æ‰§è¡ŒæŸ¥è¯¢ aï¼‰è¿”å›äºŒç»´æ•°ç»„ bï¼‰è¿”å›ä¸€ç»´æ•°ç»„ cï¼‰è¿”å›ä¸€è¡Œä¸€åˆ— 6.2 ä»£ç å®ç°ç¬¬ä¸€éƒ¨åˆ†ï¼šå•ä¾‹ã€åˆå§‹åŒ–å‚æ•°ã€å®ä¾‹åŒ–PDO 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;?phpclass MyPDO&#123; private $type; //æ•°æ®åº“ç±»åˆ« private $host; //ä¸»æœºåœ°å€ private $port; //ç«¯å£å· private $dbname; //æ•°æ®åº“å private $charset; //å­—ç¬¦é›† private $user; //ç”¨æˆ·å private $pwd; //å¯†ç  private $pdo; //ä¿å­˜PDOå¯¹è±¡ private static $instance; private function __construct($param) &#123; $this-&gt;initParam($param); $this-&gt;initPDO(); &#125; private function __clone() &#123; &#125; public static function getInstance($param=array())&#123; if(!self::$instance instanceof self) self::$instance=new self($param); return self::$instance; &#125; //åˆå§‹åŒ–å‚æ•° private function initParam($param)&#123; $this-&gt;type=$param[&#x27;type&#x27;]??&#x27;mysql&#x27;; $this-&gt;host=$param[&#x27;host&#x27;]??&#x27;127.0.0.1&#x27;; $this-&gt;port=$param[&#x27;port&#x27;]??&#x27;3306&#x27;; $this-&gt;dbname=$param[&#x27;dbname&#x27;]??&#x27;data&#x27;; $this-&gt;charset=$param[&#x27;charset&#x27;]??&#x27;utf8&#x27;; $this-&gt;user=$param[&#x27;user&#x27;]??&#x27;root&#x27;; $this-&gt;pwd=$param[&#x27;pwd&#x27;]??&#x27;root&#x27;; &#125; //åˆå§‹åŒ–PDO private function initPDO()&#123; try&#123; $dsn=&quot;&#123;$this-&gt;type&#125;:host=&#123;$this-&gt;host&#125;;port=&#123;$this-&gt;port&#125;;dbname=&#123;$this-&gt;dbname&#125;;charset=&#123;$this-&gt;charset&#125;&quot;; $this-&gt;pdo=new PDO($dsn, $this-&gt;user, $this-&gt;pwd); &#125; catch (PDOException $ex) &#123; echo &#x27;é”™è¯¯ç¼–å·ï¼š&#x27;.$ex-&gt;getCode(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯è¡Œå·ï¼š&#x27;.$ex-&gt;getLine(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯æ–‡ä»¶ï¼š&#x27;.$ex-&gt;getFile(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;.$ex-&gt;getMessage(),&#x27;&lt;br&gt;&#x27;; exit; &#125; &#125;&#125;//æµ‹è¯•$param=array();$mypdo= MyPDO::getInstance($param);var_dump($mypdo); ç¬¬äºŒéƒ¨åˆ†ï¼šæ•°æ®æ“ä½œéƒ¨åˆ† 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182&lt;?phpclass MyPDO&#123; private $type; //æ•°æ®åº“ç±»åˆ« private $host; //ä¸»æœºåœ°å€ private $port; //ç«¯å£å· private $dbname; //æ•°æ®åº“å private $charset; //å­—ç¬¦é›† private $user; //ç”¨æˆ·å private $pwd; //å¯†ç  private $pdo; //ä¿å­˜PDOå¯¹è±¡ private static $instance; private function __construct($param) &#123; $this-&gt;initParam($param); $this-&gt;initPDO(); $this-&gt;initException(); &#125; private function __clone() &#123; &#125; public static function getInstance($param=array())&#123; if(!self::$instance instanceof self) self::$instance=new self($param); return self::$instance; &#125; //åˆå§‹åŒ–å‚æ•° private function initParam($param)&#123; $this-&gt;type=$param[&#x27;type&#x27;]??&#x27;mysql&#x27;; $this-&gt;host=$param[&#x27;host&#x27;]??&#x27;127.0.0.1&#x27;; $this-&gt;port=$param[&#x27;port&#x27;]??&#x27;3306&#x27;; $this-&gt;dbname=$param[&#x27;dbname&#x27;]??&#x27;data&#x27;; $this-&gt;charset=$param[&#x27;charset&#x27;]??&#x27;utf8&#x27;; $this-&gt;user=$param[&#x27;user&#x27;]??&#x27;root&#x27;; $this-&gt;pwd=$param[&#x27;pwd&#x27;]??&#x27;root&#x27;; &#125; //åˆå§‹åŒ–PDO private function initPDO()&#123; try&#123; $dsn=&quot;&#123;$this-&gt;type&#125;:host=&#123;$this-&gt;host&#125;;port=&#123;$this-&gt;port&#125;;dbname=&#123;$this-&gt;dbname&#125;;charset=&#123;$this-&gt;charset&#125;&quot;; $this-&gt;pdo=new PDO($dsn, $this-&gt;user, $this-&gt;pwd); &#125; catch (PDOException $ex) &#123; $this-&gt;showException($ex); exit; &#125; &#125; //æ˜¾ç¤ºå¼‚å¸¸ private function showException($ex,$sql=&#x27;&#x27;)&#123; if($sql!=&#x27;&#x27;)&#123; echo &#x27;SQLè¯­å¥æ‰§è¡Œå¤±è´¥&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯çš„SQLè¯­å¥æ˜¯ï¼š&#x27;.$sql,&#x27;&lt;br&gt;&#x27;; &#125; echo &#x27;é”™è¯¯ç¼–å·ï¼š&#x27;.$ex-&gt;getCode(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯è¡Œå·ï¼š&#x27;.$ex-&gt;getLine(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯æ–‡ä»¶ï¼š&#x27;.$ex-&gt;getFile(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;.$ex-&gt;getMessage(),&#x27;&lt;br&gt;&#x27;; &#125; //è®¾ç½®å¼‚å¸¸æ¨¡å¼ private function initException()&#123; $this-&gt;pdo-&gt;setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION); &#125; //æ‰§è¡Œå¢ã€åˆ ã€æ”¹æ“ä½œ public function exec($sql)&#123; try&#123; return $this-&gt;pdo-&gt;exec($sql); &#125; catch (PDOException $ex) &#123; $this-&gt;showException($ex, $sql); exit; &#125; &#125; //è·å–è‡ªåŠ¨å¢é•¿çš„ç¼–å· public function lastInsertId()&#123; return $this-&gt;pdo-&gt;lastInsertId(); &#125;&#125;//æµ‹è¯•$param=array();$mypdo= MyPDO::getInstance($param);//echo $mypdo-&gt;exec(&#x27;delete from news where id=6&#x27;);if($mypdo-&gt;exec(&quot;insert into news values (null,&#x27;11&#x27;,&#x27;1111&#x27;,unix_timestamp())&quot;)) echo &#x27;è‡ªåŠ¨å¢é•¿çš„ç¼–å·æ˜¯ï¼š&#x27;.$mypdo-&gt;lastInsertId (); ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ•°æ®æŸ¥è¯¢éƒ¨åˆ† 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;?phpclass MyPDO&#123; ... //åˆ¤æ–­åŒ¹é…çš„ç±»å‹ private function fetchType($type)&#123; switch ($type)&#123; case &#x27;num&#x27;: return PDO::FETCH_NUM; case &#x27;both&#x27;: return PDO::FETCH_BOTH; case &#x27;obj&#x27;: return PDO::FETCH_OBJ; default: return PDO::FETCH_ASSOC; &#125; &#125; //è·å–æ‰€æœ‰æ•°æ® ï¼Œè¿”å›äºŒç»´æ•°ç»„ public function fetchAll($sql,$type=&#x27;assoc&#x27;)&#123; try&#123; $stmt=$this-&gt;pdo-&gt;query($sql); //è·å–PDOStatementå¯¹è±¡ $type= $this-&gt;fetchType($type); //è·å–åŒ¹é…æ–¹æ³• return $stmt-&gt;fetchAll($type); &#125; catch (Exception $ex) &#123; $this-&gt;showException($ex, $sql); &#125; &#125; //è·å–ä¸€ç»´æ•°ç»„ public function fetchRow($sql,$type=&#x27;assoc&#x27;)&#123; try&#123; $stmt=$this-&gt;pdo-&gt;query($sql); //è·å–PDOStatementå¯¹è±¡ $type= $this-&gt;fetchType($type); //è·å–åŒ¹é…æ–¹æ³• return $stmt-&gt;fetch($type); &#125; catch (Exception $ex) &#123; $this-&gt;showException($ex, $sql); exit; &#125; &#125; //è¿”å›ä¸€è¡Œä¸€åˆ— public function fetchColumn($sql)&#123; try&#123; $stmt=$this-&gt;pdo-&gt;query($sql); return $stmt-&gt;fetchColumn(); &#125; catch (Exception $ex) &#123; $this-&gt;showException($ex, $sql); exit; &#125; &#125;&#125;//æµ‹è¯•$param=array();$mypdo= MyPDO::getInstance($param);//echo $mypdo-&gt;exec(&#x27;delete from news where id=6&#x27;);/*if($mypdo-&gt;exec(&quot;insert into news values (null,&#x27;11&#x27;,&#x27;1111&#x27;,unix_timestamp())&quot;)) echo &#x27;è‡ªåŠ¨å¢é•¿çš„ç¼–å·æ˜¯ï¼š&#x27;.$mypdo-&gt;lastInsertId (); *///$list=$mypdo-&gt;fetchAll(&#x27;select * from news&#x27;);//$list=$mypdo-&gt;fetchRow(&#x27;select * from news where id=1&#x27;);$list=$mypdo-&gt;fetchColumn(&#x27;select count(*) from news&#x27;);echo &#x27;&lt;pre&gt;&#x27;;var_dump($list); 3ã€$stmt-&gt;bindParam()å’Œ$stmt-&gt;bindValue()åŒºåˆ« 4ã€é¢„å¤„ç†çš„å¥½å¤„ 12a)æé«˜æ‰§è¡Œæ•ˆç‡b)æé«˜å®‰å…¨æ€§ 2ã€å‚æ•°å ä½ç¬¦ä»¥å†’å·å¼€å¤´ 1ã€?æ˜¯ä½ç½®å ä½ç¬¦ å°ç»“ï¼š 1234567891011121314151617181920&lt;?php$dsn=&#x27;mysql:dbname=data;charset=utf8&#x27;;$pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;);//åˆ›å»ºé¢„å¤„ç†å¯¹è±¡$stmt=$pdo-&gt;prepare(&quot;insert into bank values (:p1,:p2)&quot;); //:p1,:p2æ˜¯å‚æ•°å ä½ç¬¦//æ‰§è¡Œé¢„å¤„ç†$cards=[ [&#x27;p1&#x27;=&gt;&#x27;1003&#x27;,&#x27;p2&#x27;=&gt;500], [&#x27;p1&#x27;=&gt;&#x27;1004&#x27;,&#x27;p2&#x27;=&gt;1000]];foreach($cards as $card)&#123; //æ–¹æ³•ä¸€ï¼š /* $stmt-&gt;bindParam(&#x27;:p1&#x27;, $card[&#x27;p1&#x27;]); $stmt-&gt;bindParam(&#x27;:p2&#x27;, $card[&#x27;p2&#x27;]); $stmt-&gt;execute(); */ //æ–¹æ³•äºŒï¼šä½†æ•°ç»„çš„ä¸‹æ ‡å’Œå‚æ•°åä¸€è‡´çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ä¼ é€’å…³è”æ•°ç»„ $stmt-&gt;execute($card);&#125; PDOä¸­çš„é¢„å¤„ç†â€”â€”å‚æ•°å ä½ç¬¦ 123456789101112131415161718192021222324252627&lt;?php $dsn=&#x27;mysql:dbname=data;charset=utf8&#x27;; $pdo=new PDO($dsn,&#x27;root&#x27;,&#x27;root&#x27;); //åˆ›å»ºé¢„å¤„ç†å¯¹è±¡ $stmt=$pdo-&gt;prepare(&quot;insert into bank values (?,?)&quot;); //?æ˜¯å ä½ç¬¦ //æ‰§è¡Œé¢„å¤„ç† $cards=[ [&#x27;1003&#x27;,500], [&#x27;1004&#x27;,100] ]; foreach($cards as $card)&#123; //ç»‘å®šå‚æ•°ï¼Œå¹¶æ‰§è¡Œé¢„å¤„ç†, //æ–¹æ³•ä¸€ï¼š /* $stmt-&gt;bindParam(1, $card[0]); //å ä½ç¬¦çš„ä½ç½®ä»1å¼€å§‹ $stmt-&gt;bindParam(2, $card[1]); $stmt-&gt;execute(); //æ‰§è¡Œé¢„å¤„ç† */ //æ–¹æ³•äºŒï¼š /* $stmt-&gt;bindValue(1, $card[0]); $stmt-&gt;bindValue(2, $card[1]); $stmt-&gt;execute(); */ //æ–¹æ³•ä¸‰ï¼šå¦‚æœå ä½ç¬¦çš„é¡ºåºå’Œæ•°ç»„çš„é¡ºåºä¸€è‡´ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’æ•°ç»„ $stmt-&gt;execute($card); &#125; PDOä¸­çš„é¢„å¤„ç†â€”â€”ä½ç½®å ä½ç¬¦ 1execute é¢„å¤„ç†åå­— [using å˜é‡] æ‰§è¡Œé¢„å¤„ç† 1prepare é¢„å¤„ç†åå­— from &#x27;sqlè¯­å¥&#x27; é¢„å¤„ç†è¯­å¥ï¼š é¢„å¤„ç†å¥½å¤„ï¼šç¼–è¯‘ä¸€æ¬¡å¤šæ¬¡æ‰§è¡Œï¼Œç”¨æ¥è§£å†³ä¸€æ¡SQLè¯­å¥å¤šæ¬¡æ‰§è¡Œçš„é—®é¢˜ï¼Œæé«˜äº†æ‰§è¡Œæ•ˆç‡ã€‚ å¤ä¹ MySQLä¸­é¢„å¤„ç†","tags":["PHP"],"categories":["Language"]},{"title":"PHPé¢å‘å¯¹è±¡-4-å‘½åç©ºé—´&trait(åŸå‹)&è¿­ä»£å™¨","path":"/p/d71be832/","content":"1 å‘½åç©ºé—´1.1 ä»‹ç»åœ¨ä¸€ä¸ªå¤§çš„é¡¹ç›®ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°åŒåçš„ç±»ã€å‡½æ•°ã€å¸¸é‡ï¼Œä¸ºäº†åŒºåˆ†è¿™äº›å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›å…ƒç´ åˆ†åˆ«å­˜æ”¾åˆ°ä¸åŒçš„å‘½åç©ºé—´ä¸­ã€‚ 1ã€å‘½åç©ºé—´å°±æ˜¯åŒ…ï¼Œç”¨æ¥å­˜æ”¾é¡¹ç›®ä¸­çš„ç±»ã€å‡½æ•°ã€å¸¸é‡ 2ã€é€šè¿‡namespaceå…³é”®å­—æ¥å£°æ˜å‘½åç©ºé—´ 1.2 å£°æ˜å‘½åç©ºé—´1234567891011121314&lt;?phpnamespace China; //å®šä¹‰å‘½åç©ºé—´function getInfo() &#123; echo &#x27;æˆ‘æ˜¯ä¸­å›½äºº&lt;br&gt;&#x27;;&#125;namespace USA; //å®šä¹‰å‘½åç©ºé—´function getInfo() &#123; echo &#x27;I am a America&lt;br&gt;&#x27;;&#125;//è°ƒç”¨getInfo(); //I am a America\\USA\\getInfo(); //I am a America\\China\\getInfo(); //æˆ‘æ˜¯ä¸­å›½äºº æ³¨æ„ï¼š\\è¡¨ç¤ºå…¬å…±ç©ºé—´ 1.3 å¤šçº§å‘½åç©ºé—´å‘½åç©ºé—´çš„åå­—å¯ä»¥æ˜¯å¤šçº§çš„ï¼ˆå­çº§å‘½åç©ºé—´ï¼‰ã€‚ 123456789101112131415161718&lt;?phpnamespace China\\Beijing\\Shunyi;class Student &#123;&#125;namespace USA\\Washington;class Student &#123;&#125;//æµ‹è¯•ï¼š$stu1=new Student(); //ç›¸å¯¹è·¯å¾„$stu2=new \\USA\\Washington\\Student(); //ç»å¯¹è·¯å¾„$stu3=new \\China\\Beijing\\Shunyi\\Student(); //ç»å¯¹è·¯å¾„var_dump($stu1,$stu2,$stu3);//object(USA\\Washington\\Student)#1 (0) &#123; &#125;//object(USA\\Washington\\Student)#2 (0) &#123; &#125;//object(China\\Beijing\\Shunyi\\Student)#3 (0) &#123; &#125; æ€»ç»“ï¼šå¦‚æœå°†ç›¸å¯¹è·¯å¾„è½¬æˆç»å¯¹è·¯å¾„ 123å…¬å…±ç©ºé—´+å‘½åç©ºé—´+ç©ºé—´å…ƒç´ å…¬å…±ç©ºé—´ å‘½åç©ºé—´ ç©ºé—´å…ƒç´  \\ China\\Shanghai\\PuDong\\ Student 1.4 è®¿é—®ç©ºé—´å…ƒç´ çš„ä¸‰ç§æ–¹å¼1ã€éé™å®šåç§°è®¿é—® 2ã€å®Œå…¨é™å®šåç§°è®¿é—® 3ã€é™å®šåç§°è®¿é—® 12345678910111213141516&lt;?phpnamespace China\\Beijing\\Shunyi;function getInfo() &#123; echo &#x27;é¡ºä¹‰...&lt;br&gt;&#x27;;&#125;namespace China\\Beijing;function getInfo() &#123; echo &#x27;åŒ—äº¬...&lt;br&gt;&#x27;;&#125;//è®¿é—®ç©ºé—´å…ƒç´ çš„ä¸‰ç§æ–¹å¼getInfo(); //éé™å®šåç§°è®¿é—® åŒ—äº¬...\\China\\Beijing\\getInfo(); //å®Œå…¨é™å®šåç§°è®¿é—® åŒ—äº¬...Shunyi\\getInfo(); //é™å®šåç§°è®¿é—® é¡ºä¹‰...//è½¬æˆç»å¯¹è·¯å¾„å¦‚ä¸‹ï¼š// \\China\\Beijing\\Shunyi\\getInfo(); 1.5 å¼•å…¥å‘½åç©ºé—´å®Œå…¨é™å®šåç§°è®¿é—®å…ƒç´ è·¯å¾„å¤ªé•¿ï¼Œå¯ä»¥å°†å…¶ä»–ç©ºé—´å¼•å…¥åˆ°å½“å‰ç©ºé—´æ¥ é€šè¿‡useå¼•å…¥å‘½åç©ºé—´ 12345678910111213141516171819&lt;?phpnamespace China\\Beijing\\Shunyi;function getInfo() &#123; echo &#x27;æç™½&lt;br&gt;&#x27;;&#125;namespace USA;function getInfo() &#123; echo &#x27;Lincoln&lt;br&gt;&#x27;;&#125;//å¼•å…¥å‘½åç©ºé—´use China\\Beijing\\Shunyi;//æµ‹è¯•getInfo(); //LincolnShunyi\\getInfo(); //æç™½/*åˆ†æï¼šç¬¬ä¸€æ­¥ï¼šé€šè¿‡å½“å‰ç©ºé—´æ‹¼æ¥æˆç»å¯¹è·¯å¾„ï¼š\\USA\\Shunyi\\getInfo(),è¿™ä¸ªåœ°å€æ²¡æœ‰å¯¹åº”çš„ç©ºé—´å…ƒç´ ç¬¬äºŒæ­¥ï¼šé€šè¿‡å¼•å…¥çš„ç©ºé—´æ‹¼æ¥ç»å¯¹è·¯å¾„ï¼š\\China\\Beijing\\Shunyi+Shunyi\\getInfo(),Shunyiæ˜¯å…¬å…±éƒ¨åˆ†ï¼Œåªéœ€è¦å–ä¸€ä¸ªï¼Œæœ€åæ‹¼æ¥çš„åœ°å€æ˜¯ï¼š\\China\\Beijing\\Shunyi\\getInfo(),è¿™ä¸ªåœ°å€å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„å…ƒç´ */ å¼•å…¥å‘½åç©ºé—´çš„æ‹¼æ¥è§„åˆ™ 12345678910å…¬å…±ç©ºé—´+å¼•å…¥ç©ºé—´+ï¼ˆå»é™¤å…¬å…±éƒ¨åˆ†ï¼Œå…¬å…±éƒ¨åˆ†åªèƒ½æœ‰ä¸€çº§ï¼‰ç©ºé—´å…ƒç´ æ¯”å¦‚ï¼šnamespace A\\B\\C;function getInfo()&#123;&#125;namespace D\\E;use A\\B\\C; //å¼•å…¥å‘½åç©ºé—´C\\getInfo(); //æ­£ç¡® \\A\\B\\C\\getInfo();B\\C\\getInfo(); //é”™è¯¯ \\A\\B\\C\\B\\C\\getInfo(); 1.6 å¼•å…¥ç©ºé—´å…ƒç´ å¼•å…¥ç±»ï¼šuse å¼•å…¥å‡½æ•°ï¼šuse function [php7.0ä»¥åæ”¯æŒ] å¼•å…¥å¸¸é‡ï¼šuse const\t[php7.0ä»¥åæ”¯æŒ] 12345678910111213141516171819202122&lt;?phpnamespace China\\Beijing\\Shunyi;class Student &#123;&#125;function getInfo() &#123; echo &#x27;æç™½&lt;br&gt;&#x27;;&#125;const TYPE=&#x27;å­¦ç”Ÿ&#x27;;namespace USA;//å¼•å…¥ç±»use China\\Beijing\\Shunyi\\Student;//å¼•å…¥å‡½æ•°use function China\\Beijing\\Shunyi\\getInfo;//å¼•å…¥å¸¸é‡use const China\\Beijing\\Shunyi\\TYPE;//æµ‹è¯•$stu=new Student;var_dump($stu);echo &#x27;&lt;br&gt;&#x27;;getInfo();echo TYPE; 1.7 ç»™ç±»ã€å‡½æ•°å–åˆ«åå¦‚æœå¼•å…¥çš„ç±»å’Œå‡½æ•°ä¸å½“å‰ç©ºé—´çš„ç±»å’Œå‡½æ•°åç§°ç›¸åŒï¼Œéœ€è¦ç»™å¼•å…¥çš„ç±»å’Œå‡½æ•°å–åˆ«åã€‚ é€šè¿‡aså–åˆ«å 1234567891011121314151617181920212223242526&lt;?phpnamespace China\\Beijing\\Shunyi;class Student &#123;&#125;function getInfo() &#123; echo &#x27;æç™½&lt;br&gt;&#x27;;&#125;namespace USA\\Washington;class Student &#123;&#125;function getInfo() &#123; echo &#x27;Lincoln&lt;br&gt;&#x27;;&#125;//å¼•å…¥ç±»å–åˆ«åuse China\\Beijing\\Shunyi\\Student as ChinaStudent;//å¼•å…¥å‡½æ•°use function China\\Beijing\\Shunyi\\getInfo as info1;//æµ‹è¯•$stu=new ChinaStudent;var_dump($stu);getInfo(); //Lincolninfo1(); //æç™½ 1.8 å…¬å…±ç©ºé—´å¦‚æœä¸€ä¸ªé¡µé¢æ²¡æœ‰namespaceå£°æ˜ç©ºé—´ï¼Œè¿™ä¸ªé¡µé¢çš„å…ƒç´ åœ¨å…¬å…±ç©ºé—´ä¸‹ å…¬å…±ç©ºé—´ç”¨\\è¡¨ç¤º 12345&lt;?phpfunction getInfo() &#123; echo &#x27;æç™½&lt;br&gt;&#x27;;&#125;\\getInfo(); //æç™½ 1.9 å‘½åç©ºé—´æ³¨æ„äº‹é¡¹1ã€å‘½åç©ºé—´åªèƒ½å­˜æ”¾ç±»ã€å‡½æ•°ã€constå¸¸é‡ 2ã€ç¬¬ä¸€ä¸ªnamespaceå‰é¢ä¸èƒ½æœ‰ä»»ä½•çš„ä»£ç ï¼Œç©ºç™½å­—ç¬¦ã€header()ä¹Ÿä¸è¡Œã€‚ 3ã€åŒ…å«æ–‡ä»¶ä¸å½±å“å½“å‰çš„å‘½åç©ºé—´ 2 trait(åŸå‹)trait ä¸ºäº†å‡å°‘å•ç»§æ‰¿è¯­è¨€çš„é™åˆ¶ï¼Œå¯ä»¥åœ¨ä¸åŒå±‚æ¬¡ç»“æ„å†…ç‹¬ç«‹çš„ç±»ä¸­å¤ç”¨ç±»çš„æ–¹æ³•é›†ã€‚ 1234567891011121314&lt;?php//åŸå‹trait A&#123; public function getInfo() &#123; echo &#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;; &#125;&#125;//ä½¿ç”¨åŸå‹class Student &#123; use A; //ä»£ç å¤ç”¨&#125;//æµ‹è¯•$stu=new Student;$stu-&gt;getInfo(); //é”„ç¦¾æ—¥å½“åˆ å¼•å…¥å¤šä¸ª trait 1234567891011121314151617181920&lt;?php//åŸå‹trait A&#123; public function getInfo1() &#123; echo &#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;; &#125;&#125;trait B&#123; public function getInfo2() &#123; echo &#x27;åºŠå‰æ˜æœˆå…‰&lt;br&gt;&#x27;; &#125;&#125;//ä½¿ç”¨åŸå‹class Student &#123; use A,B; //å¼•å…¥Aã€B trait&#125;//æµ‹è¯•$stu=new Student;$stu-&gt;getInfo1(); //é”„ç¦¾æ—¥å½“åˆ$stu-&gt;getInfo2(); //åºŠå‰æ˜æœˆå…‰ traitå’Œç»§æ‰¿ç»“åˆ 123456789101112131415161718&lt;?phptrait A&#123; public function getInfo() &#123; echo &#x27;è¿™æ˜¯traitåŸå‹&lt;br&gt;&#x27;; &#125;&#125;class Person &#123; public function getInfo() &#123; echo &#x27;è¿™æ˜¯Personç±»&lt;br&gt;&#x27;; &#125;&#125;//ç»§æ‰¿ç±»åŒæ—¶ä»£ç å¤ç”¨class Student extends Person &#123; use A; //ç»§æ‰¿äº†getInfoï¼Œæœ‰è¢«Aä¸­getInfoè¦†ç›–&#125;//æµ‹è¯•$stu=new Student;$stu-&gt;getInfo(); //è¿™æ˜¯traitåŸå‹ è§£å†³åŒåå†²çª 1234567891011121314151617181920212223242526272829303132&lt;?php//åŸå‹trait A&#123; public function getInfo() &#123; echo &#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;; &#125;&#125;trait B&#123; public function getInfo() &#123; echo &#x27;åºŠå‰æ˜æœˆå…‰&lt;br&gt;&#x27;; &#125;&#125;//ä½¿ç”¨åŸå‹class Student &#123; use A,B&#123; //å¼•å…¥Aå’ŒBçš„traitï¼ŒåŒæ—¶è§£å†³åç§°å†²çª //æ–¹æ³•ä¸€ï¼šæ–¹æ³•æ›¿æ¢ //A::getInfo insteadof B; //å°†Aä¸­çš„getInfoæ›¿æ¢æ‰Bä¸­çš„getInfo //B::getInfo insteadof A; //å°†Bä¸­çš„getInfoæ›¿æ¢åˆ°Aä¸­çš„getInfo //æ–¹æ³•äºŒï¼šæ”¹å A::getInfo insteadof B; B::getInfo as show; //å°†Bçš„getInfoæ”¹åä¸ºshow &#125;&#125;//æµ‹è¯•$stu=new Student;$stu-&gt;getInfo(); //é”„ç¦¾æ—¥å½“åˆ$stu-&gt;show(); //åºŠå‰æ˜æœˆå…‰/*åŒåå†²çªçš„è§£å†³æ–¹æ³•æœ‰ä¸¤ä¸ªï¼šç¬¬ä¸€ï¼šæ–¹æ³•æ›¿æ¢ç¬¬äºŒï¼šæ–¹æ³•æ”¹å æ›´æ”¹æƒé™ 1234567891011121314151617&lt;?phptrait A&#123; private function show() &#123; echo &#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;; &#125;&#125;class Student &#123; use A&#123; //show as public; //å°†showæ–¹æ³•æƒé™è®¾ä¸ºpublic; show as public show2; //å°†showæ–¹æ³•è®¾ç½®publicï¼Œå¹¶æ”¹åä¸ºshow2 &#125;&#125;$stu=new Student;//$stu-&gt;show();$stu-&gt;show2(); å¤šå­¦ä¸€æ‹›ï¼šå…·ä½“å‚è§æ‰‹å†Œ 1ã€ å¤šä¸ªtraitå¯ä»¥ç»„æˆä¸€ä¸ªtrait 2ã€ traitå¯ä»¥å®šä¹‰æŠ½è±¡æˆå‘˜ 3ã€ traitå¯ä»¥å®šä¹‰é™æ€æˆå‘˜ 4ã€ traitå¯ä»¥å®šä¹‰å±æ€§ 3 è¿­ä»£å™¨3.1 éå†æ•°ç»„æ‰‹åŠ¨éå†æ•°ç»„ æ­¥éª¤ï¼š 1ã€å¤ä½æ•°ç»„æŒ‡é’ˆ reset() 2ã€æ£€æŸ¥æŒ‡é’ˆæ˜¯å¦åˆæ³•\tè·å–å½“å‰æŒ‡é’ˆï¼Œå¦‚æœä¸ä¸ºnullå°±æ˜¯åˆæ³•çš„ 3ã€è·å–å½“å‰å€¼ current() 4ã€è·å–å½“å‰é”® key() 5ã€æŒ‡é’ˆä¸‹ç§» next() ä»£ç å®ç° 12345678910111213&lt;?php$stu=[&#x27;tom&#x27;,&#x27;berry&#x27;,&#x27;ketty&#x27;,&#x27;rose&#x27;];reset($stu); //å¤ä½æŒ‡é’ˆwhile(key($stu)!==null)&#123;//é”®åˆæ³• echo key($stu),&#x27;-&#x27;,current($stu),&#x27;&lt;br&gt;&#x27;;//è·å–é”®ã€å€¼ next($stu); //æŒ‡é’ˆä¸‹ç§»&#125;/*0-tom1-berry2-ketty3-rose*/ 3.2 è¿­ä»£å™¨è¿­ä»£å™¨æ˜¯PHPå†…ç½®çš„æ¥å£ åœºæ™¯ï¼šéå†å¯¹è±¡ï¼Œè·å–çš„æ˜¯å¯¹è±¡ä¸­å±æ€§ä¿å­˜çš„æ•°ç»„ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;?php//å®šä¹‰ç±»å®ç°è¿­ä»£å™¨æ¥å£class MyClass implements Iterator&#123; //$listå±æ€§ç”¨æ¥ä¿å­˜å­¦ç”Ÿæ•°ç»„ private $list=array(); //æ·»åŠ å­¦ç”Ÿ public function addStu($name) &#123; $this-&gt;list[]=$name; &#125; //å®ç°æ¥å£ä¸­çš„å¤ä½æ–¹æ³• public function rewind() &#123; reset($this-&gt;list); &#125; //éªŒè¯å½“å‰æŒ‡é’ˆæ˜¯å¦åˆæ³• public function valid() &#123; return key($this-&gt;list)!==null; &#125; //è·å–å€¼ public function current() &#123; return current($this-&gt;list); &#125; //è·å–é”® public function key() &#123; return key($this-&gt;list); &#125; //æŒ‡é’ˆä¸‹ç§» public function next() &#123; next($this-&gt;list); &#125;&#125;//åˆ›å»ºç­çº§$class=new MyClass();//æ·»åŠ å­¦ç”Ÿ$class-&gt;addStu(&#x27;tom&#x27;);$class-&gt;addStu(&#x27;berry&#x27;);$class-&gt;addStu(&#x27;ketty&#x27;);//éå†ç­çº§foreach($class as $k=&gt;$v)&#123; echo &quot;&#123;$k&#125;-&#123;$v&#125;&lt;br&gt;&quot;;&#125;/*0-tom1-berry2-ketty*/ 4 PSRç¼–ç è§„èŒƒ4.1 æ¦‚è¿° PSR æ˜¯ PHP Standard Recommendations çš„ç®€å†™ï¼Œç”± PHP FIG ç»„ç»‡åˆ¶å®šçš„ PHP è§„èŒƒï¼Œæ˜¯ PHP å¼€å‘çš„å®è·µæ ‡å‡†ã€‚ ç›®å‰å·²è¡¨å†³é€šè¿‡äº† 6 å¥—æ ‡å‡†ï¼Œå·²ç»å¾—åˆ°å¤§éƒ¨åˆ† PHP æ¡†æ¶çš„æ”¯æŒå’Œè®¤å¯ã€‚ ç½‘å€ï¼šhttp://psr.phphub.org/ 4.2 PSR-1 åŸºç¡€ç¼–ç è§„èŒƒ12341ã€PHPä»£ç æ–‡ä»¶ å¿…é¡» ä»¥ &lt;?php æˆ– &lt;?= æ ‡ç­¾å¼€å§‹2ã€ç±»çš„å‘½åå¤§å†™å¼€å¤´çš„é©¼å³°å‘½åè§„èŒƒ3ã€ç±»ä¸­çš„å¸¸é‡æ‰€æœ‰å­—æ¯éƒ½å¿…é¡»å¤§å†™ï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿åˆ†éš”4ã€æ–¹æ³•åç§°å¿…é¡»ç¬¦åˆå°å†™å¼€å¤´é©¼å³°å‘½åè§„èŒƒ5ã€ å‰¯ä½œç”¨ï¼š(side effects)ï¼Œä¸€ä¸ªæ–‡ä»¶åªåšä¸€ä»¶äº‹æƒ…ï¼Œå¦‚æœåšäº†å…¶ä»–äº‹æƒ…å°±æ˜¯äº§ç”Ÿäº†å‰¯ä½œç”¨ ä¸äº§ç”Ÿå‰¯ä½œç”¨ï¼šä¸€ä¸ªæ–‡ä»¶åªåšä¸€ä»¶äº‹ äº§ç”Ÿå‰¯ä½œç”¨ï¼šä¸€ä¸ªæ–‡ä»¶åšäº†å¤šä»¶äº‹æƒ… 4.3 PSR-2 ç¼–ç é£æ ¼è§„èŒƒ12345ä»£ç  å¿…é¡» ä½¿ç”¨ 4 ä¸ªç©ºæ ¼ç¬¦è€Œä¸æ˜¯ã€ŒTab é”®ã€è¿›è¡Œç¼©è¿›æ¯ä¸ª namespace å‘½åç©ºé—´å£°æ˜è¯­å¥å’Œ use å£°æ˜è¯­å¥å—åé¢ï¼Œå¿…é¡» æ’å…¥ä¸€ä¸ªç©ºç™½è¡Œç±»çš„å¼€å§‹èŠ±æ‹¬å·ï¼ˆ&#123;ï¼‰ å¿…é¡» å†™åœ¨ç±»å£°æ˜åè‡ªæˆä¸€è¡Œï¼Œç»“æŸèŠ±æ‹¬å·ï¼ˆ&#125;ï¼‰ä¹Ÿ å¿…é¡» å†™åœ¨ç±»ä¸»ä½“åè‡ªæˆä¸€è¡Œæ–¹æ³•çš„å¼€å§‹èŠ±æ‹¬å·ï¼ˆ&#123;ï¼‰ å¿…é¡» å†™åœ¨å‡½æ•°å£°æ˜åè‡ªæˆä¸€è¡Œï¼Œç»“æŸèŠ±æ‹¬å·ï¼ˆ&#125;ï¼‰ä¹Ÿ å¿…é¡» å†™åœ¨å‡½æ•°ä¸»ä½“åè‡ªæˆä¸€è¡Œã€‚ç±»çš„å±æ€§å’Œæ–¹æ³• å¿…é¡» æ·»åŠ è®¿é—®ä¿®é¥°ç¬¦ï¼ˆprivateã€protected ä»¥åŠ publicï¼‰ï¼Œabstract ä»¥åŠ final å¿…é¡» å£°æ˜åœ¨è®¿é—®ä¿®é¥°ç¬¦ä¹‹å‰ï¼Œè€Œ static å¿…é¡» å£°æ˜åœ¨è®¿é—®ä¿®é¥°ç¬¦ä¹‹åã€‚","tags":["PHP"],"categories":["Language"]},{"title":"PHPé¢å‘å¯¹è±¡-3-åŠ è½½ç±»&è®¾è®¡æ¨¡å¼&é­”æœ¯æ–¹æ³•&åºåˆ—åŒ–","path":"/p/be32be3e/","content":"1 è‡ªåŠ¨åŠ è½½ç±»1.1 ç±»çš„è§„åˆ™ ä¸€ä¸ªæ–‡ä»¶ä¸­åªèƒ½æ”¾ä¸€ä¸ªç±»ï¼ˆå¿…é¡»ï¼‰ æ–‡ä»¶åå’Œç±»ååŒåï¼ˆå¿…é¡»ï¼‰ ç±»æ–‡ä»¶ä»¥.class.phpç»“å°¾ï¼ˆä¸æ˜¯å¿…é¡»ï¼‰ 1.2 æ‰‹åŠ¨åŠ è½½ç±»åœ¨PHPé¡µé¢ä¸ŠåŠ è½½ç±»æ–‡ä»¶ 1234567891011&lt;?phprequire &#x27;./Goods.class.php&#x27;; //æ‰‹åŠ¨åŠ è½½ç±»æ–‡ä»¶require &#x27;./Book.class.php&#x27;; //æ‰‹åŠ¨åŠ è½½ç±»æ–‡ä»¶require &#x27;./Phone.class.php&#x27;; //æ‰‹åŠ¨åŠ è½½ç±»æ–‡ä»¶//æµ‹è¯•$book=new Book();$book-&gt;setName(&#x27;é¢å‘å¯¹è±¡ç¼–ç¨‹&#x27;);$phone=new Phone();$phone-&gt;setName(&#x27;è‹¹æœ6s&#x27;);$book-&gt;getName();$phone-&gt;getName(); 1.3 è‡ªåŠ¨åŠ è½½ç±»å½“ç¼ºå°‘ç±»çš„æ—¶å€™è‡ªåŠ¨çš„è°ƒç”¨__autoload()å‡½æ•°ï¼Œå¹¶ä¸”å°†ç¼ºå°‘çš„ç±»åä½œä¸ºå‚æ•°ä¼ é€’ç»™__autoload()ã€‚ 123456789101112131415&lt;?php/**ä½œç”¨ï¼šè‡ªåŠ¨åŠ è½½ç±»*@param $class_name string ç¼ºå°‘çš„ç±»å*/function __autoload($class_name) &#123; require &quot;./&#123;$class_name&#125;.class.php&quot;;&#125;//æµ‹è¯•$book=new Book();$book-&gt;setName(&#x27;é¢å‘å¯¹è±¡ç¼–ç¨‹&#x27;);$phone=new Phone();$phone-&gt;setName(&#x27;è‹¹æœ6s&#x27;);$book-&gt;getName();$phone-&gt;getName(); ğŸ’¡ æ³¨æ„ï¼š__autoload()å‡½æ•°åœ¨PHP7.2ä»¥åå°±ä¸æ”¯æŒäº†ã€‚ 1.4 æ³¨å†ŒåŠ è½½ç±»é€šè¿‡spl_autoload_register()æ³¨å†Œ__autoload()å‡½æ•° 1234567891011121314151617181920212223&lt;?php//æ–¹æ³•ä¸€ï¼š/*//åŠ è½½ç±»å‡½æ•°function loadClass($class_name) &#123; require &quot;./&#123;$class_name&#125;.class.php&quot;;&#125;//æ³¨å†ŒåŠ è½½ç±»å‡½æ•°spl_autoload_register(&#x27;loadClass&#x27;);*///æ–¹æ³•äºŒï¼šspl_autoload_register(function($class_name)&#123; require &quot;./&#123;$class_name&#125;.class.php&quot;;&#125;);//æµ‹è¯•$book=new Book();$book-&gt;setName(&#x27;é¢å‘å¯¹è±¡ç¼–ç¨‹&#x27;);$phone=new Phone();$phone-&gt;setName(&#x27;è‹¹æœ6s&#x27;);$book-&gt;getName();$phone-&gt;getName(); 1ã€spl_autoload_register()å¯ä»¥æ³¨å†Œå¤šä¸ªè‡ªåŠ¨åŠ è½½å‡½æ•° 12345678910111213&lt;?phpfunction load1($class) &#123; require &quot;./&#123;$class&#125;.class.php&quot;;&#125;function load2($class) &#123; require &quot;./&#123;$class&#125;.php&quot;;&#125;function load3($class) &#123; require &quot;./&#123;$class&#125;.fun.php&quot;;&#125;spl_autoload_register(&#x27;load1&#x27;);spl_autoload_register(&#x27;load2&#x27;);spl_autoload_register(&#x27;load3&#x27;); 2ã€PHP5.1ä»¥åå°±å¼€å§‹æ”¯æŒæ­¤å‡½æ•°ã€‚ 1.5 ç±»æ–‡ä»¶å­˜å‚¨ä¸è§„åˆ™çš„åŠ è½½æ–¹æ³•å°†ç±»åå’Œæ–‡ä»¶åœ°å€åšä¸€ä¸ªæ˜ å°„ï¼Œç»„æˆä¸€ä¸ªå…³è”æ•°ç»„ã€‚ 123456$map=array( //ç±»å =&gt; ç±»æ–‡ä»¶åœ°å€ &#x27;Goods&#x27; =&gt; &#x27;./aa/Goods.class.php&#x27;, &#x27;Book&#x27; =&gt; &#x27;./bb/Book.class.php&#x27;, &#x27;Phone&#x27; =&gt; &#x27;./cc/Phone.class.php&#x27;); ä»£ç å¦‚ä¸‹ 12345678910111213141516171819&lt;?phpspl_autoload_register(function($class_name)&#123; //ç±»åå’Œæ–‡ä»¶åœ°å€æ˜ å°„æˆä¸€ä¸ªå…³è”æ•°ç»„ $map=array( &#x27;Goods&#x27; =&gt; &#x27;./aa/Goods.class.php&#x27;, &#x27;Book&#x27; =&gt; &#x27;./bb/Book.class.php&#x27;, &#x27;Phone&#x27; =&gt; &#x27;./cc/Phone.class.php&#x27; ); //åœ¨æ˜ å°„æ•°ç»„ä¸­æ‰¾åˆ°å°±åŒ…å« if(isset($map[$class_name])) require $map[$class_name];&#125;);//æµ‹è¯•$book=new Book();$book-&gt;setName(&#x27;é¢å‘å¯¹è±¡ç¼–ç¨‹&#x27;);$phone=new Phone();$phone-&gt;setName(&#x27;è‹¹æœ6s&#x27;);$book-&gt;getName();$phone-&gt;getName(); åœ¨é¡¹ç›®ä¸­ï¼Œç»å¤§éƒ¨åˆ†éƒ½æ˜¯è§„åˆ™å­˜å‚¨çš„ï¼Œä¸è§„åˆ™çš„æ¯”è¾ƒå°‘ã€‚ 2 cloneå’Œ__clone()æ€è€ƒï¼šåˆ›å»ºå¯¹è±¡çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ 12æ–¹æ³•ä¸€ï¼šå®ä¾‹åŒ–æ–¹æ³•äºŒï¼šå…‹éš† ä¾‹é¢˜ 12345678910&lt;?phpclass Student &#123; //æ‰§è¡ŒcloneæŒ‡ä»¤çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ public function __clone() &#123; echo &#x27;æ­£åœ¨å…‹éš†å¯¹è±¡&lt;br&gt;&#x27;; &#125;&#125;$stu1=new Student;$stu2=clone $stu1; //å…‹éš†å¯¹è±¡var_dump($stu1,$stu2); //object(Student)#1 (0) &#123; &#125; object(Student)#2 (0) &#123; &#125; å°ç»“ï¼š 1ã€cloneçš„åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸€ 2ã€å½“æ‰§è¡ŒcloneæŒ‡ä»¤çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨çš„è°ƒç”¨__clone()æ–¹æ³• 3 è®¾è®¡æ¨¡å¼3.1 å•ä¾‹æ¨¡å¼1.4.1 å•ä¾‹æ¨¡å¼ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå¯¹è±¡ åº”ç”¨åœºæ™¯ï¼šå¤šæ¬¡è¯·æ±‚æ•°æ®åº“åªéœ€è¦ä¸€ä¸ªè¿æ¥å¯¹è±¡ã€‚ å®ç°ï¼šä¸‰ç§ä¸€å…¬ 12341ã€ç§æœ‰çš„é™æ€å±æ€§ç”¨æ¥ä¿å­˜å¯¹è±¡çš„å•ä¾‹2ã€ç§æœ‰çš„æ„é€ æ–¹æ³•ç”¨æ¥é˜»æ­¢åœ¨ç±»çš„å¤–éƒ¨å®ä¾‹åŒ–3ã€ç§æœ‰çš„__cloneé˜»æ­¢åœ¨ç±»çš„å¤–éƒ¨cloneå¯¹è±¡4ã€å…¬æœ‰çš„é™æ€æ–¹æ³•ç”¨æ¥è·å–å¯¹è±¡çš„å•ä¾‹ ä»£ç  123456789101112131415161718192021222324&lt;?php//ä¸‰ç§ä¸€å…¬class DB &#123; //é™æ€çš„å±æ€§ç”¨æ¥ä¿å­˜å¯¹è±¡çš„å•ä¾‹ private static $instance; //ç§æœ‰çš„æ„é€ æ–¹æ³•é˜»æ­¢åœ¨ç±»çš„å¤–éƒ¨å®ä¾‹åŒ– private function __construct() &#123; &#125; //ç§æœ‰çš„__clone()é˜»æ­¢åœ¨ç±»çš„å¤–éƒ¨cloneå¯¹è±¡ private function __clone() &#123; &#125; public static function getInstance() &#123; //ä¿å­˜çš„å€¼ä¸å±äºDBç±»çš„ç±»å‹å°±å®ä¾‹åŒ– if(!self::$instance instanceof self) self::$instance=new self(); return self::$instance; &#125;&#125;//æµ‹è¯•$db1=DB::getInstance();$db2=DB::getInstance();var_dump($db1,$db2); //object(DB)#1 (0) &#123; &#125; object(DB)#1 (0) &#123; &#125; 3.2 å·¥å‚æ¨¡å¼ç‰¹ç‚¹ï¼šä¼ é€’ä¸åŒçš„å‚æ•°è·å–ä¸åŒçš„å¯¹è±¡ 1234567891011121314151617181920212223&lt;?phpclass ProductsA &#123;&#125;class ProductsB &#123;&#125;//å·¥å‚æ¨¡å¼class ProductsFactory &#123; public function create($num) &#123; switch($num) &#123; case 1: return new ProductsA; case 2: return new ProductsB; default: return null; &#125; &#125;&#125;//æµ‹è¯•$factory=new ProductsFactory();$obj1=$factory-&gt;create(1);$obj2=$factory-&gt;create(2);var_dump($obj1,$obj2); //object(ProductsA)#2 (0) &#123; &#125; object(ProductsB)#3 (0) &#123; &#125; 3.3 ç­–ç•¥æ¨¡å¼ç‰¹ç‚¹ï¼šä¼ é€’ä¸åŒçš„å‚æ•°è°ƒç”¨ä¸åŒçš„ç­–ç•¥ï¼ˆæ–¹æ³•ï¼‰ 123456789101112131415161718192021&lt;?phpclass Walk &#123; public function way() &#123; echo &#x27;èµ°ç€å»&lt;br&gt;&#x27;; &#125;&#125;class Bus &#123; public function way() &#123; echo &#x27;åè½¦å»&lt;br&gt;&#x27;; &#125;&#125;//ç­–ç•¥æ¨¡å¼class Student &#123; public function play($obj) &#123; $obj-&gt;way(); &#125;&#125;//æµ‹è¯•$stu=new Student;$stu-&gt;play(new Walk()); //èµ°ç€å»$stu-&gt;play(new Bus()); //åè½¦å» 4 åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åœ¨PHPä¸­ï¼Œæ•°ç»„å’Œå¯¹è±¡æ— æ³•ä¿å­˜ï¼Œå¦‚æœéœ€è¦ä¿å­˜å°±è¦å°†æ•°ç»„æˆ–å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªåºåˆ—ã€‚ åºåˆ—åŒ–ï¼šå°†æ•°ç»„æˆ–å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªåºåˆ—ï¼ˆserializeï¼‰ ååºåˆ—åŒ–ï¼šå°†åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è½¬æ¢æˆæ•°ç»„æˆ–å¯¹è±¡ã€‚(unserialize) 4.1 æ•°ç»„çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–123456789101112&lt;?php//æ•°ç»„çš„åºåˆ—åŒ–/*$stu=[&#x27;tom&#x27;,&#x27;berry&#x27;,&#x27;ketty&#x27;];$str=serialize($stu); //åºåˆ—åŒ–file_put_contents(&#x27;./stu.txt&#x27;,$str);*///æ•°ç»„çš„ååºåˆ—åŒ–$str=file_get_contents(&#x27;./stu.txt&#x27;);$stu=unserialize($str); //ååºåˆ—åŒ–print_r($stu);\t//Array ( [0] =&gt; tom [1] =&gt; berry [2] =&gt; ketty ) 4.2 å¯¹è±¡çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ğŸ’¡ æ³¨æ„ï¼šå¯¹è±¡çš„ååºåˆ—åŒ–éœ€è¦æœ‰ç±»çš„å‚ä¸ï¼Œå¦‚æœæ²¡æœ‰ç±»åœ¨ååºåˆ—åŒ–æ—¶å€™æ— æ³•ç¡®å®šç±» 5 é­”æœ¯æ–¹æ³•1234å·²ç»å­¦è¿‡çš„é­”æœ¯æ–¹æ³•__construct() æ„é€ æ–¹æ³•__destruct() ææ„æ–¹æ³•__clone() å…‹éš†æ–¹æ³• 5.1 __tostring()ã€__invoke()__tostring()ï¼šå°†å¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ __invoke()ï¼šå°†å¯¹è±¡å½“æˆå‡½æ•°ä½¿ç”¨çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ 1234567891011121314&lt;?phpclass Student &#123;\t//æŠŠå¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ\tpublic function __tostring() &#123; return &#x27;è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯å­—ç¬¦ä¸²&lt;br&gt;&#x27;;\t&#125;\t//æŠŠå¯¹è±¡å½“æˆå‡½æ•°ä½¿ç”¨çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ\tpublic function __invoke() &#123; echo &#x27;è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯å‡½æ•°&lt;br&gt;&#x27;;\t&#125;&#125;$stu=new Student;echo $stu;\t//å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨$stu(); //å½“æˆå‡½æ•°ä½¿ç”¨ 5.2 __set()ã€__get()ã€__isset()ã€__unset()1234__set($k,$v)ï¼šç»™æ— æ³•è®¿é—®çš„å±æ€§èµ‹å€¼çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ__get($k)ï¼šè·å–æ— æ³•è®¿é—®çš„å±æ€§å€¼çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨__isset($k)ï¼šåˆ¤æ–­æ— æ³•è®¿é—®çš„å±æ€§æ˜¯å¦å­˜åœ¨è‡ªåŠ¨è°ƒç”¨__unset($k)ï¼šé”€æ¯æ— æ³•è®¿é—®çš„å±æ€§çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ 5.3 __call()ã€__callstatic()12__call()ï¼šè°ƒç”¨æ— æ³•è®¿é—®çš„æ–¹æ³•æ—¶è‡ªåŠ¨æ‰§è¡Œ__callstatic()ï¼šè°ƒç”¨æ— æ³•è®¿é—®çš„é™æ€æ–¹æ³•æ—¶è‡ªåŠ¨æ‰§è¡Œ 1234567891011121314151617181920&lt;?phpclass Student &#123;\t/**\t*ä½œç”¨ï¼šè°ƒç”¨æ— æ³•è®¿é—®çš„æ–¹æ³•æ—¶è‡ªåŠ¨æ‰§è¡Œ\t*@param $fn_name string æ–¹æ³•å\t*@param $fn_args array å‚æ•°æ•°ç»„\t*/\tpublic function __call($fn_name,$fn_args) &#123; echo &quot;&#123;$fn_name&#125;ä¸å­˜åœ¨&lt;br&gt;&quot;;\t&#125;\t//è°ƒç”¨æ— æ³•è®¿é—®çš„é™æ€æ–¹æ³•æ—¶è‡ªåŠ¨æ‰§è¡Œ\tpublic static function __callstatic($fn_name,$fn_args) &#123; echo &quot;&#123;$fn_name&#125;é™æ€æ–¹æ³•ä¸å­˜åœ¨&lt;br&gt;&quot;; &#125;&#125;//æµ‹è¯•$stu=new Student;$stu-&gt;show(10,20);Student::show(); 5.4 __sleep()ã€__wakeup()12__sleep()ï¼šå½“åºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨__wakeup()ï¼šå½“ååºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ 1234567891011121314151617181920212223242526&lt;?phpclass Student &#123;\tprivate $name;\tprivate $sex;\tprivate $add=&#x27;ä¸­å›½&#x27;;\tpublic function __construct($name,$sex) &#123; $this-&gt;name=$name; $this-&gt;sex=$sex;\t&#125;\t/**\t*åºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨\t*@return array åºåˆ—åŒ–çš„å±æ€§å\t*/\tpublic function __sleep() &#123; return array(&#x27;name&#x27;,&#x27;sex&#x27;);\t&#125;\t//ååºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨\tpublic function __wakeup() &#123; $this-&gt;type=&#x27;å­¦ç”Ÿ&#x27;;\t&#125;&#125;//æµ‹è¯•$stu=new Student(&#x27;tom&#x27;,&#x27;ç”·&#x27;);$str=serialize($stu);\t//åºåˆ—åŒ–$stu=unserialize($str);\t//ååºåˆ—åŒ–print_r($stu); 6 æ¨¡æ‹Ÿæ–¹æ³•é‡è½½é€šè¿‡é­”æœ¯æ–¹æ³•æ¨¡æ‹Ÿæ–¹æ³•é‡è½½ 123456789101112131415&lt;?phpclass Math &#123; public function __call($fn_name,$fn_args) &#123; $sum=0; foreach($fn_args as $v) &#123; $sum+=$v; &#125; echo implode(&#x27;,&#x27;,$fn_args).&#x27;çš„å’Œæ˜¯ï¼š&#x27;.$sum,&#x27;&lt;br&gt;&#x27;; &#125;&#125;//åˆ©ç”¨é­”æœ¯æ–¹æ³•æ¨¡æ‹Ÿæ–¹æ³•é‡è½½$math=new Math();$math-&gt;call(10,20);$math-&gt;call(10,20,30);$math-&gt;call(10,20,30,40); 7 éå†å¯¹è±¡é€šè¿‡foreachéå†å¯¹è±¡ 12345678910111213141516171819&lt;?phpclass Student &#123; public $name=&#x27;tom&#x27;; protected $sex=&#x27;ç”·&#x27;; private $age=22; public function show() &#123; foreach($this as $k=&gt;$v) &#123; echo &quot;&#123;$k&#125;-&#123;$v&#125;&lt;br&gt;&quot;; &#125; &#125;&#125;//æµ‹è¯•$stu=new Student;foreach($stu as $k=&gt;$v) &#123; echo &quot;&#123;$k&#125;-&#123;$v&#125;&lt;br&gt;&quot;;&#125;echo &#x27;&lt;hr&gt;&#x27;;$stu-&gt;show(); ç»“è®ºï¼šéå†åˆ°å½“å‰ä½ç½®æ‰€èƒ½è®¿é—®åˆ°å±æ€§ 8 å°è£…MySQLçš„å•ä¾‹8.1 åˆ†æ1ã€å®ç°å•ä¾‹ 2ã€è¿æ¥æ•°æ®åº“ 3ã€å¯¹æ•°æ®è¿›è¡Œæ“ä½œ 8.2 æ­¥éª¤ç¬¬ä¸€æ­¥ï¼šå®ç°å•ä¾‹ ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–å‚æ•° ç¬¬ä¸‰æ­¥ï¼šè¿æ¥æ•°æ®åº“ ç¬¬å››æ­¥ï¼šæ“ä½œæ•°æ® 1ã€æ‰§è¡Œæ•°æ®æ“ä½œè¯­å¥ï¼ˆå¢ã€åˆ ã€æ”¹ï¼‰ 2ã€æ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥ a) è¿”å›äºŒç»´æ•°ç»„ b) è¿”å›ä¸€ç»´æ•°ç»„ c)è¿”å›ä¸€è¡Œä¸€åˆ— 8.3 ä»£ç å®ç° ç¬¬ä¸€æ­¥ï¼šå®ç°å•ä¾‹ 123456789101112131415161718&lt;?phpclass MySQLDB &#123; private static $instance; private function __construct() &#123; &#125; private function __clone() &#123; &#125; public static function getInstance() &#123; if(!self::$instance instanceof self) self::$instance=new self(); return self::$instance; &#125;&#125;//æµ‹è¯•$db=MySQLDB::getInstance();var_dump($db); æ³¨æ„ï¼šA instanceof Bï¼Œè¡¨ç¤ºAæ˜¯å¦æ˜¯Bçš„ç±»å‹ï¼Œè¿”å›boolå€¼ ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–å‚æ•° 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?php//å°è£…MySQLå•ä¾‹class MySQLDB &#123; private $host; //ä¸»æœºåœ°å€ private $port; //ç«¯å£å· private $user; //ç”¨æˆ·å private $pwd; //å¯†ç  private $dbname; //æ•°æ®æ¥å private $charset; //å­—ç¬¦é›† private $link; //è¿æ¥å¯¹è±¡ private static $instance; private function __construct($param) &#123; $this-&gt;initParam($param); &#125; private function __clone() &#123; &#125; //è·å–å•ä¾‹ public static function getInstance($param=array()) &#123; if(!self::$instance instanceof self) self::$instance=new self($param); return self::$instance; &#125; //åˆå§‹åŒ–å‚æ•° private function initParam($param) &#123; $this-&gt;host=$param[&#x27;host&#x27;]??&#x27;127.0.0.1&#x27;; $this-&gt;port=$param[&#x27;port&#x27;]??&#x27;3306&#x27;; $this-&gt;user=$param[&#x27;user&#x27;]??&#x27;&#x27;; $this-&gt;pwd=$param[&#x27;pwd&#x27;]??&#x27;&#x27;; $this-&gt;dbname=$param[&#x27;dbname&#x27;]??&#x27;&#x27;; $this-&gt;charset=$param[&#x27;charset&#x27;]??&#x27;utf8&#x27;; &#125;&#125;//æµ‹è¯•//é…ç½®å‚æ•°$param=array( &#x27;user&#x27; =&gt; &#x27;root&#x27;, &#x27;pwd&#x27; =&gt; &#x27;root&#x27;, &#x27;dbname&#x27; =&gt; &#x27;data&#x27;);//è·å–å•ä¾‹$db=MySQLDB::getInstance($param);var_dump($db); ç¬¬ä¸‰æ­¥ï¼šè¿æ¥æ•°æ®åº“ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;?php//å°è£…MySQLå•ä¾‹class MySQLDB &#123; private $host; //ä¸»æœºåœ°å€ private $port; //ç«¯å£å· private $user; //ç”¨æˆ·å private $pwd; //å¯†ç  private $dbname; //æ•°æ®æ¥å private $charset; //å­—ç¬¦é›† private $link; //è¿æ¥å¯¹è±¡ private static $instance; private function __construct($param) &#123; $this-&gt;initParam($param); $this-&gt;initConnect(); &#125; private function __clone() &#123; &#125; //è·å–å•ä¾‹ public static function getInstance($param=array()) &#123; if(!self::$instance instanceof self) self::$instance=new self($param); return self::$instance; &#125; //åˆå§‹åŒ–å‚æ•° private function initParam($param) &#123; $this-&gt;host=$param[&#x27;host&#x27;]??&#x27;127.0.0.1&#x27;; $this-&gt;port=$param[&#x27;port&#x27;]??&#x27;3306&#x27;; $this-&gt;user=$param[&#x27;user&#x27;]??&#x27;&#x27;; $this-&gt;pwd=$param[&#x27;pwd&#x27;]??&#x27;&#x27;; $this-&gt;dbname=$param[&#x27;dbname&#x27;]??&#x27;&#x27;; $this-&gt;charset=$param[&#x27;charset&#x27;]??&#x27;utf8&#x27;; &#125; //è¿æ¥æ•°æ®åº“ private function initConnect() &#123; $this-&gt;link=@mysqli_connect($this-&gt;host,$this-&gt;user,$this-&gt;pwd,$this-&gt;dbname); if(mysqli_connect_error())&#123; echo &#x27;æ•°æ®åº“è¿æ¥å¤±è´¥&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;.mysqli_connect_error(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ç ï¼š&#x27;.mysqli_connect_errno(),&#x27;&lt;br&gt;&#x27;; exit; &#125; mysqli_set_charset($this-&gt;link,$this-&gt;charset); &#125;&#125;//æµ‹è¯•//é…ç½®å‚æ•°$param=array( &#x27;user&#x27; =&gt; &#x27;root&#x27;, &#x27;pwd&#x27; =&gt; &#x27;root&#x27;, &#x27;dbname&#x27; =&gt; &#x27;data&#x27;);//è·å–å•ä¾‹$db=MySQLDB::getInstance($param);var_dump($db); ç¬¬å››æ­¥ï¼šæ•°æ®æ“ä½œçš„åŠŸèƒ½ 1ã€æ‰§è¡Œå¢ã€åˆ ã€æ”¹æ“ä½œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889&lt;?php//å°è£…MySQLå•ä¾‹class MySQLDB &#123; private $host; //ä¸»æœºåœ°å€ private $port; //ç«¯å£å· private $user; //ç”¨æˆ·å private $pwd; //å¯†ç  private $dbname; //æ•°æ®æ¥å private $charset; //å­—ç¬¦é›† private $link; //è¿æ¥å¯¹è±¡ private static $instance; private function __construct($param) &#123; $this-&gt;initParam($param); $this-&gt;initConnect(); &#125; private function __clone() &#123; &#125; //è·å–å•ä¾‹ public static function getInstance($param=array()) &#123; if(!self::$instance instanceof self) self::$instance=new self($param); return self::$instance; &#125; //åˆå§‹åŒ–å‚æ•° private function initParam($param) &#123; $this-&gt;host=$param[&#x27;host&#x27;]??&#x27;127.0.0.1&#x27;; $this-&gt;port=$param[&#x27;port&#x27;]??&#x27;3306&#x27;; $this-&gt;user=$param[&#x27;user&#x27;]??&#x27;&#x27;; $this-&gt;pwd=$param[&#x27;pwd&#x27;]??&#x27;&#x27;; $this-&gt;dbname=$param[&#x27;dbname&#x27;]??&#x27;&#x27;; $this-&gt;charset=$param[&#x27;charset&#x27;]??&#x27;utf8&#x27;; &#125; //è¿æ¥æ•°æ®åº“ private function initConnect() &#123; $this-&gt;link=@mysqli_connect($this-&gt;host,$this-&gt;user,$this-&gt;pwd,$this-&gt;dbname); if(mysqli_connect_error())&#123; echo &#x27;æ•°æ®åº“è¿æ¥å¤±è´¥&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;.mysqli_connect_error(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ç ï¼š&#x27;.mysqli_connect_errno(),&#x27;&lt;br&gt;&#x27;; exit; &#125; mysqli_set_charset($this-&gt;link,$this-&gt;charset); &#125; //æ‰§è¡Œæ•°æ®åº“çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥ private function execute($sql) &#123; if(!$rs=mysqli_query($this-&gt;link,$sql))&#123; echo &#x27;SQLè¯­å¥æ‰§è¡Œå¤±è´¥&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;.mysqli_error($this-&gt;link),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ç ï¼š&#x27;.mysqli_errno($this-&gt;link),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯çš„SQLè¯­å¥ï¼š&#x27;.$sql,&#x27;&lt;br&gt;&#x27;; exit; &#125; return $rs; &#125; /** *æ‰§è¡Œå¢ã€åˆ ã€æ”¹ *@return bool æˆåŠŸè¿”å›true,å¤±è´¥è¿”å›false */ public function exec($sql) &#123; $key=substr($sql,0,6); if(in_array($key,array(&#x27;insert&#x27;,&#x27;update&#x27;,&#x27;delete&#x27;))) return $this-&gt;execute($sql); else&#123; echo &#x27;éæ³•è®¿é—®&lt;br&gt;&#x27;; exit; &#125; &#125; //è·å–è‡ªåŠ¨å¢é•¿çš„ç¼–å· public function getLastInsertId() &#123; return mysqli_insert_id($this-&gt;link); &#125;&#125;//æµ‹è¯•//é…ç½®å‚æ•°$param=array( &#x27;user&#x27; =&gt; &#x27;root&#x27;, &#x27;pwd&#x27; =&gt; &#x27;root&#x27;, &#x27;dbname&#x27; =&gt; &#x27;data&#x27;);//è·å–å•ä¾‹$db=MySQLDB::getInstance($param);//æ›´æ–°//$db-&gt;exec(&quot;update news set title=&#x27;é’è‰&#x27; where id=2&quot;);//æ’å…¥if($db-&gt;exec(&quot;insert into news values (null,&#x27;aa&#x27;,&#x27;bb&#x27;,unix_timestamp())&quot;)) echo &#x27;ç¼–å·æ˜¯ï¼š&#x27;.$db-&gt;getLastInsertId(); 2ã€æŸ¥è¯¢ç»“æœ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147&lt;?php//å°è£…MySQLå•ä¾‹class MySQLDB &#123; private $host; //ä¸»æœºåœ°å€ private $port; //ç«¯å£å· private $user; //ç”¨æˆ·å private $pwd; //å¯†ç  private $dbname; //æ•°æ®æ¥å private $charset; //å­—ç¬¦é›† private $link; //è¿æ¥å¯¹è±¡ private static $instance; private function __construct($param) &#123; $this-&gt;initParam($param); $this-&gt;initConnect(); &#125; private function __clone() &#123; &#125; //è·å–å•ä¾‹ public static function getInstance($param=array()) &#123; if(!self::$instance instanceof self) self::$instance=new self($param); return self::$instance; &#125; //åˆå§‹åŒ–å‚æ•° private function initParam($param) &#123; $this-&gt;host=$param[&#x27;host&#x27;]??&#x27;127.0.0.1&#x27;; $this-&gt;port=$param[&#x27;port&#x27;]??&#x27;3306&#x27;; $this-&gt;user=$param[&#x27;user&#x27;]??&#x27;&#x27;; $this-&gt;pwd=$param[&#x27;pwd&#x27;]??&#x27;&#x27;; $this-&gt;dbname=$param[&#x27;dbname&#x27;]??&#x27;&#x27;; $this-&gt;charset=$param[&#x27;charset&#x27;]??&#x27;utf8&#x27;; &#125; //è¿æ¥æ•°æ®åº“ private function initConnect() &#123; $this-&gt;link=@mysqli_connect($this-&gt;host,$this-&gt;user,$this-&gt;pwd,$this-&gt;dbname); if(mysqli_connect_error())&#123; echo &#x27;æ•°æ®åº“è¿æ¥å¤±è´¥&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;.mysqli_connect_error(),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ç ï¼š&#x27;.mysqli_connect_errno(),&#x27;&lt;br&gt;&#x27;; exit; &#125; mysqli_set_charset($this-&gt;link,$this-&gt;charset); &#125; //æ‰§è¡Œæ•°æ®åº“çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥ private function execute($sql) &#123; if(!$rs=mysqli_query($this-&gt;link,$sql))&#123; echo &#x27;SQLè¯­å¥æ‰§è¡Œå¤±è´¥&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;.mysqli_error($this-&gt;link),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯ç ï¼š&#x27;.mysqli_errno($this-&gt;link),&#x27;&lt;br&gt;&#x27;; echo &#x27;é”™è¯¯çš„SQLè¯­å¥ï¼š&#x27;.$sql,&#x27;&lt;br&gt;&#x27;; exit; &#125; return $rs; &#125; /** *æ‰§è¡Œå¢ã€åˆ ã€æ”¹ *@return bool æˆåŠŸè¿”å›true,å¤±è´¥è¿”å›false */ public function exec($sql) &#123; $key=substr($sql,0,6); if(in_array($key,array(&#x27;insert&#x27;,&#x27;update&#x27;,&#x27;delete&#x27;))) return $this-&gt;execute($sql); else&#123; echo &#x27;éæ³•è®¿é—®&lt;br&gt;&#x27;; exit; &#125; &#125; //è·å–è‡ªåŠ¨å¢é•¿çš„ç¼–å· public function getLastInsertId() &#123; return mysqli_insert_id($this-&gt;link); &#125; //æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ private function query($sql) &#123; if(substr($sql,0,6)==&#x27;select&#x27; || substr($sql,0,4)==&#x27;show&#x27; || substr($sql,0,4)==&#x27;desc&#x27;)&#123; return $this-&gt;execute($sql); &#125;else&#123; echo &#x27;éæ³•è®¿é—®&lt;br&gt;&#x27;; exit; &#125; &#125; /** *æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè¿”å›äºŒç»´æ•°ç»„ *@$sql string æŸ¥è¯¢sqlè¯­å¥ *@type string assoc|num|both */ public function fetchAll($sql,$type=&#x27;assoc&#x27;) &#123; $rs=$this-&gt;query($sql); $type=$this-&gt;getType($type); return mysqli_fetch_all($rs,$type); &#125; //åŒ¹é…ä¸€ç»´æ•°ç»„ public function fetchRow($sql,$type=&#x27;assoc&#x27;) &#123; $list=$this-&gt;fetchAll($sql,$type); if(!empty($list)) return $list[0]; return array(); &#125; //åŒ¹é…ä¸€è¡Œä¸€åˆ— public function fetchColumn($sql) &#123; $list=$this-&gt;fetchRow($sql,&#x27;num&#x27;); if(!empty($list)) return $list[0]; return null; &#125; //è·å–åŒ¹é…ç±»å‹ private function getType($type) &#123; switch($type)&#123; case &#x27;num&#x27;: return MYSQLI_NUM; case &#x27;both&#x27;: return MYSQLI_BOTH; default: return MYSQLI_ASSOC; &#125; &#125;&#125;//æµ‹è¯•//é…ç½®å‚æ•°$param=array( &#x27;user&#x27; =&gt; &#x27;root&#x27;, &#x27;pwd&#x27; =&gt; &#x27;root&#x27;, &#x27;dbname&#x27; =&gt; &#x27;data&#x27;);//è·å–å•ä¾‹$db=MySQLDB::getInstance($param);//æ›´æ–°//$db-&gt;exec(&quot;update news set title=&#x27;é’è‰&#x27; where id=2&quot;);//æ’å…¥/*if($db-&gt;exec(&quot;insert into news values (null,&#x27;aa&#x27;,&#x27;bb&#x27;,unix_timestamp())&quot;)) echo &#x27;ç¼–å·æ˜¯ï¼š&#x27;.$db-&gt;getLastInsertId();*///æŸ¥è¯¢//$list=$db-&gt;fetchAll(&#x27;select * from news&#x27;,&#x27;aa&#x27;);//$list=$db-&gt;fetchRow(&#x27;select * from news where id=1&#x27;,&#x27;aa&#x27;);$list=$db-&gt;fetchColumn(&#x27;select count(*) from news&#x27;);echo &#x27;&lt;pre&gt;&#x27;;var_dump($list); å°ç»“ï¼š 1ã€instanceof ç”¨æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å±äºæŸä¸ªç±» 2ã€å‚æ•°å¿…é¡»ä»å¤–éƒ¨ä¼ é€’åˆ°å†…éƒ¨ï¼Œä¸èƒ½å†™æ­»åˆ°ç±»çš„å†…éƒ¨ã€‚ 3ã€ä¸ºäº†ä¿è¯ä»£ç çš„å¯é‡ç”¨æ€§ï¼Œä¸€ä¸ªæ–¹æ³•åªå®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œæ‰€ä»¥åˆå§‹åŒ–å‚æ•°å’Œè¿æ¥æ•°æ®åº“åˆ†åˆ°ä¸¤ä¸ªæ–¹æ³•ä¸­ã€‚","tags":["PHP"],"categories":["Language"]},{"title":"PHPé¢å‘å¯¹è±¡-2-ä¸‰å¤§ç‰¹æ€§&ç±»å¸¸é‡&æ¥å£","path":"/p/980312b6/","content":"1 å¤šæ€å¤šæ€ï¼šå¤šç§å½¢æ€ã€‚ å¤šæ€åˆ†ä¸ºä¸¤ç§ï¼šæ–¹æ³•é‡å†™å’Œæ–¹æ³•é‡è½½ 1.1 æ–¹æ³•é‡å†™å­ç±»é‡å†™äº†çˆ¶ç±»çš„åŒåçš„æ–¹æ³• 1234567891011121314151617&lt;?php//çˆ¶ç±»class Person &#123; public function show() &#123; echo &#x27;è¿™æ˜¯çˆ¶ç±»&lt;br&gt;&#x27;; &#125;&#125;//å­ç±»class Student extends Person &#123; //å­ç±»é‡å†™äº†çˆ¶ç±»çš„åŒåæ–¹æ³• public function show() &#123; echo &#x27;è¿™æ˜¯å­ç±»&lt;br&gt;&#x27;; &#125;&#125;//æµ‹è¯•$stu=new Student;$stu-&gt;show(); //è¿™æ˜¯å­ç±» æ³¨æ„äº‹é¡¹ï¼š å­ç±»çš„æ–¹æ³•å¿…é¡»å’Œçˆ¶ç±»çš„æ–¹æ³•åŒå å‚æ•°ä¸ªæ•°è¦ä¸€è‡´ å­ç±»ä¿®é¥°çš„ä¸èƒ½æ¯”çˆ¶ç±»æ›´åŠ ä¸¥æ ¼ 1.2 æ–¹æ³•é‡è½½åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œæœ‰å¤šä¸ªåŒåçš„å‡½æ•°ï¼Œé€šè¿‡å‚æ•°çš„ä¸åŒæ¥åŒºåˆ†ä¸åŒçš„æ–¹æ³•ï¼Œç§°ä¸ºæ–¹æ³•é‡è½½ ğŸ’¡ æ³¨æ„ï¼šPHPä¸æ”¯æŒæ–¹æ³•é‡è½½ï¼Œä½†æ˜¯PHPå¯ä»¥é€šè¿‡å…¶ä»–æ–¹æ³•æ¥æ¨¡æ‹Ÿæ–¹æ³•é‡è½½ã€‚ 2é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§ å°è£… ç»§æ‰¿ å¤šæ€ 3 ç§æœ‰å±æ€§ç»§æ‰¿å’Œé‡å†™ç§æœ‰å±æ€§å¯ä»¥ç»§æ‰¿ä½†ä¸èƒ½é‡å†™ã€‚ 1234567891011121314151617181920212223&lt;?phpclass A &#123; private $name=&#x27;PHP&#x27;; public function showA() &#123; //var_dump($this); //object(B)#1 (2) &#123; [&quot;name&quot;:&quot;B&quot;:private]=&gt; string(4) &quot;Java&quot; [&quot;name&quot;:&quot;A&quot;:private]=&gt; string(3) &quot;PHP&quot; &#125; echo $this-&gt;name,&#x27;&lt;br&gt;&#x27;; //PHP &#125;&#125;class B extends A &#123; private $name=&#x27;Java&#x27;; public function showB() &#123; //var_dump($this); //object(B)#1 (2) &#123; [&quot;name&quot;:&quot;B&quot;:private]=&gt; string(4) &quot;Java&quot; [&quot;name&quot;:&quot;A&quot;:private]=&gt; string(3) &quot;PHP&quot; &#125; echo $this-&gt;name,&#x27;&lt;br&gt;&#x27;; //Java &#125;&#125;$obj=new B();$obj-&gt;showA();$obj-&gt;showB();/*åˆ†æï¼šshowA()å’ŒshowB()ä¸­çš„$thiséƒ½è¡¨ç¤ºBçš„å¯¹è±¡ï¼ŒBä¸­ç»§æ‰¿äº†Açš„ç§æœ‰å±æ€§ï¼Œæ‰€ä»¥Bä¸­æœ‰ä¸¤ä¸ª$name.åœ¨showA()ä¸­åªèƒ½è®¿é—®Aä¸­çš„$nameï¼Œä¸èƒ½è®¿é—®Bä¸­çš„$nameåœ¨showB()ä¸­åªèƒ½è®¿é—®Bä¸­çš„$name,ä¸èƒ½è®¿é—®Aä¸­çš„$name*/ 4 æ–¹æ³•ä¿®é¥°ç¬¦æ–¹æ³•ä¿®é¥°ç¬¦æœ‰ï¼šstaticã€finalã€abstract 4.1 staticã€é™æ€çš„ã€‘ staticä¿®é¥°çš„å±æ€§å«é™æ€å±æ€§ã€staticä¿®é¥°çš„æ–¹æ³•å«é™æ€æ–¹æ³• é™æ€æˆå‘˜åŠ è½½ç±»çš„æ—¶å€™åˆ†é…ç©ºé—´ï¼Œç¨‹åºæ‰§è¡Œå®Œæ¯•åé”€æ¯ é™æ€æˆå‘˜åœ¨å†…å­˜ä¸­å°±ä¸€ä»½ã€‚ è°ƒç”¨è¯­æ³• ç±»å::å±æ€§ ç±»å::æ–¹æ³•å() 123456789&lt;?phpclass Person &#123; public static $add=&#x27;åŒ—äº¬&#x27;; // ä¿®é¥°ç¬¦ä¹‹é—´æ²¡æœ‰é¡ºåº static public function show() &#123; echo &#x27;è¿™æ˜¯ä¸€ä¸ªé™æ€çš„æ–¹æ³•&lt;br&gt;&#x27;; &#125;&#125;echo Person::$add,&#x27;&lt;br&gt;&#x27;; //åŒ—äº¬Person::show(); //è¿™æ˜¯ä¸€ä¸ªé™æ€çš„æ–¹æ³• ğŸ’¡ æ³¨æ„ï¼šselfè¡¨ç¤ºæ‰€åœ¨ç±»çš„ç±»åï¼Œä½¿ç”¨selfé™ä½è€¦åˆæ€§ é™æ€æˆå‘˜ä¹Ÿå¯ä»¥è¢«ç»§æ‰¿ 12345678910111213&lt;?phpclass Person &#123; public static $add=&#x27;ä¸­å›½&#x27;; public static function show() &#123; echo &#x27;è¿™æ˜¯äººç±»&lt;br&gt;&#x27;; &#125;&#125;//ç»§æ‰¿class Student extends Person &#123;&#125;//æµ‹è¯•echo Student::$add,&#x27;&lt;br&gt;&#x27;; //ä¸­å›½ é€šè¿‡å­ç±»åç§°è®¿é—®çˆ¶ç±»çš„é™æ€æˆå‘˜Student::show(); //è¿™æ˜¯äººç±» é™æ€å»¶æ—¶ç»‘å®š staticè¡¨ç¤ºå½“å‰å¯¹è±¡æ‰€å±çš„ç±» 123456789101112131415161718192021&lt;?phpclass Person &#123; public static $type=&#x27;äººç±»&#x27;; public function show1() &#123; //var_dump($this); //object(Student)#1 (0) &#123; &#125; //echo self::$type,&#x27;&lt;br&gt;&#x27;; //äººç±» echo static::$type,&#x27;&lt;br&gt;&#x27;; //å­¦ç”Ÿ å»¶æ—¶ç»‘å®š &#125;&#125;class Student extends Person &#123; public static $type=&#x27;å­¦ç”Ÿ&#x27;; public function show2() &#123; //var_dump($this); //object(Student)#1 (0) &#123; &#125; //echo self::$type,&#x27;&lt;br&gt;&#x27;; //å­¦ç”Ÿ echo static::$type,&#x27;&lt;br&gt;&#x27;; //å­¦ç”Ÿ &#125;&#125;//æµ‹è¯•$obj=new Student();$obj-&gt;show1();$obj-&gt;show2(); å°ç»“ï¼š 1ã€staticåœ¨å†…å­˜ä¸­å°±ä¸€ä»½ï¼Œåœ¨ç±»åŠ è½½çš„æ—¶å€™åˆ†é…ç©ºé—´ 2ã€å¦‚æœæœ‰å¤šä¸ªä¿®é¥°ç¬¦ï¼Œä¿®é¥°ç¬¦ä¹‹é—´æ˜¯æ²¡æœ‰é¡ºåºçš„ 3ã€selfè¡¨ç¤ºæ‰€åœ¨ç±»çš„ç±»å 4ã€staticè¡¨ç¤ºå½“å‰å¯¹è±¡æ‰€å±çš„ç±» 5ã€staticæœ‰ä¸¤ä¸ªä½œç”¨ï¼Œç¬¬ä¸€è¡¨ç¤ºé™æ€çš„ï¼Œç¬¬äºŒè¡¨ç¤ºç±»å 4.2 finalã€æœ€ç»ˆçš„ã€‘finalä¿®é¥°çš„æ–¹æ³•ä¸èƒ½è¢«é‡å†™ finalä¿®é¥°çš„ç±»ä¸èƒ½è¢«ç»§æ‰¿ 4.2.1 ä½œç”¨1ã€å¦‚æœä¸€ä¸ªç±»ç¡®å®šä¸è¢«ç»§æ‰¿ï¼Œä¸€ä¸ªæ–¹æ³•ç¡®å®šä¸ä¼šè¢«é‡å†™ï¼Œç”¨finalä¿®é¥°å¯ä»¥æé«˜æ‰§è¡Œæ•ˆç‡ã€‚ 2ã€å¦‚æœä¸€ä¸ªæ–¹æ³•ä¸å…è®¸è¢«å…¶ä»–ç±»é‡å†™ï¼Œå¯ä»¥ç”¨finalä¿®é¥°ã€‚ 4.3 abstractã€æŠ½è±¡çš„ã€‘ abstractä¿®é¥°çš„æ–¹æ³•æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œä¿®é¥°çš„ç±»æ˜¯æŠ½è±¡ç±» åªæœ‰æ–¹æ³•çš„å£°æ˜æ²¡æœ‰æ–¹æ³•çš„å®ç°ç§°ä¸ºæŠ½è±¡æ–¹æ³• ä¸€ä¸ªç±»ä¸­åªè¦æœ‰ä¸€ä¸ªæ–¹æ³•æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œè¿™ä¸ªç±»å¿…é¡»æ˜¯æŠ½è±¡ç±»ã€‚ æŠ½è±¡ç±»çš„ç‰¹ç‚¹æ˜¯ä¸èƒ½è¢«å®ä¾‹åŒ– å­ç±»ç»§æ‰¿äº†æŠ½è±¡ç±»ï¼Œå°±å¿…é¡»é‡æ–°å®ç°çˆ¶ç±»çš„æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•ï¼Œå¦åˆ™ä¸å…è®¸å®ä¾‹åŒ– ç±»ä¸­æ²¡æœ‰æŠ½è±¡æ–¹æ³•ä¹Ÿå¯ä»¥å£°æ˜æˆæŠ½è±¡ç±»ï¼Œç”¨æ¥é˜»æ­¢ç±»çš„å®ä¾‹åŒ– 4.3.1 æŠ½è±¡ç±»çš„ä½œç”¨1ã€å®šä¹‰å‘½åè§„èŒƒ 2ã€é˜»æ­¢å®ä¾‹åŒ–ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œè¿™æ—¶å€™æ²¡æœ‰å¿…è¦å»å®ä¾‹åŒ–ï¼Œå¯ä»¥é€šè¿‡abstractæ¥é˜»æ­¢æ¥çš„å®ä¾‹åŒ–ã€‚ 5 ç±»å¸¸é‡ç±»å¸¸é‡æ˜¯constå¸¸é‡ 123456&lt;?phpclass Student &#123; //public const ADDï¼› //7.1ä»¥åæ‰æ”¯æŒè®¿é—®ä¿®é¥°ç¬¦ const ADD=&#x27;åœ°å€ä¸è¯¦&#x27;;&#125;echo Student::ADD; é—®é¢˜ï¼šdefineå¸¸é‡å’Œconstå¸¸é‡çš„åŒºåˆ«ï¼Ÿ ç­”ï¼šconstå¸¸é‡å¯ä»¥åšç±»æˆå‘˜ï¼Œdefineå¸¸é‡ä¸å¯ä»¥åšç±»æˆå‘˜ã€‚ é—®é¢˜ï¼šå¸¸é‡å’Œé™æ€çš„å±æ€§çš„åŒºåˆ«ï¼Ÿ ç­”ï¼šç›¸åŒç‚¹ï¼šéƒ½åœ¨åŠ è½½ç±»çš„æ—¶å€™åˆ†é…ç©ºé—´ ä¸åŒç‚¹ï¼šå¸¸é‡çš„å€¼ä¸å¯ä»¥æ›´æ”¹ï¼Œé™æ€å±æ€§çš„å€¼å¯ä»¥æ›´æ”¹ 6 æ¥å£ï¼ˆinterfaceï¼‰6.1 æ¥å£ å¦‚æœä¸€ä¸ªç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•æ˜¯éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæŠ½è±¡ç±»å¯ä»¥å£°æ˜æˆæ¥å£ æ¥å£æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æŠ½è±¡ç±»ï¼Œæ¥å£ä¸­åªèƒ½æœ‰æŠ½è±¡æ–¹æ³•å’Œå¸¸é‡ æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•åªèƒ½æ˜¯publicï¼Œå¯ä»¥çœç•¥ï¼Œé»˜è®¤ä¹Ÿæ˜¯publicçš„ é€šè¿‡implementså…³é”®å­—æ¥å®ç°æ¥å£ ä¸èƒ½ä½¿ç”¨abstractå’Œfinalæ¥ä¿®é¥°æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•ã€‚ 123456789101112131415161718&lt;?php//å£°æ˜æ¥å£interface IPerson &#123; const ADD=&#x27;ä¸­å›½&#x27;; function fun1(); function fun2();&#125;//æ¥å£å®ç°class Student implements IPerson &#123; public function fun1() &#123; &#125; public function fun2() &#123; &#125;&#125;//è®¿é—®æ¥å£ä¸­çš„å¸¸é‡echo IPerson::ADD; 6.2 æ¥å£çš„å¤šé‡å®ç°ç±»ä¸å…è®¸å¤šé‡ç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å…è®¸å¤šé‡å®ç°ã€‚ 12345678910111213141516&lt;?phpinterface IPic1 &#123; function fun1();&#125;interface IPic2 &#123; function fun2();&#125;//æ¥å£å…è®¸å¤šé‡å®ç°class Student implements IPic1,IPic2 &#123; public function fun1() &#123; &#125; public function fun2() &#123; &#125;&#125; æ³¨æ„ï¼š 1ã€åœ¨æ¥å£çš„å¤šé‡å®ç°ä¸­ï¼Œå¦‚æœæœ‰åŒåçš„æ–¹æ³•ï¼Œåªè¦å®ç°ä¸€æ¬¡å³å¯ 2ã€ç±»å¯ä»¥ç»§æ‰¿çš„åŒæ—¶å®ç°æ¥å£ 123class Student extends Person implements IPIc1,IPic1&#123;&#125; 7 åŒ¿åç±»è¿™æ˜¯äº†è§£çš„å†…å®¹ï¼ŒPHP7.0æ”¯æŒ 123456789101112&lt;?php$stu=new class &#123; public $name=&#x27;tom&#x27;; public function __construct() &#123; echo &#x27;æ„é€ å‡½æ•°&lt;br&gt;&#x27;; &#125;&#125;;echo $stu-&gt;name;/*è¿è¡Œç»“æœï¼›æ„é€ å‡½æ•°tom*/ å°ç»“ï¼š 1ã€å¦‚æœç±»åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡å°±å¯ä»¥ä½¿ç”¨åŒ¿åç±» 2ã€å¥½å¤„ï¼Œåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œç±»ä¸å ç”¨ç©ºé—´ 8 æ–¹æ³•ç»‘å®šè¿™æ˜¯äº†è§£çš„å†…å®¹ï¼ŒPHP7.0æ”¯æŒ 123456789101112&lt;?php$stu=new class &#123; public $name=&#x27;tom&#x27;; public function __construct() &#123; echo &#x27;æ„é€ å‡½æ•°&lt;br&gt;&#x27;; &#125;&#125;;echo $stu-&gt;name;/*è¿è¡Œç»“æœï¼›æ„é€ å‡½æ•°tom*/ å°ç»“ï¼š 1ã€å¦‚æœç±»åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡å°±å¯ä»¥ä½¿ç”¨åŒ¿åç±» 2ã€å¥½å¤„ï¼Œåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œç±»ä¸å ç”¨ç©ºé—´ 9 å¼‚å¸¸å¤„ç†é›†ä¸­å¤„ç†åœ¨ä»£ç å—ä¸­å‘ç”Ÿçš„å¼‚å¸¸ã€‚ åœ¨ä»£ç å—ä¸­å‘ç”Ÿäº†å¼‚å¸¸ç›´æ¥æŠ›å‡ºï¼Œä»£ç å—ä¸­ä¸å¤„ç†å¼‚å¸¸ï¼Œå°†å¼‚å¸¸é›†ä¸­èµ·æ¥ä¸€èµ·å¤„ç†ã€‚ 9.1 ä½¿ç”¨çš„å…³é”®å­—12345try:ç›‘æµ‹ä»£ç å—catch:æ•è·å¼‚å¸¸throw:æŠ›å‡ºå¼‚å¸¸finally:æ— è®ºæœ‰æ— å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œï¼Œå¯ä»¥çœç•¥Exceptionï¼šå¼‚å¸¸ç±» è¯­æ³•ç»“æ„ 12345678try&#123;\t//æ£€æµ‹ä»£ç &#125;catch(Exception $ex)&#123;\t//æ•è·å¼‚å¸¸&#125;finally&#123;\t//ä¸è®ºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œéƒ½è¦æ‰§è¡Œï¼Œfinallyå¯ä»¥çœç•¥&#125; 9.2 è‡ªå®šä¹‰å¼‚å¸¸åœºæ™¯ï¼šå¦‚æœå®ç°å¼‚å¸¸çš„åˆ†ç±»å¤„ç†ï¼Ÿæ¯”å¦‚å¼‚å¸¸æœ‰ä¸‰ä¸ªçº§åˆ«å¼‚å¸¸å¯¹åº”ä¸‰ç§å¤„ç†æ–¹å¼ è‡ªå®šä¹‰ä¸‰ç§å¼‚å¸¸å³å¯ æ‰€æœ‰å¼‚å¸¸ç±»çš„çˆ¶ç±»æ˜¯Exceptionï¼ŒExceptionä¸­çš„æ–¹æ³•ä¸å…è®¸é‡å†™","tags":["PHP"],"categories":["Language"]},{"title":"PHPé¢å‘å¯¹è±¡-1-ç±»&å¯¹è±¡&å±æ€§&è®¿é—®ä¿®é¥°ç¬¦","path":"/p/b78a5232/","content":"1 é¢å‘å¯¹è±¡ä»‹ç»1.1 ä»‹ç»é¢å‘å¯¹è±¡æ˜¯ä¸€ä¸ªç¼–ç¨‹æ€æƒ³ã€‚ç¼–ç¨‹æ€æƒ³æœ‰é¢å‘è¿‡ç¨‹å’Œé¢å‘å¯¹è±¡ é¢å‘è¿‡ç¨‹ï¼šç¼–ç¨‹æ€è·¯é›†ä¸­çš„æ˜¯è¿‡ç¨‹ä¸Š é¢å‘å¯¹è±¡ï¼šç¼–ç¨‹æ€è·¯é›†ä¸­åœ¨å‚ä¸çš„å¯¹è±¡ ä»¥å»é¥­é¦†åƒé¥­ä¸ºä¾‹ï¼š é¢å‘è¿‡ç¨‹ï¼šç‚¹èœâ€”â€”åšèœâ€”â€”ä¸Šèœâ€”â€”åƒé¥­â€”â€”ç»“è´¦â€”â€”æ”¶æ‹¾ é¢å‘å¯¹è±¡ï¼šæœåŠ¡å‘˜ï¼Œå¨å¸ˆï¼Œå®¢äºº 1.2 é¢å‘å¯¹è±¡çš„å¥½å¤„ å¤šäººåˆä½œæ–¹ä¾¿ å‡å°‘ä»£ç å†—ä½™ï¼Œçµæ´»æ€§é«˜ ä»£ç çš„å¯é‡ç”¨æ€§å‘æŒ¥åˆ°æè‡´ å¯æ‰©å±•æ€§å¼º 1234å¤šå­¦ä¸€æ‹›ï¼šOOPï¼šé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject Oriented Programmingï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰OOA: é¢å‘å¯¹è±¡åˆ†æ(Object-Oriented Analysis,OOA)OOD: é¢å‘å¯¹è±¡è®¾è®¡ï¼ˆObject-Oriented Designï¼ŒOODï¼‰ 2 ç±»å’Œå¯¹è±¡1ã€å¯¹è±¡æ˜¯å…·ä½“å­˜åœ¨çš„äº‹ç‰©ï¼Œå¯¹è±¡æ˜¯ç”±å±æ€§ï¼ˆå˜é‡ï¼‰å’Œæ–¹æ³•ï¼ˆå‡½æ•°ï¼‰ç»„æˆçš„ 2ã€ç±»æ˜¯å…·æœ‰ç›¸åŒå±æ€§å’Œè¡Œä¸ºçš„ä¸€ç»„å¯¹è±¡çš„é›†åˆ åˆ†æï¼šåšèœåŠ¨ä½œâ€”â€”å¨å¸ˆå¯¹è±¡â€”â€”å¨å¸ˆç±»ç»“è®ºï¼šæˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™ï¼Œå…ˆå†™ç±»ï¼Œé€šè¿‡ç±»åˆ›å»ºå¯¹è±¡ï¼Œç„¶åè°ƒç”¨å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å®ç°åŠŸèƒ½ã€‚ ç±»â€”â€”å¯¹è±¡â€”â€”è°ƒç”¨æˆå‘˜ ğŸ’¡ æ³¨æ„ï¼šä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ å°ç»“ï¼š 1ã€å¯¹è±¡æ˜¯ç”±å±æ€§å’Œæ–¹æ³•ç»„æˆçš„ 2ã€ç±»æ˜¯æ‰€æœ‰å¯¹è±¡çš„ç›¸åŒå±æ€§å’Œæ–¹æ³•çš„é›†åˆ 3ã€åœ¨å¼€å‘çš„æ—¶å€™å…ˆå†™ç±»ï¼Œé€šè¿‡ç±»åˆ›å»ºå¯¹è±¡ï¼Œé€šè¿‡å¯¹è±¡è°ƒç”¨æ–¹æ³•å’Œå±æ€§ 4ã€ä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ 3 åœ¨PHPä¸­å®ç°ç±»å’Œå¯¹è±¡3.1 åˆ›å»ºç±»è¯­æ³•ï¼š 1234567class ç±»å&#123; //å±æ€§ //æ–¹æ³• //å¸¸é‡&#125;ç±»æ˜¯ç”±å±æ€§ã€æ–¹æ³•ã€å¸¸é‡ç»„æˆçš„ï¼Œä¹Ÿå¯ä»¥è¯´ç±»æˆå‘˜æœ‰ï¼šå±æ€§ã€æ–¹æ³•ã€å¸¸é‡ ç±»åçš„å‘½åè§„åˆ™ï¼š ä»¥å­—æ¯ã€ä¸‹åˆ’çº¿å¼€å¤´ï¼Œåé¢è·Ÿçš„æ˜¯å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ ä¸èƒ½ç”¨PHPå…³é”®å­—åšç±»å ç±»åä¸åŒºåˆ†å¤§å°å†™ï¼ˆå˜é‡ååŒºåˆ†ï¼Œå…³é”®å­—ã€ç±»åä¸åŒºåˆ†å¤§å°å†™ï¼‰ ç±»åç”¨å¸•æ–¯å¡å‘½åæ³•ï¼ˆå¤§é©¼å³° å•è¯çš„é¦–å­—æ¯å¤§å†™ï¼‰ 123&lt;?phpclass Student &#123;&#125; 3.2 å¯¹è±¡å®ä¾‹åŒ–é€šè¿‡newå…³é”®å­—æ¥å®ä¾‹åŒ–å¯¹è±¡ã€‚ 123456789&lt;?php//å®šä¹‰ç±»class Student &#123;&#125;//å®ä¾‹åŒ–å¯¹è±¡$stu1=new Student();$stu2=new Student; //å°æ‹¬å·å¯ä»¥çœç•¥var_dump($stu1,$stu2); //object(Student)#1 (0) &#123; &#125; object(Student)#2 (0) &#123; &#125; 3.3 å¯¹è±¡çš„æ¯”è¾ƒğŸ’¡ æ³¨æ„ï¼šå¯¹è±¡çš„ä¼ é€’æ˜¯åœ°å€ä¼ é€’ ç›¸ç­‰ï¼šç»“æ„å’Œä¿å­˜çš„å€¼ä¸€æ ·å°±ç›¸ç­‰å…¨ç­‰ï¼šæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡æ‰æ˜¯å…¨ç­‰ã€‚ 12345678910111213141516&lt;?php//å®šä¹‰ç±»class Student &#123;&#125;//å®ä¾‹åŒ–å¯¹è±¡$stu1=new Student();$stu2=new Student;$stu3=$stu2; //å¯¹è±¡ä¼ é€’çš„æ˜¯åœ°å€//var_dump($stu1,$stu2,$stu3); //object(Student)#1 (0) &#123; &#125; object(Student)#2 (0) &#123; &#125; object(Student)#2 (0) &#123; &#125;//å¯¹è±¡æ¯”è¾ƒvar_dump($stu1==$stu2); //bool(true) ,æ¯”è¾ƒå¯¹è±¡çš„ç»“æ„echo &#x27;&lt;br&gt;&#x27;;var_dump($stu1===$stu2); //bool(false) $stu1å’Œ$stu2æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡echo &#x27;&lt;br&gt;&#x27;;var_dump($stu2===$stu3); //bool(true) $stu2å’Œ$stu3æ˜¯åŒä¸€ä¸ªå¯¹è±¡ 4 å±æ€§å±æ€§æœ¬è´¨å°±æ˜¯å˜é‡ é€šè¿‡-&gt;è°ƒç”¨å¯¹è±¡çš„æˆå‘˜ å¯¹è±¡å-&gt;å±æ€§å å¯¹è±¡å-&gt;æ–¹æ³•å() 12345678910111213141516171819202122232425&lt;?php//å®šä¹‰ç±»class Student &#123; public $name; //å±æ€§ public $add=&#x27;åœ°å€ä¸è¯¦&#x27;; //å±æ€§&#125;//å®ä¾‹åŒ–å¯¹è±¡$stu=new Student();//print_r($stu); //Student Object ( [name] =&gt; [add] =&gt; åœ°å€ä¸è¯¦ )//æ“ä½œå±æ€§//1ã€ç»™å±æ€§èµ‹å€¼$stu-&gt;name=&#x27;tom&#x27;;$stu-&gt;add=&#x27;åŒ—äº¬&#x27;;//2ã€è·å–å±æ€§çš„å€¼echo &#x27;å§“åï¼š&#x27;.$stu-&gt;name,&#x27;&lt;br&gt;&#x27;; //å§“åï¼štomecho &#x27;åœ°å€ï¼š&#x27;.$stu-&gt;add,&#x27;&lt;br&gt;&#x27;; //åœ°å€ï¼šåŒ—äº¬//3ã€æ·»åŠ å±æ€§$stu-&gt;age=20;print_r($stu); //Student Object ( [name] =&gt; tom [add] =&gt; åŒ—äº¬ [age] =&gt; 20 )echo &#x27;&lt;br&gt;&#x27;;//4ã€åˆ é™¤å±æ€§unset($stu-&gt;add);print_r($stu); //Student Object ( [name] =&gt; tom [age] =&gt; 20 ) 5 æ–¹æ³•æ–¹æ³•çš„æœ¬è´¨å°±æ˜¯å‡½æ•° 1234567891011121314&lt;?phpclass Student &#123; //å®šä¹‰æ–¹æ³• public function show() &#123; echo &#x27;è¿™æ˜¯showæ–¹æ³•&lt;br&gt;&#x27;; &#125; //publicå¯ä»¥çœç•¥ï¼Œå¦‚æœçœç•¥ï¼Œé»˜è®¤å°±æ˜¯public function test() &#123; echo &#x27;è¿™æ˜¯testæ–¹æ³•&lt;br&gt;&#x27;; &#125;&#125;$stu=new Student;$stu-&gt;show(); //è°ƒç”¨æ–¹æ³•$stu-&gt;test(); å¤šå­¦ä¸€æ‹›ï¼š 1ã€æ–¹æ³•å‰é¢publicæ˜¯å¯ä»¥çœç•¥çš„ï¼Œå¦‚æœçœç•¥ï¼Œé»˜è®¤å°±æ˜¯publicçš„ã€‚ 2ã€å±æ€§å‰é¢çš„publicä¸èƒ½çœç•¥ 6 è®¿é—®ä¿®é¥°ç¬¦ç”¨æ¥æ§åˆ¶æˆå‘˜çš„è®¿é—®æƒé™ ä¿®é¥°ç¬¦ æè¿° publicï¼ˆå…¬æœ‰çš„ï¼‰ åœ¨ç±»çš„å†…éƒ¨å’Œå¤–éƒ¨éƒ½èƒ½è®¿é—® privateï¼ˆç§æœ‰çš„ï¼‰ åªèƒ½åœ¨ç±»çš„å†…éƒ¨è®¿é—® protectedï¼ˆå—ä¿æŠ¤çš„ï¼‰ åœ¨æ•´ä¸ªç»§æ‰¿é“¾ä¸Šè®¿é—® å¤šå­¦ä¸€æ‹›ï¼šä¸€èˆ¬æ¥è¯´ï¼Œå±æ€§éƒ½ç”¨ç§æœ‰çš„ï¼Œé€šè¿‡å…¬æœ‰çš„æ–¹æ³•å¯¹ç§æœ‰çš„å±æ€§è¿›è¡Œèµ‹å€¼å’Œå–å€¼ã€‚ ä½œç”¨ï¼šä¿è¯æ•°æ®çš„åˆæ³•æ€§ ğŸ’¡ æç¤ºï¼š$thisè¡¨ç¤ºè°ƒç”¨å½“å‰æ–¹æ³•çš„å¯¹è±¡ 7 ç±»å’Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒ å¯¹è±¡çš„æœ¬è´¨æ˜¯ä¸€ä¸ªå¤æ‚çš„å˜é‡ ç±»çš„æœ¬è´¨æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„å¤æ‚æ•°æ®ç±»å‹ æ ˆåŒºï¼šè¿è¡Œé€Ÿåº¦å¿«ï¼Œä½“ç§¯å°ï¼Œä¿å­˜åŸºæœ¬ç±»å‹ å †åŒºï¼šè¿è¡Œé€Ÿåº¦ç¨æ…¢ï¼Œä½“ç§¯å¤§ï¼Œä¿å­˜å¤æ‚ç±»å‹ å®ä¾‹åŒ–çš„è¿‡ç¨‹å°±æ˜¯åˆ†é…å†…å­˜ç©ºé—´çš„è¿‡ç¨‹ å¯¹è±¡ä¿å­˜åœ¨å †åŒºï¼Œå°†å †åŒºçš„åœ°å€ä¿å­˜åˆ°æ ˆåŒº 8 å°è£…å°è£…å°±æ˜¯æœ‰é€‰æ‹©æ€§çš„æä¾›æ•°æ® é€šè¿‡è®¿é—®ä¿®é¥°ç¬¦æ¥å®ç°å°è£… 9 æ„é€ æ–¹æ³•9.1 ä»‹ç»æ„é€ æ–¹æ³•ä¹Ÿå«æ„é€ å‡½æ•°ï¼Œå½“å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œã€‚è¯­æ³•ï¼š 123function __construct()&#123;&#125;æ³¨æ„ï¼šå‰é¢æ˜¯ä¸¤ä¸ªä¸‹åˆ’çº¿ ğŸ’¡ æ³¨æ„ï¼šåœ¨å…¶ä»–è¯­è¨€é‡Œï¼Œä¸ç±»ååŒåçš„å‡½æ•°æ˜¯æ„é€ å‡½æ•°ï¼Œåœ¨PHPä¸­ä¸å…è®¸è¿™ç§å†™æ³•ã€‚ 10 ææ„æ–¹æ³•10.1 ä»‹ç»å½“å¯¹è±¡é”€æ¯çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ è¯­æ³• 12function __destruct()&#123;&#125; è„šä¸‹ç•™å¿ƒï¼šææ„å‡½æ•°ä¸å¯ä»¥å¸¦å‚æ•° 11 ç»§æ‰¿11.1 ç»§æ‰¿ä»‹ç» ç»§æ‰¿ä½¿å¾—ä»£ç å…·æœ‰å±‚æ¬¡ç»“æ„ å­ç±»ç»§æ‰¿äº†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå®ç°äº†ä»£ç çš„å¯é‡ç”¨æ€§ã€‚ ä½¿ç”¨extendså…³é”®å­—å®ç°ç»§æ‰¿ çˆ¶ç±»å’Œå­ç±»æ˜¯ç›¸å¯¹çš„ è¯­æ³• 12class å­ç±» extends çˆ¶ç±»&#123;&#125; 11.2 å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æˆå‘˜1ã€æ–¹æ³•ä¸€ï¼šé€šè¿‡å®ä¾‹åŒ–çˆ¶ç±»è°ƒç”¨çˆ¶ç±»çš„æˆå‘˜ 2ã€æ–¹æ³•äºŒï¼šé€šè¿‡$thiså…³é”®å­—è°ƒç”¨çˆ¶ç±»çš„æˆå‘˜ 11.3 protectedprotectedï¼šå—ä¿æŠ¤çš„ï¼Œåœ¨æ•´ä¸ªç»§æ‰¿é“¾ä¸Šä½¿ç”¨ 11.4 ç»§æ‰¿ä¸­çš„æ„é€ å‡½æ•°è§„åˆ™ï¼š 1231ã€å¦‚æœå­ç±»æœ‰æ„é€ å‡½æ•°å°±è°ƒç”¨å­ç±»çš„ï¼Œå¦‚æœå­ç±»æ²¡æœ‰å°±è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚2ã€å­ç±»çš„æ„é€ å‡½æ•°è°ƒç”¨åï¼Œé»˜è®¤ä¸å†è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•° é€šè¿‡ç±»åè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•° 1ç±»å::__construct() ğŸ’¡ æ³¨æ„ï¼šå¯ä»¥ç”¨parentå…³é”®å­—è¡¨ç¤ºçˆ¶ç±»çš„åå­—ï¼Œå¯ä»¥é™ä½ç¨‹åºçš„è€¦åˆæ€§ 11.5 $thisè¯¦è§£$thisè¡¨ç¤ºå½“å‰å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯æ˜¯æˆ–**$this**ä¿å­˜çš„å½“å‰å¯¹è±¡çš„åœ°å€ 11.6 å¤šé‡ç»§æ‰¿PHPä¸å…è®¸å¤šé‡ç»§æ‰¿ï¼Œå› ä¸ºå¤šé‡ç»§æ‰¿å®¹æ˜“äº§ç”ŸäºŒä¹‰æ€§ å¦‚ä½•å®ç°Cç»§æ‰¿Aå’ŒBï¼Œä½¿ç”¨ç»§æ‰¿é“¾","tags":["PHP"],"categories":["Language"]},{"title":"PHPåŸºç¡€-3-æ–‡ä»¶æ“ä½œ","path":"/p/a73ab557/","content":"1 æ–‡ä»¶æ“ä½œ1.1 å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶123&lt;?php$str=&quot;åºŠå‰æ˜æœˆå…‰ï¼Œ\\r ç–‘æ˜¯åœ°ä¸Šéœœã€‚\\r ä¸¾å¤´æœ›æ˜æœˆï¼Œ\\r ä½å¤´æ€æ•…ä¹¡ã€‚&quot;;file_put_contents(&#x27;./test.txt&#x27;,$str); //å°†å­—ç¬¦ä¸²å†™åˆ°æ–‡æœ¬ä¸­ å°ç»“ï¼š 1ã€ æ‰€æœ‰çš„â€œå†™â€æ“ä½œéƒ½æ˜¯æ¸…ç©ºé‡å†™ 2ã€åœ¨æ–‡æœ¬ä¸­æ¢è¡Œæ˜¯\\r 123\\r:å›è½¦ å…‰æ ‡ç§»åŠ¨åˆ°å½“å‰è¡Œçš„æœ€å‰é¢ :æ¢è¡Œ å°†å…‰æ ‡ä¸‹ç§»åŠ¨ä¸€è¡ŒæŒ‰é”®ç›˜çš„å›è½¦é”®åšäº†ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥å°†å…‰æ ‡ç§»åŠ¨åˆ°å½“å‰è¡Œçš„æœ€å‰é¢ï¼Œç¬¬äºŒæ­¥ä¸‹ç§»ä¸€è¡Œã€‚ 3ã€\\r æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œå¿…é¡»æ”¾åœ¨åŒå¼•å·å†… 1.2 å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²123456//æ–¹æ³•ä¸€ï¼šecho file_get_contents(&#x27;./test.txt&#x27;); //å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²//æ–¹æ³•äºŒï¼šreadfile(&#x27;./test.txt&#x27;); //è¯»å–è¾“å‡ºæ–‡ä»¶å†…å®¹//æ³¨æ„ï¼šecho file_get_contents()==readfile() 1.3 æ‰“å¼€æ–‡ä»¶å¹¶æ“ä½œ12345fopen(åœ°å€,æ¨¡å¼) æ‰“å¼€æ–‡ä»¶æ¨¡å¼ï¼šrï¼šè¯» readw:å†™ writea:è¿½åŠ  append 1234567891011121314151617181920//3.1ã€æ‰“å¼€æ–‡ä»¶å†™å…¥/*$fp=fopen(&#x27;./test.txt&#x27;,&#x27;w&#x27;); //æ‰“å¼€æ–‡ä»¶è¿”å›æ–‡ä»¶æŒ‡é’ˆï¼ˆæ–‡ä»¶åœ°å€ï¼‰//var_dump($fp); //resource(3) of type (stream) for($i=1;$i&lt;=10;$i++)\tfputs($fp,&#x27;å…³å…³é›é¸ &#x27;.&quot;\\r &quot;);\t//å†™ä¸€è¡Œfclose($fp);\t//å…³é—­æ–‡ä»¶*///3.2 æ‰“å¼€æ–‡ä»¶è¯»å–/*$fp=fopen(&#x27;./test.txt&#x27;,&#x27;r&#x27;);\t//æ‰“å¼€æ–‡ä»¶è¯»å–while($line=fgets($fp))&#123;\techo $line,&#x27;&lt;br&gt;&#x27;;&#125;*///3.3 æ‰“å¼€æ–‡ä»¶è¿½åŠ $fp=fopen(&#x27;./test.txt&#x27;,&#x27;a&#x27;);\t//æ‰“å¼€æ–‡ä»¶è¿½åŠ fputs($fp,&#x27;åœ¨æ²³ä¹‹æ´²&#x27;); //åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ  å°ç»“ï¼š 1ã€æ‰“å¼€æ–‡ä»¶ï¼Œè¿”å›æ–‡ä»¶æŒ‡é’ˆï¼ˆæ–‡ä»¶æŒ‡é’ˆå°±æ˜¯æ–‡ä»¶åœ°å€ï¼‰ï¼Œèµ„æºç±»å‹ 2ã€æ‰“å¼€æ–‡ä»¶å†™ã€è¿½åŠ æ“ä½œï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºæ–°çš„æ–‡ä»¶ 3ã€æ‰“å¼€æ–‡ä»¶è¯»æ“ä½œï¼Œæ–‡ä»¶ä¸å­˜åœ¨å°±æŠ¥é”™ 4ã€fputs()å†™ä¸€è¡Œï¼Œfgets()è¯»ä¸€è¡Œï¼Œfclose()å…³é—­æ–‡ä»¶ 5ã€è¿½åŠ æ˜¯åœ¨æ–‡ä»¶çš„æœ«å°¾è¿½åŠ  1.4 æ˜¯å¦æ˜¯æ–‡ä»¶ã€is_file()ã€‘1echo is_file(&#x27;./test.txt&#x27;)?&#x27;æ˜¯æ–‡ä»¶&#x27;:&#x27;ä¸æ˜¯æ–‡ä»¶&#x27;; 1.5 åˆ¤æ–­æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ã€file_exists()ã€‘1echo file_exists(&#x27;./test.txt&#x27;)?&#x27;æ–‡ä»¶å­˜åœ¨&#x27;:&#x27;æ–‡ä»¶ä¸å­˜åœ¨&#x27;; 1.6 åˆ é™¤æ–‡ä»¶ã€unlinkã€‘123456789$path=&#x27;./test.txt&#x27;;if(file_exists($path))&#123; //æ–‡ä»¶å­˜åœ¨ if(is_dir($path)) //å¦‚æœæ˜¯æ–‡ä»¶å¤¹ç”¨rmdir()åˆ é™¤ rmdir($path); elseif(is_file($Path)) //å¦‚æœæ˜¯æ–‡ä»¶ç”¨unlink()åˆ é™¤ unlink($path);&#125;else&#123; echo &#x27;æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶ä¸å­˜åœ¨&#x27;;&#125; 1.7 äºŒè¿›åˆ¶è¯»å–ã€fread(æ–‡ä»¶æŒ‡é’ˆï¼Œæ–‡ä»¶å¤§å°)ã€‘æ–‡ä»¶çš„å­˜å‚¨æœ‰ä¸¤ç§ï¼šå­—ç¬¦æµå’ŒäºŒè¿›åˆ¶æµ äºŒè¿›åˆ¶æµçš„è¯»å–æŒ‰æ–‡ä»¶å¤§å°æ¥è¯»çš„ã€‚ 1234$path=&#x27;./face.jpg&#x27;;$fp=fopen($path,&#x27;r&#x27;);header(&#x27;content-type:image/jpeg&#x27;); //å‘ŠçŸ¥æµè§ˆå™¨ä¸‹é¢çš„ä»£ç é€šè¿‡jpgå›¾ç‰‡æ–¹å¼è§£æecho fread($fp,filesize($path)); //äºŒè¿›åˆ¶è¯»å– å¤šå­¦ä¸€æ‹›ï¼šfile_get_contents()ä¹Ÿå¯ä»¥è¿›è¡ŒäºŒè¿›åˆ¶è¯»å– 12header(&#x27;content-type:image/jpeg&#x27;);echo file_get_contents(&#x27;./face.jpg&#x27;); å°ç»“ï¼š 1ã€æ–‡æœ¬æµæœ‰æ˜ç¡®çš„ç»“æŸç¬¦ï¼ŒäºŒè¿›åˆ¶æµæ²¡æœ‰æ˜ç¡®çš„ç»“æŸç¬¦ï¼Œé€šè¿‡æ–‡ä»¶å¤§å°åˆ¤æ–­æ–‡ä»¶æ˜¯å¦è¯»å–å®Œæ¯• 2ã€file_get_contents()æ—¢å¯ä»¥è¿›è¡Œå­—ç¬¦æµè¯»å–ï¼Œä¹Ÿå¯ä»¥è¿›è¡ŒäºŒè¿›åˆ¶è¯»å–ã€‚ 2 è¡¨å•æäº¤æ•°æ®çš„ä¸¤ç§æ–¹å¼2.1 ä¸¤ç§æ–¹å¼1ã€get 2ã€post 12&lt;form method=&quot;post&quot; action=&quot;&quot;&gt;&lt;/form&gt;&lt;form method=&quot;get&quot; action=&quot;&quot;&gt;&lt;/form&gt; 2.2 åŒºåˆ«1ã€å¤–è§‚ä¸Šçœ‹ getæäº¤åœ¨åœ°å€ä¸Šå¯ä»¥çœ‹åˆ°å‚æ•° postæäº¤åœ¨åœ°å€æ ä¸Šçœ‹ä¸åˆ°å‚æ•° 2ã€å®‰å…¨æ€§ getä¸å®‰å…¨ postå®‰å…¨ 3ã€æäº¤åŸç† getæäº¤æ˜¯å‚æ•°ä¸€ä¸ªä¸€ä¸ªçš„æäº¤ postæäº¤æ˜¯æ‰€æœ‰å‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“ä¸€èµ·æäº¤ 4ã€æäº¤æ•°æ®å¤§å° getæäº¤ä¸€èˆ¬ä¸è¶…è¿‡255ä¸ªå­—èŠ‚ postæäº¤çš„å¤§å°å–å†³äºæœåŠ¡å™¨ 12// åœ¨php.iniä¸­ï¼Œå¯ä»¥é…ç½®postæäº¤çš„å¤§å°post_max_size = 8M 5ã€çµæ´»æ€§ getå¾ˆçµæ´»ï¼Œåªè¦æœ‰é¡µé¢çš„è·³è½¬å°±å¯ä»¥ä¼ é€’å‚æ•° postä¸çµæ´»ï¼Œpostæäº¤éœ€è¦æœ‰è¡¨å•çš„å‚ä¸ 1234567891011121ã€ htmlè·³è½¬ &lt;a href=&quot;index.php?name=tom&amp;age=20&quot;&gt;è·³è½¬&lt;/a&gt;2ã€JSè·³è½¬&lt;script type=&quot;text/javascript&quot;&gt; location.href=&#x27;index.php?name=tom&amp;age=20&#x27;; location.assign(&#x27;index.php?name=tom&amp;age=20&#x27;); location.replace(&#x27;index.php?name=tom&amp;age=20&#x27;);&lt;/script&gt;3ã€PHPè·³è½¬header(&#x27;location:index.php?name=tom&amp;age=22&#x27;) å°ç»“ï¼š 12&lt;form method=&quot;post&quot; action=&quot;&quot;&gt;&lt;/form&gt;&lt;form method=&quot;get&quot; action=&quot;&quot;&gt;&lt;/form&gt; 3 æœåŠ¡å™¨æ¥å—æ•°æ®çš„ä¸‰ç§æ–¹å¼é€šè¿‡åå­—è·å–åå­—å¯¹åº”çš„å€¼ 123$_POSTï¼šæ•°ç»„ç±»å‹ï¼Œä¿å­˜çš„POSTæäº¤çš„å€¼$_GETï¼šæ•°ç»„ç±»å‹ï¼Œä¿å­˜çš„GETæäº¤çš„å€¼$_REQUESTï¼šæ•°ç»„ç±»å‹ï¼Œä¿å­˜çš„GETå’ŒPOSTæäº¤çš„å€¼ åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­ï¼Œæ—¢æœ‰getåˆæœ‰postï¼Œgetå’Œpostä¼ é€’çš„åå­—æ˜¯ä¸€æ ·çš„ï¼Œè¿™æ—¶å€™é€šè¿‡$_REQUETè·å–çš„æ•°æ®æ˜¯ä»€ä¹ˆ? ç­”ï¼šç»“æœå–å†³äºé…ç½®æ–‡ä»¶ 1request_order = &quot;GP&quot; # å…ˆè·å–GETï¼Œåœ¨è·å–POSTå€¼ å°ç»“ï¼š 1ã€åœ¨å¼€å‘çš„æ—¶å€™ï¼Œå¦‚æœæ˜ç¡®æ˜¯postæäº¤å°±ä½¿ç”¨$_POSTè·å–ï¼Œå¦‚æœæ˜ç¡®getæäº¤å°±ç”¨$_GETè·å– 2ã€requestè·å–æ•ˆç‡ä½ï¼Œå°½å¯èƒ½ä¸è¦ä½¿ç”¨ï¼Œé™¤éæäº¤çš„ç±»å‹ä¸ç¡®å®šçš„æƒ…å†µä¸‹æ‰ä½¿ç”¨ã€‚ 4 å‚æ•°ä¼ é€’4.1 å¤é€‰æ¡†å€¼çš„ä¼ é€’å¤é€‰æ¡†çš„å‘½åè¦æ³¨æ„å¸¦â€™[]â€™ã€‚ 123456789101112131415&lt;body&gt;&lt;?phpif(isset($_POST[&#x27;button&#x27;])) &#123; print_r($_POST[&#x27;hobby&#x27;]);&#125;?&gt;&lt;form method=&quot;post&quot; action=&quot;&quot;&gt; çˆ±å¥½ï¼š &lt;input type=&quot;checkbox&quot; name=&quot;hobby[]&quot; value=&#x27;çˆ¬å±±&#x27;&gt;çˆ¬å±± &lt;input type=&quot;checkbox&quot; name=&quot;hobby[]&quot; value=&#x27;æŠ½çƒŸ&#x27;&gt;æŠ½çƒŸ &lt;input type=&quot;checkbox&quot; name=&quot;hobby[]&quot; value=&#x27;å–é…’&#x27;&gt;å–é…’ &lt;input type=&quot;checkbox&quot; name=&quot;hobby[]&quot; value=&#x27;çƒ«å¤´&#x27;&gt;çƒ«å¤´ &lt;input type=&quot;submit&quot; name=&quot;button&quot; value=&quot;æäº¤&quot;&gt;&lt;/form&gt;&lt;/body&gt; å°ç»“ï¼š 1ã€è¡¨å•æäº¤åˆ°æœ¬é¡µé¢éœ€è¦åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦æœ‰postæäº¤ 2ã€æ•°ç»„çš„æäº¤è¡¨å•å…ƒç´ çš„åå­—å¿…é¡»å¸¦æœ‰[] 5 æ–‡ä»¶ä¸Šä¼ å¼€å‘ä¸­éœ€è¦ä¸Šä¼ å›¾ç‰‡ã€éŸ³ä¹ã€è§†é¢‘ç­‰ç­‰ï¼Œè¿™ç§ä¸Šä¼ ä¼ é€’æ˜¯äºŒè¿›åˆ¶æ•°æ®ã€‚ 5.1 å®¢æˆ·ç«¯ä¸Šä¼ æ–‡ä»¶æ–‡ä»¶åŸŸ 1&lt;input type=&quot;file&quot; name=&quot;image&quot;&gt; è¡¨å•çš„enctypeå±æ€§ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¡¨å•ä¼ é€’æ˜¯å­—ç¬¦æµï¼Œä¸èƒ½ä¼ é€’äºŒè¿›åˆ¶æµï¼Œé€šè¿‡è®¾ç½®è¡¨å•çš„enctypeå±æ€§ä¼ é€’å¤åˆæ•°æ®ã€‚ enctypeå±æ€§çš„å€¼æœ‰ï¼š application&#x2F;x-www-form-urlencodedï¼šã€é»˜è®¤ã€‘ï¼Œè¡¨ç¤ºä¼ é€’çš„æ˜¯å¸¦æ ¼å¼çš„æ–‡æœ¬æ•°æ®ã€‚ multipart&#x2F;form-dataï¼šå¤åˆçš„è¡¨å•æ•°æ®ï¼ˆå­—ç¬¦ä¸²ï¼Œæ–‡ä»¶ï¼‰ï¼Œæ–‡ä»¶ä¸Šä¼ å¿…é¡»è®¾ç½®æ­¤å€¼ text&#x2F;plainï¼šç”¨äºå‘æœåŠ¡å™¨ä¼ é€’æ— æ ¼å¼çš„æ–‡æœ¬æ•°æ®ï¼Œä¸»è¦ç”¨æˆ·ç”µå­é‚®ä»¶ å•è¯ 12multipartï¼šå¤åˆform-dataï¼šè¡¨å•æ•°ç»„ 5.2 æœåŠ¡å™¨æ¥å—æ–‡ä»¶è¶…å…¨å±€å˜é‡$_FILESæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œç”¨æ¥ä¿å­˜å®¢æˆ·ç«¯ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æ–‡ä»¶ä¿¡æ¯ã€‚äºŒç»´æ•°ç»„çš„è¡Œæ˜¯æ–‡ä»¶åŸŸçš„åç§°ï¼Œåˆ—æœ‰5ä¸ªã€‚1ã€$_FILES[][â€˜nameâ€™]ï¼šä¸Šä¼ çš„æ–‡ä»¶å2ã€$_FILES[][â€˜type]ï¼šä¸Šä¼ çš„ç±»å‹ï¼Œè¿™ä¸ªç±»å‹æ˜¯MIMEç±»å‹ï¼ˆimage&#x2F;jpegã€image&#x2F;gifã€image&#x2F;pngï¼‰3ã€$_FILES[][â€˜sizeâ€™]ï¼šæ–‡ä»¶çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½4ã€$_FILES[][â€˜tmp_nameâ€™]ï¼šæ–‡ä»¶ä¸Šä¼ æ—¶çš„ä¸´æ—¶æ–‡ä»¶5ã€$_FILES[][â€˜errorâ€™]ï¼šé”™è¯¯ç¼–ç (å€¼æœ‰0ã€1ã€2ã€3ã€4ã€6ã€7)0è¡¨ç¤ºæ­£ç¡® $_FILES[][â€˜errorâ€™]è¯¦è§£ å€¼ é”™è¯¯æè¿° 0 æ­£ç¡® 1 æ–‡ä»¶å¤§å°è¶…è¿‡äº†php.iniä¸­å…è®¸çš„æœ€å¤§å€¼ upload_max_filesize &#x3D; 2M 2 æ–‡ä»¶å¤§å°è¶…è¿‡äº†è¡¨å•å…è®¸çš„æœ€å¤§å€¼ 3 åªæœ‰éƒ¨åˆ†æ–‡ä»¶ä¸Šä¼  4 æ²¡æœ‰æ–‡ä»¶ä¸Šä¼  6 æ‰¾ä¸åˆ°ä¸´æ—¶æ–‡ä»¶ 7 æ–‡ä»¶å†™å…¥å¤±è´¥ æ³¨æ„ï¼šMAX_FILE_SIZEå¿…é¡»åœ¨æ–‡ä»¶åŸŸçš„ä¸Šé¢ã€‚ åªè¦æŒæ¡çš„é”™è¯¯å·ï¼š0å’Œ4 5.3 å°†ä¸Šä¼ æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®å‡½æ•°ï¼š 1move_uploaded_file(ä¸´æ—¶åœ°å€,ç›®æ ‡åœ°å€) ä»£ç  1234567891011121314151617&lt;body&gt;&lt;?phpif(!empty($_POST)) &#123; if($_FILES[&#x27;face&#x27;][&#x27;error&#x27;]==0)&#123; //ä¸Šä¼ æ­£ç¡® //æ–‡ä»¶ä¸Šä¼  move_uploaded_file($_FILES[&#x27;face&#x27;][&#x27;tmp_name&#x27;],&#x27;./&#x27;.$_FILES[&#x27;face&#x27;][&#x27;name&#x27;]); &#125;else&#123; echo &#x27;ä¸Šä¼ æœ‰è¯¯&#x27;; echo &#x27;é”™è¯¯ç :&#x27;.$_FILES[&#x27;face&#x27;][&#x27;error&#x27;]; &#125;&#125;?&gt;&lt;form method=&quot;post&quot; action=&quot;&quot; enctype=&#x27;multipart/form-data&#x27;&gt; &lt;input type=&quot;file&quot; name=&quot;face&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;button&quot; value=&quot;ä¸Šä¼ &quot;&gt;&lt;/form&gt;&lt;/body&gt; å°ç»“ï¼šä¸Šä¼ çš„åŒåçš„æ–‡ä»¶è¦ç»™è¦†ç›– 5.4 ä¸æ–‡ä»¶ä¸Šä¼ æœ‰å…³çš„é…ç½®123456789post_max_size = 8Mï¼šè¡¨å•å…è®¸çš„æœ€å¤§å€¼upload_max_filesize = 2Mï¼šå…è®¸ä¸Šä¼ çš„æ–‡ä»¶å¤§å°upload_tmp_dir =F:\\wamp\\tmpï¼šæŒ‡å®šä¸´æ—¶æ–‡ä»¶åœ°å€ï¼Œå¦‚æœä¸çŸ¥é“æ“ä½œç³»ç»ŸæŒ‡å®šfile_uploads = Onï¼šæ˜¯å¦å…è®¸æ–‡ä»¶ä¸Šä¼ max_file_uploads = 20ï¼šå…è®¸åŒæ—¶ä¸Šä¼ 20ä¸ªæ–‡ä»¶ 6 ä¼˜åŒ–æ–‡ä»¶ä¸Šä¼ 6.1 æ›´æ”¹æ–‡ä»¶åæ–¹æ³•ä¸€ï¼šé€šè¿‡æ—¶é—´æˆ³åšæ–‡ä»¶å 1234&lt;?php$path=&#x27;face.stu.jpg&#x27;;//echo strrchr($path,&#x27;.&#x27;); //ä»æœ€åä¸€ä¸ªç‚¹å¼€å§‹æˆªå–ï¼Œä¸€ç›´æˆªå–åˆ°æœ€åecho time().rand(100,999).strrchr($path,&#x27;.&#x27;); æ–¹æ³•äºŒï¼šé€šè¿‡uniqid()å®ç° 1234$path=&#x27;face.stu.jpg&#x27;;echo uniqid().strrchr($path,&#x27;.&#x27;),&#x27;&lt;br&gt;&#x27;; //ç”Ÿæˆå”¯ä¸€çš„IDecho uniqid(&#x27;goods_&#x27;).strrchr($path,&#x27;.&#x27;),&#x27;&lt;br&gt;&#x27;; //å¸¦æœ‰å‰ç¼€echo uniqid(&#x27;goods_&#x27;,true).strrchr($path,&#x27;.&#x27;),&#x27;&lt;br&gt;&#x27;; //å”¯ä¸€ID+éšæœºæ•° 6.2 éªŒè¯æ–‡ä»¶æ ¼å¼æ–¹æ³•ä¸€ï¼šåˆ¤æ–­æ–‡ä»¶çš„æ‰©å±•åï¼ˆä¸èƒ½è¯†åˆ«æ–‡ä»¶ä¼ªè£…ï¼‰ æ“ä½œæ€è·¯ï¼šå°†æ–‡ä»¶çš„åç¼€å’Œå…è®¸çš„åç¼€å¯¹æ¯” 12345678910111213141516&lt;body&gt;&lt;?phpif(!empty($_POST)) &#123; $allow=array(&#x27;.jpg&#x27;,&#x27;.png&#x27;,&#x27;.gif&#x27;); //å…è®¸çš„æ‰©å±•å $ext=strrchr($_FILES[&#x27;face&#x27;][&#x27;name&#x27;],&#x27;.&#x27;); //ä¸Šä¼ æ–‡ä»¶æ‰©å±•å if(in_array($ext,$allow)) echo &#x27;å…è®¸ä¸Šä¼ &#x27;; else echo &#x27;æ–‡ä»¶ä¸åˆæ³•&#x27;;&#125;?&gt;&lt;form method=&quot;post&quot; action=&quot;&quot; enctype=&#x27;multipart/form-data&#x27;&gt; &lt;input type=&quot;file&quot; name=&quot;face&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;button&quot; value=&quot;ä¸Šä¼ &quot;&gt;&lt;/form&gt;&lt;/body&gt; æ³¨æ„ï¼šæ¯”è¾ƒæ‰©å±•åä¸èƒ½é˜²æ­¢æ–‡ä»¶ä¼ªè£…ã€‚ æ–¹æ³•äºŒï¼šé€šè¿‡$_FIELS[][&#39;type&#39;]ç±»å‹ï¼ˆä¸èƒ½è¯†åˆ«æ–‡ä»¶ä¼ªè£…ï¼‰ 12345678910111213141516&lt;body&gt;&lt;?phpif(!empty($_POST)) &#123; $allow=array(&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;,&#x27;image/gif&#x27;); //å…è®¸çš„ç±»åˆ« $mime=$_FILES[&#x27;face&#x27;][&#x27;type&#x27;]; //ä¸Šä¼ æ–‡ä»¶ç±»å‹ if(in_array($mime,$allow)) echo &#x27;å…è®¸ä¸Šä¼ &#x27;; else echo &#x27;æ–‡ä»¶ä¸åˆæ³•&#x27;;&#125;?&gt;&lt;form method=&quot;post&quot; action=&quot;&quot; enctype=&#x27;multipart/form-data&#x27;&gt; &lt;input type=&quot;file&quot; name=&quot;face&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;button&quot; value=&quot;ä¸Šä¼ &quot;&gt;&lt;/form&gt;&lt;/body&gt; æ³¨æ„ï¼šæ¯”è¾ƒ$_FIELS[][&#39;type&#39;]ä¸èƒ½é˜²æ­¢æ–‡ä»¶ä¼ªè£…ã€‚ æ–¹æ³•ä¸‰ï¼šphp_fileinfoæ‰©å±•ï¼ˆå¯ä»¥é˜²æ­¢æ–‡ä»¶ä¼ªè£…ï¼‰ åœ¨php.iniä¸­å¼€å¯fileinfoæ‰©å±• 1extension=php_fileinfo.dll æ³¨æ„ï¼šå¼€å¯fileinfoæ‰©å±•ä»¥åï¼Œå°±å¯ä»¥ä½¿ç”¨finfo_*çš„å‡½æ•°äº† 123456789101112131415161718&lt;body&gt;&lt;?phpif(!empty($_POST)) &#123; //ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºfinfoèµ„æº $info=finfo_open(FILEINFO_MIME_TYPE); //var_dump($info); //resource(2) of type (file_info) //ç¬¬äºŒæ­¥ï¼šå°†finfoèµ„æºå’Œæ–‡ä»¶åšæ¯”è¾ƒ $mime=finfo_file($info,$_FILES[&#x27;face&#x27;][&#x27;tmp_name&#x27;]); //ç¬¬ä¸‰æ­¥ï¼Œæ¯”è¾ƒæ˜¯å¦åˆæ³• $allow=array(&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;,&#x27;image/gif&#x27;); //å…è®¸çš„ç±»åˆ« echo in_array($mime,$allow)?&#x27;åˆæ³•&#x27;:&#x27;ä¸åˆæ³•&#x27;;&#125;?&gt;&lt;form method=&quot;post&quot; action=&quot;&quot; enctype=&#x27;multipart/form-data&#x27;&gt; &lt;input type=&quot;file&quot; name=&quot;face&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;button&quot; value=&quot;ä¸Šä¼ &quot;&gt;&lt;/form&gt;&lt;/body&gt; å°ç»“ï¼šéªŒè¯æ–‡ä»¶æ ¼å¼æœ‰ä¸‰ç§æ–¹æ³• 1ã€å¯ä»¥éªŒè¯æ‰©å±•åï¼ˆä¸å¯ä»¥é˜²æ­¢æ–‡ä»¶ä¼ªè£…ï¼‰ 2ã€é€šè¿‡$_FILES[][&#39;type&#39;]éªŒè¯ï¼ˆä¸å¯ä»¥é˜²æ­¢æ–‡ä»¶ä¼ªè£…ï¼‰ 3ã€é€šè¿‡file_infoæ‰©å±•ï¼ˆå¯ä»¥é˜²æ­¢æ–‡ä»¶ä¼ªè£…ï¼‰","tags":["PHP"],"categories":["Language"]},{"title":"PHPåŸºç¡€-2-ä½œç”¨åŸŸ&é€’å½’&æ–‡ä»¶å¤¹æ“ä½œ","path":"/p/f60eefa5/","content":"1 ä½œç”¨åŸŸ1.1 å˜é‡ä½œç”¨åŸŸ1ã€å…¨å±€å˜é‡ï¼šåœ¨å‡½æ•°å¤–é¢ 2ã€å±€éƒ¨å˜é‡ï¼šåœ¨å‡½æ•°é‡Œé¢ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°å†…éƒ¨æ˜¯ä¸ä¼šå»è®¿é—®å‡½æ•°å¤–éƒ¨çš„å˜é‡ 3ã€è¶…å…¨å±€å˜é‡ï¼šå¯ä»¥åœ¨å‡½æ•°å†…éƒ¨å’Œå‡½æ•°å¤–éƒ¨è®¿é—® | $GLOBALS || â€” || $_SERVER || $_GET || $_POST || $_FILES || $_COOKIE || $_SESSION || $_REQUEST || $_ENV | globalå…³é”®å­— 12345678910111213141516171819&lt;?php$num=10;function fun() &#123;\tglobal $num; //å°†å…¨å±€å˜é‡çš„$numçš„åœ°å€å¼•å…¥åˆ°å‡½æ•°å†…éƒ¨ ç›¸å½“äº$num=&amp;GLOBALS[&#x27;num&#x27;]\techo $num;\t//10\t$num=100;&#125;fun();echo &#x27;&lt;br&gt;&#x27;;echo $num; //100-----------------------------------&lt;?php$num=10;function fun() &#123;\tglobal $num;\tunset($num); //é”€æ¯çš„æ˜¯å¼•ç”¨ï¼Œä¸æ˜¯å…·ä½“çš„å€¼&#125;fun();echo $num; //10 å°ç»“ï¼š 1ã€$GLOBALSä¿å­˜çš„æ˜¯å…¨å±€å˜é‡çš„æ‰€æœ‰çš„å€¼ 2ã€globalç”¨äºåˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡çš„å¼•ç”¨ ğŸ’¡ æ³¨æ„ï¼šå¸¸é‡æ²¡æœ‰ä½œç”¨åŸŸçš„æ¦‚å¿µ 1.2 é™æ€å˜é‡ï¼ˆstaticï¼‰é™æ€å˜é‡ä¸€èˆ¬æŒ‡çš„æ˜¯é™æ€å±€éƒ¨å˜é‡ã€‚ é™æ€å˜é‡åªåˆå§‹åŒ–ä¸€æ¬¡ 1.2.1 å¸¸é‡å’Œé™æ€å˜é‡çš„åŒºåˆ«1ã€å¸¸é‡å’Œé™æ€å˜é‡éƒ½æ˜¯åˆå§‹åŒ–ä¸€æ¬¡ 2ã€å¸¸é‡ä¸èƒ½æ”¹å˜å€¼ï¼Œé™æ€å˜é‡å¯ä»¥æ”¹å˜å€¼ 3ã€å¸¸é‡æ²¡æœ‰ä½œç”¨åŸŸï¼Œé™æ€å˜é‡æœ‰ä½œç”¨åŸŸ 12345678910111213141516171819&lt;?phpfunction fun1() &#123;\tdefine(&#x27;num&#x27;,10);&#125;function fun2() &#123;\techo num; //10&#125;fun1();fun2();------------------------------------------------------------&lt;?phpfunction fun1() &#123;\tstatic $num=10;&#125;function fun2() &#123;\techo $num; //Notice: Undefined variable: num å› ä¸ºé™æ€å˜é‡æ˜¯æœ‰ä½œç”¨åŸŸçš„&#125;fun1();fun2(); 1.3 åŒ¿åå‡½æ•°use()é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°å†…éƒ¨ä¸èƒ½è®¿é—®å‡½æ•°å¤–éƒ¨çš„å˜é‡ï¼Œä½†åœ¨åŒ¿åå‡½æ•°ä¸­ï¼Œå¯ä»¥é€šè¿‡useå°†å¤–éƒ¨å˜é‡å¼•å…¥åŒ¿åå‡½æ•°ä¸­ 123456&lt;?php$num=10;$fun=function() use($num) &#123; //å°†$numå¼•å…¥åˆ°åŒ¿åå‡½æ•°ä¸­\techo $num;\t&#125;;$fun(); //10 æ€è€ƒï¼šå¦‚ä½•åœ¨å‡½æ•°å†…éƒ¨è®¿é—®å‡½æ•°å¤–éƒ¨å˜é‡ 1ã€ä½¿ç”¨è¶…å…¨å±€å˜é‡ 2ã€$GLOBALS 3ã€global 4ã€useå°†å‡½æ•°å¤–éƒ¨å˜é‡å¼•å…¥åˆ°åŒ¿åå‡½æ•°å†…éƒ¨ 2 é€’å½’å‡½æ•°å†…éƒ¨è‡ªå·±è°ƒç”¨è‡ªå·± é€’å½’æœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæ˜¯é€’å½’ç‚¹ï¼ˆä»ä»€ä¹ˆåœ°æ–¹é€’å½’ï¼‰ï¼Œç¬¬äºŒé€’å½’å‡ºå£ 3 åŒ…å«æ–‡ä»¶3.1 åŒ…å«æ–‡ä»¶çš„æ–¹å¼1ã€requireï¼šåŒ…å«å¤šæ¬¡ 2ã€includeï¼šåŒ…å«å¤šæ¬¡ 3ã€require_onceï¼š åŒ…å«ä¸€æ¬¡ 4ã€include_onceï¼š åŒ…å«ä¸€æ¬¡ ğŸ’¡ å°ç»“ï¼š 1ã€requireé‡åˆ°é”™è¯¯æŠ›å‡ºerrorç±»åˆ«çš„é”™è¯¯ï¼Œåœæ­¢æ‰§è¡Œ 2ã€includeé‡åˆ°é”™è¯¯æŠ›å‡ºwarningç±»å‹çš„é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ 3ã€require_onceã€include_onceåªèƒ½åŒ…å«ä¸€æ¬¡ 4ã€HTMLç±»å‹çš„åŒ…å«é¡µé¢ä¸­å­˜åœ¨PHPä»£ç ï¼Œå¦‚æœåŒ…å«åˆ°PHPä¸­æ˜¯å¯ä»¥è¢«æ‰§è¡Œçš„ 5ã€åŒ…å«æ–‡ä»¶ç›¸å½“äºæŠŠåŒ…å«æ–‡ä»¶ä¸­çš„ä»£ç æ‹·è´åˆ°ä¸»æ–‡ä»¶ä¸­æ‰§è¡Œï¼Œé­”æœ¯å¸¸é‡é™¤å¤–ï¼Œé­”æœ¯å¸¸é‡è·å–çš„æ˜¯æ‰€åœ¨æ–‡ä»¶çš„ä¿¡æ¯ã€‚ 6ã€åŒ…å«åœ¨ç¼–è¯‘æ—¶ä¸æ‰§è¡Œã€è¿è¡Œæ—¶åŠ è½½åˆ°å†…å­˜ã€ç‹¬ç«‹ç¼–è¯‘åŒ…å«æ–‡ä»¶ 3.2 åŒ…å«æ–‡ä»¶çš„è·¯å¾„12./ å½“å‰ç›®å½•../ ä¸Šä¸€çº§ç›®å½• 12require &#x27;./head.html&#x27;; //åœ¨å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾require &#x27;head.html&#x27;; //å—include_pathé…ç½®å½±å“ include_pathçš„ä½¿ç”¨åœºæ™¯ï¼š å¦‚æœåŒ…å«æ–‡ä»¶çš„ç›®å½•ç»“æ„æ¯”è¾ƒå¤æ‚ï¼Œæ¯”å¦‚ï¼šåœ¨c:\\aa\\bb\\cc\\ddä¸­æœ‰å¤šä¸ªæ–‡ä»¶éœ€è¦åŒ…å«ï¼Œå¯ä»¥å°†åŒ…å«çš„è·¯å¾„è®¾ç½®æˆinclude_pathï¼Œè¿™æ ·åŒ…å«å°±åªè¦å†™æ–‡ä»¶åå°±å¯ä»¥äº† 1234&lt;?phpset_include_path(&#x27;c:\\aa\\bb\\cc\\dd&#x27;); //è®¾ç½®include_pathrequire &#x27;head1.html&#x27;; //å—include_pathé…ç½®å½±å“require &#x27;head2.html&#x27;; include_pathå¯ä»¥è®¾ç½®å¤šä¸ªï¼Œè·¯å¾„ä¹‹é—´ç”¨åˆ†å·éš”å¼€ 1set_include_path(&#x27;c:\\aa\\bb\\cc\\dd;d:\\\\&#x27;); 4 é”™è¯¯å¤„ç†4.1 é”™è¯¯çš„çº§åˆ« noticeï¼šæç¤º warningï¼šè­¦å‘Š errorï¼šè‡´å‘½é”™è¯¯ noticeå’ŒwarningæŠ¥é”™åç»§ç»­æ‰§è¡Œï¼ŒerroræŠ¥é”™ååœæ­¢æ‰§è¡Œ 4.2 é”™è¯¯çš„æç¤ºæ–¹æ³•æ–¹æ³•ä¸€ï¼šæ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Š æ–¹æ³•äºŒï¼šè®°å½•åœ¨æ—¥å¿—ä¸­ 4.3 ä¸é”™è¯¯å¤„ç†æœ‰å…³çš„é…ç½®åœ¨php.iniä¸­ 123451. error_reporting = E_ALLï¼šæŠ¥å‘Šæ‰€æœ‰çš„é”™è¯¯2. display_errors = Onï¼šå°†é”™è¯¯æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Š3. log_errors = Onï¼šå°†é”™è¯¯è®°å½•åœ¨æ—¥å¿—ä¸­4. error_log=â€™åœ°å€â€™ï¼šé”™è¯¯æ—¥å¿—ä¿å­˜çš„åœ°å€ åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­æœ‰ä¸¤ä¸ªæ¨¡å¼ï¼Œå¼€å‘æ¨¡å¼ï¼Œè¿è¡Œæ¨¡å¼ 123å¼€å‘æ¨¡å¼ï¼šé”™è¯¯æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Šï¼Œä¸è¦è®°å½•åœ¨æ—¥å¿—ä¸­è¿è¡Œæ¨¡å¼ï¼šé”™è¯¯ä¸æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Šï¼Œè®°å½•æ˜¯æ—¥å¿—ä¸­ 5 æ–‡ä»¶ç¼–ç¨‹5.1 æ–‡ä»¶å¤¹æ“ä½œ1 ã€åˆ›å»ºæ–‡ä»¶å¤¹ã€mkdir(è·¯å¾„ï¼Œæƒé™ï¼Œæ˜¯å¦é€’å½’åˆ›å»º)ã€‘ 12make:åˆ›å»ºdirectoryï¼šç›®å½•ï¼Œæ–‡ä»¶å¤¹ ä¾‹é¢˜ 12345&lt;?php//1ã€åˆ›å»ºç›®å½•//mkdir(&#x27;./aa&#x27;); //åˆ›å»ºaaæ–‡ä»¶å¤¹//mkdir(&#x27;./aa/bb&#x27;); //åœ¨aaç›®å½•ä¸‹åˆ›å»ºbb(aaç›®å½•å¿…é¡»å­˜åœ¨)mkdir(&#x27;./aa/bb/cc/dd&#x27;,0777,true); //é€’å½’åˆ›å»º å°ç»“ï¼š 1ã€0777è¡¨ç¤ºæ˜¯æ–‡ä»¶å¤¹çš„æƒé™ï¼Œåœ¨Linuxä¸­ä¼šè¯¦ç»†è®²è§£ 2ã€trueè¡¨ç¤ºé€’å½’åˆ›å»ºï¼Œé»˜è®¤æ˜¯false 2ã€åˆ é™¤æ–‡ä»¶å¤¹ã€rmdir()ã€‘ 123//remove:ç§»é™¤rmdir(&#x27;./aa/bb/cc/dd&#x27;); //åˆ é™¤ddæ–‡ä»¶å¤¹ æé†’ï¼š 121ã€åˆ é™¤çš„æ–‡ä»¶å¤¹å¿…é¡»æ˜¯ç©ºçš„2ã€PHPåŸºäºå®‰å…¨è€ƒè™‘ï¼Œæ²¡æœ‰æä¾›é€’å½’åˆ é™¤ã€‚ 3ã€é‡å‘½åæ–‡ä»¶å¤¹ã€rename(æ—§åå­—ï¼Œæ–°åå­—)ã€‘ 1rename(&#x27;./aa&#x27;,&#x27;./aaa&#x27;); //å°†aaæ”¹ä¸ºaaa 4ã€æ˜¯å¦æ˜¯æ–‡ä»¶å¤¹ã€is_dir()ã€‘ 1echo is_dir(&#x27;./aaa&#x27;)?&#x27;æ˜¯æ–‡ä»¶å¤¹&#x27;:&#x27;ä¸æ˜¯æ–‡ä»¶å¤¹&#x27;; 5ã€æ‰“å¼€æ–‡ä»¶å¤¹ã€è¯»å–æ–‡ä»¶å¤¹ã€å…³é—­æ–‡ä»¶å¤¹ 12345678$folder=opendir(&#x27;./&#x27;); //æ‰“å¼€ç›®å½•//var_dump($folder); //resource(3) of type (stream)while($f=readdir($folder))&#123; //è¯»å–æ–‡ä»¶å¤¹ if($f==&#x27;.&#x27; || $f==&#x27;..&#x27;) continue; echo iconv(&#x27;gbk&#x27;,&#x27;utf-8&#x27;,$f),&#x27;&lt;br&gt;&#x27;; //å°†gbkè½¬æˆutf-8&#125;closedir($folder); //å…³é—­æ–‡ä»¶å¤¹ å°ç»“ï¼š 1231ã€opendir()è¿”å›èµ„æºç±»å‹2ã€æ¯ä¸ªæ–‡ä»¶å¤¹ä¸­éƒ½æœ‰.å’Œ..3ã€iconv()ç”¨æ¥åšå­—ç¬¦ç¼–ç è½¬æ¢","tags":["PHP"],"categories":["Language"]},{"title":"PHPåŸºç¡€-1-å˜é‡-å¸¸é‡-è¿ç®—ç¬¦-æ•°æ®ç±»å‹-åˆ¤æ–­-å¾ªç¯","path":"/p/5b8fbc6e/","content":"0 è¾“å‡ºè¯­å¥12345678echo:è¾“å‡ºprint:è¾“å‡ºï¼Œè¾“å‡ºæˆåŠŸè¿”å›1print_r()ï¼šè¾“å‡ºæ•°ç»„var_dump():è¾“å‡ºæ•°æ®çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¸¦æœ‰æ•°æ®ç±»å‹å’Œæ•°æ®é•¿åº¦&lt;?php\tvar_dump(&#x27;abc&#x27;);\t//string(3) &quot;abc&quot; ?&gt; 1 å˜é‡1.1 å˜é‡çš„å‘½åè§„åˆ™ å˜é‡å¿…é¡»ä»¥$å¼€å¤´ï¼Œ$ç¬¦ä¸æ˜¯å˜é‡çš„ä¸€éƒ¨åˆ†ï¼Œä»…è¡¨ç¤ºåé¢çš„æ ‡è¯†ç¬¦æ˜¯å˜é‡åã€‚ é™¤äº†$ä»¥å¤–ï¼Œä»¥å­—æ¯ã€ä¸‹åˆ’çº¿å¼€å¤´ï¼Œåé¢è·Ÿç€æ•°å­—ã€å­—æ¯ã€ä¸‹åˆ’çº¿ å˜é‡ååŒºåˆ†å¤§å°å†™ï¼Œ$aaå’Œ$Aaæ˜¯ä¸¤ä¸ªç©ºé—´ 1.2 å¯å˜å˜é‡å˜é‡åå¯ä»¥å˜ï¼Œå°†å˜é‡åå­˜å‚¨åœ¨å¦å¤–ä¸€ä¸ªå˜é‡ä¸­ 1234&lt;?php$a=10;$b=&#x27;a&#x27;;echo $$b;\t//10 1.3 å˜é‡ä¼ é€’å˜é‡çš„ä¼ é€’æœ‰å€¼ä¼ é€’å’Œåœ°å€ä¼ é€’ï¼ˆå¼•ç”¨ä¼ é€’ï¼‰ 123456&lt;?php//å€¼ä¼ é€’$num1=10;\t//å°†10ä»˜ç»™$num1$num2=$num1;\t//å°†$num1çš„å€¼ä»˜ç»™$num2$num2=20; //æ›´æ”¹$num2echo $num1; //10 1.4 é”€æ¯å˜é‡ç”¨unset()æ¥é”€æ¯å˜é‡ï¼Œé”€æ¯çš„æ˜¯å˜é‡åï¼Œå˜é‡å€¼ç”±PHPåƒåœ¾å›æ”¶æœºåˆ¶é”€æ¯ 12345&lt;?php$num1=10;$num2=&amp;$num1;unset($num1);\t//é”€æ¯çš„æ˜¯å˜é‡åecho $num2; //10 2 å¸¸é‡2.1 å®šä¹‰å¸¸é‡1ã€ç”¨define()å‡½æ•°å®šä¹‰å¸¸é‡ 1define(å¸¸é‡åï¼Œå€¼ï¼Œ[æ˜¯å¦åŒºåˆ«å¤§å°å†™]) trueè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ï¼Œé»˜è®¤æ˜¯false 2ã€è¿˜å¯ä»¥ä½¿ç”¨constå…³é”®å­—å®šä¹‰å¸¸é‡ 12const NAME=&#x27;tom&#x27;;echo NAME; //tom å®šä¹‰å¸¸é‡æœ‰ä¸¤ç§æ–¹å¼ï¼Œdefine()å’Œconst å¸¸é‡åœ¨æ•´ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­å€¼ä¿æŒä¸å˜ï¼Œå¸¸é‡ä¸èƒ½é‡æ–°å®šä¹‰ ä½¿ç”¨constantè·å–ç‰¹æ®Šå­—ç¬¦åšçš„å¸¸é‡åçš„å€¼ defined()ç”¨æ¥åˆ¤æ–­å¸¸é‡æ˜¯å¦è¢«å®šä¹‰ 2.2 é¢„å®šä¹‰å¸¸é‡123echo PHP_VERSION,&#x27;&lt;br&gt;&#x27;; //PHPç‰ˆæœ¬å·echo PHP_OS,&#x27;&lt;br&gt;&#x27;; //PHPæ“ä½œç³»ç»Ÿecho PHP_INT_MAX,&#x27;&lt;br&gt;&#x27;; //PHPä¸­æ•´å‹çš„æœ€å¤§å€¼ 2.3 é­”æœ¯å¸¸é‡é­”æœ¯å¸¸é‡å®ƒä»¬çš„å€¼éšç€å®ƒä»¬åœ¨ä»£ç ä¸­çš„ä½ç½®æ”¹å˜è€Œæ”¹å˜ 123echo __LINE__,&#x27;&lt;br&gt;&#x27;; //è·å–å½“å‰è¡Œå·echo __FILE__,&#x27;&lt;br&gt;&#x27;; //æ–‡ä»¶çš„å®Œæ•´è·¯å¾„å’Œæ–‡ä»¶åecho __DIR__,&#x27;&lt;br&gt;&#x27;; //æ–‡ä»¶æ‰€åœ¨çš„ç›®å½• 3 æ•°æ®ç±»å‹3.1 åŸºæœ¬ç±»å‹ï¼ˆæ ‡é‡ç±»å‹ï¼‰3.1.1 æ•´å‹å­˜æ•´æ•°ï¼ŒPHP_INT_MAXè·å–æ•´å½¢æœ€å¤§å€¼ æœºåˆ¶ ç¼©å†™ å•è¯ åè¿›åˆ¶ dec decimalist äºŒè¿›åˆ¶ bin binary å…«è¿›åˆ¶ oct octonary åå…­è¿›åˆ¶ hex hexdecimalist 3.1.2 æµ®ç‚¹å‹æµ®ç‚¹æ•°åœ¨å†…å­˜ä¸­ä¿å­˜çš„æ˜¯è¿‘ä¼¼å€¼ æµ®ç‚¹æ•°ä¸èƒ½å‚ä¸æ¯”è¾ƒ 123var_dump(0.9==(1-0.1)); //bool(true) echo &#x27;&lt;br&gt;&#x27;;var_dump(0.1==(1-0.9)); //bool(false) å¦‚æœæµ®ç‚¹æ•°è¦æ¯”è¾ƒï¼Œå¿…é¡»ç¡®å®šæ¯”è¾ƒçš„ä½æ•° 12345var_dump(0.9==(1-0.1)); //bool(true) echo &#x27;&lt;br&gt;&#x27;;var_dump(0.1==(1-0.9)); //bool(false) echo &#x27;&lt;br&gt;&#x27;;var_dump(bccomp(0.1,1-0.9,5));\t//æ¯”è¾ƒå°æ•°ç‚¹åé¢5ä½ int(0) 0è¡¨ç¤ºç›¸ç­‰ ğŸ’¡ æé†’ï¼šå¦‚æœä¸€ä¸ªæ•´æ•°è¶…å‡ºäº†æ•´å½¢çš„èŒƒå›´ï¼Œä¼šè‡ªåŠ¨çš„è½¬æˆæµ®ç‚¹å‹ 3.1.3 å¸ƒå°”å‹ä¸èƒ½ä½¿ç”¨echo å’Œprintè¾“å‡ºå¸ƒå°”å‹ï¼Œè¦ä½¿ç”¨var_dump()è¾“å‡º 123$name=&#x27;tom&#x27;;echo &#x27;æˆ‘çš„åå­—å«$name&#x27;,&#x27;&lt;br&gt;&#x27;;\t//æˆ‘çš„åå­—å«$nameecho &quot;æˆ‘çš„åå­—å«$name&quot;,&#x27;&lt;br&gt;&#x27;;\t//æˆ‘çš„åå­—å«tom 3.1.4 å­—ç¬¦ä¸²å‹åœ¨PHPä¸­å•å¼•å·å­—ç¬¦ä¸²å’ŒåŒå¼•å·å­—ç¬¦ä¸²æ˜¯æœ‰åŒºåˆ«çš„ å•å¼•å·å­—ç¬¦ä¸²æ˜¯çœŸæ­£çš„å­—ç¬¦ä¸² åŒå¼•å·å­—ç¬¦ä¸²è¦è§£æå­—ç¬¦ä¸²ä¸­çš„å˜é‡ 123$name=&#x27;tom&#x27;;echo &#x27;æˆ‘çš„åå­—å«$name&#x27;,&#x27;&lt;br&gt;&#x27;;\t//æˆ‘çš„åå­—å«$nameecho &quot;æˆ‘çš„åå­—å«$name&quot;,&#x27;&lt;br&gt;&#x27;;\t//æˆ‘çš„åå­—å«tom 3.2 å¤åˆç±»å‹3.2.1 æ•°ç»„åœ¨PHPä¸­æ•°ç»„æœ‰ä¸¤ç§å½¢å¼ï¼Œç´¢å¼•æ•°ç»„å’Œå…³è”æ•°ç»„ ç´¢å¼•æ•°ç»„ï¼šç”¨æ•´æ•°åšä¸‹æ ‡ï¼Œé»˜è®¤ä»0å¼€å§‹ï¼Œåé¢ä¾æ¬¡åŠ ä¸€ å…³è”æ•°ç»„ï¼šç”¨å­—ç¬¦ä¸²åšä¸‹æ ‡ï¼Œé€šè¿‡&#x3D;&gt;ç¬¦å·å°†ä¸‹æ ‡å’Œå€¼å…³è”èµ·æ¥ 12345678910111213141516&lt;?php//1ã€ç´¢å¼•æ•°ç»„çš„å£°æ˜$stu=array(&#x27;tom&#x27;,&#x27;berry&#x27;,&#x27;ketty&#x27;); //ç´¢å¼•æ•°ç»„print_r($stu);\t//è¾“å‡ºæ•°ç»„ Array ( [0] =&gt; tom [1] =&gt; berry [2] =&gt; ketty ) echo &#x27;&lt;hr&gt;&#x27;;echo $stu[0],&#x27;&lt;br&gt;&#x27;;\t//tomecho $stu[1],&#x27;&lt;br&gt;&#x27;;\t//berryecho $stu[2],&#x27;&lt;hr&gt;&#x27;;\t//ketty------------------------------------------//2ã€å…³è”æ•°ç»„$emp=array(&#x27;name&#x27;=&gt;&#x27;æç™½&#x27;,&#x27;sex&#x27;=&gt;&#x27;ç”·&#x27;,&#x27;age&#x27;=&gt;22);print_r($emp);\t//Array ( [name] =&gt; æç™½ [sex] =&gt; ç”· [age] =&gt; 22 ) echo &#x27;&lt;hr&gt;&#x27;;echo $emp[&#x27;name&#x27;],&#x27;&lt;br&gt;&#x27;;\t//æç™½echo $emp[&#x27;sex&#x27;],&#x27;&lt;br&gt;&#x27;;\t//ç”·echo $emp[&#x27;age&#x27;]; //22 äºŒç»´æ•°ç»„çš„å£°æ˜ 12345$stu=[\t[&#x27;name&#x27;=&gt;&#x27;tom&#x27;,&#x27;sex&#x27;=&gt;&#x27;ç”·&#x27;,&#x27;age&#x27;=&gt;22],\t[&#x27;name&#x27;=&gt;&#x27;berry&#x27;,&#x27;sex&#x27;=&gt;&#x27;å¥³&#x27;,&#x27;age&#x27;=&gt;23]];echo &#x27;&lt;pre&gt;&#x27;; çŸ­æ•°ç»„è¯­æ³•ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ä¸­æ‹¬å·å£°æ˜æ•°ç»„ 12$stu=[&#x27;tom&#x27;,&#x27;berry&#x27;,&#x27;ketty&#x27;];print_r($stu); //Array ( [0] =&gt; tom [1] =&gt; berry [2] =&gt; ketty ) 3.2.2 å¯¹è±¡3.3 ç‰¹æ®Šç±»å‹1ã€èµ„æº 2ã€null 3.4 ç±»å‹è½¬æ¢1ã€è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼šå½“æä¾›çš„ç±»å‹å’Œéœ€è¦çš„ç±»å‹ä¸ä¸€è‡´çš„æ—¶å€™ä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ 12345678$num=10;if($num)&#123; //è‡ªåŠ¨å°†æ•°å­—è½¬æˆå¸ƒå°”å‹\techo &#x27;aa&#x27;;&#125;else&#123;\techo &#x27;bb&#x27;;&#125;---------------------------------echo &#x27;20&#x27;-10;\t//è‡ªåŠ¨çš„å°†å­—ç¬¦ä¸²è½¬æˆæ•°å­— 2ã€å¼ºåˆ¶ç±»å‹è½¬æ¢ è¯­æ³•ï¼šï¼ˆæ•°æ®ç±»å‹ï¼‰æ•°æ® å…¶ä»–ç±»å‹å’Œå¸ƒå°”ä¹‹é—´çš„è½¬æ¢ è§„åˆ™ï¼š0ã€ç©ºä¸ºå‡ï¼Œé0éç©ºä¸ºçœŸ 12345&lt;?phpvar_dump((bool)&#x27;abc&#x27;);\techo &#x27;&lt;br&gt;&#x27;; //bool(true) var_dump((bool)&#x27;&#x27;); echo &#x27;&lt;br&gt;&#x27;; //bool(false) var_dump((bool)&#x27;0&#x27;);\techo &#x27;&lt;br&gt;&#x27;; //bool(false)?&gt; 4 è¿ç®—ç¬¦4.1 ç®—æœ¯è¿ç®—ç¬¦ ä¸€å…ƒè¿ç®—ç¬¦ äºŒå…ƒè¿ç®—ç¬¦ ++ + â€“ - * &#x2F; % (å–æ¨¡) 4.2 å…³ç³»è¿ç®—ç¬¦ï¼ˆæ¯”è¾ƒè¿ç®—ç¬¦ï¼‰1234567=&lt;&lt;=== //å¼±ç±»å‹æ¯”è¾ƒ ä¸å¯¹æ•°æ®ç±»å‹ä½œæ¯”è¾ƒ &#x27;1&#x27;=1 true!====//å¼ºç±»å‹æ¯”è¾ƒ å¯¹æ•°æ®ç±»å‹å’Œå€¼éƒ½è¿›è¡Œæ¯”è¾ƒ &#x27;1&#x27;=1 false!== 4.3 é€»è¾‘è¿ç®—ç¬¦123456&amp;\tä¸ï¼šè¿ç®—ç¬¦ä¸¤è¾¹çš„è¡¨è¾¾å¼éƒ½è¦è®¡ç®—|\tæˆ–ï¼šè¿ç®—ç¬¦ä¸¤è¾¹çš„è¡¨è¾¾å¼éƒ½è¦è®¡ç®—&amp;&amp;\tçŸ­è·¯ä¸ï¼šå¦‚æœå‰é¢çš„æ¡ä»¶ä¸æ»¡è¶³ï¼Œåé¢çš„æ¡ä»¶å°±ä¸ç”¨è®¡ç®—äº†||\tçŸ­è·¯æˆ–!\té 4.4 èµ‹å€¼è¿ç®—ç¬¦123456=\t//èµ‹å€¼+= //a+=b a=a+b-=*=/=%= 4.5 å­—ç¬¦ä¸²è¿æ¥ç¬¦(.)4.6 é”™è¯¯æŠ‘åˆ¶ç¬¦(@)é”™è¯¯æŠ‘åˆ¶ç¬¦åªå¯¹è¡¨è¾¾å¼æœ‰æ•ˆ 12&lt;?phpecho @($aa+$bb);\t//é”™è¯¯æŠ‘åˆ¶ 4.7 ä¸‰å…ƒè¿ç®—ç¬¦(?:)è¡¨è¾¾å¼1 ? å€¼1 : å€¼2 4.8 nullåˆå¹¶è¿ç®—ç¬¦(??)PHP7.0ä»¥åæ‰æ”¯æŒ ä¾‹é¢˜ 12&lt;?phpecho $name??&#x27;å§“åä¸è¯¦&#x27;; //å§“åä¸è¯¦ å¤šå­¦ä¸€æ‹›ï¼šä¸¤ä¸ªç”¨æ¥åˆ¤æ–­çš„å‡½æ•° 12isset()ï¼šåˆ¤æ–­å˜é‡æ˜¯å¦è¢«è®¾ç½®ï¼Œå¹¶ä¸”è®¾ç½®çš„ä¸æ˜¯nullempty()ï¼šæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ºç©ºï¼Œèƒ½è½¬æˆfalseå…¨éƒ¨æ˜¯ç©ºï¼Œ[&#x27;&#x27;,0,0.0,array(),null] ä¾‹é¢˜ 5 åˆ¤æ–­5.1 è¯­æ³•1ã€ifè¯­å¥ 2ã€ifelseè¯­å¥ 3ã€switch caseè¯­å¥ 6 å¾ªç¯1ã€for 123for(åˆå§‹å€¼;æ¡ä»¶;å¢é‡)&#123;\t//å¾ªç¯ä½“&#125; 2ã€while&amp;do-while 123456while(æ¡ä»¶)&#123;&#125;-------------------------do&#123; &#125;while(æ¡ä»¶) 3ã€foreach 123456//è¯­æ³•ä¸€foreach(æ•°ç»„ as å€¼)&#123;&#125;//è¯­æ³•äºŒforeach(æ•°ç»„ as é”®=&gt;å€¼)&#123;&#125; ç¤ºä¾‹ï¼š 123456789101112131415161718192021&lt;?php$stu=[&#x27;tom&#x27;,&#x27;berry&#x27;,&#x27;ketty&#x27;];foreach($stu as $v)&#123;\techo $v,&#x27;&lt;br&gt;&#x27;;&#125;/**tomberryketty*/echo &#x27;&lt;hr&gt;&#x27;;-----------------------------------------------------------foreach($stu as $k=&gt;$v)&#123;\techo &quot;&#123;$k&#125;:&#123;$v&#125;&lt;br&gt;&quot;;&#125;/**0:tom1:berry2:ketty*/?&gt; å°ç»“ï¼š forã€whileã€do-whileå¯ä»¥ç›¸äº’æ›¿æ¢ å¦‚æœæ˜ç¡®çŸ¥é“å¾ªç¯å¤šå°‘æ¬¡é¦–å…ˆforå¾ªç¯ï¼Œå¦‚è¦è¦å¾ªç¯åˆ°æ¡ä»¶ä¸æˆç«‹ä¸ºæ­¢é€‰whileæˆ–do-while å…ˆåˆ¤æ–­å†æ‰§è¡Œé€‰whileï¼Œå…ˆæ‰§è¡Œå†åˆ¤æ–­é€‰do-while whileå¾ªç¯æ¡ä»¶ä¸æˆç«‹å°±ä¸æ‰§è¡Œï¼Œdo-whileè‡³å°‘æ‰§è¡Œä¸€æ¬¡ 7 è·³è½¬è¯­å¥123breakï¼šä¸­æ–­å¾ªç¯continueï¼šä¸­æ–­å½“å‰å¾ªç¯ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯ 8 å‡½æ•°8.1 å‡½æ•°å®šä¹‰123function å‡½æ•°å(å‚æ•°1ï¼Œå‚æ•°2ï¼Œ...)&#123; //å‡½æ•°ä½“&#125; å°ç»“ï¼š 1ã€å˜é‡ååŒºåˆ†å¤§å°å†™ 2ã€å…³é”®å­—ã€å‡½æ•°åä¸åŒºåˆ†å¤§å°å†™ 8.2 å¯å˜å‡½æ•° 123456&lt;?phpfunction show($args) &#123;\techo $args,&#x27;&lt;br&gt;&#x27;;&#125;$str=&#x27;show&#x27;;\t//å°†å‡½æ•°åä¿å­˜åˆ°å˜é‡ä¸­$str(&#x27;é”„ç¦¾æ—¥å½“åˆ&#x27;); 8.3 åŒ¿åå‡½æ•° åŒ¿åå‡½æ•°å°±æ˜¯æ²¡æœ‰åå­—çš„å‡½æ•° 1234567&lt;?php//åŒ¿åå‡½æ•°$fun=function()&#123;\techo &#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;;&#125;;//åŒ¿åå‡½æ•°è°ƒç”¨$fun();","tags":["PHP"],"categories":["Language"]},{"title":"æ±‡ç¼–å…¥é—¨å­¦ä¹ ","path":"/p/d147e7fa/","content":"æ±‡ç¼–ä¸€ã€æŒ‡ä»¤1 movå¯ä»¥ç«‹å³æ•°åˆ°å†…å­˜ï¼Œå¯„å­˜å™¨åˆ°å†…å­˜ã€‚å†…å­˜åˆ°å¯„å­˜å™¨ 1.1 movæŒ‡ä»¤æ“ä½œçš„å››ç§å½¢å¼ [ç«‹å³æ•°] [reg] regä»£è¡¨å¯„å­˜å™¨ å¯ä»¥æ˜¯8ä¸ªé€šç”¨å¯„å­˜å™¨ä¸­çš„ä»»æ„ä¸€ä¸ª [reg+ç«‹å³æ•°] [reg+reg*{1,2,4,8}] 1.2 æŒ‡ä»¤æ ¼å¼ MOV r&#x2F;m8,r8 ré€šç”¨å¯„å­˜å™¨ MOV r&#x2F;m16,r16 mä»£è¡¨å†…å­˜ MOV r&#x2F;m32,r32 r8ä»£è¡¨8ä½é€šç”¨å¯„å­˜å™¨ MOV r8,r&#x2F;m8 m8ä»£è¡¨8ä¸ºå†…å­˜ MOV r16,r&#x2F;m16 imm8ä»£è¡¨8ä½ç«‹å³æ•° MOV r32,r&#x2F;m32 MOV r8,imm8 MOV r16,imm16 MOV r32,imm32 2 movsç§»åŠ¨æ•°æ® å†…å­˜-å†…å­˜ ï¼ˆEDI-ESIï¼‰ MOVS BYTE PTR ES:[EDI],BYTE PTR DS:[ESI] ç®€å†™ä¸ºï¼šMOVSB MOVS WORD PTR ES:[EDI],WORD PTR DS:[ESI] ç®€å†™ä¸ºï¼šMOVSW MOVS DWORD PTR ES:[EDI],DWORD PTR DS:[ESI] ç®€å†™ä¸ºï¼šMOVSD ğŸ’¡ é»˜è®¤DFä½æ˜¯0æ—¶ï¼Œå½“å®Œæˆmovsæ“ä½œåESIå’ŒEDIçš„å€¼ä¼šåŠ byte,word,dword{1ï¼Œ2ï¼Œ4} 3 stoså°†AI&#x2F;AX&#x2F;EAXçš„å€¼å­˜å‚¨åˆ°[EDI]æŒ‡å®šçš„å†…å­˜å•å…ƒ STOS BYTE PRT ES:[EDI] ç®€å†™ä¸ºSTOSB STOS WORD PRT ES:[EDI] ç®€å†™ä¸ºSTOSW STOS DWORD PRT ES:[EDI] ç®€å†™ä¸ºSTOSD ğŸ’¡ é»˜è®¤DFä½æ˜¯0æ—¶ï¼Œå½“å®Œæˆstosæ“ä½œåEDIçš„å€¼ä¼šåŠ byte,word,dword{1ï¼Œ2ï¼Œ4} 4 repæŒ‰è®¡æ•°å¯„å­˜å™¨ECXä¸­æŒ‡å®šçš„æ¬¡æ•°é‡å¤æ‰§è¡Œå­—ç¬¦ä¸²æŒ‡ä»¤ 1234MOV ECX,10REP MOVSDREP STOSD 5 add5.1 æŒ‡ä»¤æ ¼å¼ ADD r&#x2F;m8,imm8 ADD r&#x2F;m16,imm16 ADD r&#x2F;m32,imm32 ADD r&#x2F;m16,imm8 ADD r&#x2F;m32,imm8 ADD r&#x2F;m8,r8 ADD r&#x2F;m16,r16 ADD r&#x2F;m32,r32 ADD r8,,r&#x2F;m8 ADD r16,r&#x2F;m16 ADD r32,r&#x2F;m32 6 sub6.1 æŒ‡ä»¤æ ¼å¼ SUB r&#x2F;m8,imm8 SUB r&#x2F;m16,imm16 SUB r&#x2F;m32,imm32 SUB r&#x2F;m16,imm8 SUB r&#x2F;m32,imm8 SUB r&#x2F;m8,r8 SUB r&#x2F;m16,r16 SUB r&#x2F;m32,r32 SUB r8,,r&#x2F;m8 SUB r16,r&#x2F;m16 SUB r32,r&#x2F;m32 7 and7.1 æŒ‡ä»¤æ ¼å¼ AND r&#x2F;m8,imm8 AND r&#x2F;m16,imm16 AND r&#x2F;m32,imm32 AND r&#x2F;m16,imm8 AND r&#x2F;m32,imm8 AND r&#x2F;m8,r8 AND r&#x2F;m16,r16 AND r&#x2F;m32,r32 AND r8,r&#x2F;m8 AND r16,r&#x2F;m16 AND r32,r&#x2F;m32 8 or8.1 æŒ‡ä»¤æ ¼å¼ OR r&#x2F;m8,imm8 OR r&#x2F;m16,imm16 OR r&#x2F;m32,imm32 OR r&#x2F;m16,imm8 OR r&#x2F;m32,imm8 OR r&#x2F;m8,r8 OR r&#x2F;m16,r16 OR r&#x2F;m32,r32 OR r8,r&#x2F;m8 OR r16,r&#x2F;m16 OR r32,r&#x2F;m32 9 not9.1 åŠŸèƒ½è¿›è¡Œå–åæ“ä½œ 9.2 æŒ‡ä»¤æ ¼å¼ NOT r32 NOT r16 NOT m16 NOT m32 10 xor10.1 æŒ‡ä»¤æ ¼å¼ XOR r&#x2F;m8,imm8 XOR r&#x2F;m16,imm16 XOR r&#x2F;m32,imm32 XOR r&#x2F;m16,imm8 XOR r&#x2F;m32,imm8 XOR r&#x2F;m8,r8 XOR r&#x2F;m16,r16 XOR r&#x2F;m32,r32 XOR r8,r&#x2F;m8 XOR r16,r&#x2F;m16 XOR r32,r&#x2F;m32 11 push11.1 åŠŸèƒ½ å‘å †æ ˆä¸­å‹å…¥æ•°æ® ç„¶åä¿®æ”¹æ ˆé¡¶æŒ‡é’ˆESPå¯„å­˜å™¨åœ°å€ï¼Œçœ‹æ•°æ®ç±»å‹byte,word,dwordåˆ†åˆ«å¯¹åº”-1ï¼Œ-2ï¼Œ-4 11.2 æŒ‡ä»¤æ ¼å¼ PUSH r32 PUSH r16 PUSH m16 PUSH m32 PUSH imm8&#x2F;imm16&#x2F;imm32 PUSHADï¼ˆæŠŠ8ä¸ªé€šç”¨å¯„å­˜å™¨çš„å€¼å­˜å…¥å †æ ˆï¼Œå…¶ä¸­Dæ˜¯DWORDï¼‰ PUSHFD (æŠŠ32ä½çš„eflagså¯„å­˜å™¨å‹å…¥æ ˆä¸­ï¼Œå…¶ä¸­Dæ˜¯DWORD) 11.3 å…¶ä»–æ–¹å¼å®ç°è¯¥åŠŸèƒ½ 12 pop12.1 åŠŸèƒ½ å°†æ ˆé¡¶æ•°æ®å­˜å‚¨åˆ°å¯„å­˜å™¨&#x2F;å†…å­˜ ä¿®æ”¹æ ˆé¡¶æŒ‡é’ˆESPå¯„å­˜å™¨åœ°å€ï¼Œçœ‹æ•°æ®ç±»å‹byte,word,dwordåˆ†åˆ«å¯¹åº”+1ï¼Œ+2ï¼Œ+4 12.2 æŒ‡ä»¤æ ¼å¼ POP r16 POP r32 POP m16 POP m32 POPAD ï¼ˆæŠŠå­˜å…¥å †æ ˆçš„8ä¸ªå¯„å­˜å™¨å€¼å¼¹å‡ºï¼Œæ¢å¤8ä¸ªå¯„å­˜å™¨çš„å€¼ï¼‰ POPFD (æŠŠå­˜å…¥å †æ ˆçš„32ä½eflagså€¼å¼¹å‡ºï¼Œæ¢å¤eflagså€¼) 12.3 å…¶ä»–æ–¹å¼å®ç°è¯¥åŠŸèƒ½ 13 jmp13.1 åŠŸèƒ½ ä¿®æ”¹å¯„å­˜å™¨EIPçš„å€¼ 13.2 æŒ‡ä»¤æ ¼å¼ JMP å¯„å­˜å™¨&#x2F;ç«‹å³æ•°&#x2F;å†…å­˜ 14 call14.1 åŠŸèƒ½ PUSHå½“å‰callæŒ‡ä»¤çš„ä¸‹ä¸€è¡Œåœ°å€è¿›å…¥å †æ ˆ å¾€EIPå†…å­˜å…¥ç«‹å³æ•°&#x2F;å¯„å­˜å™¨&#x2F;å†…å­˜ ç®€å†™ï¼šjmp ç«‹å³æ•°&#x2F;å¯„å­˜å™¨&#x2F;å†…å­˜ ğŸ’¡ ä¸JMPå”¯ä¸€çš„åŒºåˆ«ï¼šåœ¨å †æ ˆä¸­å­˜å‚¨callæŒ‡ä»¤ä¸‹ä¸€è¡Œå†…å­˜åœ°å€ 14.2 æŒ‡ä»¤æ ¼å¼ CALL ç«‹å³æ•°&#x2F;å¯„å­˜å™¨&#x2F;å†…å­˜ 15 ret15.1 åŠŸèƒ½ å°†å½“å‰æ ˆé¡¶æ•°æ®å€¼å­˜å…¥EIP ADD ESP,4 ç„¶åå½“å‰æ ˆé¡¶æŒ‡é’ˆ+4ï¼Œèµ‹å€¼ç»™ESP MOV EIP,[ESP-4] 15.2 æŒ‡ä»¤æ ¼å¼ RET 16 CMP16.1 åŠŸèƒ½è¯¥æŒ‡ä»¤æ˜¯æ¯”è¾ƒä¸¤ä¸ªæ“ä½œæ•°ã€‚ å®é™…ä¸Šï¼Œå®ƒç›¸å½“äºSUBæŒ‡ä»¤ï¼Œä½†æ˜¯ç›¸å‡çš„è®°è¿‡å¹¶ä¸ä¿å­˜åˆ°ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸­ã€‚ åªæ˜¯æ ¹æ®ç›¸å‡çš„ç»“æœæ¥æ”¹å˜é›¶æ ‡å¿—ä½çš„,å½“ä¸¤ä¸ªæ“ä½œæ•°ç›¸ç­‰çš„æ—¶å€™,é›¶æ ‡å¿—ä½ç½®1ã€‚ 16.2 æŒ‡ä»¤æ ¼å¼ CMP R&#x2F;M,R&#x2F;M&#x2F;IMM 17 TEST17.1 åŠŸèƒ½TESTæŒ‡ä»¤ç›¸å½“äºANDæŒ‡ä»¤ï¼Œåªä¸è¿‡ä¸çš„ç»“æœå¹¶ä¸ä¿å­˜åˆ°ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸­ã€‚ è¯¥æŒ‡ä»¤åœ¨ä¸€å®šç¨‹åºä¸Šå’ŒCMPæŒ‡ä»¤æ—¶ç±»ä¼¼çš„,ä¸¤ä¸ªæ•°å€¼è¿›è¡ŒANDæ“ä½œ,ç»“æœä¸ä¿å­˜,ä½†æ˜¯ä¼šæ”¹å˜ç›¸åº”æ ‡å¿—ä½. 17.2 æŒ‡ä»¤æ ¼å¼TEST r&#x2F;m,r&#x2F;m&#x2F;imm 18 ADC18.1 åŠŸèƒ½å¸¦è¿›ä½åŠ æ³•ï¼Œä¸¤è¾¹ä¸èƒ½åŒæ—¶ä¸ºå†…å­˜ å®½åº¦è¦ä¸€æ · 18.2 æŒ‡ä»¤æ ¼å¼ ADC r&#x2F;m,r&#x2F;m&#x2F;imm 19 SBB19.1 åŠŸèƒ½å¸¦å€Ÿä½å‡æ³•ï¼Œä¸¤è¾¹ä¸èƒ½åŒæ—¶ä¸ºå†…å­˜ å®½åº¦è¦ä¸€æ · 19.2 æŒ‡ä»¤æ ¼å¼ SBB r&#x2F;m,r&#x2F;m 20 XCHG20.1 åŠŸèƒ½äº¤æ¢æ•°æ®ï¼Œä¸¤è¾¹ä¸èƒ½åŒæ—¶ä¸ºå†…å­˜ å®½åº¦è¦ä¸€æ · 20.2 æŒ‡ä»¤æ ¼å¼ XCHG r&#x2F;m,r&#x2F;m 21 ç®—æœ¯ä½ç§»æŒ‡ä»¤21.1 SALï¼ˆç®—æœ¯å·¦ç§»ï¼‰SAR Reg&#x2F;Mem, CL&#x2F;Imm 21.2 SARï¼ˆç®—æœ¯å³ç§»ï¼‰SAR Reg&#x2F;Mem, CL&#x2F;Imm æ³¨æ„ï¼šç®—æœ¯å³ç§»æ—¶å€™è¡¥æœ€é«˜ä½ç¬¦å·ä½ï¼Œæ˜¯1è¡¥1ï¼Œæ˜¯0è¡¥0 22 é€»è¾‘ç§»ä½æŒ‡ä»¤æ³¨æ„ï¼šä¸ç®¡æ˜¯å·¦ç§»è¿˜æ˜¯å³ç§»éƒ½æ˜¯è¡¥0 22.1 SHLï¼ˆé€»è¾‘å·¦ç§»ï¼‰SHL Reg&#x2F;Mem, CL&#x2F;Imm 22.2 SHRï¼ˆé€»è¾‘å³ç§»ï¼‰SHR Reg&#x2F;Mem, CL&#x2F;Imm 23 å¾ªç¯ç§»ä½æŒ‡ä»¤23.1 ROLï¼ˆå¾ªç¯å·¦ç§»ï¼‰ROL r&#x2F;m, i8 æœ€ä½ä½æ˜¯1åˆ™è¡¥1ï¼Œæœ€ä½ä½æ˜¯0åˆ™è¡¥0 23.2 RORï¼ˆå¾ªç¯å³ç§»ï¼‰ROR r&#x2F;m, CL æœ€é«˜ä½æ˜¯1åˆ™è¡¥1ï¼Œæœ€é«˜ä½æ˜¯0åˆ™è¡¥0 24 å¸¦è¿›ä½çš„å¾ªç¯ç§»ä½æŒ‡ä»¤CFä½æ˜¯1åˆ™è¡¥1ï¼Œåä¹‹åˆ™è¡¥0 24.1 RCLï¼ˆå¸¦è¿›ä½å¾ªç¯å·¦ç§»ï¼‰RCL r&#x2F;m, i8 24.2 RCRï¼ˆå¸¦è¿›ä½å¾ªç¯å³ç§»ï¼‰RCR r&#x2F;m, CL äºŒã€å­˜å‚¨æ¨¡å¼å¤§ç«¯æ¨¡å¼ï¼šæ•°æ®é«˜ä½åœ¨ä½ä½ï¼Œæ•°æ®ä½ä½åœ¨é«˜ä½ å°ç«¯æ¨¡å¼ï¼šæ•°æ®é«˜ä½åœ¨é«˜ä½ï¼Œæ•°æ®ä½ä½åœ¨ä½ä½ ä¸‰ JCC1 æ ‡å¿—å¯„å­˜å™¨ EFLAGS 2 CFï¼ˆbit 0ï¼‰[Carry flag]2.1 åŠŸèƒ½è‹¥ç®—æœ¯æ“ä½œäº§ç”Ÿçš„ç»“æœåœ¨æœ€é«˜æœ‰æ•ˆä½å‘ç”Ÿè¿›ä½æˆ–è€…å€Ÿä½åˆ™å°†å…¶ç½®1ï¼Œåä¹‹æ¸…é›¶ã€‚è¿™ä¸ªæ ‡å¿—é€šå¸¸ç”¨æ¥åªæ˜¯æ— ç¬¦å·æ•´å‹è¿ç®—çš„æº¢å‡ºçŠ¶æ€ã€‚ ğŸ‘‰ æœ‰ç¬¦å·è¿ç®—çœ‹Oä½ï¼Œæ— ç¬¦å·è¿ç®—çœ‹Cä½ 2.2 ä¾‹å­ 3 PF ï¼ˆbit 2ï¼‰[parity flag]3.1 åŠŸèƒ½å¦‚æœç»“æœçš„æœ€ä½æœ‰æ•ˆå­—èŠ‚åŒ…å«å¶æ•°ä¸ª1ä½ï¼Œåˆ™è¯¥ä½ç½®1ï¼Œå¦åˆ™æ¸…é›¶ã€‚ åˆ©ç”¨PFè¯¾è¿›è¡Œå¥‡å¶æ ¡éªŒæ£€æŸ¥ï¼š éœ€è¦ä¼ è¾“â€œ11001110â€ï¼Œæ•°æ®ä¸­å«æœ‰5ä¸ªâ€œ1â€ï¼Œæ‰€ä»¥å…¶å¥‡æ ¡éªŒä½ä¸ºâ€œ0â€ï¼ŒåŒæ—¶æŠŠâ€œ110011100â€æ•°æ®ä¼ è¾“ç»™æ¥æ”¶æ–¹ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®æ—¶åå†ä¸€æ¬¡è®¡ç®—å¥‡å¶æ€§ï¼Œâ€œ110011100â€ä¸­ä»ç„¶å«æœ‰5ä¸ªâ€œ1â€ï¼Œæ‰€ä»¥æ¥æ”¶æ–¹è®¡ç®—å‡ºçš„å¥‡æ ¡éªŒä½è¿˜æ˜¯â€œ0â€ï¼Œä¸å‘é€æ–¹ä¸€è‡´ï¼Œè¡¨ç¤ºåœ¨æ­¤æ¬¡ä¼ è¾“è¿‡ç¨‹ä¸­æœªå‘ç”Ÿé”™è¯¯ 4 AFï¼ˆbit 4ï¼‰[Auxiliary carry flag]4.1 åŠŸèƒ½ åœ¨å­—æ“ä½œæ—¶ï¼Œå‘ç”Ÿä½å­—èŠ‚å‘é«˜å­—èŠ‚è¿›ä½æˆ–å€Ÿä½æ—¶ï¼› åœ¨å­—èŠ‚æ“ä½œæ—¶ï¼Œå‘ç”Ÿä½å››ä½å‘é«˜å››ä½è¿›ä½æˆ–å€Ÿä½æ—¶ã€‚ è¾…åŠ©è¿›ä½æ ‡å¿—AFçš„å€¼è¢«ç½®ä¸º1ï¼Œå¦åˆ™å…¶å€¼ä¸º0ï¼š 5 ZFï¼ˆbit 6ï¼‰[zero flag]5.1 åŠŸèƒ½é›¶æ ‡å¿—ZFç”¨æ¥åæ˜ è¿ç®—ç»“æœæ˜¯å¦ä¸º0ã€‚ è‹¥ç»“æœä¸º0ï¼Œåˆ™å°†å…¶ç½®1ï¼Œåä¹‹æ¸…é›¶ ç»å¸¸ä¸CMPæˆ–è€…TESTç­‰æŒ‡ä»¤ä¸€èµ·ä½¿ç”¨ 6 SFï¼ˆbit 7ï¼‰[Sign flag]6.1 åŠŸèƒ½è¯¥æ ‡å¿—è¢«è®¾ç½®ä¸ºæœ‰ç¬¦å·æ•´å‹çš„æœ€é«˜æœ‰æ•ˆä½ 0æŒ‡ç¤ºç»“æœä¸ºæ­£ï¼Œåä¹‹åˆ™ä¸ºè´Ÿ 7 OFï¼ˆbit 11ï¼‰[OverFlow flag]7.1 åŠŸèƒ½ä¸€å¤„æ ‡å¿—OFç”¨äºåæ˜ æœ‰ç¬¦å·æ•°åŠ å‡è¿ç®—æ‰€å¾—ç»“æœæ˜¯å¦æº¢å‡ºã€‚ å¦‚æœæ˜¯æ— ç¬¦å·æ•°è¿ç®—ï¼Œæ˜¯å¦æº¢å‡ºçœ‹CFä½ã€‚ å¦‚æœæ˜¯æœ‰ç¬¦å·æ•°è¿ç®—ï¼Œæ˜¯å¦æº¢å‡ºçœ‹OFä½ã€‚ 8 DFï¼ˆbit 10ï¼‰[Oirection flag]8.1 åŠŸèƒ½è¿™ä¸ªæ–¹å‘æ ‡å¿—æ§åˆ¶ä¸²æŒ‡ä»¤ï¼ˆMOVS,CMPS,SCAS,LODSä»¥åŠSTOSï¼‰è®¾ç½®DFæ ‡å¿—æ˜¯çš„ä¸²æŒ‡ä»¤è‡ªåŠ¨é€’å‡ï¼ˆä»é«˜åœ°å€å‘ä½åœ°å€æ–¹å‘å¤„ç†å­—ç¬¦ä¸²ï¼‰ï¼Œæ¸…æ¥šè¯¥æ ‡å¿—åˆ™ä½¿å¾—æŒ‡ä»¤è‡ªåŠ¨é€’å¢ STDä»¥åŠCLDæŒ‡ä»¤åˆ†åˆ«ç”¨äºè®¾ç½®ä»¥åŠæ¸…æ¥šDFæ ‡å¿— 9 JCCæŒ‡ä»¤ Index JCCæŒ‡ä»¤ è¯´æ˜ EFLAGS 1 JE ï¼ŒJZ ç»“æœä¸ºé›¶åˆ™è·³è½¬(ç›¸ç­‰æ—¶è·³è½¬) ZF&#x3D;1 2 JNEï¼ŒJNZ ç»“æœä¸ä¸ºé›¶åˆ™è·³è½¬(ä¸ç›¸ç­‰æ—¶è·³è½¬) ZF&#x3D;0 3 JS ç»“æœä¸ºè´Ÿåˆ™è·³è½¬ SF&#x3D;1 4 JNS ç»“æœä¸ºéè´Ÿåˆ™è·³è½¬ SF&#x3D;0 5 JPï¼ŒJPE ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬ PF&#x3D;1 6 JNPï¼ŒJPO ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬ PF&#x3D;0 7 JO ç»“æœæº¢å‡ºäº†åˆ™è·³è½¬ OF&#x3D;1 8 JNO ç»“æœæ²¡æœ‰æº¢å‡ºåˆ™è·³è½¬ OF&#x3D;0 9 JBï¼ŒJNAE å°äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°) CF&#x3D;1 10 JNBï¼ŒJAE å¤§äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°) CF&#x3D;0 11 JBEï¼ŒJNA å°äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°) CF&#x3D;1 or ZF&#x3D;1 12 JNBEï¼ŒJA å¤§äºåˆ™è·³è½¬(æ— ç¬¦å·æ•°) CF&#x3D;0 and ZF&#x3D;0 13 JLï¼ŒJNGE å°äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°) SFâ‰  OF 14 JNLï¼ŒJGE å¤§äºç­‰äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°) SF&#x3D;OF 15 JLEï¼ŒJNG å°äºç­‰äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°) ZF&#x3D;1 or SFâ‰  OF 16 JNLEï¼ŒJG å¤§äºåˆ™è·³è½¬(æœ‰ç¬¦å·æ•°) ZF&#x3D;0 and SF&#x3D;OF ğŸ‘‰ åœ¨ä»»ä½•è¿ç®—ä¹‹å‰å¾—å…ˆç¡®å®šæ—¶æœ‰ç¬¦å·è¿ç®—è¿˜æ˜¯æ— ç¬¦å·è¿ç®—","tags":["Assembly"],"categories":["Language"]},{"title":"shellcodeç¼–å†™","path":"/p/22672422/","content":"ä»€ä¹ˆæ˜¯ShellCodeï¼Ÿä¸ä¾èµ–ç¯å¢ƒï¼Œæ”¾åˆ°ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥æ‰§è¡Œçš„æœºå™¨ç  shellcodeç¼–å†™åŸåˆ™ ä¸èƒ½æœ‰å…¨å±€å˜é‡ ä¸èƒ½ä½¿ç”¨å¸¸é‡å­—ç¬¦ä¸² ä¸èƒ½ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ ä¸èƒ½åµŒå¥—è°ƒç”¨å…¶ä»–å‡½æ•° æ¡ˆä¾‹æ€è·¯é€šè¿‡TEBç»“æ„ä½“æŸ¥æ‰¾PEBï¼Œç„¶ååœ¨PEBä¸­æ‰¾åˆ°_PEB_LDR_DATAï¼Œå†ä»_PEB_LDR_DATAä¸­æ‰¾åˆ°InLoadOrderModuleListï¼Œè¿™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨å†…å­˜å‚¨çš„æ˜¯æœ‰å…³æ‰€æœ‰åŠ è½½dllçš„ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªç»“æ„æ¥è¿›è¡Œæ–­é“¾dlléšè—ï¼Œ_LDR_DATA_TABLE_ENTRYè¿™æ˜¯é“¾è¡¨é‡Œçš„nodeçš„ç»“æ„ä½“ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éå†æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°çš„dllï¼Œæ‹¿åˆ°DllBaseï¼Œä¹‹åé€šè¿‡PEçš„çŸ¥è¯†è§£æï¼Œä»ä¸­æ‰¾åˆ°å¯¼å‡ºè¡¨ï¼Œä»å¯¼å‡ºè¡¨ä¸­æ‹¿åˆ°GetProcAddresså’ŒLoadLibraryAå‡½æ•°ï¼Œä¹‹åå°±å¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªå‡½æ•°è¿›è¡ŒåŠ è½½dllå’Œä½¿ç”¨dllä¸­çš„å‡½æ•°ã€‚ å…¶ä¸­æœ‰å…³_LDR_DATA_TABLE_ENTRYç»“æ„ä½“å†…å®¹å¦‚ä¸‹ï¼Œå¯ä»¥å‚è€ƒçœ‹çœ‹ 12345678910111213141516171819202122232425262728293031//0x50 bytes (sizeof)struct _LDR_DATA_TABLE_ENTRY&#123; struct _LIST_ENTRY InLoadOrderLinks; //0x0 struct _LIST_ENTRY InMemoryOrderLinks; //0x8 struct _LIST_ENTRY InInitializationOrderLinks; //0x10 VOID* DllBase; //0x18 VOID* EntryPoint; //0x1c ULONG SizeOfImage; //0x20 struct _UNICODE_STRING FullDllName; //0x24 struct _UNICODE_STRING BaseDllName; //0x2c ULONG Flags; //0x34 USHORT LoadCount; //0x38 USHORT TlsIndex; //0x3a union &#123; struct _LIST_ENTRY HashLinks; //0x3c struct &#123; VOID* SectionPointer; //0x3c ULONG CheckSum; //0x40 &#125;; &#125;; union &#123; ULONG TimeDateStamp; //0x44 VOID* LoadedImports; //0x44 &#125;; VOID* EntryPointActivationContext; //0x48 VOID* PatchInformation; //0x4c&#125;; å®ä¾‹ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167// demo08shellcode.cpp : Defines the entry point for the console application.//#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;//functiontypedef FARPROC (WINAPI *GETPROCADDRESS)(HMODULE hModule,LPCSTR lpProcName); typedef int (WINAPI *MESSAGEBOXA)(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType);typedef HMODULE (WINAPI *LOADLIBRARYA)(LPCSTR lpLibFileName);GETPROCADDRESS PGETPROCADDRESS;MESSAGEBOXA PMESSAGEBOX;LOADLIBRARYA PLOADLIBRARY;//structtypedef struct _UNICODE_STRING&#123; USHORT Length; //0x0 USHORT MaximumLength; //0x2 PWSTR Buffer; //0x4&#125;UNICODE_STRING;//0x0 bytes (sizeof)//0x28 bytes (sizeof)typedef struct _PEB_LDR_DATA&#123; DWORD Length; //0x0 BYTE Initialized; //0x4 VOID* SsHandle; //0x8 LIST_ENTRY InLoadOrderModuleList; //0xc LIST_ENTRY InMemoryOrderModuleList; //0x14 LIST_ENTRY InInitializationOrderModuleList; //0x1c VOID* EntryInProgress; //0x24&#125;PEB_LDR_DATA; typedef struct _LDR_DATA_TABLE_ENTRY&#123; LIST_ENTRY InLoadOrderLinks; //0x0 LIST_ENTRY InMemoryOrderLinks; //0x8 LIST_ENTRY InInitializationOrderLinks; //0x10 VOID* DllBase; //0x18 VOID* EntryPoint; //0x1c DWORD SizeOfImage; //0x20 UNICODE_STRING FullDllName; //0x24 UNICODE_STRING BaseDllName; //0x2c DWORD Flags; //0x34 WORD LoadCount; //0x38 WORD TlsIndex; //0x3a union &#123; LIST_ENTRY HashLinks; //0x3c struct &#123; VOID* SectionPointer; //0x3c DWORD CheckSum; //0x40 &#125;; &#125;; union &#123; DWORD TimeDateStamp; //0x44 VOID* LoadedImports; //0x44 &#125;; VOID* EntryPointActivationContext; //0x48 VOID* PatchInformation; //0x4c&#125;LDR_DATA_TABLE_ENTRY; int strcmp(char* buf1,char* buf2)&#123;\twhile(*buf1 &amp;&amp; *buf2 &amp;&amp; *buf1 == *buf2)&#123; buf1++; buf2++;\t&#125;\tif (*buf1 == *buf2)\t&#123; return 1;\t&#125;\treturn 0;&#125;void ToShellcode()&#123;\tLDR_DATA_TABLE_ENTRY *pPLD = NULL,*pBeg = NULL;\tPGETPROCADDRESS = NULL;\tPLOADLIBRARY = NULL;\tPMESSAGEBOX = NULL;\tWORD *pFirst = NULL,*pLast = NULL;\tDWORD ret = 0,i=0;\tDWORD dwKernelBase = 0;\tchar szKerner32[] = &#123;&#x27;k&#x27;,0,&#x27;e&#x27;,0,&#x27;r&#x27;,0,&#x27;n&#x27;,0,&#x27;e&#x27;,0,&#x27;l&#x27;,0,&#x27;3&#x27;,0,&#x27;2&#x27;,0,&#x27;.&#x27;,0,&#x27;d&#x27;,0,&#x27;l&#x27;,0,&#x27;l&#x27;,0,0,0&#125;;\tchar szUser32[] = &#123;&#x27;U&#x27;,&#x27;S&#x27;,&#x27;E&#x27;,&#x27;R&#x27;,&#x27;3&#x27;,&#x27;2&#x27;,&#x27;.&#x27;,&#x27;d&#x27;,&#x27;l&#x27;,&#x27;l&#x27;,0&#125;; char szGetProAddress[] = &#123;&#x27;G&#x27;,&#x27;e&#x27;,&#x27;t&#x27;,&#x27;P&#x27;,&#x27;r&#x27;,&#x27;o&#x27;,&#x27;c&#x27;,&#x27;A&#x27;,&#x27;d&#x27;,&#x27;d&#x27;,&#x27;r&#x27;,&#x27;e&#x27;,&#x27;s&#x27;,&#x27;s&#x27;,0&#125;;\tchar szLoadLibrary[] = &#123;&#x27;L&#x27;,&#x27;o&#x27;,&#x27;a&#x27;,&#x27;d&#x27;,&#x27;L&#x27;,&#x27;i&#x27;,&#x27;b&#x27;,&#x27;r&#x27;,&#x27;a&#x27;,&#x27;r&#x27;,&#x27;y&#x27;,&#x27;A&#x27;,0&#125;;\tchar szMessageBox[] = &#123;&#x27;M&#x27;,&#x27;e&#x27;,&#x27;s&#x27;,&#x27;s&#x27;,&#x27;a&#x27;,&#x27;g&#x27;,&#x27;e&#x27;,&#x27;B&#x27;,&#x27;o&#x27;,&#x27;x&#x27;,&#x27;A&#x27;,0&#125;;\tchar lpText[] = &#123;0xD7,0xA2,0xC8,0xEB,0xB3,0xC9,0xB9,0xA6,0x00&#125;;\tchar lpCaption[]= &#123;&#x27;s&#x27;,&#x27;h&#x27;,&#x27;e&#x27;,&#x27;l&#x27;,&#x27;l&#x27;,&#x27;c&#x27;,&#x27;o&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;T&#x27;,&#x27;e&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,0&#125;;\t__asm&#123; mov eax,fs:[0x30] //PEB mov eax,[eax+0xc] //PEB-&gt;Ldr add eax,0x0c //LDR_DATA_TABLE_ENTRY InLoadOrderModuleList mov pBeg,eax mov eax,[eax] mov pPLD,eax\t&#125;\t/*\tif (strcmp(szMessageBox,name))\t&#123; printf(&quot;%d:--%s--%x &quot;,t+1,name,funAddress); PMESSAGEBOX = (MESSAGEBOX)funAddress;\t&#125;*/\t//kernel32.dll\twhile (pPLD != pBeg)\t&#123; pLast = (WORD*)pPLD-&gt;BaseDllName.Buffer; pFirst = (WORD*)szKerner32; while(!pLast &amp;&amp; *pLast == *pFirst)&#123; pLast++; pFirst++; &#125; if (*pLast == *pFirst) &#123; dwKernelBase = (DWORD)pPLD-&gt;DllBase; break; &#125; pPLD = (LDR_DATA_TABLE_ENTRY*)pPLD-&gt;InLoadOrderLinks.Flink;\t&#125;\tPIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)dwKernelBase;\tPIMAGE_NT_HEADERS pNTHeader = (PIMAGE_NT_HEADERS)((DWORD)pDosHeader + pDosHeader-&gt;e_lfanew);\tPIMAGE_FILE_HEADER pPEHeader = (PIMAGE_FILE_HEADER)((DWORD)pNTHeader + 4);\tPIMAGE_OPTIONAL_HEADER32 pOptionHeader = (PIMAGE_OPTIONAL_HEADER32)((DWORD)pPEHeader + IMAGE_SIZEOF_FILE_HEADER);\tDWORD dataDirectorySize = sizeof(pOptionHeader-&gt;DataDirectory) / sizeof(IMAGE_DATA_DIRECTORY);\tPIMAGE_DATA_DIRECTORY pDataDirectory = (PIMAGE_DATA_DIRECTORY)pOptionHeader-&gt;DataDirectory;\tPIMAGE_EXPORT_DIRECTORY pExportTable = (PIMAGE_EXPORT_DIRECTORY)(dwKernelBase + pDataDirectory-&gt;VirtualAddress);\tLPVOID funNameBase = (LPVOID)(dwKernelBase + pExportTable-&gt;AddressOfNames);\tLPVOID funAddressBase = (LPVOID)(dwKernelBase + pExportTable-&gt;AddressOfFunctions);\tfor (DWORD t = 0;t&lt;pExportTable-&gt;NumberOfNames;t++)\t&#123; DWORD funAddress = dwKernelBase + *(PDWORD)((DWORD)funAddressBase+(t*4)); char* name = (char*)(dwKernelBase + *(PDWORD)((DWORD)funNameBase+(t*4))); //printf(&quot;name:%s &quot;,name); if (strcmp(szGetProAddress,name)) &#123; printf(&quot;%d:--%s--%x &quot;,t+1,name,funAddress); PGETPROCADDRESS = (GETPROCADDRESS)funAddress; &#125;else if (strcmp(szLoadLibrary,name)) &#123; printf(&quot;%d:--%s--%x &quot;,t+1,name,funAddress); PLOADLIBRARY = (LOADLIBRARYA)funAddress; &#125;\t&#125;\t//getchar();\tHMODULE hmodule = PLOADLIBRARY((LPCSTR)szUser32);\tPMESSAGEBOX = (MESSAGEBOXA)PGETPROCADDRESS(hmodule,szMessageBox);\tPMESSAGEBOX(0,lpText,lpCaption,MB_OK);\treturn;&#125;int main(int argc, char* argv[])&#123;\tToShellcode();\tprintf(&quot;Hello World! &quot;);\treturn 0;&#125;","tags":["shellcode"],"categories":["é€†å‘"]},{"title":"ä¿æŠ¤æ¨¡å¼","path":"/p/6c15571f/","content":"ä¿æŠ¤æ¨¡å¼ä»‹ç»ä»€ä¹ˆæ˜¯ä¿æŠ¤æ¨¡å¼ï¼Ÿx86 CPUçš„3ä¸ªæ¨¡å¼ï¼šå®æ¨¡å¼ã€ä¿æŠ¤æ¨¡å¼å’Œè™šæ‹Ÿ8086æ¨¡å¼ã€‚ ä¸ºä»€ä¹ˆä¸ç›´æ¥è®²x64çš„ï¼Ÿx86æ˜¯ç”±Intelæ¨å‡ºçš„ä¸€ç§å¤æ‚æŒ‡ä»¤é›†,èƒ½å¤Ÿç”Ÿäº§æ”¯æŒè¿™ç§æŒ‡ä»¤é›†CPUå…¬å¸ä¸»è¦æ˜¯Intelå’ŒAMD. AMDåœ¨1999å¹´çš„æ—¶å€™ï¼Œæ‹“å±•äº†è¿™å¥—æŒ‡ä»¤é›†ï¼Œç§°ä¸ºx86-64,åæ”¹åä¸ºAMD64,Intelä¹Ÿå…¼å®¹äº†è¿™ä¸ªäº§å“ï¼Œç§°ä¸ºIntel 64.ä½†AMD64å’ŒIntel64å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥åœ¨å¾ˆå¤šèµ„æ–™ä¸­ç»Ÿç§°ä¸ºx64.è¿™å¥—æŒ‡ä»¤é›†æ˜¯å¯¹x86çš„æ‹“å±•ï¼Œå‘ä¸‹å…¼å®¹çš„. ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿæ®µçš„æœºåˆ¶ é¡µçš„æœºåˆ¶ å­¦ä¹ ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç”¨ï¼ŸçœŸæ­£ç†è§£å†…æ ¸æ˜¯å¦‚ä½•è¿ä½œçš„ æ®µå¯„å­˜å™¨ç»“æ„1ã€ä»€ä¹ˆæ˜¯æ®µå¯„å­˜å™¨ï¼Ÿå½“æˆ‘ä»¬ç”¨æ±‡ç¼–è¯»å†™æŸä¸€ä¸ªåœ°å€æ—¶ï¼š 1mov dword ptr ds:[0x123456] eaxæˆ‘ä»¬çœŸæ­£è¯»å†™çš„åœ°å€æ˜¯ï¼š 1ds.base + 0x123456 ES CS SS DS FS GS LDTR TR å…±8ä¸ª 2ã€æ®µå¯„å­˜å™¨çš„ç»“æ„ 3ã€æ®µå¯„å­˜å™¨çš„è¯»å†™3.1 è¯»æ®µå¯„å­˜å™¨12345æ¯”å¦‚ï¼šMOV AX,ES åªèƒ½è¯»16ä½çš„å¯è§éƒ¨åˆ†è¯»å†™LDTRçš„æŒ‡ä»¤ä¸ºï¼šSLDT/LLDTè¯»å†™TRçš„æŒ‡ä»¤ä¸ºï¼šSTR/LTR 3.2 å†™æ®µå¯„å­˜å™¨1æ¯”å¦‚ï¼šMOV DS,AX å†™æ—¶æ˜¯å†™96ä½ æ®µå¯„å­˜å™¨å±æ€§æ¢æµ‹1ã€æ®µå¯„å­˜å™¨æˆå‘˜ç®€ä»‹ æ®µå¯„å­˜å™¨ Selector Attribute Base Limit ES 0023 å¯è¯»ã€å¯å†™ 0 0xFFFFFFFF CS 001B å¯è¯»ã€å¯æ‰§è¡Œ 0 0xFFFFFFFF SS 0023 å¯è¯»ã€å¯å†™ 0 0xFFFFFFFF DS 0023 å¯è¯»ã€å¯å†™ 0 0xFFFFFFFF FS 003B å¯è¯»ã€å¯å†™ 0x7FFDE000 0xFFF GS - - - - 2ã€æ¢æµ‹Attribute1234567int var = 0; __asm &#123; mov ax,ss\t//csä¸è¡Œ csæ˜¯å¯è¯» å¯æ‰§è¡Œ ä½†ä¸å¯å†™ mov ds,ax mov dword ptr ds:[var],eax &#125; 3ã€æ¢æµ‹Base12345678910int var = 1; __asm &#123; mov ax,fs mov gs,ax mov eax,gs:[0]\t//ä¸è¦ç”¨DS å¦åˆ™ç¼–è¯‘ä¸è¿‡å» mov dword ptr ds:[var],eax //mov edx,dword ptr ds:[0x7FFDF000]&#125; 4ã€æ¢æµ‹Limit12345678910int var = 1; __asm &#123; mov ax,fs mov gs,ax mov eax,gs:[0]\t//ä¸è¦ç”¨DS å¦åˆ™ç¼–è¯‘ä¸è¿‡å» mov dword ptr ds:[var],eax //mov edx,dword ptr ds:[0x7FFDF000]&#125; æ®µæè¿°ç¬¦ä¸æ®µé€‰æ‹©å­æ®µæè¿°ç¬¦åˆ†ç±»GDT(å…¨å±€æè¿°ç¬¦è¡¨) LDT(å±€éƒ¨æè¿°ç¬¦è¡¨) å½“æˆ‘ä»¬æ‰§è¡Œç±»ä¼¼MOV DS,AXæŒ‡ä»¤æ—¶ï¼ŒCPUä¼šæŸ¥è¡¨ï¼Œæ ¹æ®AXçš„å€¼æ¥å†³å®šæŸ¥æ‰¾GDTè¿˜æ˜¯LDT,æŸ¥æ‰¾è¡¨çš„ä»€ä¹ˆä½ç½®ï¼ŒæŸ¥å‡ºå¤šå°‘æ•°æ®. æ®µæè¿°ç¬¦ æ®µé€‰æ‹©å­æ®µé€‰æ‹©å­æ˜¯ä¸€ä¸ª16ä½çš„æ®µæè¿°ç¬¦ï¼Œè¯¥æè¿°ç¬¦æŒ‡å‘äº†å®šä¹‰è¯¥æ®µçš„æ®µæè¿°ç¬¦. RPLï¼šè¯·æ±‚ç‰¹æƒçº§åˆ« TIï¼š 12TI=0 æŸ¥GDTè¡¨TI=1 æŸ¥LDTè¡¨ Indexï¼šå¤„ç†å™¨å°†ç´¢å¼•å€¼ä¹˜ä»¥8åœ¨åŠ ä¸ŠGDTæˆ–è€…LDTçš„Baseåœ°å€ï¼Œå°±æ˜¯è¦åŠ è½½çš„æ®µæè¿°ç¬¦ åŠ è½½æ®µæè¿°ç¬¦è‡³æ®µå¯„å­˜å™¨é™¤äº†MOVæŒ‡ä»¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨LESã€LSSã€LDSã€LFSã€LGSæŒ‡ä»¤ä¿®æ”¹å¯„å­˜å™¨ CSä¸èƒ½é€šè¿‡ä¸Šè¿°çš„æŒ‡ä»¤è¿›è¡Œä¿®æ”¹ï¼ŒCSä¸ºä»£ç æ®µï¼ŒCSçš„æ”¹å˜ä¼šå¯¼è‡´EIPçš„æ”¹å˜ï¼Œè¦æ”¹CSï¼Œå¿…é¡»è¦ä¿è¯CSä¸EIPä¸€èµ·æ”¹ï¼Œåé¢ä¼šè®² 12345char buffer[6]; __asm &#123; les ecx,fword ptr ds:[buffer] //é«˜2ä¸ªå­—èŠ‚ç»™esï¼Œä½å››ä¸ªå­—èŠ‚ç»™ecx\t&#125; [!NOTE] æ³¨æ„ï¼šRPL&lt;&#x3D;DPL(åœ¨æ•°å€¼ä¸Š) æ®µæè¿°ç¬¦å±æ€§Pä½å’ŒGä½1ã€Pä½ 123P = 1 æ®µæè¿°ç¬¦æœ‰æ•ˆP = 0 æ®µæè¿°ç¬¦æ— æ•ˆ 2ã€Gä½ï¼ˆå½“å‰å¯»å€ä¸Šé™ï¼‰ G &#x3D; 0 Limitå•ä½æ˜¯bytes 1Limit = 000 FFFFF å‰é¢åŠ 000 G &#x3D; 1 Limitå•ä½æ˜¯ä»¥4KB 1Limit = FFFFF FFF åé¢åŠ FFF Sä½å’ŒTYPEåŸŸ1ã€Sä½ S &#x3D; 1 ä»£ç æ®µæˆ–è€…æ•°æ®æ®µæè¿°ç¬¦ S &#x3D; 0 ç³»ç»Ÿæ®µæè¿°ç¬¦ 2ã€TYPEåŸŸ åˆ†æä¸¾ä¾‹ æ•°æ®æ®µï¼ˆDSï¼‰è¯´æ˜Access è®¿é—®ä½ï¼Œè¡¨ç¤ºè¯¥ä½æœ€åä¸€æ¬¡è¢«æ“ä½œç³»ç»Ÿæ¸…é›¶åï¼Œè¯¥æ®µæ˜¯å¦è¢«è®¿é—®è¿‡.æ¯å½“å¤„ç†å™¨å°†è¯¥æ®µé€‰æ‹©ç¬¦ç½®å…¥æŸä¸ªæ®µå¯„å­˜å™¨æ—¶ï¼Œå°±å°†è¯¥ä½ç½®1. Write æ˜¯å¦å¯å†™ E æ‰©å±•æ–¹å‘ ï¼ˆå‘ä¸Šæ‹“å±•çº¢è‰²éƒ¨åˆ†å›¾ä¸€ï¼Œå‘ä¸‹æ‹“å±•çº¢è‰²éƒ¨åˆ†å›¾äºŒï¼‰ ä»£ç æ®µï¼ˆCSï¼‰è¯´æ˜A è®¿é—®ä½ R å¯è¯»ä½ C ä¸€è‡´ä½ 123C = 1 ä¸€è‡´ä»£ç æ®µC = 0 éä¸€è‡´ä»£ç æ®µ ç³»ç»Ÿæ®µï¼ˆSSï¼‰æè¿°ç¬¦å½“S&#x3D;0æ—¶ï¼Œè¯¥æ®µæè¿°ç¬¦ä¸ºç³»ç»Ÿæè¿°ç¬¦.ç³»ç»Ÿæè¿°ç¬¦æœ‰åˆ†ä¸ºä»¥ä¸‹ç±»å‹ DBä½DBä½ï¼šå½“å‰å®é™…åœ°å€æœ€å¤šå¤§å° 1ã€CSæ®µ 1D = 1 é‡‡ç”¨32ä½å¯»å€æ–¹å¼ æ•´ä¸ªåœ°å€ç©ºé—´æ˜¯4KB 12D = 0 é‡‡ç”¨16ä½å¯»å€æ–¹å¼\tå‰ç¼€67 æ”¹å˜å¯»å€æ–¹å¼ æ•´ä¸ªåœ°å€ç©ºé—´æ˜¯64K 2ã€SSæ®µ 123D = 1 éšå¼å †æ ˆè®¿é—®æŒ‡ä»¤ï¼ˆå¦‚ï¼šPUSH POP CALLï¼‰ ä½¿ç”¨32ä½å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨ESP D = 0 éšå¼å †æ ˆè®¿é—®æŒ‡ä»¤ï¼ˆå¦‚ï¼šPUSH POP CALLï¼‰ ä½¿ç”¨16ä½å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨SP 3ã€å‘ä¸‹æ‹“å±•çš„æ•°æ®æ®µ 1D = 1 æ®µä¸Šçº¿ä¸º4GB 1D = 0 æ®µä¸Šçº¿ä¸º64KB æ€»ç»“ æ®µæè¿°ç¬¦ä¸­çš„DBä½æ§åˆ¶æ“ä½œæ•°çš„é»˜è®¤å¤§å°ï¼ŒDB&#x3D;0æ—¶é»˜è®¤æ“ä½œæ•°ä¸º16ä½ï¼ŒDB&#x3D;1æ—¶é»˜è®¤æ“ä½œæ•°ä¸º32ä½ã€‚ å¯„å­˜å™¨å®½åº¦çš„æ”¹å˜é€šè¿‡æ”¹å˜DBä½å®ç°ï¼Œä¸å½±å“å¯„å­˜å™¨æœ¬èº«çš„å®½åº¦ã€‚ CSæ®µæè¿°ç¬¦çš„DBä½æ§åˆ¶ä»£ç æ®µçš„é»˜è®¤æ“ä½œæ•°å¤§å°ï¼Œå½±å“pushæŒ‡ä»¤çš„é»˜è®¤æ“ä½œæ•°ã€‚ SSæ®µæè¿°ç¬¦çš„DBä½æ”¹å˜å †æ ˆå¯„å­˜å™¨çš„å¯»å€æ–¹å¼ï¼Œä»32ä½å˜ä¸º16ä½ æ®µæƒé™æ£€æŸ¥CPUåˆ†çº§ å¦‚ä½•æŸ¥çœ‹ç¨‹åºå¤„äºå‡ ç¯?CPL(Current Privilege Level) ï¼šå½“å‰ç‰¹æƒçº§ CSå’ŒSSä¸­å­˜å‚¨çš„æ®µé€‰æ‹©å­å2ä½ ä¾‹å¦‚ï¼š23 &#x3D;&#x3D; 0010 0011 2b &#x3D;&#x3D; 0010 1011 11&#x3D;&#x3D;3 é‚£ä¹ˆåœ¨ä¸‰ç¯ DPL(Descriptor Privilege Level) æè¿°ç¬¦ç‰¹æƒçº§åˆ« DPLå­˜å‚¨åœ¨æ®µæè¿°ç¬¦ä¸­ï¼Œè§„å®šäº†è®¿é—®è¯¥æ®µæ‰€éœ€è¦çš„ç‰¹æƒçº§åˆ«æ˜¯ä»€ä¹ˆ. é€šä¿—çš„ç†è§£ï¼šå¦‚æœä½ æƒ³è®¿é—®æˆ‘ï¼Œé‚£ä¹ˆä½ åº”è¯¥å…·å¤‡ä»€ä¹ˆç‰¹æƒ. ä¸¾ä¾‹è¯´æ˜ï¼š 123mov DS,AX å¦‚æœAXæŒ‡å‘çš„æ®µDPL = 0 ä½†å½“å‰ç¨‹åºçš„CPL = 3 è¿™è¡ŒæŒ‡ä»¤æ˜¯ä¸ä¼šæˆåŠŸçš„ RPL(Request Privilege Level) è¯·æ±‚ç‰¹æƒçº§åˆ«RPLæ˜¯é’ˆå¯¹æ®µé€‰æ‹©å­è€Œè¨€çš„ï¼Œæ¯ä¸ªæ®µçš„é€‰æ‹©å­éƒ½æœ‰è‡ªå·±çš„RPL ä¸¾ä¾‹è¯´æ˜ï¼š 123Mov ax,0008\tä¸\tMov ax,000B //æ®µé€‰æ‹©å­ Mov ds,ax Mov ds,ax //å°†æ®µæè¿°æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªæ®µæè¿°ç¬¦,ä½†RPLæ˜¯ä¸ä¸€æ ·çš„. æ•°æ®æ®µçš„æƒé™æ£€æŸ¥12345æ¯”å¦‚å½“å‰ç¨‹åºå¤„äº0ç¯ï¼Œä¹Ÿå°±æ˜¯è¯´CPL=0Mov ax,000B\t//1011 RPL = 3Mov ds,ax\t//axæŒ‡å‘çš„æ®µæè¿°ç¬¦çš„DPL = 0 æ•°æ®æ®µçš„æƒé™æ£€æŸ¥ï¼š 1CPL &lt;= DPL å¹¶ä¸” RPL &lt;= DPL (æ•°å€¼ä¸Šçš„æ¯”è¾ƒ) æ³¨æ„ï¼šä»£ç æ®µå’Œç³»ç»Ÿæ®µæè¿°ç¬¦ä¸­çš„æ£€æŸ¥æ–¹å¼å¹¶ä¸ä¸€æ · æ€»ç»“12345CPL CPUå½“å‰çš„æƒé™çº§åˆ«DPL å¦‚æœä½ æƒ³è®¿é—®æˆ‘ï¼Œä½ åº”è¯¥å…·å¤‡ä»€ä¹ˆæ ·çš„æƒé™RPL ç”¨ä»€ä¹ˆæƒé™å»è®¿é—®ä¸€ä¸ªæ®µ ä»£ç è·¨æ®µæ‰§è¡Œæµç¨‹æ®µå¯„å­˜å™¨:ES,CS,SS,DS,FS,GS,LDTR,TR æ®µå¯„å­˜å™¨è¯»å†™ï¼šé™¤CSå¤–ï¼Œå…¶ä»–çš„æ®µå¯„å­˜å™¨éƒ½å¯ä»¥é€šè¿‡MOV,LES,LSS,LDS,LFS,LGSæŒ‡ä»¤è¿›è¡Œä¿®æ”¹ 1ã€ä»£ç é—´çš„è·³è½¬(æ®µé—´è·³è½¬ éè°ƒç”¨é—¨ä¹‹ç±»çš„)æ®µé—´è·³è½¬ï¼Œæœ‰2ç§æƒ…å†µï¼Œå³è¦è·³è½¬çš„æ®µæ˜¯ä¸€è‡´ä»£ç æ®µè¿˜æ˜¯éä¸€è‡´ä»£ç æ®µï¼Œä¹Ÿå°±æ˜¯çœ‹Cç­‰äº0è¿˜æ˜¯1 åŒæ—¶ä¿®æ”¹CSä¸EIPçš„æŒ‡ä»¤ JMP FAR &#x2F; CALL FAR &#x2F; RETF &#x2F; INT &#x2F;IRETED [!NOTE] æ³¨æ„ï¼šåªæ”¹å˜EIPçš„æŒ‡ä»¤ JMP &#x2F; CALL &#x2F; JCC &#x2F; RET 2ã€æ‰§è¡Œæµç¨‹CPUå¦‚ä½•æ‰§è¡Œè¿™è¡Œä»£ç ? JMP 0x20:0x004183D7 (1) æ®µé€‰æ‹©å­æ‹†åˆ† 12340x20 å¯¹åº”äºŒè¿›åˆ¶å½¢å¼ 0000 0000 0010 0000\tRPL = 00 TI = 0Index = 4 (2) æŸ¥è¡¨å¾—åˆ°æ®µæè¿°ç¬¦ 12345TI = 0 æ‰€ä»¥æŸ¥GDTè¡¨ Index = 4 æ‰¾åˆ°å¯¹åº”çš„æ®µæè¿°ç¬¦å››ç§æƒ…å†µå¯ä»¥è·³è½¬ï¼šä»£ç æ®µã€è°ƒç”¨é—¨ã€TSSä»»åŠ¡æ®µã€ä»»åŠ¡é—¨ (3) æƒé™æ£€æŸ¥ 123å¦‚æœæ˜¯éä¸€è‡´ä»£ç æ®µï¼Œè¦æ±‚:CPL == DPL å¹¶ä¸” RPL &lt;= DPL å¦‚æœæ˜¯ä¸€è‡´ä»£ç æ®µï¼Œè¦æ±‚:CPL &gt;= DPL (4) åŠ è½½æ®µæè¿°ç¬¦ 1é€šè¿‡ä¸Šé¢çš„æƒé™æ£€æŸ¥åï¼ŒCPUä¼šå°†æ®µæè¿°ç¬¦åŠ è½½åˆ°CSæ®µå¯„å­˜å™¨ä¸­. (5) ä»£ç æ‰§è¡Œ 1CPUå°† CS.Base + Offset çš„å€¼å†™å…¥EIP ç„¶åæ‰§è¡ŒCS:EIPå¤„çš„ä»£ç ï¼Œæ®µé—´è·³è½¬ç»“æŸ. 3ã€æ€»ç»“ å¯¹äºä¸€è‡´ä»£ç æ®µ:ä¹Ÿå°±æ˜¯å…±äº«çš„æ®µ ç‰¹æƒçº§é«˜çš„ç¨‹åºä¸å…è®¸è®¿é—®ç‰¹æƒçº§ä½çš„æ•°æ®ï¼šæ ¸å¿ƒæ€ä¸å…è®¸è®¿é—®ç”¨æˆ·æ€çš„æ•°æ® ç‰¹æƒçº§ä½çš„ç¨‹åºå¯ä»¥è®¿é—®åˆ°ç‰¹æƒçº§é«˜çš„æ•°æ®ï¼Œä½†ç‰¹æƒçº§ä¸ä¼šæ”¹å˜ï¼šç”¨æˆ·æ€è¿˜æ˜¯ç”¨æˆ·æ€ å¯¹äºæ™®é€šä»£ç æ®µï¼šä¹Ÿå°±æ˜¯éä¸€è‡´ä»£ç æ®µ åªå…è®¸åŒçº§è®¿é—® ç»å¯¹ç¦æ­¢ä¸åŒçº§åˆ«çš„è®¿é—®ï¼šæ ¸å¿ƒæ€ä¸æ˜¯ç”¨æˆ·æ€ï¼Œç”¨æˆ·æ€ä¹Ÿä¸æ˜¯æ ¸å¿ƒæ€. ç›´æ¥å¯¹ä»£ç æ®µè¿›è¡ŒJMP æˆ–è€… CALLçš„æ“ä½œï¼Œæ— è®ºç›®æ ‡æ˜¯ä¸€è‡´ä»£ç æ®µè¿˜æ˜¯éä¸€è‡´ä»£ç æ®µï¼ŒCPLéƒ½ä¸ä¼šå‘ç”Ÿæ”¹å˜.å¦‚æœè¦æå‡CPLçš„æƒé™ï¼Œåªèƒ½é€šè¿‡è°ƒç”¨é—¨. 3ã€å®éªŒ3.1 æ„é€ æ®µæè¿°ç¬¦æ‰¾ä¸€ä¸ªéä¸€è‡´ä»£ç æ®µæè¿°ç¬¦,å¤åˆ¶ä¸€ä»½ï¼Œå†™å…¥åˆ°GDTè¡¨ä¸­ 1234567891011kd&gt; r gdtrgdtr=8003f000kd&gt; dq 8003f0008003f000 00000000`00000000 00cf9b00`0000ffff8003f010 00cf9300`0000ffff 00cffb00`0000ffff8003f020 00cff300`0000ffff 80008b04`200020ab8003f030 ffc093df`f0000001 0040f300`00000fff8003f040 0000f200`0400ffff 00000000`000000008003f050 80008954`b1000068 80008954`b16800688003f060 00009302`2f40ffff 0000920b`80003fff8003f070 ff0092ff`700003ff 80009a40`0000ffff å°† 00cffb00&#96;0000ffff æ•°æ®å†™å¦‚æŸä¸ªPä½ä¸º0çš„ä½ç½® 1kd&gt; eq 8003f048 00cffb00`0000ffff(ç”¨å†…æ ¸å·¥å…·æŸ¥çœ‹æ–°å¢æ˜¯å¦æˆåŠŸï¼‰ 3.2 ODä¸­è¿›è¡Œæµ‹è¯•åœ¨ODä¸­ï¼Œæ‰§è¡Œè·¨æ®µè·³è½¬ JMP FAR 004B:0041840D æˆåŠŸçš„è¯ï¼ŒCSæ®µå¯„å­˜å™¨å°±ä¼šä¿®æ”¹æˆ4B 3.3 ä¿®æ”¹æ®µæè¿°ç¬¦çš„æƒé™çº§åˆ«,å¹¶å†æ¬¡åœ¨ODä¸­è¿›è¡Œæµ‹è¯•å°†00cffb00`0000ffff æ”¹ä¸º00cf9b00`0000ffffåœ¨ODä¸­ï¼Œæ‰§è¡Œè·¨æ®µè·³è½¬ JMP FAR 004B:0041840D 3.4 å°†è¯¥æ®µæè¿°ç¬¦çš„å±æ€§æ›´æ”¹ä¸ºä¸€è‡´ä»£ç æ®µ.å°†00cffb00`0000ffff æ”¹ä¸º00cf9f00`0000ffffåœ¨ODä¸­ï¼Œæ‰§è¡Œè·¨æ®µè·³è½¬ JMP FAR 004B:0041840D å¦‚æœæ˜¯ä¸€è‡´ä»£ç æ®µï¼Œè¦æ±‚:CPL &gt;&#x3D; DPL (å½“å‰åŒæ ·å¯ä»¥è®¿é—®) CPL:3 DPL:0 4ã€æ€»ç»“1ã€ä¸ºäº†å¯¹æ•°æ®è¿›è¡Œä¿æŠ¤ï¼Œæ™®é€šä»£ç æ®µæ˜¯ç¦æ­¢ä¸åŒçº§åˆ«è¿›è¡Œè®¿é—®çš„ã€‚ç”¨æˆ·æ€çš„ä»£ç ä¸èƒ½è®¿é—®å†…æ ¸çš„æ•°æ®ï¼ŒåŒæ ·ï¼Œå†…æ ¸æ€çš„ä»£ç ä¹Ÿä¸èƒ½è®¿é—®ç”¨æˆ·æ€çš„æ•°æ®. 2ã€å¦‚æœæƒ³æä¾›ä¸€äº›é€šç”¨çš„åŠŸèƒ½ï¼Œè€Œä¸”è¿™äº›åŠŸèƒ½å¹¶ä¸ä¼šç ´åå†…æ ¸æ•°æ®ï¼Œé‚£ä¹ˆå¯ä»¥é€‰æ‹©ä¸€è‡´ä»£ç æ®µï¼Œè¿™æ ·ä½çº§åˆ«çš„ç¨‹åºå¯ä»¥åœ¨ä¸æå‡CPLæƒé™ç­‰çº§çš„æƒ…å†µä¸‹å³å¯ä»¥è®¿é—®. 3ã€å¦‚æœæƒ³è®¿é—®æ™®é€šä»£ç æ®µï¼Œåªæœ‰é€šè¿‡â€œè°ƒç”¨é—¨â€ç­‰æç¤ºCPLæƒé™ï¼Œæ‰èƒ½è®¿é—®ã€‚ é•¿è°ƒç”¨ä¸çŸ­è°ƒç”¨æˆ‘ä»¬é€šè¿‡JMP FARå¯ä»¥å®ç°æ®µé—´çš„è·³è½¬ï¼Œå¦‚æœè¦å®ç°è·¨æ®µçš„è°ƒç”¨å°±å¿…é¡»è¦å­¦ä¹ CALL FARï¼Œä¹Ÿå°±æ˜¯é•¿è°ƒç”¨. CALL FARæ¯”JMP FARè¦å¤æ‚ï¼ŒJMPå¹¶ä¸å½±å“å †æ ˆ,ä½†CALLæŒ‡ä»¤ä¼šå½±å“. 1ã€çŸ­è°ƒç”¨æŒ‡ä»¤æ ¼å¼ï¼šCALL ç«‹å³æ•°&#x2F;å¯„å­˜å™¨&#x2F;å†…å­˜ å‘ç”Ÿæ”¹å˜çš„å¯„å­˜å™¨ï¼šESP EIP 2ã€é•¿è°ƒç”¨(è·¨æ®µä¸ææƒ)æŒ‡ä»¤æ ¼å¼ï¼šCALL CS:EIP(EIPæ˜¯åºŸå¼ƒçš„) å‘ç”Ÿæ”¹å˜çš„å¯„å­˜å™¨ï¼šESP EIP CS 3ã€é•¿è°ƒç”¨(è·¨æ®µå¹¶ææƒ)æŒ‡ä»¤æ ¼å¼ï¼šCALL CS:EIP(EIPæ˜¯åºŸå¼ƒçš„) å‘ç”Ÿæ”¹å˜çš„å¯„å­˜å™¨ï¼šESP EIP CS SS 4ã€æ€»ç»“ è·¨æ®µè°ƒç”¨æ—¶ï¼Œä¸€æ—¦æœ‰æƒé™åˆ‡æ¢ï¼Œå°±ä¼šåˆ‡æ¢å †æ ˆ. CSçš„æƒé™ä¸€æ—¦æ”¹å˜ï¼ŒSSçš„æƒé™ä¹Ÿè¦éšç€æ”¹å˜ï¼ŒCSä¸SSçš„ç­‰çº§å¿…é¡»ä¸€æ ·. JMP FAR åªèƒ½è·³è½¬åˆ°åŒçº§éä¸€è‡´ä»£ç æ®µï¼Œä½†CALL FARå¯ä»¥é€šè¿‡è°ƒç”¨é—¨ææƒï¼Œæå‡CPLçš„æƒé™. è°ƒç”¨é—¨1ã€è°ƒç”¨é—¨æ‰§è¡Œæµç¨‹æŒ‡ä»¤æ ¼å¼ï¼šCALL CS:EIP(EIPæ˜¯åºŸå¼ƒçš„) æ‰§è¡Œæ­¥éª¤ï¼š æ ¹æ®CSçš„å€¼ æŸ¥GDTè¡¨ï¼Œæ‰¾åˆ°å¯¹åº”çš„æ®µæè¿°ç¬¦ è¿™ä¸ªæè¿°ç¬¦æ˜¯ä¸€ä¸ªè°ƒç”¨é—¨. åœ¨è°ƒç”¨é—¨æè¿°ç¬¦ä¸­å­˜å‚¨å¦ä¸€ä¸ªä»£ç æ®µæ®µçš„é€‰æ‹©å­. é€‰æ‹©å­æŒ‡å‘çš„æ®µ æ®µ.Base + åç§»åœ°å€ å°±æ˜¯çœŸæ­£è¦æ‰§è¡Œçš„åœ°å€. 2ã€é—¨æè¿°ç¬¦ ï¼ˆ16-31ä½ï¼‰offset+ï¼ˆ0-15ä½ï¼‰offset &#x3D; è·³è½¬åˆ°å‡½æ•°æ‰§è¡Œçš„ä½ç½® 3ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæ— å‚ ææƒï¼‰1234567891011ç¬¬ä¸€æ­¥ï¼šæ„é€ å¤§æ¦‚çš„å€¼DPL:3ç¯ == 110000 0000 0000 0000 1110 1100(è°ƒç”¨é—¨å›ºå®šå€¼) 0000 0000 == 0000ec000000 0000 0000 1000 0000 0000 0000 0000 == 000800000000ec00`00080000ç¬¬äºŒæ­¥ï¼šæ‹¿åˆ°æ–¹æ³•åœ°å€4010000040ec00`00081000ç¬¬ä¸‰æ­¥ï¼šeq 80b99048 0040ec00`00081000ç¬¬å››æ­¥ï¼šè¿è¡Œç¨‹åº 3.1 ä»£ç æµ‹è¯•æ­¥éª¤ä¸€ï¼šä»£ç æµ‹è¯•ï¼Œå¹¶è§‚å¯Ÿå †æ ˆä¸å¯„å­˜å™¨çš„å˜åŒ–è®°å½•æ‰§è¡Œå‰çš„å¯„å­˜å™¨å€¼ï¼šSS ESP CS æ‰§è¡Œå‰ï¼š æ‰§è¡Œåï¼š 1234567eax=00000048 ebx=7ffd9000 ecx=00000000 edx=00000001 esi=00000000 edi=0012fe5ceip=00401000 esp=a69f5ca0 ebp=0012fe5c iopl=0 nv up ei pl nz na pe nccs=0008 ss=0010 ds=0023 es=0023 fs=0030 gs=0000 efl=00000206 å˜åŒ–ï¼š 12345CS:1b-&gt;08 ESP:12fd7c-&gt;a682bca0(é«˜åœ°å€)SS:23-&gt;10 å †æ ˆï¼š æ­¥éª¤äºŒï¼šåœ¨æµ‹è¯•ä»£ç ä¸­åŠ å…¥ç‰¹æƒæŒ‡ä»¤å¹¶è¯»å–é«˜2Gå†…å­˜ æµ‹è¯•ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950BYTE GDT[6] = &#123;0&#125;;DWORD dwH2Gvalue;void _declspec(naked) getRegister()&#123;\t__asm&#123; pushad pushfd mov eax,0x80b9900c mov ebx,[eax] mov dwH2Gvalue,ebx sgdt GDT //è·å–GDTè¡¨åœ°å€ popfd popad retf\t&#125;&#125;void printfRegister()&#123;\tDWORD GDT_ADDR = *(PDWORD)(&amp;GDT[2]);\tWORD GDT_LIMIT = *(PWORD)(&amp;GDT[0]);\tprintf(&quot;%x %x %x &quot;,dwH2Gvalue,GDT_ADDR,GDT_LIMIT);&#125;int testfun1()&#123;\t__asm&#123; mov ebx,ebx mov ebx,ebx\t&#125;\tchar buf[6];\t*(DWORD*)&amp;buf[0] = 0x12345678;\t*(WORD*)&amp;buf[4] = 0x48;\t__asm&#123; call fword ptr[buf]\t&#125;\tprintfRegister();\tgetchar();\treturn 0;&#125;int _tmain(int argc, _TCHAR* argv[])&#123;\ttestfun1();\treturn 0;&#125; 4ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæœ‰å‚ ææƒï¼‰è°ƒç”¨é—¨æè¿°ç¬¦ï¼š 0040EC03&#96;00081030 ï¼ˆä¸‰ä¸ªå‚æ•°ï¼‰ 1kd&gt;eq 8003f048 0040EC03`00081030 æµ‹è¯•ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657// demo03.cpp : å®šä¹‰æ§åˆ¶å°åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ã€‚//#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;DWORD x,y,z;void _declspec(naked) getRegister()&#123;\t__asm&#123; pushad pushfd mov eax,[esp+0x24+0x8+0x8] mov dword ptr ds:[x],eax mov eax,[esp+0x24+0x8+0x4] mov dword ptr ds:[y],eax mov eax,[esp+0x24+0x8+0x0] mov dword ptr ds:[z],eax popfd popad retf 0xc\t&#125;&#125;void printfRegister()&#123;\tprintf(&quot;%x %x %x &quot;,x,y,z);&#125;int testfun1()&#123; char buf[6];\t*(DWORD*)&amp;buf[0] = 0x12345678;\t*(WORD*)&amp;buf[4] = 0x68;\t__asm&#123; push 1 push 2 push 3 call fword ptr[buf]\t&#125;\tprintfRegister();\tgetchar();\treturn 0;&#125;int _tmain(int argc, _TCHAR* argv[])&#123;\ttestfun1();\treturn 0;&#125; æˆåŠŸè·å–åˆ°3ä¸ªä¼ å…¥çš„å‚æ•° 5ã€æ€»ç»“ å½“é€šè¿‡é—¨ï¼Œæƒé™ä¸å˜çš„æ—¶å€™ï¼Œåªä¼šPUSHä¸¤ä¸ªå€¼ï¼šCSå’Œè¿”å›åœ°å€æ–°çš„CSçš„å€¼ç”±è°ƒç”¨é—¨å†³å®š å½“é€šè¿‡é—¨ï¼Œæƒé™æ”¹å˜çš„æ—¶å€™ï¼Œä¼šPUSHå››ä¸ªå€¼ï¼šSSã€ESPã€CSå’Œè¿”å›åœ°å€ æ–°çš„CSçš„å€¼ç”±è°ƒç”¨é—¨å†³å®š æ–°çš„SSå’ŒESPç”±TSSæä¾› é€šè¿‡é—¨è°ƒç”¨æ—¶ï¼Œè¦æ‰§è¡Œå“ªè¡Œä»£ç æœ‰è°ƒç”¨é—¨å†³å®šï¼Œä½†ä½¿ç”¨RETFè¿”å›æ—¶ï¼Œç”±å †æ ˆä¸­å‹å…¥çš„å€¼å†³å®šï¼Œè¿™å°±æ˜¯è¯´ï¼Œè¿›é—¨æ—¶åªèƒ½æŒ‰æŒ‡å®šè·¯çº¿èµ°ï¼Œå‡ºé—¨æ—¶å¯ä»¥ç¿»å¢™(åªè¦æ”¹å˜å †æ ˆé‡Œé¢çš„å€¼å°±å¯ä»¥æƒ³å»å“ªå»å“ª) å¯ä¸å¯ä»¥å†å»ºä¸ªé—¨å‡ºå»å‘¢?ä¹Ÿå°±æ˜¯ç”¨Call å½“ç„¶å¯ä»¥äº† å‰é—¨è¿› åé—¨å‡º ä¸­æ–­é—¨ä½¿ç”¨åœºæ™¯ ç³»ç»Ÿè°ƒç”¨ 1å¤§å®¶åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶éƒ½ä¼šä½¿ç”¨åˆ°Windowsæä¾›çš„APIï¼Œè¿™äº›APIåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­éœ€è¦ä»3ç¯ä¸€æ­¥ä¸€æ­¥è¿›å…¥åˆ°0ç¯ï¼Œè¿™ä¸€è¿‡ç¨‹å°±æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿç”¨åˆ°äº†ä¸­æ–­é—¨ï¼ˆä¸€äº›æ¯”è¾ƒè€çš„APIä½¿ç”¨çš„æ˜¯ä¸­æ–­é—¨ï¼Œä½†æ˜¯æ–°APIä¸­ä½¿ç”¨çš„éƒ½æ˜¯å¿«é€Ÿè°ƒç”¨ï¼‰ è°ƒè¯• 1å¤§å®¶ä½¿ç”¨ODè°ƒè¯•ç¨‹åºæ—¶å€™ä¼šä½¿ç”¨æ–­ç‚¹ï¼Œæ–­ç‚¹æœ¬è´¨ä¸Šå°±æ˜¯åœ¨ä½ é€‰ä¸­çš„è¿™ä¸€è¡Œä¸­å†™å…¥ä¸€ä¸ªå­—èŠ‚0xCCï¼Œä¹Ÿå°±æ˜¯INT 3æŒ‡ä»¤ï¼Œè¿™ä¸ªæŒ‡ä»¤å°±æ˜¯ç”¨æ¥æ‰§è¡Œä¸­æ–­é—¨çš„ã€‚ä¸­æ–­é—¨ä¹Ÿæœ‰ä¸€å¼ è¡¨ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºIDTï¼ˆä¸­æ–­æè¿°ç¬¦è¡¨ï¼‰ï¼Œä¸GDTä¸€æ ·ï¼ŒIDTä¹Ÿæ˜¯ç”±ä¸€ç³»åˆ—æè¿°ç¬¦ç»„æˆçš„ï¼Œæ¯ä¸ªæè¿°ç¬¦å 8å­—èŠ‚ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯IDTè¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸æ˜¯NULLï¼ˆGDTæ˜¯ï¼‰ 1ã€IDTIDTå³ä¸­æ–­æè¿°ç¬¦è¡¨,åŒGDTä¸€æ ·ï¼ŒIDTä¹Ÿæ˜¯ç”±ä¸€ç³»åˆ—æè¿°ç¬¦ç»„æˆçš„ï¼Œæ¯ä¸ªæè¿°ç¬¦å 8ä¸ªå­—èŠ‚ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼ŒIDTè¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸æ˜¯NULLã€‚åœ¨windbgä¸­æŸ¥çœ‹IDTè¡¨çš„åŸºå€å’Œé•¿åº¦ 2ã€IDTè¡¨çš„æ„æˆIDTè¡¨å¯ä»¥åŒ…å«3ç§é—¨æè¿°ç¬¦ï¼š ä»»åŠ¡é—¨æè¿°ç¬¦ ä¸­æ–­é—¨æè¿°ç¬¦ é™·é˜±é—¨æè¿°ç¬¦ 3ã€ä¸­æ–­é—¨æè¿°ç¬¦ç»“æ„ å½“8-12ä½çš„å€¼æ˜¯01110åˆ™æ˜¯ä¸€ä¸ªä¸­æ–­é—¨ å‡½æ•°æ‰§è¡Œï¼š401030 0040ee00&#96;00081030 4ã€æ„é€ ä¸€ä¸ªä¸­æ–­é—¨1234567//INT index æŒ‡ä»¤è§¦å‘å¯»æ‰¾ä¸­æ–­é—¨//å½“å‰ï¼ˆå†™å…¥çš„åœ°å€-idté¦–åœ°å€ï¼‰/ 8 = indexç´¢å¼• 16è¿›åˆ¶ __asm&#123; push fs INT 0x22 pop fs&#125; 5ã€ä¸­æ–­æ‰§è¡ŒINTXå…¶ä¸­ï¼ŒXæ˜¯ç´¢å¼•ï¼ŒX*8+IDTçš„åŸºå€å°±æ˜¯å…·ä½“çš„ä¸­æ–­é—¨æè¿°ç¬¦ 6ã€ä¸­æ–­è¿”å›INT NæŒ‡ä»¤ï¼š åœ¨æ²¡æœ‰æƒé™åˆ‡æ¢æ—¶ï¼Œä¼šå‘å †æ ˆPUSH 3ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ï¼šCS EFLAG EIPï¼ˆè¿”å›åœ°å€ï¼‰ åœ¨æœ‰æƒé™åˆ‡æ¢æ—¶ï¼Œä¼šå‘å †æ ˆPUSH 5ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ï¼šSS ESP EFLAG CS EIPï¼ˆè¿”å›åœ°å€ï¼‰ åœ¨ä¸­æ–­é—¨ä¸­ï¼Œä¸èƒ½é€šè¿‡RETFè¿”å›ï¼Œè€Œåº”è¯¥é€šè¿‡IRET&#x2F;IRETDæŒ‡ä»¤è¿”å› é™·é˜±é—¨1ã€é™·é˜±é—¨æè¿°ç¬¦ç»“æ„ å½“8-12ä½çš„å€¼æ˜¯01111åˆ™æ˜¯ä¸€ä¸ªé™·é˜±é—¨ 2ã€æ„é€ ä¸€ä¸ªé™·é˜±é—¨æ„é€ ä¸€ä¸ªé™·é˜±é—¨ï¼ˆ0040EF00 00081030ï¼‰ 0000ef00 00080000 0000 0000 0000 0000 1110 1111 0000 0000 å†™å…¥åˆ°IDTè¡¨ä¸­ 1eq&gt;8003f500 0040EF00`0008103 æ‰§è¡Œé™·é˜±é—¨ 123__asm&#123; INT 0x32&#125; 3ã€é™·é˜±é—¨ä¸ä¸­æ–­é—¨çš„åŒºåˆ«ä¸­æ–­é—¨æ‰§è¡Œæ—¶ï¼Œå°†IFä½ï¼ˆä¸­æ–­æ ‡å¿—ï¼‰æ¸…é›¶,ä½†é™·é˜±é—¨ä¸ä¼šã€‚ ä»»åŠ¡æ®µåœ¨è°ƒç”¨é—¨ã€ä¸­æ–­é—¨ä¸é™·é˜±é—¨ä¸­ï¼Œä¸€æ—¦å‡ºç°æƒé™åˆ‡æ¢ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰å †æ ˆçš„åˆ‡æ¢ã€‚è€Œä¸”ï¼Œç”±äºCSçš„CPLå‘ç”Ÿæ”¹å˜ï¼Œä¹Ÿå¯¼è‡´äº†SSä¹Ÿå¿…é¡»è¦åˆ‡æ¢ã€‚ åˆ‡æ¢æ—¶ï¼Œä¼šæœ‰æ–°çš„ESPå’ŒSS(CSæ˜¯ç”±ä¸­æ–­é—¨æˆ–è€…è°ƒç”¨é—¨æŒ‡å®š)è¿™2ä¸ªå€¼ä»å“ªé‡Œæ¥çš„å‘¢ï¼ŸTSS (Task-state segment )ï¼Œä»»åŠ¡çŠ¶æ€æ®µ. 1ã€TSSçš„ç»“æ„ å¤§å°104å­—èŠ‚ 2ã€TSSçš„ä½œç”¨ä¸è¦æŠŠTSSä¸â€œä»»åŠ¡åˆ‡æ¢â€è”ç³»åˆ°ä¸€èµ· TSSçš„æ„ä¹‰å°±åœ¨äºå¯ä»¥åŒæ—¶æ¢æ‰â€ä¸€å †â€å¯„å­˜å™¨ 3ã€TRæ®µå¯„å­˜å™¨å–å€¼CPUå¦‚ä½•æ‰¾åˆ°TSSå‘¢? é€šè¿‡TRæ®µå¯„å­˜å™¨ï¼Œbaseæ‰¾åˆ°TSSå†…å­˜ LimitæŒ‡çš„æ˜¯TSSå†…å­˜å¤§å°ï¼ŒTRæ®µå¯„å­˜å™¨å€¼æ¥è‡ªäºGDTè¡¨ï¼ŒGDTè¡¨é‡Œçš„TSSæ®µæè¿°ç¬¦ 4ã€TSSæ®µæè¿°ç¬¦(TSS Descriptor) 5ã€TRå¯„å­˜å™¨è¯»å†™ å°†TSSæ®µæè¿°ç¬¦åŠ è½½åˆ°TRå¯„å­˜å™¨ æŒ‡ä»¤ï¼šLTR è¯´æ˜ï¼š ç”¨LTRæŒ‡ä»¤å»è£…è½½çš„è¯ä»…ä»…æ˜¯æ”¹å˜TRå¯„å­˜å™¨çš„å€¼(96ä½) å¹¶æ²¡æœ‰çœŸæ­£æ”¹å˜TSS LTRæŒ‡ä»¤åªèƒ½åœ¨ç³»ç»Ÿå±‚ä½¿ç”¨ åŠ è½½åTSSæ®µæè¿°ç¬¦ä¼šçŠ¶æ€ä½ä¼šå‘ç”Ÿæ”¹å˜ 6ã€ä¿®æ”¹TRå¯„å­˜å™¨ åœ¨Ring0 æˆ‘ä»¬å¯ä»¥é€šè¿‡LTRæŒ‡ä»¤å»ä¿®æ”¹TRå¯„å­˜å™¨ åœ¨Ring3 æˆ‘ä»¬å¯ä»¥é€šè¿‡CALL FAR æˆ–è€… JMP FARæŒ‡ä»¤æ¥ä¿®æ”¹ ç”¨JMPå»è®¿é—®ä¸€ä¸ªä»£ç æ®µçš„æ—¶å€™ï¼Œæ”¹å˜çš„æ˜¯CSå’ŒEIP ï¼š 12JMP 0x48:0x123456 å¦‚æœ0x48æ˜¯ä»£ç æ®µ æ‰§è¡Œåï¼šCS--&gt;0x48 EIP--&gt;0x123456 ç”¨JMPå»è®¿é—®ä¸€ä¸ªä»»åŠ¡æ®µçš„æ—¶å€™ï¼š å¦‚æœ0x48æ˜¯TSSæ®µæè¿°ç¬¦ï¼Œå…ˆä¿®æ”¹TRå¯„å­˜å™¨ï¼Œåœ¨ç”¨TR.BaseæŒ‡å‘çš„TSSä¸­çš„å€¼ä¿®æ”¹å½“å‰çš„å¯„å­˜å™¨ æ³¨æ„ï¼š å¦‚æœä½ ç”¨JMPçš„è¯Previous Task Linkçš„å€¼ä¸å˜å’ŒNTä½ä¸å˜ï¼Œæ²¡æœ‰äººç»™ä½ å¡«å……åˆå§‹å€¼å¤šå°‘ç°åœ¨å°±å¤šå°‘ï¼Œå¦‚æœç”¨Callé‚£å°±ä¼šå†™æˆåŸæ¥é‚£ä¸ªTSSæ®µçš„é€‰æ‹©å­å’ŒNTä½ç½®1 NT &#x3D; 0 IRETï¼ˆå †æ ˆå– ä¸­æ–­è¿”å›ï¼‰ NT &#x3D; 1 IRET ï¼ˆTSS:PTL ä¸æ˜¯ä¸­æ–­è¿”å›ï¼‰ 7ã€å®ç°ä»»åŠ¡åˆ‡æ¢ æ„é€ å®Œæ•´çš„TSS æ„é€ TSSæ®µæè¿°ç¬¦ ä½¿ç”¨CALL FAR&#x2F;JMP FARæŒ‡ä»¤ä¿®æ”¹TRå¯„å­˜å™¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071#include &lt;stdio.h&gt;#include &lt;windows.h&gt; int o_eax, n_esp;short n_cs, n_ss; void __declspec(naked) GetValue() &#123; // å°†å¯„å­˜å™¨ä¿å­˜åˆ°å…¨å±€å˜é‡ä¸­ _asm &#123; mov o_eax, eax mov n_esp, esp mov ax, cs mov n_cs, ax mov ax, ss mov n_ss, ax mov eax, o_eax iretd &#125;&#125; void main()&#123; char stack[100] = &#123;0&#125;; // æ ˆ char buffer[6] = &#123;0x0, 0x0, 0x0, 0x0, 0x4B, 0x0&#125;; // é€‰æ‹©å­ int iCr3 = 0; printf(&quot;Input: &quot;); scanf(&quot;%x&quot;, &amp;iCr3); getchar(); DWORD tss[0x68] = &#123; 0x00000000, // Previous Task Link // ä¸åŒæƒé™å¯¹åº”çš„ESPã€SSï¼Œå¦‚æœä¸æ¶‰åŠåˆ°æƒé™åˆ‡æ¢æ‰€ä»¥å¯ä»¥å°†è¿™äº›å¯„å­˜å™¨çš„å€¼å…¨éƒ¨å¡«0 0x00000000, // ESP0 0x00000000, // SS0 0x00000000, // ESP1 0x00000000, // SS1 0x00000000, // ESP2 0x00000000, // SS2 (DWORD)iCr3, // Cr3ï¼Œä¸é¡µçš„çŸ¥è¯†æœ‰å…³ï¼Œå¿…é¡»è¦èµ‹å€¼ 0x00401020, // EIPï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œä»£ç çš„ä½ç½®ï¼Œå¿…é¡»è¦èµ‹å€¼ï¼Œåœ¨ä»£ç ä¸­å°±æ˜¯GetValueå‡½æ•°çš„åœ°å€ 0x00000000, // EFLAGS 0x00000000, // EAX 0x00000000, // ECX 0x00000000, // EDX 0x00000000, // EBX (DWORD)stack, // ESPï¼Œä»»åŠ¡åˆ‡æ¢æ—¶ä¹Ÿéœ€è¦åˆ‡æ¢æ ˆï¼Œæ‰€ä»¥åœ¨ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥å£°æ˜ä¸€ä¸ªæ•°ç»„ï¼Œå°†å…¶åœ°å€ä½œä¸ºä¸€å—æ ˆ 0x00000000, // EBP 0x00000000, // ESI 0x00000000, // EDI 0x00000023, // ES 0x00000008, // CSï¼Œåˆ‡åˆ°0ç¯çš„ä»£ç æ®µæè¿°ç¬¦ 0x00000010, // SSï¼ŒCSä¸SSéœ€è¦ä¿æŒä¸€è‡´ 0x00000023, // DS 0x00000030, // FSï¼Œåˆ‡åˆ°0ç¯å°±æ˜¯0x30ï¼Œ3ç¯å°±æ˜¯0x3B 0x00000000, // GSï¼ŒWindowsæ²¡æœ‰ä½¿ç”¨è¿™ä¸ªæ®µå¯„å­˜å™¨æ‰€ä»¥æ°¸è¿œæ˜¯0 0x00000000, // LDTï¼Œå¡«0 0x20ac0000 // IO_MAPï¼ŒWindows2000ä»¥åä¸ç”¨äº†ï¼Œé»˜è®¤å€¼ &#125;; _asm &#123; push fs call far fword ptr[buffer] // é•¿è°ƒç”¨ pop fs &#125; // è¾“å‡ºå¯„å­˜å™¨çš„å€¼è¯æ˜å®Œæˆäº†ä»»åŠ¡åˆ‡æ¢ printf(&quot;ESP: %x, CS: %x, SS: %x &quot;, n_esp, n_cs, n_ss); getchar();&#125; æ ¹æ®TSSæ®µæè¿°ç¬¦çš„ç»“æ„æ„é€ æè¿°ç¬¦ï¼Œé¦–å…ˆè·å–TSSçš„åœ°å€ï¼Œåœ¨ä»£ç ä¸­ä¸‹æ–­ç‚¹ç„¶åæŸ¥çœ‹åœ°å€å³å¯ï¼šå…¶åœ°å€ä¸º0x0012fd70 æˆ‘ä»¬å°±å¾—å‡ºå¯¹åº”TSSæ®µæè¿°ç¬¦ä¸­Baseçš„å€¼ï¼Œæ¥ç€Limitå°±æ˜¯TSSçš„å¤§å°0x68ï¼ŒDPLä¸º3ï¼ˆ3ç¯ç¨‹åºè®¿é—®ï¼‰ TypeåŸŸä¸º0x9å³è¡¨ç¤ºå½“å‰æè¿°ç¬¦æ²¡æœ‰è¢«åŠ è½½è¿‡ã€‚ åœ¨Windbgä¸­æ–­ç‚¹è¾“å…¥ 1kd&gt; !process 0 0 æŒ‡ä»¤æ‰¾åˆ°å½“å‰çš„ç¨‹åºè·å–Cr3çš„å€¼å¡«å…¥åˆ°ç¨‹åºä¸­ æœ€ç»ˆå¾—å‡ºTSSæ®µæè¿°ç¬¦ä¸ºï¼š æ„é€ TSSæ®µæè¿°ç¬¦ï¼šXX00e9XX&#96;XXXX0068 1234tss:0x0012fc2ceq 8003f0c0 0000e912`fc2c0068cr3:bf3915e0 getValue 4113d0 æ¥ç€æˆ‘ä»¬ä½¿ç”¨eqæŒ‡ä»¤åœ¨Windbgä¸­å‘GDTè¡¨ä¸­å†™å…¥æˆ‘ä»¬æ„é€ å¥½çš„TSSæ®µæè¿°ç¬¦ï¼š é€šè¿‡windbgå¯„å­˜å™¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°EIP,ESP,CS,SSå˜æˆäº†æˆ‘ä»¬è®¾ç½®çš„å€¼ ä»»åŠ¡é—¨1ã€ä»»åŠ¡é—¨æè¿°ç¬¦ 12æ„é€ ä»»åŠ¡é—¨ï¼š0000 e500 00c3 0000&gt;eq 8003f500 0000e500`00c30000 2ã€ä»»åŠ¡é—¨æ‰§è¡Œè¿‡ç¨‹ï¼š INT N æŸ¥IDTè¡¨ï¼Œæ‰¾åˆ°ä¸­æ–­é—¨æè¿°ç¬¦ é€šè¿‡ä¸­æ–­é—¨æè¿°ç¬¦ï¼ŒæŸ¥GDTè¡¨ï¼Œæ‰¾åˆ°ä»»åŠ¡æ®µæè¿°ç¬¦ ä½¿ç”¨TSSæ®µä¸­çš„å€¼ä¿®æ”¹å¯„å­˜å™¨ IRETDè¿”å› 3ã€ä»£ç æ®µé€‰æ‹©å­ä¸€å®šè¦è®¡ç®—æ­£ç¡® 1234idt 0x20 æ„é€ ä¸­æ–­é—¨eq 8003f500 0000e500`004b0000gdt 0x4b æ„é€ ä»»åŠ¡é—¨ 0100 1011 RPLï¼š3 eq 8003f048 0000e912`fd700068 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172// demo07.cpp : Defines the entry point for the console application.//#include &quot;stdafx.h&quot;#include &lt;stdio.h&gt;#include &lt;windows.h&gt; DWORD dwOK,dwESP,dwCS; void __declspec(naked) GetValue() &#123; // å°†å¯„å­˜å™¨ä¿å­˜åˆ°å…¨å±€å˜é‡ä¸­\tdwOK = 1;\t_asm &#123; mov eax,esp mov dwESP,eax mov ax,cs mov word ptr[dwCS],ax iretd &#125;&#125;int main()&#123; char stack[100] = &#123;0&#125;; // æ ˆ char buffer[6] = &#123;0x0, 0x0, 0x0, 0x0, 0xC0, 0x0&#125;; // é€‰æ‹©å­ int iCr3 = 0;\tprintf(&quot;Input: &quot;); scanf(&quot;%x&quot;, &amp;iCr3); getchar();\tDWORD tss[0x68] = &#123; 0x00000000, // Previous Task Link // ä¸åŒæƒé™å¯¹åº”çš„ESPã€SSï¼Œå¦‚æœä¸æ¶‰åŠåˆ°æƒé™åˆ‡æ¢æ‰€ä»¥å¯ä»¥å°†è¿™äº›å¯„å­˜å™¨çš„å€¼å…¨éƒ¨å¡«0 0x00000000, // ESP0 0x00000000, // SS0 0x00000000, // ESP1 0x00000000, // SS1 0x00000000, // ESP2 0x00000000, // SS2 (DWORD)iCr3, // Cr3ï¼Œä¸é¡µçš„çŸ¥è¯†æœ‰å…³ï¼Œå¿…é¡»è¦èµ‹å€¼ (ULONG)GetValue, // EIPï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œä»£ç çš„ä½ç½®ï¼Œå¿…é¡»è¦èµ‹å€¼ï¼Œåœ¨ä»£ç ä¸­å°±æ˜¯GetValueå‡½æ•°çš„åœ°å€ 0x00000000, // EFLAGS 0x00000000, // EAX 0x00000000, // ECX 0x00000000, // EDX 0x00000000, // EBX (DWORD)stack, // ESPï¼Œä»»åŠ¡åˆ‡æ¢æ—¶ä¹Ÿéœ€è¦åˆ‡æ¢æ ˆï¼Œæ‰€ä»¥åœ¨ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥å£°æ˜ä¸€ä¸ªæ•°ç»„ï¼Œå°†å…¶åœ°å€ä½œä¸ºä¸€å—æ ˆ 0x00000000, // EBP 0x00000000, // ESI 0x00000000, // EDI 0x00000023, // ES 0x00000008, // CSï¼Œåˆ‡åˆ°0ç¯çš„ä»£ç æ®µæè¿°ç¬¦ 0x00000010, // SSï¼ŒCSä¸SSéœ€è¦ä¿æŒä¸€è‡´ 0x00000023, // DS 0x00000030, // FSï¼Œåˆ‡åˆ°0ç¯å°±æ˜¯0x30ï¼Œ3ç¯å°±æ˜¯0x3B 0x00000000, // GSï¼ŒWindowsæ²¡æœ‰ä½¿ç”¨è¿™ä¸ªæ®µå¯„å­˜å™¨æ‰€ä»¥æ°¸è¿œæ˜¯0 0x00000000, // LDTï¼Œå¡«0 0x20ac0000 // IO_MAPï¼ŒWindows2000ä»¥åä¸ç”¨äº†ï¼Œé»˜è®¤å€¼ &#125;;\tprintf(&quot;TSS:%x &quot;,&amp;tss);\tgetchar();\t_asm &#123; PUSH fs INT 0X20 // é•¿è°ƒç”¨ POP fs &#125;\t// è¾“å‡ºå¯„å­˜å™¨çš„å€¼è¯æ˜å®Œæˆäº†ä»»åŠ¡åˆ‡æ¢ printf(&quot;ESP: %x, CS: %x, dwOK: %x &quot;, dwESP, dwCS, dwOK);\tgetchar();\treturn 0;&#125; åˆ†é¡µ1ã€4GBç©ºé—´ 2ã€ç‰©ç†åœ°å€åœ°å€åˆ†ä¸ºï¼šçº¿æ€§åœ°å€ã€æœ‰æ•ˆåœ°å€ã€ç‰©ç†åœ°å€ æŒ‡ä»¤ï¼š 1MOV eax,dword ptr ds:[0x12345678] 0x12345678æ˜¯å±äºæœ‰æ•ˆåœ°å€ ds.base+0x12345678 &#x3D; çº¿æ€§åœ°å€ 3ã€ç‰©ç†åœ¨å“ªæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªCR3ï¼Œ(å‡†ç¡®çš„è¯´æ˜¯éƒ½ä¸€ä¸ªCR3çš„å€¼ï¼ŒCR3æœ¬èº«æ˜¯ä¸ªå¯„å­˜å™¨ï¼Œä¸€ä¸ªæ ¸ï¼Œåªæœ‰ä¸€å¥—å¯„å­˜å™¨) CR3æŒ‡å‘ä¸€ä¸ªç‰©ç†é¡µï¼Œä¸€å…±4096å­—èŠ‚ 4ã€è®¾ç½®åˆ†é¡µæ–¹å¼ å°†noexecute æ”¹æˆ execute 5ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ10-10-12ä¸ºä¾‹ï¼‰10-10-12 ä¸€å…±32ä½ï¼ŒæŠŠä¸€æ®µåœ°å€æ‹†åˆ†æˆä¸‰æ®µ10ä½ 10ä½ 12ä½ ç”¨notepadä¸ºä¾‹ ç¬¬ä¸€æ­¥å…ˆåœ¨notepadä¸­å†™å…¥ä¸€ä¸ªhello worldå­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨CEè¿›è¡Œæœç´¢æ‹¿åˆ°å­—ç¬¦ä¸²åœ¨è¿›ç¨‹ä¸­çš„åœ°å€ ç¬¬äºŒæ­¥æ‹†åˆ†åœ°å€ 1234000AA750 hello worldå­—ç¬¦ä¸²åœ¨è¿›ç¨‹ä¸­åœ°å€ç¬¬ä¸€çº§ï¼š0000 0000 00 0ç¬¬äºŒçº§ï¼š00 1010 1010 AA * 4 = 2A8ç¬¬ä¸‰çº§ï¼š750 ç¬¬ä¸‰æ­¥windbgè¿›è¡ŒæŸ¥çœ‹æ‰¾åˆ°cr3çš„å€¼ 12345DirBase:314b7000ç¬¬ä¸€çº§ï¼š!dd cr3+0 = 314b7000+0ç¬¬äºŒçº§ï¼š!dd 3192d067+2A8 åé¢ä¸‰ä½æ˜¯å±æ€§ä½¿ç”¨æ—¶æ”¹æˆ000ç¬¬ä¸‰çº§ï¼š!dd 319ed000+750!db 319ed000+750 å¯éªŒè¯ PDE&#x2F;PTEPDEå’ŒPTEä»‹ç»1ã€PDEä¸PTE 2ã€æŒ‡å‘ç›¸åŒç‰©ç†é¡µ PTEå¯ä»¥æ²¡æœ‰ç‰©ç†é¡µï¼Œä¸”åªèƒ½å¯¹åº”ä¸€ä¸ªç‰©ç†é¡µ å¤šä¸ªPTEä¹Ÿå¯ä»¥æŒ‡å‘åŒä¸€ä¸ªç‰©ç†é¡µ 3ã€å®éªŒæŸ¥åˆ†0åœ°å€ï¼Œè§‚å¯ŸPTEæ˜¯å¦æœ‰ç‰©ç†é¡µ å‘0åœ°å€è¯»å†™æ•°æ® æ²¡æœ‰æŒ‚ç‰©ç†é¡µä¹‹å‰å‘0åœ°å€å†™å…¥ä¸äº†æ•°æ® æ‰‹åŠ¨æŒ‚ç‰©ç†é¡µ 12345678910111213141516171819202122232425262728293031323334353637383940414243xçš„çº¿æ€§åœ°å€ï¼š0x1245052å…ˆæ‹†åˆ†0000 0001 00 1010 0100 0101 245 * 4 = 914052DirBase: 553aa000ç¬¬ä¸€çº§ï¼škd&gt; !dd 553aa000#553aa000 54ad6067 54a95067 00000000 00000000#553aa010 00000000 00000000 00000000 00000000#553aa020 00000000 00000000 00000000 00000000#553aa030 00000000 00000000 00000000 00000000#553aa040 00000000 00000000 00000000 00000000#553aa050 00000000 00000000 00000000 00000000#553aa060 00000000 00000000 00000000 00000000#553aa070 00000000 00000000 00000000 00000000ç¬¬äºŒçº§ï¼škd&gt; !dd 54ad6000 + 914#54ad6914 54df5067 00000000 00000000 00000000#54ad6924 00000000 00000000 00000000 00000000#54ad6934 00000000 00000000 00000000 5576d067#54ad6944 5556f067 553b0067 00000000 00000000#54ad6954 00000000 00000000 00000000 00000000#54ad6964 00000000 00000000 00000000 00000000#54ad6974 00000000 00000000 00000000 0bb31025#54ad6984 0bb32025 00000000 00000000 00000000æŸ¥è¯¢ä¸‹0åœ°å€kd&gt; !dd 54ad6000#54ad6000 00000000 00000000 00000000 00000000#54ad6010 00000000 00000000 00000000 00000000#54ad6020 00000000 00000000 00000000 00000000#54ad6030 00000000 00000000 00000000 00000000#54ad6040 54e97067 00000000 00000000 00000000#54ad6050 00000000 00000000 00000000 00000000#54ad6060 00000000 00000000 00000000 00000000#54ad6070 00000000 00000000 00000000 00000000æŠŠå½“å‰xå˜é‡çš„ç‰©ç†é¡µæŒ‚åˆ°0åœ°å€ä¸Škd&gt; !ed 54ad6000 54df5067 PDE&#x2F;PTE å±æ€§1ã€ç‰©ç†é¡µçš„å±æ€§ç‰©ç†é¡µçš„å±æ€§ &#x3D; PDEå±æ€§ &amp; PTEå±æ€§ 2ã€Pä½PDEå’ŒPTEçš„Pä½å¦‚æœä¸º0ï¼Œåˆ™å½“å‰çš„ç‰©ç†é¡µæ˜¯æ— æ•ˆçš„ï¼Œåä¹‹ 3ã€R&#x2F;Wä½R&#x2F;W &#x3D; 0 åªè¯» R&#x2F;W &#x3D; 1 å¯è¯»å¯å†™ 12345678910111213141516#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;int main(int argc, char* argv[])&#123;\tchar* str = &quot;hello world&quot;;\tprintf(&quot;%x &quot;,str);\tgetchar();\tDWORD dwAddr = (DWORD)str;\t*(char*)dwAddr = &#x27;M&#x27;;\tprintf(&quot;%s &quot;,str);\treturn 0;&#125; å·²çŸ¥ä¸Šé¢ä»£ç åœ¨æ­£å¸¸æƒ…å†µä¸‹stræ˜¯åªè¯»çš„ï¼Œåç»­æ˜¯æ— æ³•å¯¹å®ƒè¿›è¡Œä»»ä½•çš„ä¿®æ”¹æ“ä½œçš„ã€‚ä¼šæŠ¥é”™å†…å­˜è®¿é—®å¼‚å¸¸ ç°åœ¨æˆ‘ä»¬å¯¹R&#x2F;Wä½è¿›è¡ŒæŸ¥è¯¢ 123456789101112131415161718192021222324250x420f94Dirbase:7f4fd0000000 0000 01 00 0010 0000 20*4=80f94ç¬¬ä¸€çº§ï¼škd&gt; !dd 7f4fd000#7f4fd000 7f57b067 7f7ba067 00000000 00000000#7f4fd010 00000000 00000000 00000000 00000000#7f4fd020 00000000 00000000 00000000 00000000#7f4fd030 00000000 00000000 00000000 00000000#7f4fd040 00000000 00000000 00000000 00000000#7f4fd050 00000000 00000000 00000000 00000000#7f4fd060 00000000 00000000 00000000 00000000#7f4fd070 00000000 00000000 00000000 00000000ç¬¬äºŒçº§ï¼škd&gt; !dd 7f7ba000 + 80#7f7ba080 7c7e9025 00000000 00de4067 7f895067#7f7ba090 7fe65067 7eb52027 00000000 00000000#7f7ba0a0 00000000 00000000 00000000 00000000#7f7ba0b0 00000000 00000000 00000000 00000000#7f7ba0c0 7f8dc067 7f7dd067 7f5de067 7f8df067#7f7ba0d0 7f960067 7fe61067 00de2067 7fbe3067#7f7ba0e0 00000000 00000000 00000000 00000000#7f7ba0f0 00000000 00000000 00000000 00000000 å¯ä»¥çœ‹åˆ°7c7e9025å¯¹åº”çš„äºŒè¿›åˆ¶æ˜¯ 10111 1100 0111 1110 1001 0000 0010 0101 è€Œç¬¬äºŒä½R/Wï¼š0 è¯´æ˜æ˜¯åªè¯»æƒé™ ç°åœ¨æˆ‘ä»¬ä¿®æ”¹7c7e9025-&gt;7c7e9027 10111 1100 0111 1110 1001 0000 0010 0111 12345678910111213141516171819kd&gt; !dd 7f7ba000 + 80#7f7ba080 7c7e9025 00000000 00de4067 7f895067#7f7ba090 7fe65067 7eb52027 00000000 00000000#7f7ba0a0 00000000 00000000 00000000 00000000#7f7ba0b0 00000000 00000000 00000000 00000000#7f7ba0c0 7f8dc067 7f7dd067 7f5de067 7f8df067#7f7ba0d0 7f960067 7fe61067 00de2067 7fbe3067#7f7ba0e0 00000000 00000000 00000000 00000000#7f7ba0f0 00000000 00000000 00000000 00000000kd&gt; !ed 7f7ba080 7c7e9027kd&gt; !dd 7f7ba000 + 80#7f7ba080 7c7e9027 00000000 00de4067 7f895067#7f7ba090 7fe65067 7eb52027 00000000 00000000#7f7ba0a0 00000000 00000000 00000000 00000000#7f7ba0b0 00000000 00000000 00000000 00000000#7f7ba0c0 7f8dc067 7f7dd067 7f5de067 7f8df067#7f7ba0d0 7f960067 7fe61067 00de2067 7fbe3067#7f7ba0e0 00000000 00000000 00000000 00000000#7f7ba0f0 00000000 00000000 00000000 00000000 ç°åœ¨çœ‹çœ‹æ•ˆæœ å·²ç»æˆåŠŸï¼ï¼ï¼ï¼ 4ã€U&#x2F;S ä½U&#x2F;S &#x3D; 0 ç‰¹æƒç”¨æˆ· U&#x2F;S &#x3D; 1 æ™®é€šç”¨æˆ· 5ã€P&#x2F;Sä½åªå¯¹PDEæœ‰æ„ä¹‰ï¼ŒPS &#x3D;&#x3D; PageSizeçš„æ„æ€ å½“PS&#x3D;&#x3D;1çš„æ—¶å€™ PDEç›´æ¥æŒ‡å‘ç‰©ç†é¡µ æ— PTE,ä½22ä½æ˜¯é¡µå†…åç§»ã€‚ä¹Ÿå°±æ˜¯è¯´å°‘ä¸€çº§åç§»ã€‚ 6ã€Aä½æ˜¯å¦è¢«è®¿é—®ï¼ˆè¯»æˆ–è€…å†™ï¼‰è¿‡ A&#x3D;1 è®¿é—®è¿‡ [!NOTE] å³ä½¿åªè®¿é—®ä¸€ä¸ªå­—èŠ‚ä¹Ÿä¼šå¯¼è‡´PDEæˆ–è€…PTEç½®1 7ã€Dä½è„ä½ï¼šæ˜¯å¦è¢«å†™è¿‡ 0ï¼šæ²¡æœ‰è¢«å†™è¿‡ 1ï¼šè¢«å†™è¿‡ é¡µç›®å½•è¡¨åŸºå€1ã€æ‹†åˆ†C0300000å½“å‰æˆ‘ä»¬ç”¨DbgViewç¨‹åºä¸ºä¾‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445DirBase: 238ef0001100 0000 00 00 300 * 4 = C0011 0000 0000 300 * 4 = C00000kd&gt; !dd 238ef000 #238ef000 237e3067 2365a067 23a2e067 23a1c067 #238ef010 00000000 00000000 00000000 00000000#238ef020 00000000 00000000 00000000 00000000#238ef030 00000000 00000000 00000000 00000000#238ef040 00000000 00000000 00000000 00000000#238ef050 00000000 00000000 00000000 00000000#238ef060 00000000 00000000 00000000 00000000#238ef070 00000000 00000000 00000000 00000000kd&gt; !dd 238ef000 + C00 PDT#238efc00 238ef063 236f0063 00000000 09f55163 //PDE#238efc10 09f56163 09f57163 09f58163 09f59163#238efc20 09f5a163 09f5b163 09f5c163 09f5d163#238efc30 09f5e163 09f5f163 09f60163 09f61163#238efc40 09f62163 09f63163 09f64163 09f65163#238efc50 09f66163 09f67163 09f68163 09f69163#238efc60 09f6a163 09f6b163 09f2c163 09f2d163#238efc70 09f2e163 09f2f163 09f30163 09f31163kd&gt; !dd 238ef000 + C00 PTT#238efc00 238ef063 236f0063 00000000 09f55163 //PTE#238efc10 09f56163 09f57163 09f58163 09f59163#238efc20 09f5a163 09f5b163 09f5c163 09f5d163#238efc30 09f5e163 09f5f163 09f60163 09f61163#238efc40 09f62163 09f63163 09f64163 09f65163#238efc50 09f66163 09f67163 09f68163 09f69163#238efc60 09f6a163 09f6b163 09f2c163 09f2d163#238efc70 09f2e163 09f2f163 09f30163 09f31163kd&gt; !dd 238ef000#238ef000 237e3067 2365a067 23a2e067 23a1c067#238ef010 00000000 00000000 00000000 00000000#238ef020 00000000 00000000 00000000 00000000#238ef030 00000000 00000000 00000000 00000000#238ef040 00000000 00000000 00000000 00000000#238ef050 00000000 00000000 00000000 00000000#238ef060 00000000 00000000 00000000 00000000#238ef070 00000000 00000000 00000000 00000000 ç»“è®ºï¼šC0300000å­˜å‚¨çš„å€¼å°±æ˜¯PDT å¦‚æœæˆ‘ä»¬è¦è®¿é—®ç¬¬Nä¸ªPDEï¼Œé‚£ä¹ˆæœ‰å¦‚ä¸‹å…¬å¼ï¼š0xC0300000 + N*4 2ã€é¡µç›®å½•è¡¨åŸºå€(XPç³»ç»Ÿ 10-10-12åˆ†é¡µæ¨¡å¼) 3ã€æ€»ç»“ é€šè¿‡0xC0300000æ‰¾åˆ°çš„ç‰©ç†é¡µå°±æ˜¯é¡µç›®å½•è¡¨ è¿™ä¸ªç‰©ç†é¡µå³æ˜¯é¡µç›®å½•è¡¨æœ¬èº«ä¹Ÿæ˜¯é¡µè¡¨ é¡µç›®å½•è¡¨æ˜¯ä¸€å¼ ç‰¹æ®Šçš„é¡µè¡¨ï¼Œæ¯ä¸€é¡¹PTEæŒ‡å‘çš„ä¸æ˜¯æ™®é€šçš„ç‰©ç†é¡µï¼Œè€Œæ˜¯æŒ‡å‘å…¶ä»–çš„é¡µè¡¨ å¦‚æœæˆ‘ä»¬è¦è®¿é—®ç¬¬Nä¸ªPDEï¼Œé‚£ä¹ˆæœ‰å¦‚ä¸‹å…¬å¼ï¼š0xC0300000 + N*4 é¡µè¡¨åŸºå€1ã€æ‹†åˆ†C0000000 &#x2F; C0001000 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859DirBase: 238ef000ç¬¬ä¸€ä¸ªPTTkd&gt; !dd 237e3000#237e3000 00000000 00000000 00000000 00000000#237e3010 00000000 00000000 00000000 00000000#237e3020 00000000 00000000 00000000 00000000#237e3030 00000000 00000000 00000000 00000000#237e3040 23764067 00000000 00000000 00000000#237e3050 00000000 00000000 00000000 00000000#237e3060 00000000 00000000 00000000 00000000#237e3070 00000000 00000000 00000000 00000000ç¬¬äºŒä¸ªPTTkd&gt; !dd 2365a000 #2365a000 238ee025 23951025 23b08025 239c9025#2365a010 23b0a025 23b8b025 23b4c025 2388d025#2365a020 2398e025 238cf025 00000000 238ad025#2365a030 00000000 239ef025 23830025 23931025#2365a040 00000000 23833025 23734025 237f5025#2365a050 236f6025 23677025 00000000 00000000#2365a060 00000000 00000000 00000000 00000000#2365a070 00000000 235a5025 23666025 00000000C000000011 0000 0000 300 * 4 = C0000 0000 0000 00kd&gt; !dd 238ef000 + C00kd&gt; !dd 238ef000 + 0kd&gt; !dd 237e3000 #237e3000 00000000 00000000 00000000 00000000#237e3010 00000000 00000000 00000000 00000000#237e3020 00000000 00000000 00000000 00000000#237e3030 00000000 00000000 00000000 00000000#237e3040 23764067 00000000 00000000 00000000#237e3050 00000000 00000000 00000000 00000000#237e3060 00000000 00000000 00000000 00000000#237e3070 00000000 00000000 00000000 00000000ç”¨0xC0000000æŸ¥å‡ºæ¥çš„æ˜¯ç¬¬ä¸€å¼ PTTè¡¨C0001000 11 0000 0000 300 * 4 = C0000 0000 0001 1 * 4 = 00kd&gt; !dd 238ef000 + C00kd&gt; !dd 238ef000 + 4kd&gt; !dd 2365a000#2365a000 238ee025 23951025 23b08025 239c9025#2365a010 23b0a025 23b8b025 23b4c025 2388d025#2365a020 2398e025 238cf025 00000000 238ad025#2365a030 00000000 239ef025 23830025 23931025#2365a040 00000000 23833025 23734025 237f5025#2365a050 236f6025 23677025 00000000 00000000#2365a060 00000000 00000000 00000000 00000000#2365a070 00000000 235a5025 23666025 00000000ç”¨0xC0001000æŸ¥å‡ºæ¥çš„æ˜¯ç¬¬äºŒå¼ PTTè¡¨ çº¿æ€§åœ°å€0xc0000000æ˜ å°„åˆ°ç¬¬ä¸€ä¸ªPTTè¡¨ï¼Œ0xC0000000åˆ°0xC0001000åˆšå¥½ç›¸å·®0x1000ç›¸å½“äºä¸€ä¸ªé¡µï¼Œåç»­åœ°å€å¢é‡ä¸º4KBï¼Œå¯¹åº”ä¸åŒçš„PTTè¡¨ã€‚ 0xc0300000çº¿æ€§åœ°å€ç”¨äºè®¿é—®é¡µç›®å½•è¡¨æœ¬èº«ã€‚æŒæ¡0xc0000000å’Œ0xc0300000ä¸¤ä¸ªåœ°å€ç­‰äºæŒæ¡äº†è¿›ç¨‹å†…å­˜çš„è¯»å†™æƒé™ æ€»ç»“ï¼š é¡µè¡¨è¢«æ˜ å°„åˆ°äº†ä»0xC0000000åˆ°0xC03FFFFFçš„4Måœ°å€ç©ºé—´ åœ¨è¿™1024ä¸ªè¡¨ä¸­æœ‰ä¸€å¼ ç‰¹æ®Šçš„è¡¨ï¼šé¡µç›®å½•è¡¨ é¡µç›®å½•è¢«æ˜ å°„åˆ°äº†0xC0300000å¼€å§‹å¤„çš„4Kåœ°å€ç©ºé—´ 2ã€æ€»ç»“PDIä¸PTIï¼š10-10-12 ï¼ˆIå°±æ˜¯Indexï¼‰ è®¿é—®é¡µç›®å½•è¡¨çš„å…¬å¼ï¼š0xC0300000 + PDI*4 è®¿é—®é¡µè¡¨çš„å…¬å¼ï¼š0xC0000000 + PDI*4096 + PTI*4 2-9-9-12åˆ†é¡µéšç€ç¡¬ä»¶çš„å‘å±•ï¼Œè¿™æ—¶å€™10-10-12åˆ†é¡µçš„ç‰©ç†åœ°å€æ˜¾ç„¶ä¸å¤Ÿç”¨ï¼Œå› æ­¤2-9-9-12åˆ†é¡µéšä¹‹äº§ç”Ÿã€‚ 1ã€10-10-12åˆ†é¡µåˆ’åˆ† å…ˆç¡®å®šäº†é¡µçš„å¤§å° 4K æ‰€ä»¥åé¢çš„12ä½çš„åŠŸèƒ½å°±ç¡®å®šäº†ã€‚(4096 &#x3D; 2^12) å½“åˆçš„ç‰©ç†å†…å­˜æ¯”è¾ƒå°ï¼Œæ‰€ä»¥4ä¸ªå­—èŠ‚çš„PTEå°±å¤Ÿäº†ï¼ŒåŠ ä¸Šé¡µçš„å°ºå¯¸æ˜¯4K æ‰€ä»¥ä¸€ä¸ªé¡µèƒ½å­˜å‚¨1024ä¸ª PTE ä¹Ÿå°±æ˜¯2çš„10æ¬¡æ–¹ ç¬¬äºŒä¸ª10ä¹Ÿå°±ç¡®å®šäº†ã€‚(4096&#x2F;4 &#x3D; 1024 &#x3D; 2^10) å‰©ä¸‹çš„10ä¸ºPDI 10+10+12åˆšå¥½32ä½ 2ã€2-9-9-12åˆ†é¡µåˆ’åˆ† é¡µçš„å¤§å°æ˜¯ç¡®å®šçš„ï¼Œ4KBä¸èƒ½éšä¾¿æ”¹ï¼Œæ‰€ä»¥12ç¡®å®šäº† å¦‚æœæƒ³å¢å¤§ç‰©ç†å†…å­˜çš„è®¿é—®èŒƒå›´ï¼Œå°±éœ€è¦å¢å¤§PTEï¼Œè€ƒè™‘å¯¹é½çš„å› ç´ ï¼Œå¢åŠ åˆ°8ä¸ªå­—èŠ‚ åŒç†PDIä¹Ÿæ˜¯2çš„9æ¬¡æ–¹32ï¼Œ2-9-9-12 è¿˜å·®2ä½ æ‰€ä»¥å°±å†åšä¸€çº§ å«PDPI 3ã€2-9-9-12åˆ†é¡µç»“æ„ PDPTEï¼šPage-Directory-Point-Table Entryé¡µç›®å½•æŒ‡é’ˆè¡¨é¡¹ æ¯é¡¹å 8ä¸ªå­—èŠ‚ ç¬¬å››é¡¹PDPTEæŒ‡å‘çš„æ˜¯ç¬¬å››å¼ PDTè¡¨æ—¶ï¼Œç¬¬å››å¼ PDTè¡¨çš„å‰å››é¡¹åˆåˆ†åˆ«æŒ‡å‘PDPTTè¡¨çš„PDPTE 12345678910111213141516171819202122æ€»ç»“å¦‚ä¸‹:\t1.ç¬¬ä¸‰ä¸ªPDPTEæŒ‡å‘äº†ä¸€ä¸ªPDTè¡¨ï¼Œæ­¤è¡¨çš„å‰å››é¡¹ æŒ‡å‘äº†PDPTEçš„æ¯ä¸€ä¸ªå…ƒç´ 2.æ ¹æ®è®¡ç®— C0600000 çš„æœ€å¤§ç´¢å¼•ï¼Œä¸ä¼šè¶…è¿‡ C0604000 mov edi, edi\t.text:0043C92A 55 push ebp\t.text:0043C92B 8B EC mov ebp, esp\t.text:0043C92D 51 push ecx\t.text:0043C92E 51 push ecx\t.text:0043C92F 8B 4D 08 mov ecx, [ebp+VirtualAddress]\t.text:0043C932 56 push esi\t.text:0043C933 8B C1 mov eax, ecx\t.text:0043C935 C1 E8 12 shr eax, 12h\t.text:0043C938 BE F8 3F 00 00 mov esi, 3FF8h\t.text:0043C93D 23 C6 and eax, esi\t.text:0043C93F 2D 00 00 A0 3F sub eax, 3FA00000hçº¿æ€§åœ°å€ &gt;&gt;18 +C0600000 ä¹Ÿå°±æ˜¯è¯´ã€‚å¾—å‡ºçš„ç´¢å¼•æ˜¯ 2^14ï¼Œæœ€å¤§å€¼4000H å®é™…åº”ç”¨ä»0å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯ 4000H-(1*8byte) é‚£ä¹ˆå¾—åˆ°æœ€åä¸€ä¸ªPDE ä¹Ÿå°±æ˜¯ C06003FFE8ï¼Œç”±æ­¤å¯æ¨å‡º C0600000æ˜¯ç¬¬ä¸€ä¸ªPDTè¡¨çš„é¦–åœ°å€\tC0601000æ˜¯ç¬¬äºŒä¸ªPDTè¡¨çš„é¦–åœ°å€ C0602000æ˜¯ç¬¬ä¸‰ä¸ªPDTè¡¨çš„é¦–åœ°å€\tC0603000æ˜¯ç¬¬å››ä¸ªPDTè¡¨çš„é¦–åœ°å€ 4ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ2-9-9-12ä¸ºä¾‹ï¼‰2-9-9-12 ä¸€å…±32ä½ï¼ŒæŠŠä¸€æ®µåœ°å€æ‹†åˆ†æˆä¸‰æ®µ2ä½ 9ä½ 9ä½ 12ä½ ç”¨notepadä¸ºä¾‹ ç¬¬ä¸€æ­¥å…ˆåœ¨notepadä¸­å†™å…¥ä¸€ä¸ªhello worldå­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨CEè¿›è¡Œæœç´¢æ‹¿åˆ°å­—ç¬¦ä¸²åœ¨è¿›ç¨‹ä¸­çš„åœ°å€ ç¬¬äºŒæ­¥æ‹†åˆ†åœ°å€ 12345000AA750 hello worldå­—ç¬¦ä¸²åœ¨è¿›ç¨‹ä¸­åœ°å€ç¬¬ä¸€éƒ¨åˆ†ï¼š00 0*8ç¬¬ä¸€éƒ¨åˆ†ï¼š00 0000 000 0*8ç¬¬ä¸€éƒ¨åˆ†ï¼š0 1010 1010 AA * 8 = 550ç¬¬å››éƒ¨åˆ†ï¼š750 ç¬¬ä¸‰æ­¥windbgè¿›è¡ŒæŸ¥çœ‹æ‰¾åˆ°cr3çš„å€¼ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647DirBase:123402a0ç¬¬ä¸€çº§ï¼š!dd 123402a0kd&gt; !dd 123402a0#123402a0 288a8001 00000000 28729001 00000000#123402b0 2886a001 00000000 287a7001 00000000#123402c0 1d083001 00000000 1cf44001 00000000#123402d0 1cec5001 00000000 1d142001 00000000#123402e0 1d402001 00000000 1d383001 00000000#123402f0 1d1c4001 00000000 1d301001 00000000#12340300 1cc20001 00000000 1cce1001 00000000#12340310 1cc62001 00000000 1cb5f001 00000000ç¬¬äºŒçº§ï¼š!dd 288a8000+0 åé¢ä¸‰ä½æ˜¯å±æ€§ä½¿ç”¨æ—¶æ”¹æˆ000kd&gt; !dd 288a8000#288a8000 285e4067 00000000 28b43067 00000000#288a8010 28696067 00000000 00000000 00000000#288a8020 285e5067 00000000 2885e067 00000000#288a8030 28ca1067 00000000 29088067 00000000#288a8040 28757067 00000000 00000000 00000000#288a8050 00000000 00000000 00000000 00000000#288a8060 00000000 00000000 00000000 00000000#288a8070 00000000 00000000 00000000 00000000ç¬¬ä¸‰çº§ï¼š!dd 285e4000+550kd&gt; !dd 285e4000+550#285e4550 2892b067 80000000 28821067 80000000#285e4560 28922067 80000000 286e4067 80000000#285e4570 28625067 80000000 28866067 80000000#285e4580 288e7067 80000000 28a68067 80000000#285e4590 288e9067 80000000 00000200 00000000#285e45a0 00000200 00000000 00000200 00000000#285e45b0 29142067 80000000 28c8d067 80000000#285e45c0 28ed1067 80000000 28d94067 80000000ç¬¬å››çº§ï¼š!dd 2892b000 + 750kd&gt; !dd 2892b000 + 750#2892b750 00650068 006c006c 0020006f 006f0077#2892b760 006c0072 00000064 00000000 00000000#2892b770 00000000 00000000 00000000 00000000#2892b780 00000000 00000000 00000000 00000000#2892b790 00000000 0088000c 000a0005 0008014a#2892b7a0 00000000 000350ac 000aaec8 000aa3e0#2892b7b0 00000000 00000000 00000000 00000000#2892b7c0 0005002e 00102341 000800cc 00000000!db 2892b000 + 750 å¯éªŒè¯ å¼€å¯2-9-9-12ï¼šå°†C:\\boot.iniæ–‡ä»¶ä¸­çš„executeæ”¹ä¸ºnoexecute é‡å¯ 5ã€PDPTEç»“æ„ PDPTEå…±æœ‰å››é¡¹ï¼ˆ4 &#x3D; 2^2ï¼‰ 35-12 å­˜å‚¨çš„æ˜¯é¡µç›®å½•è¡¨çš„åŸºå€ï¼Œä½12ä½è¡¥0ï¼Œå…±36ä½ï¼Œå³é¡µç›®å½•åŸºå€ã€‚ 6ã€PDEç»“æ„ å½“PS&#x3D;1æ—¶æ˜¯å¤§é¡µï¼Œ35-21ä½æ˜¯å¤§é¡µçš„ç‰©ç†åœ°å€ï¼Œè¿™æ ·36ä½çš„ç‰©ç†åœ°å€çš„ä½21ä½ä¸º0ï¼Œè¿™å°±æ„å‘³ç€é¡µçš„å¤§å°ä¸º2MBï¼Œä¸”éƒ½æ˜¯2MBå¯¹é½ã€‚ 12^21 = 2MB å½“PS&#x3D;0æ—¶ï¼Œ35-12ä½æ˜¯é¡µè¡¨åŸºå€ï¼Œä½12ä½è¡¥0ï¼Œå…±36ä½ 12^12 = 4KB åœ¨æ‰€æœ‰çš„è¡¨é¡¹ä¸­ï¼ˆé™¤äº†æŒ‡å‘2MBé¡µçš„é¡µç›®å½•é¡¹ï¼‰ï¼ŒåŸºåœ°å€éƒ½è¢«è§†ä¸º36ä½ç‰©ç†åœ°å€çš„é«˜24ä½ï¼Œè¿™å°±è¿«ä½¿é¡µè¡¨å’Œé¡µéƒ½æ˜¯4KBå¯¹é½çš„ï¼ˆè¿™æ ·ï¼Œ36ä½ç‰©ç†åœ°å€çš„ä½12ä½éƒ½ä¸º0ï¼‰ã€‚å½“é¡µç›®å½•é¡¹æŒ‡å‘ä¸€ä¸ª2MBçš„é¡µæ—¶ï¼ŒåŸºåœ°å€è¢«è§†ä¸º36ä½ç‰©ç†åœ°å€çš„é«˜15ä½ï¼Œè¿™å°±è¿«ä½¿2MBçš„é¡µéƒ½æ˜¯2MBå¯¹é½çš„ï¼ˆè¿™æ ·ï¼Œ36ä½ç‰©ç†åœ°å€çš„ä½21ä½ä¸º0ï¼‰ 7ã€PTEç»“æ„ PTEä¸­35-12æ˜¯ç‰©ç†é¡µåŸºå€ï¼Œ24ä½ï¼Œä½12ä½è¡¥0 ç‰©ç†é¡µåŸºå€+12ä½çš„é¡µå†…åç§»æŒ‡å‘å…·ä½“æ•°æ® 8ã€XDæ ‡å¿—ä½AMDä¸­ç§°ä¸ºNX,å³No Excetion PDE&#x2F;PTEç»“æ„ï¼š æ®µçš„å±æ€§ï¼šæœ‰å¯è¯»ã€å¯å†™å’Œå¯æ‰§è¡Œ é¡µçš„å±æ€§ï¼šæœ‰å¯è¯»ã€å¯å†™ å½“RETæ‰§è¡Œè¿”å›çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä¿®æ”¹å †æ ˆé‡Œé¢çš„æ•°æ®æŒ‡å‘ä¸€ä¸ªæˆ‘æå‰å‡†å¤‡å¥½çš„æ•°æ®ï¼ˆæŠŠæ•°æ®å½“ä½œä»£ç æ¥æ‰§è¡Œï¼‰æ‰€ä»¥ï¼ŒIntelå°±åšäº†ç¡¬ä»¶ä¿æŠ¤ï¼Œåšäº†ä¸€ä¸ªä¸å¯æ‰§è¡Œä½ï¼ŒXD&#x3D;1æ—¶ã€‚é‚£ä¹ˆä½ çš„è½¯ä»¶æº¢å‡ºäº†ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå³ä½¿ä½ çš„EIPè¹¦åˆ°äº†å±é™©çš„â€œæ•°æ®åŒºâ€ï¼Œä¹Ÿæ˜¯ä¸å¯ä»¥æ‰§è¡Œçš„ï¼åœ¨PAEåˆ†é¡µæ¨¡å¼ä¸‹ï¼ŒPDEä¸PTEçš„æœ€é«˜ä½ä¸ºXD&#x2F;NXä½ 9ã€é¡µç›®å½•è¡¨ï¼Œé¡µè¡¨åŸºåœ°å€PAEåˆ†é¡µæ¨¡å¼ä¸‹ é¡µç›®å½•è¡¨åŸºå€ï¼š0xC0600000é¡µè¡¨åŸºå€ï¼š0xC0000000 PDPTEã€PDIä¸PTI 12-9-9-12 ï¼ˆIå°±æ˜¯Indexï¼‰ è®¿é—®é¡µç›®å½•è¡¨é¡¹ï¼ˆPDEï¼‰çš„å…¬å¼ï¼š 10xc0600000 + PDPTI * 0x200 * 8 + PDI * 8 è®¿é—®é¡µè¡¨é¡¹ï¼ˆPTEï¼‰çš„å…¬å¼ 10xc0000000 + PDPTI * 0x200 * 0x200 * 8 + PDI * 0x200 * 8 + PTI * 8 TLB1ã€åœ°å€è§£æ é€šè¿‡ä¸€ä¸ªçº¿æ€§åœ°å€è®¿é—®ä¸€ä¸ªç‰©ç†é¡µã€‚æ¯”å¦‚ï¼šä¸€ä¸ªDWORDï¼Œå…¶å®æœªå¿…çœŸæ­£è¯»çš„æ˜¯4ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬å…ˆè¯»çš„PDEå†è¯»PTEï¼Œæœ€åæ‰è¯»çš„4ä¸ªå­—èŠ‚çš„é¡µã€‚ åœ¨2-9-9-12ä¼šè¯»24ä¸ªå­—èŠ‚ï¼Œå¦‚æœè·¨é¡µå¯èƒ½æ›´å¤šã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œåªèƒ½åšè®°å½•ã€‚CPUå†…éƒ¨åšäº†ä¸€ä¸ªè¡¨ï¼Œæ¥è®°å½•è¿™äº›ä¸œè¥¿ï¼Œè¿™ä¸ªè¡¨æ ¼æ˜¯CPUå†…éƒ¨çš„ï¼Œå’Œå¯„å­˜å™¨ä¸€æ ·å¿«ï¼Œè¿™ä¸ªè¡¨æ ¼ï¼šTLB 2ã€TLBç»“æ„ ATTRï¼ˆå±æ€§ï¼‰ï¼šå±æ€§æ˜¯PDPE PDE PTEä¸‰ä¸ªå±æ€§ANDèµ·æ¥çš„. å¦‚æœæ˜¯10-10-12 å°±æ˜¯PDE and PTE ä¸åŒçš„CPU è¿™ä¸ªè¡¨çš„å¤§å°ä¸ä¸€æ · åªè¦Cr3å˜äº†ï¼ŒTLBç«‹é©¬åˆ·æ–°ï¼Œä¸€æ ¸ä¸€å¥—TLB. æ“ä½œç³»ç»Ÿçš„é«˜2Gæ˜ å°„åŸºæœ¬ä¸å˜ï¼Œå¦‚æœCr3æ”¹äº†ï¼ŒTLBåˆ·æ–° é‡å»ºé«˜2Gä»¥ä¸Šå¾ˆæµªè´¹ã€‚æ‰€ä»¥PDEå’ŒPTEä¸­æœ‰ä¸ªGæ ‡å¿—ä½ï¼Œå¦‚æœGä½ä¸º1åˆ·æ–°TLBæ—¶å°†ä¸ä¼šåˆ·æ–° PDE&#x2F;PTEçš„Gä½ä¸º1çš„é¡µï¼Œå½“TLBæ»¡äº†ï¼Œæ ¹æ®ç»Ÿè®¡ä¿¡æ¯å°†ä¸å¸¸ç”¨çš„åœ°å€åºŸå¼ƒï¼Œæœ€è¿‘æœ€å¸¸ç”¨çš„ä¿ç•™ 3ã€TLBç§ç±»TLBåœ¨X86ä½“ç³»çš„CPUé‡Œçš„å®é™…åº”ç”¨æœ€æ—©æ˜¯ä»Intelçš„486CPUå¼€å§‹çš„ï¼Œåœ¨X86ä½“ç³»çš„CPUé‡Œè¾¹ï¼Œä¸€èˆ¬éƒ½è®¾æœ‰å¦‚ä¸‹4ç»„TLB: ç¬¬ä¸€ç»„ï¼šç¼“å­˜ä¸€èˆ¬é¡µè¡¨ï¼ˆ4Kå­—èŠ‚é¡µé¢ï¼‰çš„æŒ‡ä»¤é¡µè¡¨ç¼“å­˜ï¼ˆInstruction-TLBï¼‰ ç¬¬äºŒç»„ï¼šç¼“å­˜ä¸€èˆ¬é¡µè¡¨ï¼ˆ4Kå­—èŠ‚é¡µé¢ï¼‰çš„æ•°æ®é¡µè¡¨ç¼“å­˜ï¼ˆData-TLBï¼‰ ç¬¬ä¸‰ç»„ï¼šç¼“å­˜å¤§å°ºå¯¸é¡µè¡¨ï¼ˆ2M&#x2F;4Må­—èŠ‚é¡µé¢ï¼‰çš„æŒ‡ä»¤é¡µè¡¨ç¼“å­˜ï¼ˆInstruction-TLBï¼‰ ç¬¬å››ç»„ï¼šç¼“å­˜å¤§å°ºå¯¸é¡µè¡¨ï¼ˆ2M&#x2F;4Må­—èŠ‚é¡µé¢ï¼‰çš„æ•°æ®é¡µè¡¨ç¼“å­˜ï¼ˆData-TLBï¼‰ ä¸­æ–­ä¸å¼‚å¸¸1ã€ä»€ä¹ˆæ˜¯ä¸­æ–­ ä¸­æ–­é€šå¸¸æ˜¯ç”±CPUå¤–éƒ¨çš„è¾“å…¥è¾“å‡ºè®¾å¤‡(ç¡¬ä»¶)æ‰€è§¦å‘çš„ï¼Œä¾›å¤–éƒ¨è®¾å¤‡é€šçŸ¥CPUâ€œæœ‰äº‹æƒ…éœ€è¦å¤„ç†â€ï¼Œå› æ­¤åˆå«ä¸­æ–­è¯·æ±‚(Interrupt Request) ä¸­æ–­è¯·æ±‚çš„ç›®çš„æ˜¯å¸Œæœ›CPUæš‚æ—¶åœæ­¢æ‰§è¡Œå½“å‰æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºï¼Œè½¬å»æ‰§è¡Œä¸­æ–­è¯·æ±‚æ‰€å¯¹åº”çš„ä¸­æ–­å¤„ç†ä¾‹ç¨‹(ä¸­æ–­å¤„ç†ç¨‹åºåœ¨å“ªæœ‰IDTè¡¨å†³å®š) 80x86æœ‰ä¸¤æ¡ä¸­æ–­è¯·æ±‚çº¿ éå±è”½ä¸­æ–­çº¿ï¼Œç§°ä¸ºNMIï¼ˆNonMaskable Interruptï¼‰ å¯å±è”½ä¸­æ–­çº¿ï¼Œç§°ä¸ºINTRï¼ˆInterrupt Requireï¼‰ 2ã€éå¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç† å½“éå¯å±è”½ä¸­æ–­äº§ç”Ÿæ—¶ï¼ŒCPUåœ¨æ‰§è¡Œå®Œå½“å‰æŒ‡ä»¤åä¼šé‡Œé¢è¿›å…¥ä¸­æ–­å¤„ç†ç¨‹åºéå¯å±è”½ä¸­æ–­ä¸å—EFLAGå¯„å­˜å™¨ä¸­IFä½çš„å½±å“ï¼Œä¸€æ—¦å‘ç”Ÿï¼ŒCPUå¿…é¡»å¤„ç†éå¯å±è”½ä¸­æ–­å¤„ç†ç¨‹åºä½äºIDTè¡¨ä¸­çš„2å·ä½ç½® 3ã€å¯å±è”½ä¸­æ–­åœ¨ç¡¬ä»¶çº§ï¼Œå¯å±è”½ä¸­æ–­æ˜¯ç”±ä¸€å—ä¸“é—¨çš„èŠ¯ç‰‡æ¥ç®¡ç†çš„ï¼Œé€šå¸¸ç§°ä¸ºä¸­æ–­æ§åˆ¶å™¨.å®ƒè´Ÿè´£åˆ†é…ä¸­æ–­èµ„æºå’Œç®¡ç†å„ä¸ªä¸­æ–­æºå‘å‡ºçš„ä¸­æ–­è¯·æ±‚.ä¸ºäº†ä¾¿äºæ ‡è¯†å„ä¸ªä¸­æ–­è¯·æ±‚ï¼Œä¸­æ–­ç®¡ç†å™¨é€šå¸¸ç”¨IRQ(Interrupt Request)åé¢åŠ ä¸Šæ•°å­—æ¥è¡¨ç¤ºä¸åŒçš„ä¸­æ–­ æ¯”å¦‚ï¼šåœ¨Windowsä¸­ æ—¶é’Ÿä¸­æ–­çš„IRQç¼–å·ä¸º0 ä¹Ÿå°±æ˜¯ï¼šIRQ0 4ã€æ—¶é’Ÿä¸­æ–­ å¤§å¤šæ•°æ“ä½œç³»ç»Ÿæ—¶é’Ÿä¸­æ–­åœ¨10-100MSä¹‹é—´ï¼ŒWindowsç³»åˆ—ä¸º10-20MS 5ã€å¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç† ï¼ˆIDTè¡¨ï¼‰ä¸­æ–­å· IRQ è¯´æ˜ 0x30 IRQ0 æ—¶é’Ÿä¸­æ–­ 0x31-0x3F IRQ1-IRQ15 å…¶ä»–ç¡¬ä»¶è®¾å¤‡çš„ä¸­æ–­ å¦‚æœè‡ªå·±çš„ç¨‹åºæ‰§è¡Œæ—¶ä¸å¸Œæœ›CPUå»å¤„ç†è¿™äº›ä¸­æ–­ ç”¨CLIæŒ‡ä»¤æ¸…ç©ºEFLAGå¯„å­˜å™¨ä¸­çš„IFä½ ç”¨STIæŒ‡ä»¤è®¾ç½®EFLAGå¯„å­˜å™¨ä¸­çš„IFä½ ç¡¬ä»¶ä¸­æ–­ä¸IDTè¡¨ä¸­çš„å¯¹åº”å…³ç³»å¹¶éå›ºå®šä¸å˜çš„ï¼Œå‚è§ï¼šAPICï¼ˆé«˜çº§å¯ç¼–ç¨‹ä¸­æ–­æ§åˆ¶å™¨ï¼‰ 6ã€å¼‚å¸¸å¼‚å¸¸é€šå¸¸æ˜¯CPUåœ¨æ‰§è¡ŒæŒ‡ä»¤æ—¶æ£€æµ‹åˆ°çš„æŸäº›é”™è¯¯ï¼Œæ¯”å¦‚é™¤0ã€è®¿é—®æ— æ•ˆé¡µé¢ç­‰ ä¸­æ–­ä¸å¼‚å¸¸çš„åŒºåˆ«ï¼š 1ã€ä¸­æ–­æ¥è‡ªäºå¤–éƒ¨è®¾å¤‡ï¼Œæ˜¯ä¸­æ–­æºï¼ˆæ¯”å¦‚é”®ç›˜ï¼‰å‘èµ·çš„ï¼ŒCPUæ˜¯è¢«åŠ¨çš„. 2ã€å¼‚å¸¸æ¥è‡ªäºCPUæœ¬èº«ï¼Œæ˜¯CPUä¸»åŠ¨äº§ç”Ÿçš„ 3ã€INT Nè™½ç„¶è¢«ç§°ä¸ºâ€œè½¯ä»¶ä¸­æ–­â€ï¼Œä½†å…¶æœ¬è´¨æ˜¯å¼‚å¸¸ã€‚EFLAGçš„IFä½å¯¹INT Næ— æ•ˆã€‚ 7ã€å¼‚å¸¸å¤„ç†æ— è®ºæ˜¯ç”±ç¡¬ä»¶è®¾å¤‡è§¦å‘çš„ä¸­æ–­è¯·æ±‚è¿˜æ˜¯ç”±CPUäº§ç”Ÿçš„å¼‚å¸¸ï¼Œå¤„ç†ç¨‹åºéƒ½åœ¨IDTè¡¨ã€‚ å¸¸è§çš„å¼‚å¸¸å¤„ç†ç¨‹åºï¼š é”™è¯¯ç±»å‹ ï¼ˆIDTè¡¨ï¼‰ä¸­æ–­å· é¡µé”™è¯¯ 0xE æ®µé”™è¯¯ 0xD é™¤é›¶é”™è¯¯ 0x0 åŒé‡é”™è¯¯ 0x8 8ã€ç¼ºé¡µå¼‚å¸¸ç¼ºé¡µå¼‚å¸¸çš„äº§ç”Ÿï¼š 1ã€å½“PDE&#x2F;PTEçš„P&#x3D;0æ—¶ã€‚ 2ã€å½“PDE&#x2F;PTEçš„å±æ€§ä¸ºåªè¯»ï¼Œä½†ç¨‹åºè¯•å›¾å†™å…¥çš„æ—¶ä¸€æ—¦å‘ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼ŒCPUä¼šæ‰§è¡ŒIDTè¡¨ä¸­çš„0xEå·ä¸­æ–­å¤„ç†ç¨‹åºï¼Œç”±æ“ä½œç³»ç»Ÿæ¥æ¥ç®¡ã€‚ æ§åˆ¶å¯„å­˜å™¨1ã€æ§åˆ¶å¯„å­˜å™¨ æ§åˆ¶å¯„å­˜å™¨ç”¨äºæ§åˆ¶å’Œç¡®å®šCPUçš„æ“ä½œæ¨¡å¼ æ§åˆ¶å¯„å­˜å™¨ç±»å‹ï¼šCr0ã€Cr1ã€Cr2ã€Cr3ã€Cr4ã€Cr8 Cr0ï¼šåŒ…å«ç³»ç»Ÿæ§åˆ¶æ ‡å¿—ï¼Œç”¨äºæ§åˆ¶å¤„ç†å™¨çš„å·¥ä½œæ¨¡å¼å’ŒçŠ¶æ€ Cr1ï¼šä¿ç•™ Cr2ï¼šåŒ…å«é¡µé¢é”™è¯¯çº¿æ€§åœ°å€ï¼ˆå¯¼è‡´é¡µé¢é”™è¯¯çš„çº¿æ€§åœ°å€ï¼‰ Cr3ï¼šé¡µç›®å½•è¡¨åŸºå€ Cr4ï¼šåŒ…å«ä¸€ç»„æ ‡å¿—ä½ï¼Œç”¨äºå¯ç”¨ä¸€äº›ä½“ç³»ç»“æ„æ‰©å±•åŠŸèƒ½ï¼Œå¹¶æŒ‡ç¤ºæ“ä½œç³»ç»Ÿæˆ–æ‰§è¡Œç¨‹åºå¯¹ç‰¹å®šå¤„ç†å™¨åŠŸèƒ½çš„æ”¯æŒæƒ…å†µã€‚ Cr8ï¼šä»…64ä½ä¸‹ä½¿ç”¨ 2ã€Cr0 PEä½ï¼šCR0çš„ä½0æ˜¯å¯ç”¨ä¿æŠ¤ï¼ˆProtection Enableï¼‰æ ‡å¿—ã€‚ PE&#x3D;1ä¿æŠ¤æ¨¡å¼ PE&#x3D;0 å®åœ°å€æ¨¡å¼ 1è¿™ä¸ªæ ‡å¿—ä»…å¼€å¯æ®µçº§ä¿æŠ¤ï¼Œè€Œå¹¶æ²¡æœ‰å¯ç”¨åˆ†é¡µæœºåˆ¶ã€‚è‹¥è¦å¯ç”¨åˆ†é¡µæœºåˆ¶ï¼Œé‚£ä¹ˆPEå’ŒPGæ ‡å¿—éƒ½è¦ç½®ä½ã€‚ PGä½ï¼šå½“è®¾ç½®è¯¥ä½æ—¶å³å¼€å¯äº†åˆ†é¡µæœºåˆ¶ã€‚åœ¨å¼€å¯è¿™ä¸ªæ ‡å¿—ä¹‹å‰å¿…é¡»å·²ç»æˆ–è€…åŒæ—¶å¼€å¯PEæ ‡å¿—ã€‚ 12345PG=0ä¸”PE=0 å¤„ç†å™¨å·¥ä½œåœ¨å®åœ°å€æ¨¡å¼ä¸‹PG=0ä¸”PE=1 å¤„ç†å™¨å·¥ä½œåœ¨æ²¡æœ‰å¼€å¯åˆ†é¡µæœºåˆ¶çš„ä¿æŠ¤æ¨¡å¼ä¸‹PG=1ä¸”PE=0 åœ¨PEæ²¡æœ‰å¼€å¯çš„æƒ…å†µä¸‹ æ— æ³•å¼€å¯PGPG=1ä¸”PE=1 å¤„ç†å™¨å·¥ä½œåœ¨å¼€å¯äº†åˆ†é¡µæœºåˆ¶çš„ä¿æŠ¤æ¨¡å¼ä¸‹ WPä½ï¼šå¯¹äºIntel 80486æˆ–ä»¥ä¸Šçš„CPUï¼ŒCR0çš„ä½16æ˜¯å†™ä¿æŠ¤ï¼ˆWrite Proctectï¼‰æ ‡å¿—å½“è®¾ç½®è¯¥æ ‡å¿—æ—¶ï¼Œå¤„ç†å™¨ä¼šç¦æ­¢è¶…çº§ç”¨æˆ·ç¨‹åºï¼ˆä¾‹å¦‚ç‰¹æƒçº§0çš„ç¨‹åºï¼‰å‘ç”¨æˆ·çº§åªè¯»é¡µé¢æ‰§è¡Œå†™æ“ä½œï¼› 1234å½“CPL&lt;3çš„æ—¶å€™ï¼šå¦‚æœ WP=0 å¯ä»¥è¯»å†™ä»»æ„ç”¨æˆ·çº§ç‰©ç†é¡µï¼Œåªè¦çº¿æ€§åœ°å€æœ‰æ•ˆ.å¦‚æœ WP=1 å¯ä»¥è¯»å–ä»»æ„ç”¨æˆ·çº§ç‰©ç†é¡µï¼Œä½†å¯¹äºåªè¯»çš„ç‰©ç†é¡µï¼Œåˆ™ä¸èƒ½å†™. 3ã€Cr2 å½“CPUè®¿é—®æŸä¸ªæ— æ•ˆé¡µé¢æ—¶ï¼Œä¼šäº§ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œæ­¤æ—¶ï¼ŒCPUä¼šå°†å¼•èµ·å¼‚å¸¸çš„çº¿æ€§åœ°å€å­˜æ”¾åœ¨CR2ä¸­ã€‚ 4ã€Cr4 PAEï¼š1 æ˜¯2-9-9-12åˆ†é¡µ ï¼Œ0 æ˜¯10-10-12åˆ†é¡µ PSEï¼š PWT&#x2F;PCD1ã€CPUç¼“å­˜ CPUç¼“å­˜æ˜¯ä½äºCPUä¸ç‰©ç†å†…å­˜ä¹‹é—´çš„ä¸´æ—¶å­˜å‚¨å™¨ï¼Œå®ƒçš„å®¹é‡æ¯”å†…å­˜å°çš„å¤šä½†æ˜¯äº¤æ¢é€Ÿåº¦å´æ¯”å†…å­˜è¦å¿«å¾—å¤šã€‚ CPUç¼“å­˜å¯ä»¥åšçš„å¾ˆå¤§ï¼Œæœ‰å‡ Kã€å‡ åKã€å‡ ç™¾K ç”šè‡³ä¸ŠMçš„ä¹Ÿæœ‰ã€‚ CPUç¼“å­˜ä¸TLBçš„åŒºåˆ«ï¼š TLBï¼šçº¿æ€§åœ°å€ &lt;â€”â€“&gt; ç‰©ç†åœ°å€ CPUç¼“å­˜ï¼šç‰©ç†åœ°å€ &lt;â€”â€“&gt; å†…å®¹ æ‰€ä»¥å½“æ‹¿åˆ°ä¸€ä¸ªç¨‹åºçš„çº¿æ€§åœ°å€æŸ¥è¯¢æ—¶ï¼Œå…ˆä¼šä½¿ç”¨TLBï¼Œç„¶ååœ¨ä½¿ç”¨CPUç¼“å­˜ 2ã€å…³äºPWT&#x2F;PCDå±æ€§PWTï¼šPage Write Through 1PWT = 1 æ—¶ å†™Cacheçš„æ—¶å€™ä¹Ÿè¦å°†æ•°æ®å†™å…¥å†…å­˜ä¸­ã€‚ PCDï¼šPage Cache Disable 1PCD = 1æ—¶ï¼Œç¦æ­¢æŸä¸ªé¡µå†™å…¥ç¼“å­˜ï¼Œç›´æ¥å†™å†…å­˜ã€‚\tæ¯”å¦‚ï¼Œåšé¡µè¡¨ç”¨çš„é¡µï¼Œå·²ç»å­˜å‚¨åœ¨TLBä¸­äº†ï¼Œå¯èƒ½ä¸éœ€è¦å†ç¼“å­˜äº† å…·ä½“ç»†èŠ‚å‚è€ƒIntelç™½çš®ä¹¦ è°ƒè¯•è¸©å‘1ã€32ä½çš„ç³»ç»Ÿå°±å¾—ç”¨è€ç‰ˆæœ¬çš„32ä½windbgï¼Œä¸è¦ç”¨windbg perview æš‚æ—¶ä¸çŸ¥é“æ€ä¹ˆè§£å†³ 2ã€windbgè€ç‰ˆæœ¬é‡åˆ°å¯„å­˜å™¨å†…å®¹æ— æ³•æ˜¾ç¤º WingDbg.dllæ’ä»¶æ”¾windbgç›¸åŒç›®å½•ä¸‹ 1!WingDbg.regfix ä¸‹è½½åœ°å€ï¼šhttps://github.com/mbikovitsky/WingDbg","tags":["æ»´æ°´ä¸­çº§","winå†…æ ¸"],"categories":["é€†å‘"]},{"title":"github actions äº‘ç¼–è¯‘","path":"/p/2d289b78/","content":"å¦‚ä½•ä½¿ç”¨Github Actions å¦‚æœä½ æƒ³è¦ç¼–è¯‘åˆ«äººçš„è½¯ä»¶ï¼Œåœ¨githubä¸Šã€‚ 1ã€forké¡¹ç›®åˆ°è‡ªå·±ä»“åº“ 2ã€ç‚¹å‡»å½“å‰é¡¹ç›®çš„ActionåŠŸèƒ½ 3ã€æ–°å»ºä¸€ä¸ªå·¥ä½œæµNew workflow 4ã€é€‰æ‹©ä½ å½“å‰é¡¹ç›®æ˜¯ä»€ä¹ˆè¯­è¨€ï¼Œcã€javaã€goç­‰ã€‚ ä¹‹åå°±ä¼šç”Ÿæˆä¸€ä¸ªymlæ–‡ä»¶ç»™ä½ ç¼–è¾‘ ä½ æŠŠä¸‹é¢çš„æ¨¡æ¿ç²˜è´´è¿›å»ä¿®æ”¹ä¸€ä¸‹å°±ç›´æ¥ç¼–è¯‘å³å¯ å¦‚æœåŸé¡¹ç›®ç”±github&#x2F;workflowsé‚£å°±ç›´æ¥ç”¨ä»–çš„ï¼Œæ²¡æœ‰åˆ™å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªæ¨¡æ¿ goé¡¹ç›®ç¼–è¯‘1234567891011121314151617181920212223242526272829303132333435363738394041# This workflow will build a golang project# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-goname: Goon: push: branches: [ &quot;main&quot; ] pull_request: branches: [ &quot;main&quot; ]jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Set up Go uses: actions/setup-go@v4 with: go-version: &#x27;1.20&#x27; - uses: goreleaser/goreleaser-action@v4 with: args: &quot;release --rm-dist --snapshot&quot; version: 1.23.0 env: GITHUB_TOKEN: &quot;$&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;&quot; path: ./ # å¯æ ¹æ®ä½ çš„é¡¹ç›®ç»“æ„é€‰æ‹©ç¼–è¯‘äº§ç‰©è·¯å¾„ - name: Zip files run: zip -r dist/VcenterKiller_archive.zip dist/VcenterKiller* #ç¼–è¯‘åçš„åå­— ï¼Œåœ¨è™šæ‹Ÿæœºé»˜è®¤æ–‡ä»¶ä¼šåœ¨distç›®å½•ä¸‹ - name: Upload binaries to release uses: svenstaro/upload-release-action@v2 with: repo_token: $&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125; file: dist/VcenterKiller* tag: $&#123;&#123; github.ref &#125;&#125; overwrite: true file_glob: true draft: false #ç¼–è¯‘å®Œæˆå ä¼šè‡ªåŠ¨å‘å¸ƒåˆ°release javaé¡¹ç›®ç¼–è¯‘maven1234567891011121314151617181920212223242526272829303132333435363738394041# This workflow will build a Java project with Maven, and cache/restore any dependencies to improve the workflow execution time# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-java-with-maven# This workflow uses actions that are not certified by GitHub.# They are provided by a third-party and are governed by# separate terms of service, privacy policy, and support# documentation.name: Java CI with Mavenon: push: branches: [ &quot;main&quot; ] pull_request: branches: [ &quot;main&quot; ]jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Set up JDK 8 uses: actions/setup-java@v4 with: java-version: &#x27;8&#x27; distribution: &#x27;temurin&#x27; cache: maven - name: Build with Maven run: | mvn package assembly:single - name: Upload binaries to release - name: Upload binaries to release uses: svenstaro/upload-release-action@v2 with: repo_token: $&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125; file: &#123;è·¯å¾„&#125;/&#123;é¡¹ç›®å&#125;* tag: $&#123;&#123; github.ref &#125;&#125; overwrite: true file_glob: true draft: false #ç¼–è¯‘å®Œæˆå ä¼šè‡ªåŠ¨å‘å¸ƒåˆ°release gradle123456789101112131415161718192021222324252627282930313233343536373839404142434445# This workflow uses actions that are not certified by GitHub.# They are provided by a third-party and are governed by# separate terms of service, privacy policy, and support# documentation.# This workflow will build a Java project with Gradle and cache/restore any dependencies to improve the workflow execution time# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-java-with-gradlename: Java CI with Gradleon: push: branches: [ &quot;main&quot; ] pull_request: branches: [ &quot;main&quot; ]jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Set up JDK 8 uses: actions/setup-java@v4 with: java-version: &#x27;8&#x27; distribution: &#x27;temurin&#x27; # Configure Gradle for optimal use in GitHub Actions, including caching of downloaded dependencies. # See: https://github.com/gradle/actions/blob/main/setup-gradle/README.md - name: Setup Gradle uses: gradle/actions/setup-gradle@af1da67850ed9a4cedd57bfd976089dd991e2582 # v4.0.0 with: gradle-version: &#x27;8.7&#x27; - name: Build with Gradle Wrapper run: ./gradlew shadowJar - name: Upload binaries to release uses: svenstaro/upload-release-action@v2 with: repo_token: $&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125; file: build/libs/&#123;é¡¹ç›®å&#125;* #è¿™é‡Œéœ€è¦ä¿®æ”¹ tag: $&#123;&#123; github.ref &#125;&#125; overwrite: true file_glob: true draft: false #ç¼–è¯‘å®Œæˆå ä¼šè‡ªåŠ¨å‘å¸ƒåˆ°release å…·ä½“ä¿å­˜å¾—çœ‹æ„å»ºçš„æ—¶å€™æ—¥å¿—é—®é¢˜ rusté¡¹ç›®ç¼–è¯‘123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209name: Release - Distribute binarieson: # If we want to make release using github interface. # release: # types: [published] # If we want to make release by pushing new tag. workflow_dispatch: push: tags: - &#x27;[0-9]+.[0-9]+.[0-9]+&#x27; pull_request: branches: - master paths: - &#x27;Cargo.toml&#x27; - &#x27;Cargo.lock&#x27; - &#x27;.github/workflows/test.yml&#x27;env: BIN_NAME: legba PROJECT_NAME: legba REPO_NAME: Legba/Legba BREW_TAP: Legba/homebrew-tapjobs: build: name: Build runs-on: $&#123;&#123; matrix.os &#125;&#125; strategy: fail-fast: false # don&#x27;t fail other jobs if one fails matrix: # aarch64-linux is failing due to python3 missing issues during tests. I&#x27;m removing it for now. # build: [x86_64-linux, aarch64-linux, x86_64-macos, aarch64-macos, x86_64-windows, x86_64-win-gnu] build: [x86_64-linux, x86_64-macos, aarch64-macos, x86_64-windows, x86_64-win-gnu] include: # - build: aarch64-linux # os: ubuntu-20.04 # rust: stable # target: aarch64-unknown-linux-gnu # cross: true - build: aarch64-macos os: macos-latest rust: stable target: aarch64-apple-darwin cross: true - build: x86_64-linux os: ubuntu-20.04 rust: stable target: x86_64-unknown-linux-gnu cross: false - build: x86_64-macos os: macos-latest rust: stable target: x86_64-apple-darwin cross: false - build: x86_64-windows os: windows-2019 rust: stable target: x86_64-pc-windows-msvc cross: false - build: x86_64-win-gnu os: windows-2019 rust: stable-x86_64-gnu target: x86_64-pc-windows-gnu cross: false steps: - name: Set Git config (windows only) if: contains(matrix.os, &#x27;windows&#x27;) # Windows is missing some dependencies run: | git config --global pack.windowMemory &quot;100m&quot; git config --global pack.packSizeLimit &quot;100m&quot; git config --global pack.threads &quot;1&quot; git config --global pack.deltaCacheSize &quot;512m&quot; #- name: Windows Install dependencies # if: contains(matrix.os, &#x27;windows&#x27;) # run: | # powershell.exe -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command &quot;iex ((New-Object System.Net.WebClient).DownloadString(&#x27;https://chocolatey.org/install.ps1&#x27;))&quot; # SET &quot;PATH=%PATH%;%ALLUSERSPROFILE%\\chocolatey\\bin&quot; # choco install openssl -y - name: Install dependencies #(æŒ‰å®é™…æƒ…å†µä¿®æ”¹) if: contains(matrix.build, &#x27;x86_64-linux&#x27;) # Windows is missing some dependencies run: sudo apt-get update &amp;&amp; sudo apt-get install -y gcc-aarch64-linux-gnu python3 - name: Install python 3.10 uses: actions/setup-python@v5 with: python-version: &#x27;3.10&#x27; - name: Checkout sources uses: actions/checkout@v4 with: submodules: true - name: Install $&#123;&#123; matrix.rust &#125;&#125; toolchain uses: actions-rs/toolchain@v1 with: profile: minimal toolchain: $&#123;&#123; matrix.rust &#125;&#125; target: $&#123;&#123; matrix.target &#125;&#125; override: true - name: Run cargo test uses: actions-rs/cargo@v1 with: use-cross: $&#123;&#123; matrix.cross &#125;&#125; command: test args: --release --locked --target $&#123;&#123; matrix.target &#125;&#125; - name: Build release binary uses: actions-rs/cargo@v1 with: use-cross: $&#123;&#123; matrix.cross &#125;&#125; command: build args: --release --locked --target $&#123;&#123; matrix.target &#125;&#125; - name: Calculate tag name # if: contains(matrix.build, &#x27;linux&#x27;) shell: bash run: | name=dev if [[ $&#123;GITHUB_REF&#125; =~ refs/tags/[0-9]+.[0-9]+.[0-9]+ ]]; then name=$&#123;GITHUB_REF#refs/tags/&#125; fi echo &quot;TAG=$name&quot; &gt;&gt; $GITHUB_ENV id: tagname - name: Build and package artifacts shell: bash run: | mkdir dist if [[ &quot;$&#123;&#123; matrix.build &#125;&#125;&quot; =~ &quot;windows&quot; ]]; then cp &quot;target/$&#123;&#123; matrix.target &#125;&#125;/release/$BIN_NAME.exe&quot; &quot;dist/&quot; else cp &quot;target/$&#123;&#123; matrix.target &#125;&#125;/release/$BIN_NAME&quot; &quot;dist/&quot; fi if [[ &quot;$&#123;&#123; matrix.build &#125;&#125;&quot; =~ &quot;linux&quot; ]]; then cargo install cargo-deb cargo deb --target $&#123;&#123; matrix.target &#125;&#125; --deb-version $&#123;TAG&#125; cp &quot;target/$&#123;&#123; matrix.target &#125;&#125;/debian/legba_$&#123;TAG&#125;_amd64.deb&quot; &quot;dist/&quot; || true fi - uses: actions/upload-artifact@v4.3.4 with: name: bins-$&#123;&#123; matrix.build &#125;&#125; path: dist package: name: Package needs: [build] runs-on: ubuntu-latest steps: - name: Checkout sources uses: actions/checkout@v4 with: submodules: false - uses: actions/download-artifact@v4 with: path: dist - name: Calculate tag name # if: contains(matrix.build, &#x27;linux&#x27;) shell: bash run: | name=dev if [[ $&#123;GITHUB_REF&#125; =~ refs/tags/[0-9]+.[0-9]+.[0-9]+ ]]; then name=$&#123;GITHUB_REF#refs/tags/&#125; fi echo &quot;TAG=$name&quot; &gt;&gt; $GITHUB_ENV id: tagname - name: Build archive shell: bash run: | set -ex rm -rf tmp mkdir tmp for dir in dist/bins-* ; do platform=$&#123;dir#&quot;dist/bins-&quot;&#125; unset exe if [[ $platform =~ &quot;win&quot; ]]; then exe=&quot;.exe&quot; fi pkgname=$PROJECT_NAME-$TAG-$platform mkdir tmp/$pkgname cp $dir/$BIN_NAME$exe dist/ || true mv $dir/$BIN_NAME$exe tmp/$pkgname chmod +x tmp/$pkgname/$BIN_NAME$exe if [[ $platform =~ &quot;linux&quot; ]]; then mv &quot;$dir/legba_$&#123;TAG&#125;_amd64.deb&quot; dist/ || true fi tar cJf dist/$pkgname.tar.xz -C tmp $pkgname 7z a dist/$pkgname.zip tmp/$pkgname done - name: Upload binaries to release if: (github.event_name == &#x27;push&#x27; &amp;&amp; startsWith(github.ref, &#x27;refs/tags/&#x27;)) || github.event_name == &#x27;release&#x27; uses: svenstaro/upload-release-action@v2 with: repo_token: $&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125; file: dist/* file_glob: true tag: $&#123;&#123; github.ref &#125;&#125; overwrite: true","tags":["github-actions"],"categories":["å¼€å‘"]},{"title":"Hello World","path":"/p/4a17b156/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment This message is used to verify that this feed (feedId:72563970594258944) belongs to me (userId:72463685633295360). Join me in enjoying the next generation information browser https://follow.is."},{"title":"å‹é“¾","path":"/friends/index.html","content":""},{"title":"explore","path":"/explore/index.html","content":"xaoxuuhxaoxuuh"}]