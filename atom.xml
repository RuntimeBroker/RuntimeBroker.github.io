<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>RuntimeBroker Blog&#39;s</title>
  
  
  <link href="https://gbk.cx/atom.xml" rel="self"/>
  
  <link href="https://gbk.cx/"/>
  <updated>2024-10-19T14:45:58.839Z</updated>
  <id>https://gbk.cx/</id>
  
  <author>
    <name>RuntimeBroker</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>PHPä»£ç å®¡è®¡ç¯å¢ƒè°ƒè¯•å‘ç‚¹æ±‡æ€»</title>
    <link href="https://gbk.cx/p/7a303294/"/>
    <id>https://gbk.cx/p/7a303294/</id>
    <published>2024-10-19T14:24:16.000Z</published>
    <updated>2024-10-19T14:45:58.839Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»£ç å®¡è®¡ç¯å¢ƒæ­å»ºæ³¨æ„ç»†èŠ‚"><a href="#ä»£ç å®¡è®¡ç¯å¢ƒæ­å»ºæ³¨æ„ç»†èŠ‚" class="headerlink" title="ä»£ç å®¡è®¡ç¯å¢ƒæ­å»ºæ³¨æ„ç»†èŠ‚"></a>ä»£ç å®¡è®¡ç¯å¢ƒæ­å»ºæ³¨æ„ç»†èŠ‚</h1><h2 id="1-php-iniå‚æ•°é—®é¢˜ï¼š"><a href="#1-php-iniå‚æ•°é—®é¢˜ï¼š" class="headerlink" title="1 php.iniå‚æ•°é—®é¢˜ï¼š"></a>1 php.iniå‚æ•°é—®é¢˜ï¼š</h2><p>ğŸ’¡ 1.åœ¨phpç‰ˆæœ¬å°äº<strong>5.3</strong>æ—¶ï¼Œphp.inié‡Œé¢é…ç½®xdebugéœ€è¦å…ˆå…³é—­<strong>ZendOptimizer</strong>å’Œ<strong>ZendDebuggerï¼Œ</strong>åœ¨å‚æ•°æ–¹é¢æ³¨æ„çš„ç»†èŠ‚å°±æ˜¯php5.3ä¹‹åä½¿ç”¨è¯¥<strong>zend_extension</strong>å‚æ•°ï¼Œphp5.3ä¹‹å‰åˆ™ä½¿ç”¨<strong>zend_extension_ts</strong>å‚æ•°ã€‚</p><p>å…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">;php5.2å¦‚è¦å¯ç”¨Xdebugè¦å…ˆå…³é—­ZendOptimizerå’ŒZendDebugger</span><br><span class="line">xdebug.profiler_append = 0</span><br><span class="line">xdebug.profiler_enable = 1</span><br><span class="line">xdebug.profiler_enable_trigger = 0</span><br><span class="line">xdebug.profiler_output_dir = <span class="string">&quot;../tmp&quot;</span></span><br><span class="line">xdebug.trace_output_dir = <span class="string">&quot;../tmp&quot;</span></span><br><span class="line">xdebug.profiler_output_name = <span class="string">&quot;cache.out.%t-%s&quot;</span></span><br><span class="line">xdebug.remote_enable = 1</span><br><span class="line">xdebug.remote_autostart = 1</span><br><span class="line">xdebug.remote_handler = <span class="string">&quot;dbgp&quot;</span></span><br><span class="line">xdebug.remote_host = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">xdebug.remote_port = 9000</span><br><span class="line">xdebug.idekey = PHPSTORM</span><br><span class="line">zend_extension_ts=<span class="string">&quot;ä½ çš„PHPstudyè·¯å¾„\PhpStudy\PHPTutorial\php\php-5.2.17\ext\xdebug.dll&quot;</span></span><br><span class="line">[ZendDebugger]</span><br><span class="line">;å…¨éƒ¨åˆ é™¤æˆ–è€…æ³¨é‡Šæ‰</span><br><span class="line">[Zend]</span><br><span class="line">;ä»…ä¿ç•™ä¸‹é¢è¿™ä¸€è¡Œ</span><br><span class="line">xdebug.zend_extension_ts=<span class="string">&quot;ä½ çš„PHPstudyè·¯å¾„\PhpStudy\PHPTutorial\php\php-5.2.17\ext\xdebug.dll&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šå› ä¸ºctrl+shift+få·²ç»è¢«å ç”¨äº†ï¼Œå¦‚æœæœ‰è¾“å…¥æ³•çš„è¯å°±æ‰“ä¸å¼€ï¼Œå°¤å…¶æ˜¯win10è‡ªå¸¦çš„ä¸­æ–‡è¾“å…¥æ³•ï¼Œctrl+shift+fæ˜¯ç®€ç¹ä½“çš„è½¬åŒ–ã€‚è¦æ‰“å¼€è‹±æ–‡çš„åŸè£…è¾“å…¥æ³•æ‰è¡Œã€‚å†æŒ‰ctrl+shift+få°±èƒ½å¤Ÿæ‰“å¼€å…¨å±€æœç´¢äº†ã€‚</p></blockquote><h2 id="2-IDEA-debugæ–­ç‚¹è°ƒè¯•å¸¸ç”¨å¿«æ·é”®"><a href="#2-IDEA-debugæ–­ç‚¹è°ƒè¯•å¸¸ç”¨å¿«æ·é”®" class="headerlink" title="2 IDEA debugæ–­ç‚¹è°ƒè¯•å¸¸ç”¨å¿«æ·é”®"></a>2 IDEA debugæ–­ç‚¹è°ƒè¯•å¸¸ç”¨å¿«æ·é”®</h2><p><strong>F8ï¼šStep Over è·³è¿‡ï¼Œä¸€è¡Œä¸€è¡Œçš„å‘ä¸‹èµ°ï¼Œå¦‚æœå½“å‰è¡Œæœ‰æ–¹æ³•ä¸è¿›å…¥æ–¹æ³•ã€‚&#96;</strong></p><p><strong>F7ï¼šStep Into è·³å…¥ï¼Œå¦‚æœå½“å‰æœ‰æ–¹æ³•ï¼Œè¿›å…¥æ–¹æ³•å†…éƒ¨ï¼Œä¸€èˆ¬ç”¨äºè¿›å…¥è‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œä¸ä¼šjdkç±»åº“çš„æ–¹æ³•ã€‚</strong></p><p><strong>F9ï¼šè·³åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„ã€‚</strong></p><p><strong>Shift+ F8ï¼šStep Out è·³å‡ºï¼Œä»è·³å…¥çš„æ–¹æ³•å†…é€€å‡ºåˆ°æ–¹æ³•è°ƒç”¨å¤„ï¼Œè¿™ä¸ªæ—¶å€™æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œåªæ˜¯è¿˜æ²¡æœ‰å®Œæˆèµ‹å€¼</strong></p><p><strong>Alt+ F8ï¼šEvaluate Expression,è®¡ç®—è¡¨è¾¾å¼çš„å€¼ã€‚</strong></p><p><strong>Alt+ F9ï¼šRun to Cursor:è¿è¡Œåˆ°å…‰æ ‡å¤„ï¼Œä½ å¯ä»¥å°†å…‰æ ‡å®šä½åˆ°ä½ éœ€è¦æŸ¥çœ‹çš„è¡Œï¼Œç„¶åä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œä»£ç ä¼šè¿è¡Œåˆ°å…‰æ ‡å¤„ï¼Œä¸éœ€è¦æ‰“æ–­ç‚¹</strong></p><p><strong>Alt+ F10ï¼šShow Exception Point:å¦‚æœä½ çš„<a href="https://so.csdn.net/so/search?q=%E5%85%89%E6%A0%87&spm=1001.2101.3001.7020">å…‰æ ‡</a>åœ¨å…¶å®ƒè¡Œæˆ–è€…å…¶å®ƒçš„é¡µé¢ï¼Œç‚¹å‡»è¿™ä¸ªæŒ‰é’®å¯è·³è½¬åˆ°å½“å‰ä»£ç æ‰§è¡Œçš„è¡Œ</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä»£ç å®¡è®¡ç¯å¢ƒæ­å»ºæ³¨æ„ç»†èŠ‚&quot;&gt;&lt;a href=&quot;#ä»£ç å®¡è®¡ç¯å¢ƒæ­å»ºæ³¨æ„ç»†èŠ‚&quot; class=&quot;headerlink&quot; title=&quot;ä»£ç å®¡è®¡ç¯å¢ƒæ­å»ºæ³¨æ„ç»†èŠ‚&quot;&gt;&lt;/a&gt;ä»£ç å®¡è®¡ç¯å¢ƒæ­å»ºæ³¨æ„ç»†èŠ‚&lt;/h1&gt;&lt;h2 id=&quot;1-php-iniå‚æ•°é—®é¢˜ï¼š&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    <category term="ä»£ç å®¡è®¡" scheme="https://gbk.cx/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
    <category term="è°ƒè¯•" scheme="https://gbk.cx/tags/%E8%B0%83%E8%AF%95/"/>
    
    <category term="debug" scheme="https://gbk.cx/tags/debug/"/>
    
  </entry>
  
  <entry>
    <title>MVCè®¾è®¡æ¨¡å¼-1</title>
    <link href="https://gbk.cx/p/988d33e4/"/>
    <id>https://gbk.cx/p/988d33e4/</id>
    <published>2024-10-19T14:05:04.000Z</published>
    <updated>2024-10-19T14:22:14.584Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-MVCä»‹ç»"><a href="#1-MVCä»‹ç»" class="headerlink" title="1 MVCä»‹ç»"></a>1 MVCä»‹ç»</h1><p>1ã€MVCæ˜¯ä¸€ä¸ªç¼–ç¨‹æ€æƒ³ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼</p><p>2ã€æ€æƒ³ï¼šå°†ä¸€ä¸ªåŠŸèƒ½åˆ†è§£æˆ3ä¸ªéƒ¨åˆ†ï¼ŒM  V  C</p><p>Modelï¼ˆæ¨¡å‹ï¼‰:å¤„ç†ä¸æ•°æ®æœ‰å…³çš„é€»è¾‘</p><p>Viewï¼ˆè§†å›¾ï¼‰:æ˜¾ç¤ºé¡µé¢</p><p>Controllerï¼ˆæ§åˆ¶å™¨ï¼‰:å¤„ç†ä¸šåŠ¡é€»è¾‘</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/4I8TglLLlt2pSCVvVN9Y1729346828214.png" alt="1561254292854.png"></p><p>å°ç»“ï¼š</p><p>1ã€æ§åˆ¶å™¨ç”¨æ¥æ¥æ”¶è¯·æ±‚</p><p>2ã€ä»¥åä¸èƒ½ç›´æ¥è¯·æ±‚æ¨¡å‹å’Œè§†å›¾</p><h1 id="2-MVCæ¼”åŒ–"><a href="#2-MVCæ¼”åŒ–" class="headerlink" title="2 MVCæ¼”åŒ–"></a>2 <strong>MVCæ¼”åŒ–</strong></h1><h2 id="2-1-æ˜¾ç¤ºå•†å“"><a href="#2-1-æ˜¾ç¤ºå•†å“" class="headerlink" title="2.1 æ˜¾ç¤ºå•†å“"></a>2.1 æ˜¾ç¤ºå•†å“</h2><p>1ã€å¯¼å…¥productsè¡¨çš„æ•°æ®</p><p>2ã€å°†ä¸Šä¸€è®²çš„MyPDOç±»æ‹·è´åˆ°ç«™ç‚¹ä¸‹ï¼Œæ”¹åä¸ºMyPDO.class.phpï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­åªå­˜æ”¾MyPDOç±»</p><p>3ã€åœ¨ç«™ç‚¹ä¸‹åˆ›å»ºindex.phpï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//è‡ªåŠ¨åŠ è½½ç±»</span></span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(function(<span class="variable">$class_name</span>)&#123;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&quot;./<span class="subst">&#123;$class_name&#125;</span>.class.php&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line"><span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;user&#x27;</span>  =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;pwd&#x27;</span>   =&gt;  <span class="string">&#x27;root&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="variable">$mypdo</span>= MyPDO::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="comment">//è·å–å•†å“æ•°æ®</span></span><br><span class="line"><span class="variable">$list</span>=<span class="variable">$mypdo</span>-&gt;<span class="title function_ invoke__">fetchAll</span>(<span class="string">&#x27;select * from products&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;æ— æ ‡é¢˜æ–‡æ¡£&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;table border=<span class="string">&#x27;1&#x27;</span> width=<span class="string">&#x27;980&#x27;</span> bordercolor=<span class="string">&#x27;#000&#x27;</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;ç¼–å·&lt;/th&gt; &lt;th&gt;åç§°&lt;/th&gt; &lt;th&gt;ä»·æ ¼&lt;/th&gt; &lt;th&gt;åˆ é™¤&lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span> <span class="keyword">foreach</span>(<span class="variable">$list</span> <span class="keyword">as</span> <span class="variable">$rows</span>):<span class="meta">?&gt;</span></span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?=</span><span class="variable">$rows</span>[<span class="string">&#x27;proID&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?=</span><span class="variable">$rows</span>[<span class="string">&#x27;proname&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?=</span><span class="variable">$rows</span>[<span class="string">&#x27;proprice&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=<span class="string">&quot;&quot;</span>&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>;<span class="meta">?&gt;</span></span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="2-2-æ¼”åŒ–ä¸€ï¼šåˆ†ç¦»è§†å›¾"><a href="#2-2-æ¼”åŒ–ä¸€ï¼šåˆ†ç¦»è§†å›¾" class="headerlink" title="2.2 æ¼”åŒ–ä¸€ï¼šåˆ†ç¦»è§†å›¾"></a>2.2 æ¼”åŒ–ä¸€ï¼šåˆ†ç¦»è§†å›¾</h2><p>1ã€åˆ›å»ºproducts_list.htmlé¡µé¢ï¼ˆè§†å›¾é¡µé¢ï¼‰,å°†æ˜¾ç¤ºéƒ¨åˆ†çš„ä»£ç æ‹·è´åˆ°è§†å›¾é¡µé¢ä¸Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;æ— æ ‡é¢˜æ–‡æ¡£&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;table border=<span class="string">&#x27;1&#x27;</span> width=<span class="string">&#x27;980&#x27;</span> bordercolor=<span class="string">&#x27;#000&#x27;</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;ç¼–å·&lt;/th&gt; &lt;th&gt;åç§°&lt;/th&gt; &lt;th&gt;ä»·æ ¼&lt;/th&gt; &lt;th&gt;åˆ é™¤&lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span> <span class="keyword">foreach</span>(<span class="variable">$list</span> <span class="keyword">as</span> <span class="variable">$rows</span>):<span class="meta">?&gt;</span></span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?=</span><span class="variable">$rows</span>[<span class="string">&#x27;proID&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?=</span><span class="variable">$rows</span>[<span class="string">&#x27;proname&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;<span class="meta">&lt;?=</span><span class="variable">$rows</span>[<span class="string">&#x27;proprice&#x27;</span>]<span class="meta">?&gt;</span>&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href=<span class="string">&quot;&quot;</span>&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        <span class="meta">&lt;?php</span> <span class="keyword">endforeach</span>;<span class="meta">?&gt;</span></span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>2ã€åœ¨index.phpé¡µé¢ä¸ŠåŠ è½½è§†å›¾</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//è‡ªåŠ¨åŠ è½½ç±»</span></span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(function(<span class="variable">$class_name</span>)&#123;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&quot;./<span class="subst">&#123;$class_name&#125;</span>.class.php&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line"><span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;user&#x27;</span>  =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;pwd&#x27;</span>   =&gt;  <span class="string">&#x27;root&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="variable">$mypdo</span>= MyPDO::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="comment">//è·å–å•†å“æ•°æ®</span></span><br><span class="line"><span class="variable">$list</span>=<span class="variable">$mypdo</span>-&gt;<span class="title function_ invoke__">fetchAll</span>(<span class="string">&#x27;select * from products&#x27;</span>);</span><br><span class="line"><span class="comment">//åŠ è½½è§†å›¾</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./products_list.html&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="2-3-æ¼”åŒ–äºŒï¼šåˆ†ç¦»æ¨¡å‹"><a href="#2-3-æ¼”åŒ–äºŒï¼šåˆ†ç¦»æ¨¡å‹" class="headerlink" title="2.3 æ¼”åŒ–äºŒï¼šåˆ†ç¦»æ¨¡å‹"></a>2.3 <strong>æ¼”åŒ–äºŒï¼šåˆ†ç¦»æ¨¡å‹</strong></h2><p>æ¨¡å‹çš„è§„åˆ™</p><p>1ã€ä¸€ä¸ªè¡¨å¯¹åº”ä¸€ä¸ªæ¨¡å‹ï¼Œè¡¨åå’Œæ¨¡å‹åä¸€è‡´ï¼ˆå¿…é¡»çš„ï¼‰</p><p>2ã€æ¨¡å‹ä»¥Modelç»“å°¾ï¼ˆä¸æ˜¯å¿…é¡»çš„ï¼‰</p><p>ä»£ç å®ç°:</p><p>1ã€åœ¨ç«™ç‚¹ä¸‹åˆ›å»ºProductsModel.class.phpé¡µé¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//productsæ¨¡å‹ç”¨æ¥æ“ä½œproductsè¡¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsModel</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è·å–productsè¡¨çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getList</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">        <span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;user&#x27;</span>  =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;pwd&#x27;</span>   =&gt;  <span class="string">&#x27;root&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="variable">$mypdo</span>= MyPDO::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line">        <span class="comment">//è·å–å•†å“æ•°æ®</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$mypdo</span>-&gt;<span class="title function_ invoke__">fetchAll</span>(<span class="string">&#x27;select * from products&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€åœ¨index.phpé¡µé¢ä¸­è°ƒç”¨æ¨¡å‹çš„getList()</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//è‡ªåŠ¨åŠ è½½ç±»</span></span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(function(<span class="variable">$class_name</span>)&#123;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&quot;./<span class="subst">&#123;$class_name&#125;</span>.class.php&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//å®ä¾‹åŒ–æ¨¡å‹</span></span><br><span class="line"><span class="variable">$model</span>=<span class="keyword">new</span> <span class="title class_">ProductsModel</span>();</span><br><span class="line"><span class="variable">$list</span>=<span class="variable">$model</span>-&gt;<span class="title function_ invoke__">getList</span>();</span><br><span class="line"><span class="comment">//åŠ è½½è§†å›¾</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./products_list.html&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="2-4-æ¼”åŒ–ä¸‰ï¼šåˆ†ç¦»åŸºç¡€æ¨¡å‹"><a href="#2-4-æ¼”åŒ–ä¸‰ï¼šåˆ†ç¦»åŸºç¡€æ¨¡å‹" class="headerlink" title="2.4 æ¼”åŒ–ä¸‰ï¼šåˆ†ç¦»åŸºç¡€æ¨¡å‹"></a>2.4 <strong>æ¼”åŒ–ä¸‰ï¼šåˆ†ç¦»åŸºç¡€æ¨¡å‹</strong></h3><p>è¿æ¥æ•°æ®åº“çš„ä»£ç æ¯ä¸ªæ¨¡å‹éƒ½è¦ä½¿ç”¨ï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦å°†è¿æ¥æ•°æ®åº“çš„ä»£ç å°è£…åˆ°åŸºç¡€æ¨¡å‹ç±»ä¸­ï¼ˆModelï¼‰</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/yOKWQN5GG4pjr8R2OlAG1729346833736.png" alt="1561257239690.png"></p><p>ç¬¬ä¸€æ­¥ï¼šåœ¨ç«™ç‚¹ä¸‹åˆ›å»ºModel.class.phpé¡µé¢ï¼ˆåŸºç¡€æ¨¡å‹ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//åŸºç¡€æ¨¡å‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$mypdo</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initMyPDO</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initMyPDO</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;user&#x27;</span>  =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;pwd&#x27;</span>   =&gt;  <span class="string">&#x27;root&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;mypdo= MyPDO::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼šProductsModelç»§æ‰¿åŸºç¡€æ¨¡å‹ç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//productsæ¨¡å‹ç”¨æ¥æ“ä½œproductsè¡¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsModel</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="comment">//è·å–productsè¡¨çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getList</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;mypdo-&gt;<span class="title function_ invoke__">fetchAll</span>(<span class="string">&#x27;select * from products&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-5-æ¼”åŒ–å››ï¼šåˆ†ç¦»æ§åˆ¶å™¨"><a href="#2-5-æ¼”åŒ–å››ï¼šåˆ†ç¦»æ§åˆ¶å™¨" class="headerlink" title="2.5 æ¼”åŒ–å››ï¼šåˆ†ç¦»æ§åˆ¶å™¨"></a>2.5 <strong>æ¼”åŒ–å››ï¼šåˆ†ç¦»æ§åˆ¶å™¨</strong></h2><p>æ§åˆ¶å™¨ä»£ç æ”¾åœ¨index.phpé¡µé¢ä¸­æ˜¯ä¸åˆç†çš„ï¼Œå› ä¸ºé¡¹ç›®ä¸­çš„æ§åˆ¶å™¨ä¼šå¾ˆå¤šï¼Œè€Œindex.phpåªæœ‰ä¸€ä¸ªã€‚æ‰€ä»¥éœ€è¦å°†æ§åˆ¶å™¨åˆ†ç¦»å¼€æ¥</p><p>æ§åˆ¶å™¨çš„è§„åˆ™ï¼š</p><p>1ã€ä¸€ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆå¿…é¡»çš„ï¼‰</p><p>2ã€æ§åˆ¶å™¨ä»¥Controllerç»“å°¾ï¼ˆä¸æ˜¯å¿…é¡»çš„ï¼‰</p><p>3ã€æ§åˆ¶å™¨ä¸­çš„æ–¹æ³•ä»¥Actionç»“å°¾ï¼ˆä¸æ˜¯å¿…é¡»çš„ï¼‰,ç›®çš„é˜²æ­¢æ–¹æ³•åæ˜¯PHPå…³é”®å­—</p><p>åˆ›å»ºProductsController.class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å•†å“æ¨¡å—</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsController</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è·å–å•†å“åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">listAction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//å®ä¾‹åŒ–æ¨¡å‹</span></span><br><span class="line">        <span class="variable">$model</span>=<span class="keyword">new</span> <span class="title class_">ProductsModel</span>();</span><br><span class="line">        <span class="variable">$list</span>=<span class="variable">$model</span>-&gt;<span class="title function_ invoke__">getList</span>();</span><br><span class="line">        <span class="comment">//åŠ è½½è§†å›¾</span></span><br><span class="line">        <span class="keyword">require</span> <span class="string">&#x27;./products_list.html&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>index.phpé¡µé¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//è‡ªåŠ¨åŠ è½½ç±»</span></span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(function(<span class="variable">$class_name</span>)&#123;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&quot;./<span class="subst">&#123;$class_name&#125;</span>.class.php&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//ç¡®å®šè·¯ç”±</span></span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]??<span class="string">&#x27;Products&#x27;</span>; Â  <span class="comment">//æ§åˆ¶å™¨</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]??<span class="string">&#x27;list&#x27;</span>;      <span class="comment">//æ–¹æ³•</span></span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">ucfirst</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$c</span>));     <span class="comment">//é¦–å­—æ¯å¤§å†™</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">strtolower</span>(<span class="variable">$a</span>);              <span class="comment">//è½¬æˆå°å†™</span></span><br><span class="line"><span class="variable">$controller_name</span>=<span class="variable">$c</span>.<span class="string">&#x27;Controller&#x27;</span>;   <span class="comment">//æ‹¼æ¥æ§åˆ¶å™¨ç±»å</span></span><br><span class="line"><span class="variable">$action_name</span>=<span class="variable">$a</span>.<span class="string">&#x27;Action&#x27;</span>;   <span class="comment">//æ‹¼æ¥æ–¹æ³•å</span></span><br><span class="line"><span class="comment">//è¯·æ±‚åˆ†å‘</span></span><br><span class="line"><span class="variable">$obj</span>=<span class="keyword">new</span> <span class="variable">$controller_name</span>();</span><br><span class="line"><span class="variable">$obj</span>-&gt;<span class="variable">$action_name</span>();</span><br></pre></td></tr></table></figure><p>aï¼šæ–¹æ³•</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/fCqIzgEIUOYxTcEEXsJx1729346840604.png" alt="1561261105995.png"></p><p>cï¼šæ§åˆ¶å™¨</p><p>é€šè¿‡åœ¨urlåœ°å€ä¸Šä¼ é€’å‚æ•°æ¥å¯»å€ã€‚</p><h1 id="3-åˆ é™¤å•†å“"><a href="#3-åˆ é™¤å•†å“" class="headerlink" title="3 åˆ é™¤å•†å“"></a>3 <strong>åˆ é™¤å•†å“</strong></h1><p>å°ç»“ï¼š</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/OyKpvWIy4iktuDbxzjbX1729346852295.png" alt="1561261460012.png"></p><p>æ³¨æ„ï¼šæ¯æ¬¡è¯·æ±‚éƒ½è¦ä»index.phpè¿›å…¥ã€‚æ‰€ä»¥index.phpåˆå«å…¥å£æ–‡ä»¶ã€‚</p><p>å…¥å£(products_list.html)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;a href=<span class="string">&quot;index.php?c=Products&amp;a=del&amp;proid=&lt;?=<span class="subst">$rows</span>[&#x27;proID&#x27;]?&gt;&quot;</span> onclick=<span class="string">&quot;return confirm(&#x27;ç¡®å®šè¦åˆ é™¤å—&#x27;)&quot;</span>&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ§åˆ¶å™¨ï¼ˆProductsControllerï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å•†å“æ¨¡å—</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsController</span> </span>&#123;</span><br><span class="line">..</span><br><span class="line"><span class="comment">//åˆ é™¤å•†å“</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">delAction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="variable">$id</span>=(<span class="keyword">int</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;proid&#x27;</span>];<span class="comment">//å¦‚æœå‚æ•°æ˜ç¡®æ˜¯æ•´æ•°ï¼Œè¦å¼ºåˆ¶è½¬æˆæ•´å½¢</span></span><br><span class="line"><span class="variable">$model</span>=<span class="keyword">new</span> <span class="title class_">ProductsModel</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$model</span>-&gt;<span class="title function_ invoke__">del</span>(<span class="variable">$id</span>))</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;location:index.php?c=Products&amp;a=list&#x27;</span>);</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;åˆ é™¤å¤±è´¥&#x27;</span>;</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¨¡å‹ï¼ˆProductsModelï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//productsæ¨¡å‹ç”¨æ¥æ“ä½œproductsè¡¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsModel</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">...</span><br><span class="line"><span class="comment">//åˆ é™¤å•†å“</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">del</span>(<span class="params"><span class="variable">$proid</span></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;mypdo-&gt;<span class="title function_ invoke__">exec</span>(<span class="string">&quot;delete from products where proid=<span class="subst">$proid</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-MVCä»‹ç»&quot;&gt;&lt;a href=&quot;#1-MVCä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;1 MVCä»‹ç»&quot;&gt;&lt;/a&gt;1 MVCä»‹ç»&lt;/h1&gt;&lt;p&gt;1ã€MVCæ˜¯ä¸€ä¸ªç¼–ç¨‹æ€æƒ³ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼&lt;/p&gt;
&lt;p&gt;2ã€æ€æƒ³ï¼šå°†ä¸€ä¸ªåŠŸèƒ½åˆ†è§£æˆ3ä¸ªéƒ¨åˆ†ï¼ŒM  V</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>MVCè®¾è®¡æ¨¡å¼-2</title>
    <link href="https://gbk.cx/p/184625e/"/>
    <id>https://gbk.cx/p/184625e/</id>
    <published>2024-10-19T14:04:58.000Z</published>
    <updated>2024-10-19T14:09:40.826Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-æ¡†æ¶ç›®å½•"><a href="#1-æ¡†æ¶ç›®å½•" class="headerlink" title="1 æ¡†æ¶ç›®å½•"></a>1 æ¡†æ¶ç›®å½•</h1><h2 id="1-1-åˆ›å»ºç›®å½•ç»“æ„"><a href="#1-1-åˆ›å»ºç›®å½•ç»“æ„" class="headerlink" title="1.1 åˆ›å»ºç›®å½•ç»“æ„"></a>1.1 <strong>åˆ›å»ºç›®å½•ç»“æ„</strong></h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/EntX05kPuvB8K3Kd3AB61729346712069.png" alt="1561428443831.png"></p><h2 id="1-2-æ–‡ä»¶åˆ†ç±»å­˜æ”¾"><a href="#1-2-æ–‡ä»¶åˆ†ç±»å­˜æ”¾" class="headerlink" title="1.2 æ–‡ä»¶åˆ†ç±»å­˜æ”¾"></a>1.2 <strong>æ–‡ä»¶åˆ†ç±»å­˜æ”¾</strong></h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/JqvdMQhivwR4xGTVLrCn1729346715253.png" alt="1561429370394.png"></p><p>å°†æ–‡ä»¶å­˜æ”¾åˆ°ä¸åŒçš„ç›®å½•ä»¥åï¼Œç”±äºç±»æ–‡ä»¶åœ°å€å‘ç”Ÿäº†å˜åŒ–ï¼Œæ‰€ä»¥æ— æ³•å®Œæˆè‡ªåŠ¨åŠ è½½ç±»ï¼Œé‚£ä¹ˆä»Šå¤©çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯å›´ç»•å¦‚ä½•å®ç°ç±»çš„è‡ªåŠ¨åŠ è½½å±•å¼€ã€‚</p><p>ç”±äºæ¯æ¬¡éƒ½è¯·æ±‚å…¥å£æ–‡ä»¶ï¼Œæ‰€ä»¥â€.â€œè¡¨ç¤ºå…¥å£æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•</p><h1 id="2-æ·»åŠ å‘½åç©ºé—´"><a href="#2-æ·»åŠ å‘½åç©ºé—´" class="headerlink" title="2 æ·»åŠ å‘½åç©ºé—´"></a>2 <strong>æ·»åŠ å‘½åç©ºé—´</strong></h1><p>é€šè¿‡æ–‡ä»¶ç›®å½•åœ°å€åšå‘½åç©ºé—´ï¼Œè¿™æ ·è·å–äº†å‘½åç©ºé—´å°±èƒ½çŸ¥é“æ–‡ä»¶å­˜æ”¾çš„åœ°å€ã€‚</p><p>Model.class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title class_">Core</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span> </span>&#123;</span><br><span class="line"> Â   ...</span><br></pre></td></tr></table></figure><p>MyPDO.class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title class_">Core</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPDO</span></span>&#123;</span><br><span class="line"> Â   ...</span><br></pre></td></tr></table></figure><p>ProductsModel.class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Model</span>;</span><br><span class="line"><span class="comment">//productsæ¨¡å‹ç”¨æ¥æ“ä½œproductsè¡¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsModel</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line"> Â   ...</span><br></pre></td></tr></table></figure><p>ProductsController.class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Controller</span>\<span class="title class_">Admin</span>;</span><br><span class="line"><span class="comment">//å•†å“æ¨¡å—</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsController</span> </span>&#123;</span><br><span class="line"> Â   ...</span><br></pre></td></tr></table></figure><h1 id="3-æ¡†æ¶ç±»å®ç°"><a href="#3-æ¡†æ¶ç±»å®ç°" class="headerlink" title="3 æ¡†æ¶ç±»å®ç°"></a>3 <strong>æ¡†æ¶ç±»å®ç°</strong></h1><h2 id="3-1-å®šä¹‰è·¯å¾„å¸¸é‡"><a href="#3-1-å®šä¹‰è·¯å¾„å¸¸é‡" class="headerlink" title="3.1 å®šä¹‰è·¯å¾„å¸¸é‡"></a>3.1 <strong>å®šä¹‰è·¯å¾„å¸¸é‡</strong></h2><p>ç”±äºæ–‡ä»¶è·¯å¾„ä½¿ç”¨é¢‘ç‡å¾ˆé«˜ï¼Œè€Œä¸”è·¯å¾„æ¯”è¾ƒé•¿ï¼Œæ‰€ä»¥å°†å›ºå®šä¸å˜çš„è·¯å¾„å®šä¹‰æˆè·¯å¾„å¸¸é‡</p><p>çŸ¥è¯†ç‚¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€<span class="title function_ invoke__">getcwd</span>()ï¼šå…¥å£æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span><br><span class="line"><span class="number">2</span>ã€windowsä¸‹é»˜è®¤çš„ç›®å½•åˆ†éš”ç¬¦æ˜¯`\`ï¼ŒLinuxä¸‹é»˜è®¤çš„ç›®å½•åˆ†éš”ç¬¦æ˜¯`/`ã€‚DIRECTORY_SEPARATORå¸¸é‡æ ¹æ®ä¸åŒçš„æ“ä½œç³»ç»Ÿè¿”å›ä¸åŒçš„ç›®å½•åˆ†éš”ç¬¦ã€‚</span><br></pre></td></tr></table></figure><p>ä»£ç å®ç°</p><p>åœ¨Coreæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºFramework.class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">initConst</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DS&#x27;</span>, DIRECTORY_SEPARATOR); Â <span class="comment">//å®šä¹‰ç›®å½•åˆ†éš”ç¬¦</span></span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;ROOT_PATH&#x27;</span>, <span class="title function_ invoke__">getcwd</span>().DS); Â <span class="comment">//å…¥å£æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•</span></span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;APP_PATH&#x27;</span>, ROOT_PATH.<span class="string">&#x27;Application&#x27;</span>.DS); Â  <span class="comment">//applicationç›®å½•</span></span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;CONFIG_PATH&#x27;</span>, APP_PATH.<span class="string">&#x27;Config&#x27;</span>.DS);</span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;CONTROLLER_PATH&#x27;</span>, APP_PATH.<span class="string">&#x27;Controller&#x27;</span>.DS);</span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;MODEL_PATH&#x27;</span>, APP_PATH.<span class="string">&#x27;Model&#x27;</span>.DS);</span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;VIEW_PATH&#x27;</span>, APP_PATH.<span class="string">&#x27;View&#x27;</span>.DS);</span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;FRAMEWORK_PATH&#x27;</span>, ROOT_PATH.<span class="string">&#x27;Framework&#x27;</span>.DS);</span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;CORE_PATH&#x27;</span>, FRAMEWORK_PATH.<span class="string">&#x27;Core&#x27;</span>.DS);</span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;LIB_PATH&#x27;</span>, FRAMEWORK_PATH.<span class="string">&#x27;Lib&#x27;</span>.DS);</span><br><span class="line"> Â  Â <span class="title function_ invoke__">define</span>(<span class="string">&#x27;TRAITS_PATH&#x27;</span>, ROOT_PATH.<span class="string">&#x27;Traits&#x27;</span>.DS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-2-å¼•å…¥é…ç½®æ–‡ä»¶"><a href="#3-2-å¼•å…¥é…ç½®æ–‡ä»¶" class="headerlink" title="3.2 å¼•å…¥é…ç½®æ–‡ä»¶"></a>3.2 <strong>å¼•å…¥é…ç½®æ–‡ä»¶</strong></h2><p>1ã€åœ¨configç›®å½•ä¸‹åˆ›å»ºconfig.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">array</span>(</span><br><span class="line"> Â  Â <span class="comment">//æ•°æ®åº“é…ç½®</span></span><br><span class="line"> Â  Â <span class="string">&#x27;database&#x27;</span>=&gt;<span class="keyword">array</span>(),</span><br><span class="line"> Â  Â <span class="comment">//åº”ç”¨ç¨‹åºé…ç½®</span></span><br><span class="line"> Â  Â <span class="string">&#x27;app&#x27;</span> Â  Â  Â  =&gt;<span class="keyword">array</span>(</span><br><span class="line"> Â  Â  Â  Â <span class="string">&#x27;dp&#x27;</span> Â  Â =&gt; Â <span class="string">&#x27;Admin&#x27;</span>, Â  Â  Â  Â <span class="comment">//é»˜è®¤å¹³å°</span></span><br><span class="line"> Â  Â  Â  Â <span class="string">&#x27;dc&#x27;</span> Â  Â =&gt; Â <span class="string">&#x27;Products&#x27;</span>, Â  Â  <span class="comment">//é»˜è®¤æ§åˆ¶å™¨</span></span><br><span class="line"> Â  Â  Â  Â <span class="string">&#x27;da&#x27;</span> Â  Â =&gt; Â <span class="string">&#x27;list&#x27;</span> Â  Â  Â  Â  Â <span class="comment">//é»˜è®¤æ–¹æ³•</span></span><br><span class="line"> Â   ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>2ã€åœ¨æ¡†æ¶ç±»ä¸­å¼•å…¥é…ç½®æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">initConfig</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> Â  <span class="variable">$GLOBALS</span>[<span class="string">&#x27;config&#x27;</span>]=<span class="keyword">require</span> CONFIG_PATH.<span class="string">&#x27;config.php&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€è€ƒï¼šé…ç½®æ–‡ä»¶ä¸ºä»€ä¹ˆä¸ä¿å­˜åœ¨å¸¸é‡ä¸­ï¼Ÿ</p><p>ç­”ï¼šå› ä¸º7.0ä¹‹å‰ï¼Œå¸¸é‡ä¸èƒ½ä¿å­˜æ•°ç»„å’Œå¯¹è±¡ã€‚</p><h2 id="3-3-ç¡®å®šè·¯ç”±"><a href="#3-3-ç¡®å®šè·¯ç”±" class="headerlink" title="3.3 ç¡®å®šè·¯ç”±"></a>3.3 <strong>ç¡®å®šè·¯ç”±</strong></h2><p>pï¼šã€platformã€‘å¹³å°</p><p>cï¼šã€controllerã€‘æ§åˆ¶å™¨</p><p>aï¼šã€actionã€‘æ–¹æ³•</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/kvd3WEQnZpvLfboxrlIH1729346721027.png" alt="1561431781576.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">initRoutes</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$p</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>]??<span class="variable">$GLOBALS</span>[<span class="string">&#x27;config&#x27;</span>][<span class="string">&#x27;app&#x27;</span>][<span class="string">&#x27;dp&#x27;</span>];</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]??<span class="variable">$GLOBALS</span>[<span class="string">&#x27;config&#x27;</span>][<span class="string">&#x27;app&#x27;</span>][<span class="string">&#x27;dc&#x27;</span>];</span><br><span class="line">    <span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]??<span class="variable">$GLOBALS</span>[<span class="string">&#x27;config&#x27;</span>][<span class="string">&#x27;app&#x27;</span>][<span class="string">&#x27;da&#x27;</span>];</span><br><span class="line">    <span class="variable">$p</span>=<span class="title function_ invoke__">ucfirst</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$p</span>));</span><br><span class="line">    <span class="variable">$c</span>=<span class="title function_ invoke__">ucfirst</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$c</span>));<span class="comment">//é¦–å­—æ¯å¤§å†™</span></span><br><span class="line">    <span class="variable">$a</span>=<span class="title function_ invoke__">strtolower</span>(<span class="variable">$a</span>);<span class="comment">//è½¬æˆå°å†™</span></span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;PLATFROM_NAME&#x27;</span>, <span class="variable">$p</span>);    <span class="comment">//å¹³å°åå¸¸é‡</span></span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;CONTROLLER_NAME&#x27;</span>, <span class="variable">$c</span>);  <span class="comment">//æ§åˆ¶å™¨åå¸¸é‡</span></span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;ACTION_NAME&#x27;</span>, <span class="variable">$a</span>);      <span class="comment">//æ–¹æ³•åå¸¸é‡</span></span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;__URL__&#x27;</span>, CONTROLLER_PATH.<span class="variable">$p</span>.DS);   <span class="comment">//å½“å‰è¯·æ±‚æ§åˆ¶å™¨çš„ç›®å½•åœ°å€</span></span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;__VIEW__&#x27;</span>,VIEW_PATH.<span class="variable">$p</span>.DS);     <span class="comment">//å½“å‰è§†å›¾çš„ç›®å½•åœ°å€</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-4-è‡ªåŠ¨åŠ è½½ç±»"><a href="#3-4-è‡ªåŠ¨åŠ è½½ç±»" class="headerlink" title="3.4 è‡ªåŠ¨åŠ è½½ç±»"></a>3.4 <strong>è‡ªåŠ¨åŠ è½½ç±»</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">initAutoLoad</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">spl_autoload_register</span>(function(<span class="variable">$class_name</span>)&#123;</span><br><span class="line">        <span class="variable">$namespace</span>= <span class="title function_ invoke__">dirname</span>(<span class="variable">$class_name</span>);   <span class="comment">//å‘½åç©ºé—´</span></span><br><span class="line">        <span class="variable">$class_name</span>= <span class="title function_ invoke__">basename</span>(<span class="variable">$class_name</span>); <span class="comment">//ç±»å</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$namespace</span>, <span class="keyword">array</span>(<span class="string">&#x27;Core&#x27;</span>,<span class="string">&#x27;Lib&#x27;</span>)))   <span class="comment">//å‘½åç©ºé—´åœ¨Coreå’ŒLibä¸‹</span></span><br><span class="line">            <span class="variable">$path</span>= FRAMEWORK_PATH.<span class="variable">$namespace</span>.DS.<span class="variable">$class_name</span>.<span class="string">&#x27;.class.php&#x27;</span>;</span><br><span class="line">        <span class="keyword">elseif</span>(<span class="variable">$namespace</span>==<span class="string">&#x27;Model&#x27;</span>)     <span class="comment">//æ–‡ä»¶åœ¨Modelä¸‹</span></span><br><span class="line">            <span class="variable">$path</span>=MODEL_PATH.<span class="variable">$class_name</span>.<span class="string">&#x27;.class.php&#x27;</span>;</span><br><span class="line">        <span class="keyword">elseif</span>(<span class="variable">$namespace</span>==<span class="string">&#x27;Traits&#x27;</span>)    <span class="comment">//æ–‡ä»¶åœ¨Traitsä¸‹</span></span><br><span class="line">            <span class="variable">$path</span>=TRAITS_PATH.<span class="variable">$class_name</span>.<span class="string">&#x27;.class.php&#x27;</span>;</span><br><span class="line">        <span class="keyword">else</span>   <span class="comment">//æ§åˆ¶å™¨</span></span><br><span class="line">            <span class="variable">$path</span>=CONTROLLER_PATH.PLATFROM_NAME.DS.<span class="variable">$class_name</span>.<span class="string">&#x27;.class.php&#x27;</span>; </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$path</span>) &amp;&amp; <span class="title function_ invoke__">is_file</span>(<span class="variable">$path</span>))</span><br><span class="line">            <span class="keyword">require</span> <span class="variable">$path</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-5-è¯·æ±‚åˆ†å‘"><a href="#3-5-è¯·æ±‚åˆ†å‘" class="headerlink" title="3.5 è¯·æ±‚åˆ†å‘"></a>3.5 <strong>è¯·æ±‚åˆ†å‘</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">initDispatch</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$controller_name</span>=<span class="string">&#x27;\Controller\\&#x27;</span>.PLATFROM_NAME.<span class="string">&#x27;\\&#x27;</span>.CONTROLLER_NAME.<span class="string">&#x27;Controller&#x27;</span>;<span class="comment">//æ‹¼æ¥æ§åˆ¶å™¨ç±»å</span></span><br><span class="line">    <span class="variable">$action_name</span>=ACTION_NAME.<span class="string">&#x27;Action&#x27;</span>;<span class="comment">//æ‹¼æ¥æ–¹æ³•å</span></span><br><span class="line">    <span class="variable">$obj</span>=<span class="keyword">new</span> <span class="variable">$controller_name</span>();</span><br><span class="line">    <span class="variable">$obj</span>-&gt;<span class="variable">$action_name</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-6-å°è£…run-æ–¹æ³•"><a href="#3-6-å°è£…run-æ–¹æ³•" class="headerlink" title="3.6 å°è£…run()æ–¹æ³•"></a>3.6 <strong>å°è£…run()æ–¹æ³•</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Framework</span></span>&#123;</span><br><span class="line">    <span class="comment">//å¯åŠ¨æ¡†æ¶</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">self</span>::<span class="title function_ invoke__">initConst</span>();</span><br><span class="line">        <span class="built_in">self</span>::<span class="title function_ invoke__">initConfig</span>();</span><br><span class="line">        <span class="built_in">self</span>::<span class="title function_ invoke__">initRoutes</span>();</span><br><span class="line">        <span class="built_in">self</span>::<span class="title function_ invoke__">initAutoLoad</span>();</span><br><span class="line">        <span class="built_in">self</span>::<span class="title function_ invoke__">initDispatch</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><h2 id="3-7-åœ¨å…¥å£ä¸­è°ƒç”¨run-æ–¹æ³•"><a href="#3-7-åœ¨å…¥å£ä¸­è°ƒç”¨run-æ–¹æ³•" class="headerlink" title="3.7 åœ¨å…¥å£ä¸­è°ƒç”¨run()æ–¹æ³•"></a>3.7 <strong>åœ¨å…¥å£ä¸­è°ƒç”¨run()æ–¹æ³•</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./Framework/Core/Framework.class.php&#x27;</span>;</span><br><span class="line"><span class="title class_">Framework</span>::<span class="title function_ invoke__">run</span>();</span><br></pre></td></tr></table></figure><p>run()æ–¹æ³•è°ƒç”¨åå°±å¯åŠ¨äº†æ¡†æ¶</p><h1 id="4-è¿è¡Œé¡¹ç›®"><a href="#4-è¿è¡Œé¡¹ç›®" class="headerlink" title="4 è¿è¡Œé¡¹ç›®"></a>4 <strong>è¿è¡Œé¡¹ç›®</strong></h1><p>1ã€è¿æ¥æ•°æ®åº“çš„å‚æ•°ä»é…ç½®æ–‡ä»¶ä¸­è·å–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Model</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initMyPDO</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> Â  Â  Â  <span class="variable language_">$this</span>-&gt;mypdo= MyPDO::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;config&#x27;</span>][<span class="string">&#x27;database&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€æ›´æ”¹ProductsControlelleræ§åˆ¶å™¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Controller</span>\<span class="title class_">Admin</span>;</span><br><span class="line"><span class="comment">//å•†å“æ¨¡å—</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsController</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è·å–å•†å“åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">listAction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="comment">//å®ä¾‹åŒ–æ¨¡å‹</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable">$model</span>=<span class="keyword">new</span> <span class="title class_">\Model\ProductsModel</span>();</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable">$list</span>=<span class="variable">$model</span>-&gt;<span class="title function_ invoke__">getList</span>();</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="comment">//åŠ è½½è§†å›¾</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">require</span> __VIEW__.<span class="string">&#x27;products_list.html&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ é™¤å•†å“</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">delAction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="variable">$model</span>=<span class="keyword">new</span> <span class="title class_">\Model\ProductsModel</span>();</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ã€æ›´æ”¹ProductsModelç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Model</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsModel</span> <span class="keyword">extends</span> \<span class="title">Core</span>\<span class="title">Model</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ã€æ›´æ”¹MyPDOç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchType</span>(<span class="params"><span class="variable">$type</span></span>)</span>&#123;</span><br><span class="line"> Â  Â <span class="keyword">switch</span> (<span class="variable">$type</span>)&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">case</span> <span class="string">&#x27;num&#x27;</span>:</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">return</span> \PDO::<span class="variable constant_">FETCH_NUM</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">case</span> <span class="string">&#x27;both&#x27;</span>:</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">return</span> \PDO::<span class="variable constant_">FETCH_BOTH</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">case</span> <span class="string">&#x27;obj&#x27;</span>:</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">return</span> \PDO::<span class="variable constant_">FETCH_OBJ</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">default</span>:</span><br><span class="line"> Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> \PDO::<span class="variable constant_">FETCH_ASSOC</span>;</span><br><span class="line"> Â   &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="comment">//æ‰€æœ‰çš„å†…ç½®ç±»éƒ½åœ¨å…¬å…±çš„å‘½åç©ºé—´ä¸‹ã€‚</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼šæˆåŠŸ</p><h1 id="5-traitsä»£ç å¤ç”¨"><a href="#5-traitsä»£ç å¤ç”¨" class="headerlink" title="5 traitsä»£ç å¤ç”¨"></a>5 <strong>traitsä»£ç å¤ç”¨</strong></h1><p>æœ‰çš„æ§åˆ¶å™¨æ“ä½œå®Œæ¯•åè¦è·³è½¬ï¼Œæœ‰çš„ä¸éœ€è¦ï¼Œ</p><p>è§£å†³ï¼šå°†è·³è½¬çš„æ–¹æ³•å°è£…åˆ°traitsä¸­ã€‚</p><p>ä»£ç å®ç°</p><p>1ã€å°†å‡†å¤‡å¥½çš„å›¾ç‰‡æ‹·è´åˆ°Publicç›®å½•ä¸‹</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/u1nuVOMF76FH2iOtZ8o81729346725621.png" alt="1561446087858.png"></p><p>2ã€åœ¨Traitsç›®å½•ä¸­åˆ›å»ºJump.class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//è·³è½¬çš„æ’ä»¶</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Traits</span>;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Jump</span></span>&#123;</span><br><span class="line"> Â  Â <span class="comment">//å°è£…æˆåŠŸçš„è·³è½¬</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">success</span>(<span class="params"><span class="variable">$url</span>,<span class="variable">$info</span>=<span class="string">&#x27;&#x27;</span>,<span class="variable">$time</span>=<span class="number">1</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">redirect</span>(<span class="variable">$url</span>, <span class="variable">$info</span>, <span class="variable">$time</span>, <span class="string">&#x27;success&#x27;</span>);</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//å°è£…å¤±è´¥è·³è½¬</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">error</span>(<span class="params"><span class="variable">$url</span>,<span class="variable">$info</span>=<span class="string">&#x27;&#x27;</span>,<span class="variable">$time</span>=<span class="number">3</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">redirect</span>(<span class="variable">$url</span>, <span class="variable">$info</span>, <span class="variable">$time</span>, <span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">/*</span></span><br><span class="line"><span class="comment"> Â  Â  * ä½œç”¨ï¼šè·³è½¬çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment"> Â  Â  * <span class="doctag">@param</span> $url string è·³è½¬çš„åœ°å€</span></span><br><span class="line"><span class="comment"> Â  Â  * <span class="doctag">@param</span> $info string æ˜¾ç¤ºä¿¡æ¯</span></span><br><span class="line"><span class="comment"> Â  Â  * <span class="doctag">@param</span> $time int åœç•™æ—¶é—´</span></span><br><span class="line"><span class="comment"> Â  Â  * <span class="doctag">@param</span> $flag string æ˜¾ç¤ºæ¨¡å¼  success|error</span></span><br><span class="line"><span class="comment"> Â  Â  */</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">redirect</span>(<span class="params"><span class="variable">$url</span>,<span class="variable">$info</span>,<span class="variable">$time</span>,<span class="variable">$flag</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">if</span>(<span class="variable">$info</span>==<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="title function_ invoke__">header</span> (<span class="string">&quot;location:<span class="subst">&#123;$url&#125;</span>&quot;</span>);</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">else</span>&#123;</span><br><span class="line"> Â  Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&lt;&lt;&lt;str</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string"> Â  Â &lt;!--</span></span><br><span class="line"><span class="string"> Â  Â &lt;meta http-equiv=&quot;refresh&quot; content=&quot;3;http://www.php.com&quot;/&gt;</span></span><br><span class="line"><span class="string"> Â  Â --&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Document&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;style&gt;</span></span><br><span class="line"><span class="string">body&#123;</span></span><br><span class="line"><span class="string">    text-align: center;</span></span><br><span class="line"><span class="string">    font-family: &#x27;å¾®è½¯é›…é»‘&#x27;;</span></span><br><span class="line"><span class="string">    font-size: 18px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">#success,#error&#123;</span></span><br><span class="line"><span class="string">    font-size: 36px;</span></span><br><span class="line"><span class="string">    margin: 10px auto;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">#success&#123;</span></span><br><span class="line"><span class="string">    color: #090;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">#error&#123;</span></span><br><span class="line"><span class="string">    color: #F00;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;img src=&quot;/Public/images/<span class="subst">&#123;$flag&#125;</span>.fw.png&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;div id=&#x27;<span class="subst">&#123;$flag&#125;</span>&#x27;&gt;<span class="subst">&#123;$info&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;&lt;span id=&#x27;t&#x27;&gt;<span class="subst">&#123;$time&#125;</span>&lt;/span&gt;ç§’ä»¥åè·³è½¬&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">window.onload=function()&#123;</span></span><br><span class="line"><span class="string">    var t=<span class="subst">&#123;$time&#125;</span>;</span></span><br><span class="line"><span class="string">    setInterval(function()&#123;</span></span><br><span class="line"><span class="string">        document.getElementById(&#x27;t&#x27;).innerHTML=--t;</span></span><br><span class="line"><span class="string">        if(t==0)</span></span><br><span class="line"><span class="string">            location.href=&#x27;index.php&#x27;;</span></span><br><span class="line"><span class="string">    &#125;,1000)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">str</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">exit</span>;</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"> Â   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ProductsControlleræ§åˆ¶å™¨ä¸­ä½¿ç”¨åŸå‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title class_">Controller</span>\<span class="title class_">Admin</span>;</span><br><span class="line"><span class="comment">//å•†å“æ¨¡å—</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsController</span></span>&#123;</span><br><span class="line"> Â  Â <span class="keyword">use</span> \<span class="title">Traits</span>\<span class="title">Jump</span>; Â  <span class="comment">//å¤ç”¨ä»£ç </span></span><br><span class="line"> Â   ...</span><br></pre></td></tr></table></figure><h1 id="6-åˆ é™¤åŠŸèƒ½"><a href="#6-åˆ é™¤åŠŸèƒ½" class="headerlink" title="6 åˆ é™¤åŠŸèƒ½"></a>6 <strong>åˆ é™¤åŠŸèƒ½</strong></h1><p>å…¥å£</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">&quot;index.php?p=Admin&amp;c=Products&amp;a=del&amp;proid=&lt;?=<span class="subst">$rows</span>[&#x27;proID&#x27;]?&gt;&quot;</span> onclick=<span class="string">&quot;return confirm(&#x27;ç¡®å®šè¦åˆ é™¤å—&#x27;)&quot;</span>&gt;åˆ é™¤&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>æ§åˆ¶å™¨ï¼ˆProductsControllerï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">delAction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="variable">$id</span>=(<span class="keyword">int</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;proid&#x27;</span>];<span class="comment">//å¦‚æœå‚æ•°æ˜ç¡®æ˜¯æ•´æ•°ï¼Œè¦å¼ºåˆ¶è½¬æˆæ•´å½¢</span></span><br><span class="line">   <span class="variable">$model</span>=<span class="keyword">new</span> \\Model\\<span class="title function_ invoke__">ProductsModel</span>();</span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$model</span>-&gt;<span class="title function_ invoke__">del</span>(<span class="variable">$id</span>))</span><br><span class="line">       <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">success</span>(<span class="string">&#x27;index.php?p=Admin&amp;c=Products&amp;a=list&#x27;</span>, <span class="string">&#x27;åˆ é™¤æˆåŠŸ&#x27;</span>);</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">error</span>(<span class="string">&#x27;index.php?p=admin&amp;c=Products&amp;a=list&#x27;</span>, <span class="string">&#x27;åˆ é™¤å¤±è´¥&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡å‹ã€è§†å›¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ— æ”¹å˜</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-æ¡†æ¶ç›®å½•&quot;&gt;&lt;a href=&quot;#1-æ¡†æ¶ç›®å½•&quot; class=&quot;headerlink&quot; title=&quot;1 æ¡†æ¶ç›®å½•&quot;&gt;&lt;/a&gt;1 æ¡†æ¶ç›®å½•&lt;/h1&gt;&lt;h2 id=&quot;1-1-åˆ›å»ºç›®å½•ç»“æ„&quot;&gt;&lt;a href=&quot;#1-1-åˆ›å»ºç›®å½•ç»“æ„&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>PHP-PDO&amp;PDOç±»&amp;PDOæ ¸å¿ƒç±»&amp;å°è£…PDOå•ä¾‹</title>
    <link href="https://gbk.cx/p/cf780ffd/"/>
    <id>https://gbk.cx/p/cf780ffd/</id>
    <published>2024-10-19T14:00:59.000Z</published>
    <updated>2024-10-19T14:21:51.883Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-PDOä»‹ç»"><a href="#1-PDOä»‹ç»" class="headerlink" title="1 PDOä»‹ç»"></a>1 PDOä»‹ç»</h1><p>æ–¹æ³•ä¸€ï¼šmysqlæ‰©å±•ã€è¿™ç§æ–¹å¼php7å·²ç»æ·˜æ±°ã€‘<br>æ–¹æ³•äºŒï¼šmysqliæ‰©å±•<br>æ–¹æ³•ä¸‰ï¼šPDOæ‰©å±•</p><h2 id="1-1-è¿æ¥æ•°æ®åº“æ–¹å¼"><a href="#1-1-è¿æ¥æ•°æ®åº“æ–¹å¼" class="headerlink" title="1.1 è¿æ¥æ•°æ®åº“æ–¹å¼"></a>1.1 <strong>è¿æ¥æ•°æ®åº“æ–¹å¼</strong></h2><h2 id="1-2-PDOä»‹ç»"><a href="#1-2-PDOä»‹ç»" class="headerlink" title="1.2 PDOä»‹ç»"></a>1.2 <strong>PDOä»‹ç»</strong></h2><p>PDOï¼ˆPHP Data Objectï¼‰æ‰©å±•ä¸ºPHPè®¿é—®å„ç§æ•°æ®åº“æä¾›äº†ä¸€ä¸ªè½»é‡çº§ï¼Œä¸€è‡´æ€§çš„æ¥å£ã€‚æ— è®ºè®¿é—®ä»€ä¹ˆæ•°æ®åº“ï¼Œéƒ½å¯ä»¥é€šè¿‡ä¸€è‡´æ€§çš„æ¥å£å»æ“ä½œã€‚</p><h2 id="1-3-å¼€å¯PDOæ‰©å±•"><a href="#1-3-å¼€å¯PDOæ‰©å±•" class="headerlink" title="1.3 å¼€å¯PDOæ‰©å±•"></a>1.3 <strong>å¼€å¯PDOæ‰©å±•</strong></h2><p>å¼€å¯PDOè¿æ¥MySQLæ‰©å±•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extension=php_pdo_mysql.dll</span><br></pre></td></tr></table></figure><h1 id="2-PDOæ ¸å¿ƒç±»"><a href="#2-PDOæ ¸å¿ƒç±»" class="headerlink" title="2 PDOæ ¸å¿ƒç±»"></a>2 <strong>PDOæ ¸å¿ƒç±»</strong></h1><p>1ã€PDOç±»ï¼šè¡¨ç¤ºPHPå’Œæ•°æ®åº“ä¹‹é—´çš„ä¸€ä¸ªè¿æ¥<br>2ã€PDOStatement ç±»<br>    ç¬¬ä¸€ï¼šè¡¨ç¤ºæ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥ï¼ˆselect ,showï¼‰åçš„ç›¸å…³ç»“æœé›†<br>    ç¬¬äºŒï¼šé¢„å¤„ç†å¯¹è±¡<br>3ã€PDOExceptionç±»ï¼šè¡¨ç¤ºPDOçš„å¼‚å¸¸</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/MspHM8Z9Hw6nMSco0zyv1729346574314.png" alt="1561083447524.png"></p><h1 id="3-å®ä¾‹åŒ–PDOå¯¹è±¡"><a href="#3-å®ä¾‹åŒ–PDOå¯¹è±¡" class="headerlink" title="3 å®ä¾‹åŒ–PDOå¯¹è±¡"></a>3 <strong>å®ä¾‹åŒ–PDOå¯¹è±¡</strong></h1><p>è¯­æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">__construct</span>(<span class="variable">$dsn</span>,ç”¨æˆ·å,å¯†ç )</span><br></pre></td></tr></table></figure><h2 id="3-1-DSN"><a href="#3-1-DSN" class="headerlink" title="3.1 DSN"></a>3.1 DSN</h2><p>DSNï¼šdata source nameï¼Œæ•°æ®æºåç§°ï¼ŒåŒ…å«çš„æ˜¯è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dsn=æ•°æ®åº“ç±»å‹:host=ä¸»æœºåœ°å€;port=ç«¯å£å·;dbname=æ•°æ®åº“åç§°;charset=å­—ç¬¦é›†</span><br></pre></td></tr></table></figure><p>æ•°æ®åº“ç±»å‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MySQLæ•°æ®åº“    =&gt;  mysql:</span><br><span class="line">oracleæ•°æ®åº“   =&gt;  oci:</span><br><span class="line">SQL Server      =&gt;sqlsrv:</span><br><span class="line">å…·ä½“é©±åŠ¨ç±»å‹å‚è§æ‰‹å†Œâ€œPDOé©±åŠ¨â€</span><br></pre></td></tr></table></figure><h2 id="3-2-å®ä¾‹åŒ–PDO"><a href="#3-2-å®ä¾‹åŒ–PDO" class="headerlink" title="3.2 å®ä¾‹åŒ–PDO"></a>3.2 å®ä¾‹åŒ–PDO</h2><p>å®ä¾‹åŒ–PDOçš„è¿‡ç¨‹å°±æ˜¯è¿æ¥æ•°æ®åº“çš„è¿‡ç¨‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&#x27;mysql:host=localhost;port=3306;dbname=data;charset=utf8&#x27;</span>;</span><br><span class="line"><span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$pdo</span>); <span class="comment">//object(PDO)#1 (0) &#123; &#125;</span></span><br></pre></td></tr></table></figure><h2 id="3-3-æ³¨æ„äº‹é¡¹"><a href="#3-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="3.3 æ³¨æ„äº‹é¡¹"></a>3.3 æ³¨æ„äº‹é¡¹</h2><p>1ã€å¦‚æœè¿æ¥çš„æ˜¯æœ¬åœ°æ•°æ®åº“ï¼Œhostå¯ä»¥çœç•¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&#x27;mysql:port=3306;dbname=data;charset=utf8&#x27;</span>;</span><br><span class="line"><span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$pdo</span>); <span class="comment">//object(PDO)#1 (0) &#123; &#125;</span></span><br></pre></td></tr></table></figure><p>2ã€å¦‚æœä½¿ç”¨çš„æ˜¯3306ç«¯å£ï¼Œportå¯ä»¥çœç•¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&#x27;mysql:dbname=data;charset=utf8&#x27;</span>;</span><br><span class="line"><span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$pdo</span>); <span class="comment">//object(PDO)#1 (0) &#123; &#125;</span></span><br></pre></td></tr></table></figure><p>3ã€charsetä¹Ÿçœç•¥ï¼Œå¦‚æœçœç•¥ï¼Œä½¿ç”¨çš„æ˜¯é»˜è®¤å­—ç¬¦ç¼–ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&#x27;mysql:dbname=data&#x27;</span>;</span><br><span class="line"><span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$pdo</span>);</span><br></pre></td></tr></table></figure><p>4ã€dbnameä¹Ÿå¯ä»¥çœç•¥ï¼Œå¦‚æœçœç•¥å°±æ²¡æœ‰é€‰æ‹©æ•°æ®åº“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&#x27;mysql:&#x27;</span>;</span><br><span class="line"><span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$pdo</span>);</span><br></pre></td></tr></table></figure><p>5ã€hostã€portã€dbnameã€charsetä¸åŒºåˆ†å¤§å°å†™ï¼Œæ²¡æœ‰å…ˆåé¡ºåº</p><p>6ã€é©±åŠ¨åç§°ä¸èƒ½çœç•¥ï¼Œå†’å·ä¸èƒ½çœç•¥ï¼ˆå› ä¸ºå†’å·æ˜¯é©±åŠ¨åç»„æˆéƒ¨åˆ†ï¼‰ï¼Œæ•°æ®åº“é©±åŠ¨åªèƒ½å°å†™</p><h1 id="4-ä½¿ç”¨PDO"><a href="#4-ä½¿ç”¨PDO" class="headerlink" title="4 ä½¿ç”¨PDO"></a>4 <strong>ä½¿ç”¨PDO</strong></h1><h2 id="4-1-æ‰§è¡Œæ•°æ®æ“ä½œè¯­å¥"><a href="#4-1-æ‰§è¡Œæ•°æ®æ“ä½œè¯­å¥" class="headerlink" title="4.1 æ‰§è¡Œæ•°æ®æ“ä½œè¯­å¥"></a>4.1 æ‰§è¡Œæ•°æ®æ“ä½œè¯­å¥</h2><p>æ–¹æ³•:$pdo-&gt;exec($sql)ï¼Œæ‰§è¡Œæ•°æ®å¢ã€åˆ ã€æ”¹è¯­å¥ï¼Œæ‰§è¡ŒæˆåŠŸè¿”å›å—å½±å“çš„è®°å½•æ•°ï¼Œå¦‚æœSQLè¯­å¥é”™è¯¯è¿”å›falseã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//1ã€å®ä¾‹åŒ–PDO</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&#x27;mysql:host=localhost;port=3306;dbname=data;charset=utf8&#x27;</span>;</span><br><span class="line"><span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="comment">//2æ‰§è¡Œæ•°æ®æ“ä½œè¯­å¥</span></span><br><span class="line"><span class="comment">//2.1 æ‰§è¡Œå¢åŠ </span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">if($pdo-&gt;exec(&quot;insert into news values (null,&#x27;bb&#x27;,&#x27;bbbbbb&#x27;,unix_timestamp())&quot;))</span></span><br><span class="line"><span class="comment"> Â  Â echo &#x27;è‡ªåŠ¨å¢é•¿çš„ç¼–å·æ˜¯ï¼š&#x27;.$pdo-&gt;lastInsertId (),&#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//2.2 æ‰§è¡Œä¿®æ”¹</span></span><br><span class="line"><span class="comment">//echo $pdo-&gt;exec(&quot;update news set title=&#x27;é™å¤œæ€&#x27; where id in (3,4)&quot;);</span></span><br><span class="line"><span class="comment">//2.3 æ‰§è¡Œåˆ é™¤</span></span><br><span class="line"><span class="comment">//echo $pdo-&gt;exec(&#x27;delete from news where id=5&#x27;);\</span></span><br><span class="line"><span class="comment">//2.4 å®Œå–„</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;update news set title=&#x27;é™å¤œæ€1&#x27; where ids in (3,4)&quot;</span>;</span><br><span class="line"><span class="variable">$rs</span>=<span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">exec</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$rs</span>)&#123;</span><br><span class="line"> Â  Â <span class="keyword">echo</span> <span class="string">&#x27;SQLè¯­å¥æ‰§è¡ŒæˆåŠŸ&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$sql</span>, <span class="number">0</span>,<span class="number">6</span>)==<span class="string">&#x27;insert&#x27;</span>)</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;è‡ªåŠ¨å¢é•¿çš„ç¼–å·æ˜¯ï¼š&#x27;</span>.<span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">lastInsertId</span> (),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â <span class="keyword">else</span></span><br><span class="line"> Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;å—åˆ°å½±å“çš„è®°å½•æ•°æ˜¯ï¼š&#x27;</span>.<span class="variable">$rs</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">elseif</span>(<span class="variable">$rs</span>===<span class="number">0</span>)&#123;</span><br><span class="line"> Â  Â <span class="keyword">echo</span> <span class="string">&#x27;æ•°æ®æ²¡æœ‰å˜åŒ–&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">elseif</span>(<span class="variable">$rs</span>===<span class="literal">false</span>)&#123;</span><br><span class="line"> Â  Â <span class="keyword">echo</span> <span class="string">&#x27;SQLè¯­å¥æ‰§è¡Œå¤±è´¥&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ç¼–å·ï¼š&#x27;</span>.<span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">errorCode</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â <span class="comment">//var_dump($pdo-&gt;errorInfo());</span></span><br><span class="line"> Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>.<span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">errorInfo</span>()[<span class="number">2</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-2-æ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥"><a href="#4-2-æ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥" class="headerlink" title="4.2 æ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥"></a>4.2 æ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥</h2><p>æ–¹æ³•ï¼š$pdo-&gt;query($sql)ï¼Œè¿”å›çš„æ˜¯PDOStatementå¯¹è±¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&#x27;mysql:dbname=data;charset=utf8&#x27;</span>;</span><br><span class="line"><span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="comment">//1ã€æ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥</span></span><br><span class="line"><span class="variable">$stmt</span>=<span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select * from products&#x27;</span>);</span><br><span class="line"><span class="comment">//var_dump($stmt); Â  Â  Â   //object(PDOStatement)</span></span><br><span class="line"><span class="comment">//2ã€è·å–æ•°æ®</span></span><br><span class="line"><span class="comment">//2.1  è·å–äºŒç»´æ•°ç»„</span></span><br><span class="line"><span class="comment">//$rs=$stmt-&gt;fetchAll();  //é»˜è®¤è¿”å›å…³è”å’Œç´¢å¼•æ•°ç»„</span></span><br><span class="line"><span class="comment">//$rs=$stmt-&gt;fetchAll(PDO::FETCH_BOTH); Â  Â  //è¿”å›å…³è”å’Œç´¢å¼•æ•°ç»„</span></span><br><span class="line"><span class="comment">//$rs=$stmt-&gt;fetchAll(PDO::FETCH_NUM); Â  Â   //è¿”å›ç´¢å¼•æ•°ç»„</span></span><br><span class="line"><span class="comment">//$rs=$stmt-&gt;fetchAll(PDO::FETCH_ASSOC); Â   //è¿”å›å…³è”æ•°ç»„</span></span><br><span class="line"><span class="comment">//$rs=$stmt-&gt;fetchAll(PDO::FETCH_OBJ); Â  Â  Â   //è¿”å›å¯¹è±¡æ•°ç»„</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.2  è·å–ä¸€ç»´æ•°ç»„,åŒ¹é…å®ŒæˆåæŒ‡é’ˆä¸‹ç§»ä¸€æ¡</span></span><br><span class="line"><span class="comment">//$rs=$stmt-&gt;fetch(); Â  Â  //å…³è”å’Œç´¢å¼•æ•°ç»„</span></span><br><span class="line"><span class="comment">//$rs=$stmt-&gt;fetch(PDO::FETCH_NUM); Â  //ç´¢å¼•æ•°ç»„</span></span><br><span class="line"><span class="comment">//ä¾‹é¢˜ï¼šé€šè¿‡whileå¾ªç¯è·å–æ‰€æœ‰æ•°æ®</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">while($row=$stmt-&gt;fetch(PDO::FETCH_ASSOC))&#123;</span></span><br><span class="line"><span class="comment"> Â  Â $rs[]=$row;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">echo &#x27;&lt;pre&gt;&#x27;;</span></span><br><span class="line"><span class="comment">var_dump($rs);</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.3  åŒ¹é…åˆ—ï¼šåŒ¹é…å½“å‰è¡Œçš„ç¬¬nåˆ—ï¼Œåˆ—çš„ç¼–å·ä»0å¼€å§‹ï¼ŒåŒ¹é…å®Œæ¯•åæŒ‡é’ˆä¸‹ç§»ä¸€æ¡</span></span><br><span class="line"><span class="comment">//echo $stmt-&gt;fetchColumn();  //è·å–å½“å‰è¡Œçš„ç¬¬0åˆ—</span></span><br><span class="line"><span class="comment">//echo $stmt-&gt;fetchColumn(1);  //è·å–å½“å‰è¡Œçš„ç¬¬1åˆ—</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.4  æ€»è¡Œæ•°ï¼Œæ€»åˆ—æ•°</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">echo &#x27;æ€»è¡Œæ•°ï¼š&#x27;.$stmt-&gt;rowCount(),&#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line"><span class="comment">echo &#x27;æ€»åˆ—æ•°ï¼š&#x27;.$stmt-&gt;columnCount();</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.5 éå†PDOStatementå¯¹è±¡ï¼ˆPDOStatementå¯¹è±¡æ˜¯æœ‰è¿­ä»£å™¨çš„ï¼‰</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$stmt</span> <span class="keyword">as</span> <span class="variable">$row</span>)&#123;</span><br><span class="line"> Â  Â <span class="keyword">echo</span> <span class="variable">$row</span>[<span class="string">&#x27;proname&#x27;</span>],<span class="string">&#x27;-&#x27;</span>,<span class="variable">$row</span>[<span class="string">&#x27;proprice&#x27;</span>],<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stdClassç±»æ˜¯æ‰€æœ‰PHPç±»çš„çˆ¶ç±»</span><br></pre></td></tr></table></figure><h2 id="4-3-PDOæ“ä½œäº‹åŠ¡"><a href="#4-3-PDOæ“ä½œäº‹åŠ¡" class="headerlink" title="4.3 PDOæ“ä½œäº‹åŠ¡"></a>4.3 <strong>PDOæ“ä½œäº‹åŠ¡</strong></h2><p>äº‹åŠ¡ï¼šæ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œè¦ä¹ˆä¸€èµ·æ‰§è¡Œï¼Œè¦ä¹ˆä¸€èµ·å›æ»š</p><p>äº‹åŠ¡çš„ç‰¹æ€§ï¼šåŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§ï¼Œæ°¸ä¹…æ€§</p><p>éœ€è¦å°†å¤šä¸ªSQLè¯­å¥ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°äº‹åŠ¡</p><p>è¯­æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">start transaction æˆ– begin       å¼€å¯äº‹åŠ¡</span><br><span class="line">commit  æäº¤äº‹åŠ¡</span><br><span class="line">rollback    å›æ»šäº‹åŠ¡</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">beginTransaction</span>()   å¼€å¯äº‹åŠ¡</span><br><span class="line"><span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">commit</span> ()            æäº¤äº‹åŠ¡</span><br><span class="line"><span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">rollBack</span>()           å›æ»šäº‹åŠ¡</span><br></pre></td></tr></table></figure><h2 id="4-4-PDOæ“ä½œé¢„å¤„ç†"><a href="#4-4-PDOæ“ä½œé¢„å¤„ç†" class="headerlink" title="4.4 PDOæ“ä½œé¢„å¤„ç†"></a>4.4 <strong>PDOæ“ä½œé¢„å¤„ç†</strong></h2><h1 id="5-PDOå¼‚å¸¸å¤„ç†"><a href="#5-PDOå¼‚å¸¸å¤„ç†" class="headerlink" title="5 PDOå¼‚å¸¸å¤„ç†"></a>5 <strong>PDOå¼‚å¸¸å¤„ç†</strong></h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="variable">$dsn</span>=<span class="string">&#x27;mysql:dbname=data;charset=utf8&#x27;</span>;</span><br><span class="line">    <span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">    <span class="comment">//è¿™æ˜¯PDOé”™è¯¯æ¨¡å¼å±æ€§ï¼ŒPDOè‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    <span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">setAttribute</span>(PDO::<span class="variable constant_">ATTR_ERRMODE</span>, PDO::<span class="variable constant_">ERRMODE_EXCEPTION</span>);</span><br><span class="line">    <span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select * from newsssssss&#x27;</span>);  <span class="comment">//è‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (PDOException <span class="variable">$ex</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getMessage</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯æ–‡ä»¶ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getFile</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯è¡Œå·ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getLine</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€PDOExceptionæ˜¯PDOçš„å¼‚å¸¸ç±»</p><p>2ã€å®ä¾‹åŒ–PDOä¼šè‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸</p><p>3ã€å…¶ä»–æ“ä½œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œéœ€è¦è®¾ç½®PDOçš„å¼‚å¸¸æ¨¡å¼</p><p>4ã€PDOå¼‚å¸¸æ¨¡å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PDO::ERRMODE_EXCEPTIONæŠ›å‡ºå¼‚å¸¸</span><br><span class="line">PDO::ERRMODE_SILENTä¸­æ–­</span><br><span class="line">PDO::ERRMODE_WARNINGè­¦å‘Š</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="6-å•ä¾‹æ¨¡å¼å°è£…MyPDOç±»"><a href="#6-å•ä¾‹æ¨¡å¼å°è£…MyPDOç±»" class="headerlink" title="6 å•ä¾‹æ¨¡å¼å°è£…MyPDOç±»"></a>6 <strong>å•ä¾‹æ¨¡å¼å°è£…MyPDOç±»</strong></h1><h2 id="6-1-æ­¥éª¤"><a href="#6-1-æ­¥éª¤" class="headerlink" title="6.1 æ­¥éª¤"></a>6.1 æ­¥éª¤</h2><p>1ã€å•ä¾‹æ¨¡å¼</p><p>2ã€åˆå§‹åŒ–å‚æ•°</p><p>3ã€è¿æ¥æ•°æ®åº“</p><p>4ã€æ‰§è¡Œå¢åˆ æ”¹</p><p>5ã€æ‰§è¡ŒæŸ¥è¯¢</p><p>aï¼‰è¿”å›äºŒç»´æ•°ç»„</p><p>bï¼‰è¿”å›ä¸€ç»´æ•°ç»„</p><p>cï¼‰è¿”å›ä¸€è¡Œä¸€åˆ—</p><h2 id="6-2-ä»£ç å®ç°"><a href="#6-2-ä»£ç å®ç°" class="headerlink" title="6.2 ä»£ç å®ç°"></a>6.2 ä»£ç å®ç°</h2><p>ç¬¬ä¸€éƒ¨åˆ†ï¼šå•ä¾‹ã€åˆå§‹åŒ–å‚æ•°ã€å®ä¾‹åŒ–PDO</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPDO</span></span>&#123;</span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$type</span>; Â  Â  Â <span class="comment">//æ•°æ®åº“ç±»åˆ«</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$host</span>; Â  Â  Â <span class="comment">//ä¸»æœºåœ°å€</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$port</span>; Â  Â  Â <span class="comment">//ç«¯å£å·</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$dbname</span>; Â  Â <span class="comment">//æ•°æ®åº“å</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$charset</span>; Â  <span class="comment">//å­—ç¬¦é›†</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$user</span>; Â  Â  Â <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$pwd</span>; Â  Â  Â  <span class="comment">//å¯†ç </span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$pdo</span>; Â  Â  Â  <span class="comment">//ä¿å­˜PDOå¯¹è±¡</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$instance</span>;</span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initParam</span>(<span class="variable">$param</span>);</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initPDO</span>();</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"><span class="variable">$param</span>=<span class="keyword">array</span>(<span class="params"></span>)</span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">if</span>(!<span class="built_in">self</span>::<span class="variable">$instance</span> <span class="keyword">instanceof</span> <span class="built_in">self</span>)</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="built_in">self</span>::<span class="variable">$instance</span>=<span class="keyword">new</span> <span class="built_in">self</span>(<span class="variable">$param</span>);</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$instance</span>;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initParam</span>(<span class="params"><span class="variable">$param</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;type=<span class="variable">$param</span>[<span class="string">&#x27;type&#x27;</span>]??<span class="string">&#x27;mysql&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;host=<span class="variable">$param</span>[<span class="string">&#x27;host&#x27;</span>]??<span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;port=<span class="variable">$param</span>[<span class="string">&#x27;port&#x27;</span>]??<span class="string">&#x27;3306&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;dbname=<span class="variable">$param</span>[<span class="string">&#x27;dbname&#x27;</span>]??<span class="string">&#x27;data&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;charset=<span class="variable">$param</span>[<span class="string">&#x27;charset&#x27;</span>]??<span class="string">&#x27;utf8&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;user=<span class="variable">$param</span>[<span class="string">&#x27;user&#x27;</span>]??<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;pwd=<span class="variable">$param</span>[<span class="string">&#x27;pwd&#x27;</span>]??<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//åˆå§‹åŒ–PDO</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initPDO</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">try</span>&#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable">$dsn</span>=<span class="string">&quot;<span class="subst">&#123;$this-&gt;type&#125;</span>:host=<span class="subst">&#123;$this-&gt;host&#125;</span>;port=<span class="subst">&#123;$this-&gt;port&#125;</span>;dbname=<span class="subst">&#123;$this-&gt;dbname&#125;</span>;charset=<span class="subst">&#123;$this-&gt;charset&#125;</span>&quot;</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;pdo=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>, <span class="variable">$this</span>-&gt;user, <span class="variable">$this</span>-&gt;pwd);</span><br><span class="line"> Â  Â  Â   &#125; <span class="keyword">catch</span> (PDOException <span class="variable">$ex</span>) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ç¼–å·ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getCode</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯è¡Œå·ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getLine</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯æ–‡ä»¶ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getFile</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getMessage</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">exit</span>;</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"> Â   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line">);</span><br><span class="line"><span class="variable">$mypdo</span>= MyPDO::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$mypdo</span>);</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒéƒ¨åˆ†ï¼šæ•°æ®æ“ä½œéƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPDO</span></span>&#123;</span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$type</span>; Â  Â  Â <span class="comment">//æ•°æ®åº“ç±»åˆ«</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$host</span>; Â  Â  Â <span class="comment">//ä¸»æœºåœ°å€</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$port</span>; Â  Â  Â <span class="comment">//ç«¯å£å·</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$dbname</span>; Â  Â <span class="comment">//æ•°æ®åº“å</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$charset</span>; Â  <span class="comment">//å­—ç¬¦é›†</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$user</span>; Â  Â  Â <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$pwd</span>; Â  Â  Â  <span class="comment">//å¯†ç </span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="variable">$pdo</span>; Â  Â  Â  <span class="comment">//ä¿å­˜PDOå¯¹è±¡</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$instance</span>;</span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initParam</span>(<span class="variable">$param</span>);</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initPDO</span>();</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initException</span>();</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"><span class="variable">$param</span>=<span class="keyword">array</span>(<span class="params"></span>)</span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">if</span>(!<span class="built_in">self</span>::<span class="variable">$instance</span> <span class="keyword">instanceof</span> <span class="built_in">self</span>)</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="built_in">self</span>::<span class="variable">$instance</span>=<span class="keyword">new</span> <span class="built_in">self</span>(<span class="variable">$param</span>);</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$instance</span>;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initParam</span>(<span class="params"><span class="variable">$param</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;type=<span class="variable">$param</span>[<span class="string">&#x27;type&#x27;</span>]??<span class="string">&#x27;mysql&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;host=<span class="variable">$param</span>[<span class="string">&#x27;host&#x27;</span>]??<span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;port=<span class="variable">$param</span>[<span class="string">&#x27;port&#x27;</span>]??<span class="string">&#x27;3306&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;dbname=<span class="variable">$param</span>[<span class="string">&#x27;dbname&#x27;</span>]??<span class="string">&#x27;data&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;charset=<span class="variable">$param</span>[<span class="string">&#x27;charset&#x27;</span>]??<span class="string">&#x27;utf8&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;user=<span class="variable">$param</span>[<span class="string">&#x27;user&#x27;</span>]??<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;pwd=<span class="variable">$param</span>[<span class="string">&#x27;pwd&#x27;</span>]??<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//åˆå§‹åŒ–PDO</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initPDO</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">try</span>&#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable">$dsn</span>=<span class="string">&quot;<span class="subst">&#123;$this-&gt;type&#125;</span>:host=<span class="subst">&#123;$this-&gt;host&#125;</span>;port=<span class="subst">&#123;$this-&gt;port&#125;</span>;dbname=<span class="subst">&#123;$this-&gt;dbname&#125;</span>;charset=<span class="subst">&#123;$this-&gt;charset&#125;</span>&quot;</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;pdo=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>, <span class="variable">$this</span>-&gt;user, <span class="variable">$this</span>-&gt;pwd);</span><br><span class="line"> Â  Â  Â   &#125; <span class="keyword">catch</span> (PDOException <span class="variable">$ex</span>) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">showException</span>(<span class="variable">$ex</span>);</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">exit</span>;</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"> Â   &#125;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="comment">//æ˜¾ç¤ºå¼‚å¸¸</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">showException</span>(<span class="params"><span class="variable">$ex</span>,<span class="variable">$sql</span>=<span class="string">&#x27;&#x27;</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">if</span>(<span class="variable">$sql</span>!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;SQLè¯­å¥æ‰§è¡Œå¤±è´¥&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯çš„SQLè¯­å¥æ˜¯ï¼š&#x27;</span>.<span class="variable">$sql</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ç¼–å·ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getCode</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯è¡Œå·ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getLine</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯æ–‡ä»¶ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getFile</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>.<span class="variable">$ex</span>-&gt;<span class="title function_ invoke__">getMessage</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//è®¾ç½®å¼‚å¸¸æ¨¡å¼</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initException</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;pdo-&gt;<span class="title function_ invoke__">setAttribute</span>(PDO::<span class="variable constant_">ATTR_ERRMODE</span>,PDO::<span class="variable constant_">ERRMODE_EXCEPTION</span>);</span><br><span class="line"> Â   &#125;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="comment">//æ‰§è¡Œå¢ã€åˆ ã€æ”¹æ“ä½œ</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">exec</span>(<span class="params"><span class="variable">$sql</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">try</span>&#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;pdo-&gt;<span class="title function_ invoke__">exec</span>(<span class="variable">$sql</span>);</span><br><span class="line"> Â  Â  Â   &#125; <span class="keyword">catch</span> (PDOException <span class="variable">$ex</span>) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">showException</span>(<span class="variable">$ex</span>, <span class="variable">$sql</span>);</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">exit</span>;</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//è·å–è‡ªåŠ¨å¢é•¿çš„ç¼–å·</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">lastInsertId</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;pdo-&gt;<span class="title function_ invoke__">lastInsertId</span>();</span><br><span class="line"> Â   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"><span class="variable">$mypdo</span>= MyPDO::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="comment">//echo $mypdo-&gt;exec(&#x27;delete from news where id=6&#x27;);</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$mypdo</span>-&gt;<span class="title function_ invoke__">exec</span>(<span class="string">&quot;insert into news values (null,&#x27;11&#x27;,&#x27;1111&#x27;,unix_timestamp())&quot;</span>))</span><br><span class="line"> Â  Â <span class="keyword">echo</span> <span class="string">&#x27;è‡ªåŠ¨å¢é•¿çš„ç¼–å·æ˜¯ï¼š&#x27;</span>.<span class="variable">$mypdo</span>-&gt;<span class="title function_ invoke__">lastInsertId</span> ();</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ•°æ®æŸ¥è¯¢éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPDO</span></span>&#123;</span><br><span class="line"> Â  ...</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="comment">//åˆ¤æ–­åŒ¹é…çš„ç±»å‹</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchType</span>(<span class="params"><span class="variable">$type</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">switch</span> (<span class="variable">$type</span>)&#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">case</span> <span class="string">&#x27;num&#x27;</span>:</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â <span class="keyword">return</span> PDO::<span class="variable constant_">FETCH_NUM</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">case</span> <span class="string">&#x27;both&#x27;</span>:</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â <span class="keyword">return</span> PDO::<span class="variable constant_">FETCH_BOTH</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">case</span> <span class="string">&#x27;obj&#x27;</span>:</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â <span class="keyword">return</span> PDO::<span class="variable constant_">FETCH_OBJ</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">default</span>:</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> PDO::<span class="variable constant_">FETCH_ASSOC</span>;</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//è·å–æ‰€æœ‰æ•°æ® ï¼Œè¿”å›äºŒç»´æ•°ç»„</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchAll</span>(<span class="params"><span class="variable">$sql</span>,<span class="variable">$type</span>=<span class="string">&#x27;assoc&#x27;</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">try</span>&#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable">$stmt</span>=<span class="variable language_">$this</span>-&gt;pdo-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>); Â <span class="comment">//è·å–PDOStatementå¯¹è±¡</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable">$type</span>= <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">fetchType</span>(<span class="variable">$type</span>); <span class="comment">//è·å–åŒ¹é…æ–¹æ³•</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">return</span> <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">fetchAll</span>(<span class="variable">$type</span>);</span><br><span class="line"> Â  Â  Â   &#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$ex</span>) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">showException</span>(<span class="variable">$ex</span>, <span class="variable">$sql</span>);</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//è·å–ä¸€ç»´æ•°ç»„</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchRow</span>(<span class="params"><span class="variable">$sql</span>,<span class="variable">$type</span>=<span class="string">&#x27;assoc&#x27;</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">try</span>&#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable">$stmt</span>=<span class="variable language_">$this</span>-&gt;pdo-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>); Â <span class="comment">//è·å–PDOStatementå¯¹è±¡</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable">$type</span>= <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">fetchType</span>(<span class="variable">$type</span>); <span class="comment">//è·å–åŒ¹é…æ–¹æ³•</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">return</span> <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">fetch</span>(<span class="variable">$type</span>);</span><br><span class="line"> Â  Â  Â   &#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$ex</span>) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">showException</span>(<span class="variable">$ex</span>, <span class="variable">$sql</span>);</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">exit</span>;</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"> Â   &#125;</span><br><span class="line"> Â  Â <span class="comment">//è¿”å›ä¸€è¡Œä¸€åˆ—</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchColumn</span>(<span class="params"><span class="variable">$sql</span></span>)</span>&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">try</span>&#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â  <span class="variable">$stmt</span>=<span class="variable language_">$this</span>-&gt;pdo-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">return</span> <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">fetchColumn</span>();</span><br><span class="line"> Â  Â  Â   &#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$ex</span>) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">showException</span>(<span class="variable">$ex</span>, <span class="variable">$sql</span>);</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">exit</span>;</span><br><span class="line"> Â  Â  Â   &#125;</span><br><span class="line"></span><br><span class="line"> Â   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"><span class="variable">$mypdo</span>= MyPDO::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="comment">//echo $mypdo-&gt;exec(&#x27;delete from news where id=6&#x27;);</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">if($mypdo-&gt;exec(&quot;insert into news values (null,&#x27;11&#x27;,&#x27;1111&#x27;,unix_timestamp())&quot;))</span></span><br><span class="line"><span class="comment"> Â  Â echo &#x27;è‡ªåŠ¨å¢é•¿çš„ç¼–å·æ˜¯ï¼š&#x27;.$mypdo-&gt;lastInsertId ();</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//$list=$mypdo-&gt;fetchAll(&#x27;select * from news&#x27;);</span></span><br><span class="line"><span class="comment">//$list=$mypdo-&gt;fetchRow(&#x27;select * from news where id=1&#x27;);</span></span><br><span class="line"><span class="variable">$list</span>=<span class="variable">$mypdo</span>-&gt;<span class="title function_ invoke__">fetchColumn</span>(<span class="string">&#x27;select count(*) from news&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$list</span>);</span><br></pre></td></tr></table></figure><p>3ã€$stmt-&gt;bindParam()å’Œ$stmt-&gt;bindValue()åŒºåˆ«</p><p>4ã€é¢„å¤„ç†çš„å¥½å¤„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a)æé«˜æ‰§è¡Œæ•ˆç‡</span><br><span class="line">b)æé«˜å®‰å…¨æ€§</span><br></pre></td></tr></table></figure><p>2ã€å‚æ•°å ä½ç¬¦ä»¥å†’å·å¼€å¤´</p><p>1ã€?æ˜¯ä½ç½®å ä½ç¬¦</p><p>å°ç»“ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dsn</span>=<span class="string">&#x27;mysql:dbname=data;charset=utf8&#x27;</span>;</span><br><span class="line"><span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="comment">//åˆ›å»ºé¢„å¤„ç†å¯¹è±¡</span></span><br><span class="line"><span class="variable">$stmt</span>=<span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;insert into bank values (:p1,:p2)&quot;</span>); Â  <span class="comment">//:p1,:p2æ˜¯å‚æ•°å ä½ç¬¦</span></span><br><span class="line"><span class="comment">//æ‰§è¡Œé¢„å¤„ç†</span></span><br><span class="line"><span class="variable">$cards</span>=[</span><br><span class="line"> Â   [<span class="string">&#x27;p1&#x27;</span>=&gt;<span class="string">&#x27;1003&#x27;</span>,<span class="string">&#x27;p2&#x27;</span>=&gt;<span class="number">500</span>],</span><br><span class="line"> Â   [<span class="string">&#x27;p1&#x27;</span>=&gt;<span class="string">&#x27;1004&#x27;</span>,<span class="string">&#x27;p2&#x27;</span>=&gt;<span class="number">1000</span>]</span><br><span class="line">];</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$cards</span> <span class="keyword">as</span> <span class="variable">$card</span>)&#123;</span><br><span class="line"> Â  Â <span class="comment">//æ–¹æ³•ä¸€ï¼š</span></span><br><span class="line"> Â  Â <span class="comment">/*</span></span><br><span class="line"><span class="comment"> Â  Â $stmt-&gt;bindParam(&#x27;:p1&#x27;, $card[&#x27;p1&#x27;]);</span></span><br><span class="line"><span class="comment"> Â  Â $stmt-&gt;bindParam(&#x27;:p2&#x27;, $card[&#x27;p2&#x27;]);</span></span><br><span class="line"><span class="comment"> Â  Â $stmt-&gt;execute();</span></span><br><span class="line"><span class="comment"> Â  Â  */</span></span><br><span class="line"> Â  Â <span class="comment">//æ–¹æ³•äºŒï¼šä½†æ•°ç»„çš„ä¸‹æ ‡å’Œå‚æ•°åä¸€è‡´çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ä¼ é€’å…³è”æ•°ç»„</span></span><br><span class="line"> Â  Â <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$card</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>PDOä¸­çš„é¢„å¤„ç†â€”â€”å‚æ•°å ä½ç¬¦</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> Â  Â <span class="variable">$dsn</span>=<span class="string">&#x27;mysql:dbname=data;charset=utf8&#x27;</span>;</span><br><span class="line"> Â  Â <span class="variable">$pdo</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"> Â  Â <span class="comment">//åˆ›å»ºé¢„å¤„ç†å¯¹è±¡</span></span><br><span class="line"> Â  Â <span class="variable">$stmt</span>=<span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&quot;insert into bank values (?,?)&quot;</span>); Â  <span class="comment">//?æ˜¯å ä½ç¬¦</span></span><br><span class="line"> Â  Â <span class="comment">//æ‰§è¡Œé¢„å¤„ç†</span></span><br><span class="line"> Â  Â <span class="variable">$cards</span>=[</span><br><span class="line"> Â  Â  Â   [<span class="string">&#x27;1003&#x27;</span>,<span class="number">500</span>],</span><br><span class="line"> Â  Â  Â   [<span class="string">&#x27;1004&#x27;</span>,<span class="number">100</span>]</span><br><span class="line"> Â   ];</span><br><span class="line"> Â  Â <span class="keyword">foreach</span>(<span class="variable">$cards</span> <span class="keyword">as</span> <span class="variable">$card</span>)&#123;</span><br><span class="line"> Â  Â  Â  Â <span class="comment">//ç»‘å®šå‚æ•°ï¼Œå¹¶æ‰§è¡Œé¢„å¤„ç†,</span></span><br><span class="line"> Â  Â  Â  Â <span class="comment">//æ–¹æ³•ä¸€ï¼š</span></span><br><span class="line"> Â  Â  Â  Â <span class="comment">/*</span></span><br><span class="line"><span class="comment"> Â  Â  Â  Â $stmt-&gt;bindParam(1, $card[0]);  //å ä½ç¬¦çš„ä½ç½®ä»1å¼€å§‹</span></span><br><span class="line"><span class="comment"> Â  Â  Â  Â $stmt-&gt;bindParam(2, $card[1]);</span></span><br><span class="line"><span class="comment"> Â  Â  Â  Â $stmt-&gt;execute(); Â  Â  Â  Â  Â  Â  Â  //æ‰§è¡Œé¢„å¤„ç†</span></span><br><span class="line"><span class="comment"> Â  Â  Â  Â  */</span></span><br><span class="line"> Â  Â  Â  Â <span class="comment">//æ–¹æ³•äºŒï¼š</span></span><br><span class="line"> Â  Â  Â  Â <span class="comment">/*</span></span><br><span class="line"><span class="comment"> Â  Â  Â  Â $stmt-&gt;bindValue(1, $card[0]);</span></span><br><span class="line"><span class="comment"> Â  Â  Â  Â $stmt-&gt;bindValue(2, $card[1]);</span></span><br><span class="line"><span class="comment"> Â  Â  Â  Â $stmt-&gt;execute();</span></span><br><span class="line"><span class="comment"> Â  Â  Â  Â  */</span></span><br><span class="line"> Â  Â  Â  Â <span class="comment">//æ–¹æ³•ä¸‰ï¼šå¦‚æœå ä½ç¬¦çš„é¡ºåºå’Œæ•°ç»„çš„é¡ºåºä¸€è‡´ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’æ•°ç»„</span></span><br><span class="line"> Â  Â  Â  Â <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$card</span>);</span><br><span class="line"> Â   &#125;</span><br></pre></td></tr></table></figure><p><strong>PDOä¸­çš„é¢„å¤„ç†â€”â€”ä½ç½®å ä½ç¬¦</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execute é¢„å¤„ç†åå­— [using å˜é‡]</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œé¢„å¤„ç†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prepare é¢„å¤„ç†åå­— from &#x27;sqlè¯­å¥&#x27;</span><br></pre></td></tr></table></figure><p>é¢„å¤„ç†è¯­å¥ï¼š</p><p>é¢„å¤„ç†å¥½å¤„ï¼šç¼–è¯‘ä¸€æ¬¡å¤šæ¬¡æ‰§è¡Œï¼Œç”¨æ¥è§£å†³ä¸€æ¡SQLè¯­å¥å¤šæ¬¡æ‰§è¡Œçš„é—®é¢˜ï¼Œæé«˜äº†æ‰§è¡Œæ•ˆç‡ã€‚</p><p><strong>å¤ä¹ MySQLä¸­é¢„å¤„ç†</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-PDOä»‹ç»&quot;&gt;&lt;a href=&quot;#1-PDOä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;1 PDOä»‹ç»&quot;&gt;&lt;/a&gt;1 PDOä»‹ç»&lt;/h1&gt;&lt;p&gt;æ–¹æ³•ä¸€ï¼šmysqlæ‰©å±•ã€è¿™ç§æ–¹å¼php7å·²ç»æ·˜æ±°ã€‘&lt;br&gt;æ–¹æ³•äºŒï¼šmysqliæ‰©å±•&lt;br&gt;æ–¹æ³•ä¸‰ï¼šP</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>PHPé¢å‘å¯¹è±¡-4-å‘½åç©ºé—´&amp;trait(åŸå‹)&amp;è¿­ä»£å™¨</title>
    <link href="https://gbk.cx/p/d71be832/"/>
    <id>https://gbk.cx/p/d71be832/</id>
    <published>2024-10-19T13:58:55.000Z</published>
    <updated>2024-10-19T14:18:07.290Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-å‘½åç©ºé—´"><a href="#1-å‘½åç©ºé—´" class="headerlink" title="1 å‘½åç©ºé—´"></a>1 <strong>å‘½åç©ºé—´</strong></h1><h2 id="1-1-ä»‹ç»"><a href="#1-1-ä»‹ç»" class="headerlink" title="1.1 ä»‹ç»"></a><strong>1.1 ä»‹ç»</strong></h2><p>åœ¨ä¸€ä¸ªå¤§çš„é¡¹ç›®ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°åŒåçš„ç±»ã€å‡½æ•°ã€å¸¸é‡ï¼Œä¸ºäº†åŒºåˆ†è¿™äº›å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›å…ƒç´ åˆ†åˆ«å­˜æ”¾åˆ°ä¸åŒçš„å‘½åç©ºé—´ä¸­ã€‚</p><p>1ã€å‘½åç©ºé—´å°±æ˜¯åŒ…ï¼Œç”¨æ¥å­˜æ”¾é¡¹ç›®ä¸­çš„ç±»ã€å‡½æ•°ã€å¸¸é‡</p><p>2ã€é€šè¿‡namespaceå…³é”®å­—æ¥å£°æ˜å‘½åç©ºé—´</p><h2 id="1-2-å£°æ˜å‘½åç©ºé—´"><a href="#1-2-å£°æ˜å‘½åç©ºé—´" class="headerlink" title="1.2 å£°æ˜å‘½åç©ºé—´"></a><strong>1.2 å£°æ˜å‘½åç©ºé—´</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">China</span>;    <span class="comment">//å®šä¹‰å‘½åç©ºé—´</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;æˆ‘æ˜¯ä¸­å›½äºº&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">USA</span>;      <span class="comment">//å®šä¹‰å‘½åç©ºé—´</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;I am a America&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è°ƒç”¨</span></span><br><span class="line"><span class="title function_ invoke__">getInfo</span>();          <span class="comment">//I am a America</span></span><br><span class="line">\USA\<span class="title function_ invoke__">getInfo</span>();     <span class="comment">//I am a America</span></span><br><span class="line">\China\<span class="title function_ invoke__">getInfo</span>();   <span class="comment">//æˆ‘æ˜¯ä¸­å›½äºº</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong><code>\</code>è¡¨ç¤ºå…¬å…±ç©ºé—´</p><h2 id="1-3-å¤šçº§å‘½åç©ºé—´"><a href="#1-3-å¤šçº§å‘½åç©ºé—´" class="headerlink" title="1.3 å¤šçº§å‘½åç©ºé—´"></a><strong>1.3 å¤šçº§å‘½åç©ºé—´</strong></h2><p>å‘½åç©ºé—´çš„åå­—å¯ä»¥æ˜¯å¤šçº§çš„ï¼ˆå­çº§å‘½åç©ºé—´ï¼‰ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">China</span>\<span class="title class_">Beijing</span>\<span class="title class_">Shunyi</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">USA</span>\<span class="title class_">Washington</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•ï¼š</span></span><br><span class="line"><span class="variable">$stu1</span>=<span class="keyword">new</span> <span class="title class_">Student</span>();    <span class="comment">//ç›¸å¯¹è·¯å¾„</span></span><br><span class="line"><span class="variable">$stu2</span>=<span class="keyword">new</span> \USA\Washington\<span class="title function_ invoke__">Student</span>();    <span class="comment">//ç»å¯¹è·¯å¾„</span></span><br><span class="line"><span class="variable">$stu3</span>=<span class="keyword">new</span> <span class="title class_">\China\Beijing\Shunyi\Student</span>();  <span class="comment">//ç»å¯¹è·¯å¾„</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$stu1</span>,<span class="variable">$stu2</span>,<span class="variable">$stu3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//object(USA\Washington\Student)#1 (0) &#123; &#125;</span></span><br><span class="line"><span class="comment">//object(USA\Washington\Student)#2 (0) &#123; &#125;</span></span><br><span class="line"><span class="comment">//object(China\Beijing\Shunyi\Student)#3 (0) &#123; &#125;</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šå¦‚æœå°†ç›¸å¯¹è·¯å¾„è½¬æˆç»å¯¹è·¯å¾„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å…¬å…±ç©ºé—´+å‘½åç©ºé—´+ç©ºé—´å…ƒç´ </span><br><span class="line">å…¬å…±ç©ºé—´ Â  Â  Â  Â  Â  å‘½åç©ºé—´ Â  Â  Â  Â  Â  Â  Â  Â   ç©ºé—´å…ƒç´ </span><br><span class="line"> Â  \ Â  Â  Â  Â  China\Shanghai\PuDong\ Â  Â  Â   Student</span><br></pre></td></tr></table></figure><h2 id="1-4-è®¿é—®ç©ºé—´å…ƒç´ çš„ä¸‰ç§æ–¹å¼"><a href="#1-4-è®¿é—®ç©ºé—´å…ƒç´ çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="1.4 è®¿é—®ç©ºé—´å…ƒç´ çš„ä¸‰ç§æ–¹å¼"></a><strong>1.4 è®¿é—®ç©ºé—´å…ƒç´ çš„ä¸‰ç§æ–¹å¼</strong></h2><p>1ã€éé™å®šåç§°è®¿é—®</p><p>2ã€å®Œå…¨é™å®šåç§°è®¿é—®</p><p>3ã€é™å®šåç§°è®¿é—®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">China</span>\<span class="title class_">Beijing</span>\<span class="title class_">Shunyi</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;é¡ºä¹‰...&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">China</span>\<span class="title class_">Beijing</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;åŒ—äº¬...&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è®¿é—®ç©ºé—´å…ƒç´ çš„ä¸‰ç§æ–¹å¼</span></span><br><span class="line"><span class="title function_ invoke__">getInfo</span>();                  <span class="comment">//éé™å®šåç§°è®¿é—®   åŒ—äº¬...</span></span><br><span class="line">\China\Beijing\<span class="title function_ invoke__">getInfo</span>();   <span class="comment">//å®Œå…¨é™å®šåç§°è®¿é—®      åŒ—äº¬...</span></span><br><span class="line">Shunyi\<span class="title function_ invoke__">getInfo</span>();           <span class="comment">//é™å®šåç§°è®¿é—®        é¡ºä¹‰...</span></span><br><span class="line"><span class="comment">//è½¬æˆç»å¯¹è·¯å¾„å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">// \China\Beijing\Shunyi\getInfo();</span></span><br></pre></td></tr></table></figure><h2 id="1-5-å¼•å…¥å‘½åç©ºé—´"><a href="#1-5-å¼•å…¥å‘½åç©ºé—´" class="headerlink" title="1.5 å¼•å…¥å‘½åç©ºé—´"></a><strong>1.5 å¼•å…¥å‘½åç©ºé—´</strong></h2><p>å®Œå…¨é™å®šåç§°è®¿é—®å…ƒç´ è·¯å¾„å¤ªé•¿ï¼Œå¯ä»¥å°†å…¶ä»–ç©ºé—´å¼•å…¥åˆ°å½“å‰ç©ºé—´æ¥</p><p>é€šè¿‡useå¼•å…¥å‘½åç©ºé—´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">China</span>\<span class="title class_">Beijing</span>\<span class="title class_">Shunyi</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;æç™½&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">USA</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Lincoln&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¼•å…¥å‘½åç©ºé—´</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">China</span>\<span class="title">Beijing</span>\<span class="title">Shunyi</span>;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="title function_ invoke__">getInfo</span>();          <span class="comment">//Lincoln</span></span><br><span class="line">Shunyi\<span class="title function_ invoke__">getInfo</span>();   <span class="comment">//æç™½</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åˆ†æï¼š</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€æ­¥ï¼šé€šè¿‡å½“å‰ç©ºé—´æ‹¼æ¥æˆç»å¯¹è·¯å¾„ï¼š\USA\Shunyi\getInfo(),è¿™ä¸ªåœ°å€æ²¡æœ‰å¯¹åº”çš„ç©ºé—´å…ƒç´ </span></span><br><span class="line"><span class="comment">ç¬¬äºŒæ­¥ï¼šé€šè¿‡å¼•å…¥çš„ç©ºé—´æ‹¼æ¥ç»å¯¹è·¯å¾„ï¼š\China\Beijing\Shunyi+Shunyi\getInfo(),Shunyiæ˜¯å…¬å…±éƒ¨åˆ†ï¼Œåªéœ€è¦å–ä¸€ä¸ªï¼Œæœ€åæ‹¼æ¥çš„åœ°å€æ˜¯ï¼š\China\Beijing\Shunyi\getInfo(),è¿™ä¸ªåœ°å€å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>å¼•å…¥å‘½åç©ºé—´çš„æ‹¼æ¥è§„åˆ™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">å…¬å…±ç©ºé—´+å¼•å…¥ç©ºé—´+ï¼ˆå»é™¤å…¬å…±éƒ¨åˆ†ï¼Œå…¬å…±éƒ¨åˆ†åªèƒ½æœ‰ä¸€çº§ï¼‰ç©ºé—´å…ƒç´ </span><br><span class="line"></span><br><span class="line">æ¯”å¦‚ï¼š</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">A</span>\<span class="title class_">B</span>\<span class="title class_">C</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">D</span>\<span class="title class_">E</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">A</span>\<span class="title">B</span>\<span class="title">C</span>;  <span class="comment">//å¼•å…¥å‘½åç©ºé—´</span></span><br><span class="line">C\<span class="title function_ invoke__">getInfo</span>();    <span class="comment">//æ­£ç¡®    \A\B\C\getInfo();</span></span><br><span class="line">B\C\<span class="title function_ invoke__">getInfo</span>();  <span class="comment">//é”™è¯¯ Â  \A\B\C\B\C\getInfo();</span></span><br></pre></td></tr></table></figure><h2 id="1-6-å¼•å…¥ç©ºé—´å…ƒç´ "><a href="#1-6-å¼•å…¥ç©ºé—´å…ƒç´ " class="headerlink" title="1.6 å¼•å…¥ç©ºé—´å…ƒç´ "></a><strong>1.6 å¼•å…¥ç©ºé—´å…ƒç´ </strong></h2><p>å¼•å…¥ç±»ï¼šuse</p><p>å¼•å…¥å‡½æ•°ï¼šuse function    [php7.0ä»¥åæ”¯æŒ]</p><p>å¼•å…¥å¸¸é‡ï¼šuse const[php7.0ä»¥åæ”¯æŒ]</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">China</span>\<span class="title class_">Beijing</span>\<span class="title class_">Shunyi</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;æç™½&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">TYPE</span>=<span class="string">&#x27;å­¦ç”Ÿ&#x27;</span>;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">USA</span>;</span><br><span class="line"><span class="comment">//å¼•å…¥ç±»</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">China</span>\<span class="title">Beijing</span>\<span class="title">Shunyi</span>\<span class="title">Student</span>;</span><br><span class="line"><span class="comment">//å¼•å…¥å‡½æ•°</span></span><br><span class="line"><span class="keyword">use</span> <span class="keyword">function</span> <span class="title">China</span>\<span class="title">Beijing</span>\<span class="title">Shunyi</span>\<span class="title">getInfo</span>;</span><br><span class="line"><span class="comment">//å¼•å…¥å¸¸é‡</span></span><br><span class="line"><span class="keyword">use</span> <span class="keyword">const</span> <span class="title">China</span>\<span class="title">Beijing</span>\<span class="title">Shunyi</span>\<span class="title">TYPE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$stu</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">getInfo</span>();</span><br><span class="line"><span class="keyword">echo</span> TYPE;</span><br></pre></td></tr></table></figure><h2 id="1-7-ç»™ç±»ã€å‡½æ•°å–åˆ«å"><a href="#1-7-ç»™ç±»ã€å‡½æ•°å–åˆ«å" class="headerlink" title="1.7 ç»™ç±»ã€å‡½æ•°å–åˆ«å"></a><strong>1.7 ç»™ç±»ã€å‡½æ•°å–åˆ«å</strong></h2><p>å¦‚æœå¼•å…¥çš„ç±»å’Œå‡½æ•°ä¸å½“å‰ç©ºé—´çš„ç±»å’Œå‡½æ•°åç§°ç›¸åŒï¼Œéœ€è¦ç»™å¼•å…¥çš„ç±»å’Œå‡½æ•°å–åˆ«åã€‚</p><p>é€šè¿‡aså–åˆ«å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">China</span>\<span class="title class_">Beijing</span>\<span class="title class_">Shunyi</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;æç™½&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">USA</span>\<span class="title class_">Washington</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Lincoln&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¼•å…¥ç±»å–åˆ«å</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">China</span>\<span class="title">Beijing</span>\<span class="title">Shunyi</span>\<span class="title">Student</span> <span class="keyword">as</span> <span class="title">ChinaStudent</span>;</span><br><span class="line"><span class="comment">//å¼•å…¥å‡½æ•°</span></span><br><span class="line"><span class="keyword">use</span> <span class="keyword">function</span> <span class="title">China</span>\<span class="title">Beijing</span>\<span class="title">Shunyi</span>\<span class="title">getInfo</span> <span class="keyword">as</span> <span class="title">info1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">ChinaStudent</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$stu</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">getInfo</span>();  <span class="comment">//Lincoln</span></span><br><span class="line"><span class="title function_ invoke__">info1</span>();    <span class="comment">//æç™½</span></span><br></pre></td></tr></table></figure><h2 id="1-8-å…¬å…±ç©ºé—´"><a href="#1-8-å…¬å…±ç©ºé—´" class="headerlink" title="1.8 å…¬å…±ç©ºé—´"></a><strong>1.8 å…¬å…±ç©ºé—´</strong></h2><p>å¦‚æœä¸€ä¸ªé¡µé¢æ²¡æœ‰namespaceå£°æ˜ç©ºé—´ï¼Œè¿™ä¸ªé¡µé¢çš„å…ƒç´ åœ¨å…¬å…±ç©ºé—´ä¸‹</p><p>å…¬å…±ç©ºé—´ç”¨<code>\</code>è¡¨ç¤º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;æç™½&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">\<span class="title function_ invoke__">getInfo</span>();     <span class="comment">//æç™½</span></span><br></pre></td></tr></table></figure><h2 id="1-9-å‘½åç©ºé—´æ³¨æ„äº‹é¡¹"><a href="#1-9-å‘½åç©ºé—´æ³¨æ„äº‹é¡¹" class="headerlink" title="1.9 å‘½åç©ºé—´æ³¨æ„äº‹é¡¹"></a><strong>1.9 å‘½åç©ºé—´æ³¨æ„äº‹é¡¹</strong></h2><p>1ã€å‘½åç©ºé—´åªèƒ½å­˜æ”¾ç±»ã€å‡½æ•°ã€constå¸¸é‡</p><p>2ã€ç¬¬ä¸€ä¸ªnamespaceå‰é¢ä¸èƒ½æœ‰ä»»ä½•çš„ä»£ç ï¼Œç©ºç™½å­—ç¬¦ã€header()ä¹Ÿä¸è¡Œã€‚</p><p>3ã€åŒ…å«æ–‡ä»¶ä¸å½±å“å½“å‰çš„å‘½åç©ºé—´</p><h1 id="2-trait-åŸå‹"><a href="#2-trait-åŸå‹" class="headerlink" title="2 trait(åŸå‹)"></a>2 <strong>trait(åŸå‹)</strong></h1><p>trait ä¸ºäº†å‡å°‘å•ç»§æ‰¿è¯­è¨€çš„é™åˆ¶ï¼Œå¯ä»¥åœ¨ä¸åŒå±‚æ¬¡ç»“æ„å†…ç‹¬ç«‹çš„ç±»ä¸­å¤ç”¨ç±»çš„æ–¹æ³•é›†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//åŸå‹</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä½¿ç”¨åŸå‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">A</span>;  <span class="comment">//ä»£ç å¤ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">getInfo</span>();    <span class="comment">//é”„ç¦¾æ—¥å½“åˆ</span></span><br></pre></td></tr></table></figure><p>å¼•å…¥å¤šä¸ª trait</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//åŸå‹</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;åºŠå‰æ˜æœˆå…‰&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä½¿ç”¨åŸå‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">A</span>,<span class="title">B</span>;    <span class="comment">//å¼•å…¥Aã€B trait</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">getInfo1</span>();   <span class="comment">//é”„ç¦¾æ—¥å½“åˆ</span></span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">getInfo2</span>();   <span class="comment">//åºŠå‰æ˜æœˆå…‰</span></span><br></pre></td></tr></table></figure><p>traitå’Œç»§æ‰¿ç»“åˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;è¿™æ˜¯traitåŸå‹&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;è¿™æ˜¯Personç±»&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç»§æ‰¿ç±»åŒæ—¶ä»£ç å¤ç”¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">A</span>;      <span class="comment">//ç»§æ‰¿äº†getInfoï¼Œæœ‰è¢«Aä¸­getInfoè¦†ç›–</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">getInfo</span>();    <span class="comment">//è¿™æ˜¯traitåŸå‹</span></span><br></pre></td></tr></table></figure><p>è§£å†³åŒåå†²çª</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//åŸå‹</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;åºŠå‰æ˜æœˆå…‰&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä½¿ç”¨åŸå‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">A</span>,<span class="title">B</span>&#123;    //å¼•å…¥<span class="title">A</span>å’Œ<span class="title">B</span>çš„<span class="title">trait</span>ï¼ŒåŒæ—¶è§£å†³åç§°å†²çª</span><br><span class="line">        //æ–¹æ³•ä¸€ï¼šæ–¹æ³•æ›¿æ¢</span><br><span class="line">        //<span class="title">A</span>::<span class="title">getInfo</span> <span class="title">insteadof</span> <span class="title">B</span>;   <span class="comment">//å°†Aä¸­çš„getInfoæ›¿æ¢æ‰Bä¸­çš„getInfo</span></span><br><span class="line">        <span class="comment">//B::getInfo insteadof A;       //å°†Bä¸­çš„getInfoæ›¿æ¢åˆ°Aä¸­çš„getInfo</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–¹æ³•äºŒï¼šæ”¹å</span></span><br><span class="line">        A::<span class="variable constant_">getInfo</span> <span class="keyword">insteadof</span> B;</span><br><span class="line">        B::<span class="variable constant_">getInfo</span> <span class="keyword">as</span> show;     <span class="comment">//å°†Bçš„getInfoæ”¹åä¸ºshow</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">getInfo</span>();    <span class="comment">//é”„ç¦¾æ—¥å½“åˆ</span></span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">show</span>();       <span class="comment">//åºŠå‰æ˜æœˆå…‰</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åŒåå†²çªçš„è§£å†³æ–¹æ³•æœ‰ä¸¤ä¸ªï¼š</span></span><br><span class="line"><span class="comment">ç¬¬ä¸€ï¼šæ–¹æ³•æ›¿æ¢</span></span><br><span class="line"><span class="comment">ç¬¬äºŒï¼šæ–¹æ³•æ”¹å</span></span><br></pre></td></tr></table></figure><p>æ›´æ”¹æƒé™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">A</span>&#123;</span><br><span class="line">        //<span class="title">show</span> <span class="keyword">as</span> <span class="title">public</span>;   <span class="comment">//å°†showæ–¹æ³•æƒé™è®¾ä¸ºpublic;</span></span><br><span class="line">        show <span class="keyword">as</span> <span class="keyword">public</span> show2;   <span class="comment">//å°†showæ–¹æ³•è®¾ç½®publicï¼Œå¹¶æ”¹åä¸ºshow2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="comment">//$stu-&gt;show();</span></span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">show2</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å¤šå­¦ä¸€æ‹›ï¼š</strong>å…·ä½“å‚è§æ‰‹å†Œ</p><p>1ã€  å¤šä¸ªtraitå¯ä»¥ç»„æˆä¸€ä¸ªtrait</p><p>2ã€  traitå¯ä»¥å®šä¹‰æŠ½è±¡æˆå‘˜</p><p>3ã€  traitå¯ä»¥å®šä¹‰é™æ€æˆå‘˜</p><p>4ã€  traitå¯ä»¥å®šä¹‰å±æ€§</p><h1 id="3-è¿­ä»£å™¨"><a href="#3-è¿­ä»£å™¨" class="headerlink" title="3 è¿­ä»£å™¨"></a>3 <strong>è¿­ä»£å™¨</strong></h1><h2 id="3-1-éå†æ•°ç»„"><a href="#3-1-éå†æ•°ç»„" class="headerlink" title="3.1 éå†æ•°ç»„"></a>3.1 éå†æ•°ç»„</h2><p>æ‰‹åŠ¨éå†æ•°ç»„</p><p>æ­¥éª¤ï¼š</p><p>1ã€å¤ä½æ•°ç»„æŒ‡é’ˆreset()</p><p>2ã€æ£€æŸ¥æŒ‡é’ˆæ˜¯å¦åˆæ³•è·å–å½“å‰æŒ‡é’ˆï¼Œå¦‚æœä¸ä¸ºnullå°±æ˜¯åˆæ³•çš„</p><p>3ã€è·å–å½“å‰å€¼current()</p><p>4ã€è·å–å½“å‰é”®key()</p><p>5ã€æŒ‡é’ˆä¸‹ç§»next()</p><p>ä»£ç å®ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$stu</span>=[<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;berry&#x27;</span>,<span class="string">&#x27;ketty&#x27;</span>,<span class="string">&#x27;rose&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">reset</span>(<span class="variable">$stu</span>);    <span class="comment">//å¤ä½æŒ‡é’ˆ</span></span><br><span class="line"><span class="keyword">while</span>(<span class="title function_ invoke__">key</span>(<span class="variable">$stu</span>)!==<span class="literal">null</span>)&#123;<span class="comment">//é”®åˆæ³•</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">key</span>(<span class="variable">$stu</span>),<span class="string">&#x27;-&#x27;</span>,<span class="title function_ invoke__">current</span>(<span class="variable">$stu</span>),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//è·å–é”®ã€å€¼</span></span><br><span class="line">    <span class="title function_ invoke__">next</span>(<span class="variable">$stu</span>);     <span class="comment">//æŒ‡é’ˆä¸‹ç§»</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">0-tom</span></span><br><span class="line"><span class="comment">1-berry</span></span><br><span class="line"><span class="comment">2-ketty</span></span><br><span class="line"><span class="comment">3-rose</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="3-2-è¿­ä»£å™¨"><a href="#3-2-è¿­ä»£å™¨" class="headerlink" title="3.2 è¿­ä»£å™¨"></a>3.2 è¿­ä»£å™¨</h2><p>è¿­ä»£å™¨æ˜¯PHPå†…ç½®çš„æ¥å£</p><p>åœºæ™¯ï¼šéå†å¯¹è±¡ï¼Œè·å–çš„æ˜¯å¯¹è±¡ä¸­å±æ€§ä¿å­˜çš„æ•°ç»„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å®šä¹‰ç±»å®ç°è¿­ä»£å™¨æ¥å£</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">implements</span> <span class="title">Iterator</span></span>&#123;</span><br><span class="line">    <span class="comment">//$listå±æ€§ç”¨æ¥ä¿å­˜å­¦ç”Ÿæ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$list</span>=<span class="keyword">array</span>();</span><br><span class="line">    <span class="comment">//æ·»åŠ å­¦ç”Ÿ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addStu</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">list</span>[]=<span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®ç°æ¥å£ä¸­çš„å¤ä½æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">rewind</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">reset</span>(<span class="variable">$this</span>-&gt;<span class="keyword">list</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//éªŒè¯å½“å‰æŒ‡é’ˆæ˜¯å¦åˆæ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">valid</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">key</span>(<span class="variable">$this</span>-&gt;<span class="keyword">list</span>)!==<span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">current</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">current</span>(<span class="variable">$this</span>-&gt;<span class="keyword">list</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–é”®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">key</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">key</span>(<span class="variable">$this</span>-&gt;<span class="keyword">list</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŒ‡é’ˆä¸‹ç§»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">next</span>(<span class="variable">$this</span>-&gt;<span class="keyword">list</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºç­çº§</span></span><br><span class="line"><span class="variable">$class</span>=<span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line"><span class="comment">//æ·»åŠ å­¦ç”Ÿ</span></span><br><span class="line"><span class="variable">$class</span>-&gt;<span class="title function_ invoke__">addStu</span>(<span class="string">&#x27;tom&#x27;</span>);</span><br><span class="line"><span class="variable">$class</span>-&gt;<span class="title function_ invoke__">addStu</span>(<span class="string">&#x27;berry&#x27;</span>);</span><br><span class="line"><span class="variable">$class</span>-&gt;<span class="title function_ invoke__">addStu</span>(<span class="string">&#x27;ketty&#x27;</span>);</span><br><span class="line"><span class="comment">//éå†ç­çº§</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$class</span> <span class="keyword">as</span> <span class="variable">$k</span>=&gt;<span class="variable">$v</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$k&#125;</span>-<span class="subst">&#123;$v&#125;</span>&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">0-tom</span></span><br><span class="line"><span class="comment">1-berry</span></span><br><span class="line"><span class="comment">2-ketty</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h1 id="4-PSRç¼–ç è§„èŒƒ"><a href="#4-PSRç¼–ç è§„èŒƒ" class="headerlink" title="4 PSRç¼–ç è§„èŒƒ"></a>4 <strong>PSRç¼–ç è§„èŒƒ</strong></h1><h2 id="4-1-æ¦‚è¿°"><a href="#4-1-æ¦‚è¿°" class="headerlink" title="4.1 æ¦‚è¿°"></a>4.1 æ¦‚è¿°</h2><ol><li>PSR æ˜¯ PHP Standard Recommendations çš„ç®€å†™ï¼Œç”± PHP FIG ç»„ç»‡åˆ¶å®šçš„ PHP è§„èŒƒï¼Œæ˜¯ PHP å¼€å‘çš„å®è·µæ ‡å‡†ã€‚</li><li>ç›®å‰å·²è¡¨å†³é€šè¿‡äº† 6 å¥—æ ‡å‡†ï¼Œå·²ç»å¾—åˆ°å¤§éƒ¨åˆ† PHP æ¡†æ¶çš„æ”¯æŒå’Œè®¤å¯ã€‚</li><li>ç½‘å€ï¼š<a href="http://psr.phphub.org/">http://psr.phphub.org/</a></li></ol><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/OoD7Mn9PJFeLIJFM5LRi1729346401959.png" alt="1560769585637.png"></p><h2 id="4-2-PSR-1-åŸºç¡€ç¼–ç è§„èŒƒ"><a href="#4-2-PSR-1-åŸºç¡€ç¼–ç è§„èŒƒ" class="headerlink" title="4.2 PSR-1 åŸºç¡€ç¼–ç è§„èŒƒ"></a>4.2 PSR-1 åŸºç¡€ç¼–ç è§„èŒƒ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1ã€PHPä»£ç æ–‡ä»¶ å¿…é¡» ä»¥ &lt;?php æˆ– &lt;?= æ ‡ç­¾å¼€å§‹</span><br><span class="line">2ã€ç±»çš„å‘½åå¤§å†™å¼€å¤´çš„é©¼å³°å‘½åè§„èŒƒ</span><br><span class="line">3ã€ç±»ä¸­çš„å¸¸é‡æ‰€æœ‰å­—æ¯éƒ½å¿…é¡»å¤§å†™ï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿åˆ†éš”</span><br><span class="line">4ã€æ–¹æ³•åç§°å¿…é¡»ç¬¦åˆå°å†™å¼€å¤´é©¼å³°å‘½åè§„èŒƒ5ã€</span><br></pre></td></tr></table></figure><p>å‰¯ä½œç”¨ï¼š(side effects)ï¼Œä¸€ä¸ªæ–‡ä»¶åªåšä¸€ä»¶äº‹æƒ…ï¼Œå¦‚æœåšäº†å…¶ä»–äº‹æƒ…å°±æ˜¯äº§ç”Ÿäº†å‰¯ä½œç”¨</p><p>ä¸äº§ç”Ÿå‰¯ä½œç”¨ï¼šä¸€ä¸ªæ–‡ä»¶åªåšä¸€ä»¶äº‹</p><p>äº§ç”Ÿå‰¯ä½œç”¨ï¼šä¸€ä¸ªæ–‡ä»¶åšäº†å¤šä»¶äº‹æƒ…</p><h2 id="4-3-PSR-2-ç¼–ç é£æ ¼è§„èŒƒ"><a href="#4-3-PSR-2-ç¼–ç é£æ ¼è§„èŒƒ" class="headerlink" title="4.3 PSR-2 ç¼–ç é£æ ¼è§„èŒƒ"></a>4.3 PSR-2 ç¼–ç é£æ ¼è§„èŒƒ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä»£ç  å¿…é¡» ä½¿ç”¨ 4 ä¸ªç©ºæ ¼ç¬¦è€Œä¸æ˜¯ã€ŒTab é”®ã€è¿›è¡Œç¼©è¿›</span><br><span class="line">æ¯ä¸ª namespace å‘½åç©ºé—´å£°æ˜è¯­å¥å’Œ use å£°æ˜è¯­å¥å—åé¢ï¼Œå¿…é¡» æ’å…¥ä¸€ä¸ªç©ºç™½è¡Œ</span><br><span class="line">ç±»çš„å¼€å§‹èŠ±æ‹¬å·ï¼ˆ&#123;ï¼‰ å¿…é¡» å†™åœ¨ç±»å£°æ˜åè‡ªæˆä¸€è¡Œï¼Œç»“æŸèŠ±æ‹¬å·ï¼ˆ&#125;ï¼‰ä¹Ÿ å¿…é¡» å†™åœ¨ç±»ä¸»ä½“åè‡ªæˆä¸€è¡Œ</span><br><span class="line">æ–¹æ³•çš„å¼€å§‹èŠ±æ‹¬å·ï¼ˆ&#123;ï¼‰ å¿…é¡» å†™åœ¨å‡½æ•°å£°æ˜åè‡ªæˆä¸€è¡Œï¼Œç»“æŸèŠ±æ‹¬å·ï¼ˆ&#125;ï¼‰ä¹Ÿ å¿…é¡» å†™åœ¨å‡½æ•°ä¸»ä½“åè‡ªæˆä¸€è¡Œã€‚</span><br><span class="line">ç±»çš„å±æ€§å’Œæ–¹æ³• å¿…é¡» æ·»åŠ è®¿é—®ä¿®é¥°ç¬¦ï¼ˆprivateã€protected ä»¥åŠ publicï¼‰ï¼Œabstract ä»¥åŠ final å¿…é¡» å£°æ˜åœ¨è®¿é—®ä¿®é¥°ç¬¦ä¹‹å‰ï¼Œè€Œ static å¿…é¡» å£°æ˜åœ¨è®¿é—®ä¿®é¥°ç¬¦ä¹‹åã€‚</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-å‘½åç©ºé—´&quot;&gt;&lt;a href=&quot;#1-å‘½åç©ºé—´&quot; class=&quot;headerlink&quot; title=&quot;1 å‘½åç©ºé—´&quot;&gt;&lt;/a&gt;1 &lt;strong&gt;å‘½åç©ºé—´&lt;/strong&gt;&lt;/h1&gt;&lt;h2 id=&quot;1-1-ä»‹ç»&quot;&gt;&lt;a href=&quot;#1-1-ä»‹ç»&quot; class=</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>PHPé¢å‘å¯¹è±¡-3-åŠ è½½ç±»&amp;è®¾è®¡æ¨¡å¼&amp;é­”æœ¯æ–¹æ³•&amp;åºåˆ—åŒ–</title>
    <link href="https://gbk.cx/p/be32be3e/"/>
    <id>https://gbk.cx/p/be32be3e/</id>
    <published>2024-10-19T13:56:51.000Z</published>
    <updated>2024-10-19T14:09:40.833Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-è‡ªåŠ¨åŠ è½½ç±»"><a href="#1-è‡ªåŠ¨åŠ è½½ç±»" class="headerlink" title="1 è‡ªåŠ¨åŠ è½½ç±»"></a><strong>1 è‡ªåŠ¨åŠ è½½ç±»</strong></h1><h2 id="1-1-ç±»çš„è§„åˆ™"><a href="#1-1-ç±»çš„è§„åˆ™" class="headerlink" title="1.1 ç±»çš„è§„åˆ™"></a>1.1 <strong>ç±»çš„è§„åˆ™</strong></h2><ol><li>ä¸€ä¸ªæ–‡ä»¶ä¸­åªèƒ½æ”¾ä¸€ä¸ªç±»ï¼ˆå¿…é¡»ï¼‰</li><li>æ–‡ä»¶åå’Œç±»ååŒåï¼ˆå¿…é¡»ï¼‰</li><li>ç±»æ–‡ä»¶ä»¥.class.phpç»“å°¾ï¼ˆä¸æ˜¯å¿…é¡»ï¼‰</li></ol><h2 id="1-2-æ‰‹åŠ¨åŠ è½½ç±»"><a href="#1-2-æ‰‹åŠ¨åŠ è½½ç±»" class="headerlink" title="1.2 æ‰‹åŠ¨åŠ è½½ç±»"></a>1.2 <strong>æ‰‹åŠ¨åŠ è½½ç±»</strong></h2><p>åœ¨PHPé¡µé¢ä¸ŠåŠ è½½ç±»æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./Goods.class.php&#x27;</span>; Â  Â <span class="comment">//æ‰‹åŠ¨åŠ è½½ç±»æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./Book.class.php&#x27;</span>;     <span class="comment">//æ‰‹åŠ¨åŠ è½½ç±»æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./Phone.class.php&#x27;</span>;    <span class="comment">//æ‰‹åŠ¨åŠ è½½ç±»æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$book</span>=<span class="keyword">new</span> <span class="title class_">Book</span>();</span><br><span class="line"><span class="variable">$book</span>-&gt;<span class="title function_ invoke__">setName</span>(<span class="string">&#x27;é¢å‘å¯¹è±¡ç¼–ç¨‹&#x27;</span>);</span><br><span class="line"><span class="variable">$phone</span>=<span class="keyword">new</span> <span class="title class_">Phone</span>();</span><br><span class="line"><span class="variable">$phone</span>-&gt;<span class="title function_ invoke__">setName</span>(<span class="string">&#x27;è‹¹æœ6s&#x27;</span>);</span><br><span class="line"><span class="variable">$book</span>-&gt;<span class="title function_ invoke__">getName</span>();</span><br><span class="line"><span class="variable">$phone</span>-&gt;<span class="title function_ invoke__">getName</span>();</span><br></pre></td></tr></table></figure><h2 id="1-3-è‡ªåŠ¨åŠ è½½ç±»"><a href="#1-3-è‡ªåŠ¨åŠ è½½ç±»" class="headerlink" title="1.3 è‡ªåŠ¨åŠ è½½ç±»"></a>1.3 <strong>è‡ªåŠ¨åŠ è½½ç±»</strong></h2><p>å½“ç¼ºå°‘ç±»çš„æ—¶å€™è‡ªåŠ¨çš„è°ƒç”¨<code>__autoload()</code>å‡½æ•°ï¼Œå¹¶ä¸”å°†ç¼ºå°‘çš„ç±»åä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>__autoload()</code>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*ä½œç”¨ï¼šè‡ªåŠ¨åŠ è½½ç±»</span></span><br><span class="line"><span class="comment">*<span class="doctag">@param</span> $class_name string ç¼ºå°‘çš„ç±»å</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$class_name</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&quot;./<span class="subst">&#123;$class_name&#125;</span>.class.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$book</span>=<span class="keyword">new</span> <span class="title class_">Book</span>();</span><br><span class="line"><span class="variable">$book</span>-&gt;<span class="title function_ invoke__">setName</span>(<span class="string">&#x27;é¢å‘å¯¹è±¡ç¼–ç¨‹&#x27;</span>);</span><br><span class="line"><span class="variable">$phone</span>=<span class="keyword">new</span> <span class="title class_">Phone</span>();</span><br><span class="line"><span class="variable">$phone</span>-&gt;<span class="title function_ invoke__">setName</span>(<span class="string">&#x27;è‹¹æœ6s&#x27;</span>);</span><br><span class="line"><span class="variable">$book</span>-&gt;<span class="title function_ invoke__">getName</span>();</span><br><span class="line"><span class="variable">$phone</span>-&gt;<span class="title function_ invoke__">getName</span>();</span><br></pre></td></tr></table></figure><p>ğŸ’¡ <strong>æ³¨æ„</strong>ï¼š__autoload()å‡½æ•°åœ¨PHP7.2ä»¥åå°±ä¸æ”¯æŒäº†ã€‚</p><h2 id="1-4-æ³¨å†ŒåŠ è½½ç±»"><a href="#1-4-æ³¨å†ŒåŠ è½½ç±»" class="headerlink" title="1.4 æ³¨å†ŒåŠ è½½ç±»"></a>1.4 <strong>æ³¨å†ŒåŠ è½½ç±»</strong></h2><p>é€šè¿‡spl_autoload_register()æ³¨å†Œ__autoload()å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æ–¹æ³•ä¸€ï¼š</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">//åŠ è½½ç±»å‡½æ•°</span></span><br><span class="line"><span class="comment">function loadClass($class_name) &#123;</span></span><br><span class="line"><span class="comment">    require &quot;./&#123;$class_name&#125;.class.php&quot;;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">//æ³¨å†ŒåŠ è½½ç±»å‡½æ•°</span></span><br><span class="line"><span class="comment">spl_autoload_register(&#x27;loadClass&#x27;);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹æ³•äºŒï¼š</span></span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(function(<span class="variable">$class_name</span>)&#123;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&quot;./<span class="subst">&#123;$class_name&#125;</span>.class.php&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$book</span>=<span class="keyword">new</span> <span class="title class_">Book</span>();</span><br><span class="line"><span class="variable">$book</span>-&gt;<span class="title function_ invoke__">setName</span>(<span class="string">&#x27;é¢å‘å¯¹è±¡ç¼–ç¨‹&#x27;</span>);</span><br><span class="line"><span class="variable">$phone</span>=<span class="keyword">new</span> <span class="title class_">Phone</span>();</span><br><span class="line"><span class="variable">$phone</span>-&gt;<span class="title function_ invoke__">setName</span>(<span class="string">&#x27;è‹¹æœ6s&#x27;</span>);</span><br><span class="line"><span class="variable">$book</span>-&gt;<span class="title function_ invoke__">getName</span>();</span><br><span class="line"><span class="variable">$phone</span>-&gt;<span class="title function_ invoke__">getName</span>();</span><br></pre></td></tr></table></figure><p>1ã€spl_autoload_register()å¯ä»¥æ³¨å†Œå¤šä¸ªè‡ªåŠ¨åŠ è½½å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">load1</span>(<span class="params"><span class="variable">$class</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&quot;./<span class="subst">&#123;$class&#125;</span>.class.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">load2</span>(<span class="params"><span class="variable">$class</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&quot;./<span class="subst">&#123;$class&#125;</span>.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">load3</span>(<span class="params"><span class="variable">$class</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&quot;./<span class="subst">&#123;$class&#125;</span>.fun.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(<span class="string">&#x27;load1&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(<span class="string">&#x27;load2&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(<span class="string">&#x27;load3&#x27;</span>);</span><br></pre></td></tr></table></figure><p>2ã€PHP5.1ä»¥åå°±å¼€å§‹æ”¯æŒæ­¤å‡½æ•°ã€‚</p><h2 id="1-5-ç±»æ–‡ä»¶å­˜å‚¨ä¸è§„åˆ™çš„åŠ è½½æ–¹æ³•"><a href="#1-5-ç±»æ–‡ä»¶å­˜å‚¨ä¸è§„åˆ™çš„åŠ è½½æ–¹æ³•" class="headerlink" title="1.5 ç±»æ–‡ä»¶å­˜å‚¨ä¸è§„åˆ™çš„åŠ è½½æ–¹æ³•"></a>1.5 <strong>ç±»æ–‡ä»¶å­˜å‚¨ä¸è§„åˆ™çš„åŠ è½½æ–¹æ³•</strong></h2><p>å°†ç±»åå’Œæ–‡ä»¶åœ°å€åšä¸€ä¸ªæ˜ å°„ï¼Œç»„æˆä¸€ä¸ªå…³è”æ•°ç»„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$map</span>=<span class="keyword">array</span>(</span><br><span class="line"> Â  Â <span class="comment">//ç±»å    =&gt;  ç±»æ–‡ä»¶åœ°å€</span></span><br><span class="line">    <span class="string">&#x27;Goods&#x27;</span> =&gt;  <span class="string">&#x27;./aa/Goods.class.php&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Book&#x27;</span>  =&gt;  <span class="string">&#x27;./bb/Book.class.php&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Phone&#x27;</span> =&gt;  <span class="string">&#x27;./cc/Phone.class.php&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(function(<span class="variable">$class_name</span>)&#123;</span><br><span class="line">    <span class="comment">//ç±»åå’Œæ–‡ä»¶åœ°å€æ˜ å°„æˆä¸€ä¸ªå…³è”æ•°ç»„</span></span><br><span class="line">    <span class="variable">$map</span>=<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;Goods&#x27;</span> =&gt;  <span class="string">&#x27;./aa/Goods.class.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Book&#x27;</span>  =&gt;  <span class="string">&#x27;./bb/Book.class.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Phone&#x27;</span> =&gt;  <span class="string">&#x27;./cc/Phone.class.php&#x27;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="comment">//åœ¨æ˜ å°„æ•°ç»„ä¸­æ‰¾åˆ°å°±åŒ…å«</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$map</span>[<span class="variable">$class_name</span>]))</span><br><span class="line">        <span class="keyword">require</span> <span class="variable">$map</span>[<span class="variable">$class_name</span>];</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$book</span>=<span class="keyword">new</span> <span class="title class_">Book</span>();</span><br><span class="line"><span class="variable">$book</span>-&gt;<span class="title function_ invoke__">setName</span>(<span class="string">&#x27;é¢å‘å¯¹è±¡ç¼–ç¨‹&#x27;</span>);</span><br><span class="line"><span class="variable">$phone</span>=<span class="keyword">new</span> <span class="title class_">Phone</span>();</span><br><span class="line"><span class="variable">$phone</span>-&gt;<span class="title function_ invoke__">setName</span>(<span class="string">&#x27;è‹¹æœ6s&#x27;</span>);</span><br><span class="line"><span class="variable">$book</span>-&gt;<span class="title function_ invoke__">getName</span>();</span><br><span class="line"><span class="variable">$phone</span>-&gt;<span class="title function_ invoke__">getName</span>();</span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®ä¸­ï¼Œç»å¤§éƒ¨åˆ†éƒ½æ˜¯è§„åˆ™å­˜å‚¨çš„ï¼Œä¸è§„åˆ™çš„æ¯”è¾ƒå°‘ã€‚</p><h1 id="2-cloneå’Œ-clone"><a href="#2-cloneå’Œ-clone" class="headerlink" title="2 cloneå’Œ__clone()"></a>2 <strong>cloneå’Œ__clone()</strong></h1><p>æ€è€ƒï¼šåˆ›å»ºå¯¹è±¡çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•ä¸€ï¼šå®ä¾‹åŒ–</span><br><span class="line">æ–¹æ³•äºŒï¼šå…‹éš†</span><br></pre></td></tr></table></figure><p>ä¾‹é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"> Â  Â <span class="comment">//æ‰§è¡ŒcloneæŒ‡ä»¤çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;æ­£åœ¨å…‹éš†å¯¹è±¡&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$stu1</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu2</span>=<span class="keyword">clone</span> <span class="variable">$stu1</span>;      <span class="comment">//å…‹éš†å¯¹è±¡</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$stu1</span>,<span class="variable">$stu2</span>); Â <span class="comment">//object(Student)#1 (0) &#123; &#125; object(Student)#2 (0) &#123; &#125;</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€cloneçš„åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ä¹‹ä¸€</p><p>2ã€å½“æ‰§è¡ŒcloneæŒ‡ä»¤çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨çš„è°ƒç”¨__clone()æ–¹æ³•</p><h1 id="3-è®¾è®¡æ¨¡å¼"><a href="#3-è®¾è®¡æ¨¡å¼" class="headerlink" title="3 è®¾è®¡æ¨¡å¼"></a>3 <strong>è®¾è®¡æ¨¡å¼</strong></h1><h2 id="3-1-å•ä¾‹æ¨¡å¼"><a href="#3-1-å•ä¾‹æ¨¡å¼" class="headerlink" title="3.1 å•ä¾‹æ¨¡å¼"></a>3.1 <strong>å•ä¾‹æ¨¡å¼</strong></h2><h3 id="1-4-1-å•ä¾‹æ¨¡å¼"><a href="#1-4-1-å•ä¾‹æ¨¡å¼" class="headerlink" title="1.4.1 å•ä¾‹æ¨¡å¼"></a><strong>1.4.1 å•ä¾‹æ¨¡å¼</strong></h3><p>ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå¯¹è±¡</p><p>åº”ç”¨åœºæ™¯ï¼šå¤šæ¬¡è¯·æ±‚æ•°æ®åº“åªéœ€è¦ä¸€ä¸ªè¿æ¥å¯¹è±¡ã€‚</p><p>å®ç°ï¼šä¸‰ç§ä¸€å…¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1ã€ç§æœ‰çš„é™æ€å±æ€§ç”¨æ¥ä¿å­˜å¯¹è±¡çš„å•ä¾‹</span><br><span class="line">2ã€ç§æœ‰çš„æ„é€ æ–¹æ³•ç”¨æ¥é˜»æ­¢åœ¨ç±»çš„å¤–éƒ¨å®ä¾‹åŒ–</span><br><span class="line">3ã€ç§æœ‰çš„__cloneé˜»æ­¢åœ¨ç±»çš„å¤–éƒ¨cloneå¯¹è±¡</span><br><span class="line">4ã€å…¬æœ‰çš„é™æ€æ–¹æ³•ç”¨æ¥è·å–å¯¹è±¡çš„å•ä¾‹</span><br></pre></td></tr></table></figure><p>ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//ä¸‰ç§ä¸€å…¬</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DB</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é™æ€çš„å±æ€§ç”¨æ¥ä¿å­˜å¯¹è±¡çš„å•ä¾‹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$instance</span>;</span><br><span class="line">    <span class="comment">//ç§æœ‰çš„æ„é€ æ–¹æ³•é˜»æ­¢åœ¨ç±»çš„å¤–éƒ¨å®ä¾‹åŒ–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç§æœ‰çš„__clone()é˜»æ­¢åœ¨ç±»çš„å¤–éƒ¨cloneå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//ä¿å­˜çš„å€¼ä¸å±äºDBç±»çš„ç±»å‹å°±å®ä¾‹åŒ–</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">self</span>::<span class="variable">$instance</span> <span class="keyword">instanceof</span> <span class="built_in">self</span>)</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$instance</span>=<span class="keyword">new</span> <span class="built_in">self</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$instance</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$db1</span>=DB::<span class="title function_ invoke__">getInstance</span>();</span><br><span class="line"><span class="variable">$db2</span>=DB::<span class="title function_ invoke__">getInstance</span>();</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$db1</span>,<span class="variable">$db2</span>);    <span class="comment">//object(DB)#1 (0) &#123; &#125; object(DB)#1 (0) &#123; &#125;</span></span><br></pre></td></tr></table></figure><h2 id="3-2-å·¥å‚æ¨¡å¼"><a href="#3-2-å·¥å‚æ¨¡å¼" class="headerlink" title="3.2 å·¥å‚æ¨¡å¼"></a>3.2 <strong>å·¥å‚æ¨¡å¼</strong></h2><p>ç‰¹ç‚¹ï¼šä¼ é€’ä¸åŒçš„å‚æ•°è·å–ä¸åŒçš„å¯¹è±¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsA</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsB</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å·¥å‚æ¨¡å¼</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductsFactory</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params"><span class="variable">$num</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span>(<span class="variable">$num</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> ProductsA;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> ProductsB;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$factory</span>=<span class="keyword">new</span> <span class="title class_">ProductsFactory</span>();</span><br><span class="line"><span class="variable">$obj1</span>=<span class="variable">$factory</span>-&gt;<span class="title function_ invoke__">create</span>(<span class="number">1</span>);</span><br><span class="line"><span class="variable">$obj2</span>=<span class="variable">$factory</span>-&gt;<span class="title function_ invoke__">create</span>(<span class="number">2</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$obj1</span>,<span class="variable">$obj2</span>); <span class="comment">//object(ProductsA)#2 (0) &#123; &#125; object(ProductsB)#3 (0) &#123; &#125;</span></span><br></pre></td></tr></table></figure><h2 id="3-3-ç­–ç•¥æ¨¡å¼"><a href="#3-3-ç­–ç•¥æ¨¡å¼" class="headerlink" title="3.3 ç­–ç•¥æ¨¡å¼"></a>3.3 <strong>ç­–ç•¥æ¨¡å¼</strong></h2><p>ç‰¹ç‚¹ï¼šä¼ é€’ä¸åŒçš„å‚æ•°è°ƒç”¨ä¸åŒçš„ç­–ç•¥ï¼ˆæ–¹æ³•ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Walk</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">way</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;èµ°ç€å»&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bus</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">way</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;åè½¦å»&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç­–ç•¥æ¨¡å¼</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">play</span>(<span class="params"><span class="variable">$obj</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$obj</span>-&gt;<span class="title function_ invoke__">way</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">play</span>(<span class="keyword">new</span> <span class="title class_">Walk</span>()); <span class="comment">//èµ°ç€å»</span></span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">play</span>(<span class="keyword">new</span> <span class="title class_">Bus</span>());  <span class="comment">//åè½¦å»</span></span><br></pre></td></tr></table></figure><h1 id="4-åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#4-åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="4 åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>4 <strong>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong></h1><p>åœ¨PHPä¸­ï¼Œæ•°ç»„å’Œå¯¹è±¡æ— æ³•ä¿å­˜ï¼Œå¦‚æœéœ€è¦ä¿å­˜å°±è¦å°†æ•°ç»„æˆ–å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªåºåˆ—ã€‚</p><p>åºåˆ—åŒ–ï¼šå°†æ•°ç»„æˆ–å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªåºåˆ—ï¼ˆserializeï¼‰</p><p>ååºåˆ—åŒ–ï¼šå°†åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è½¬æ¢æˆæ•°ç»„æˆ–å¯¹è±¡ã€‚(unserialize)</p><h2 id="4-1-æ•°ç»„çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#4-1-æ•°ç»„çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="4.1 æ•°ç»„çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>4.1 <strong>æ•°ç»„çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æ•°ç»„çš„åºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">$stu=[&#x27;tom&#x27;,&#x27;berry&#x27;,&#x27;ketty&#x27;];</span></span><br><span class="line"><span class="comment">$str=serialize($stu);//åºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">file_put_contents(&#x27;./stu.txt&#x27;,$str);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ•°ç»„çš„ååºåˆ—åŒ–</span></span><br><span class="line"><span class="variable">$str</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./stu.txt&#x27;</span>);</span><br><span class="line"><span class="variable">$stu</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);<span class="comment">//ååºåˆ—åŒ–</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$stu</span>);<span class="comment">//Array ( [0] =&gt; tom [1] =&gt; berry [2] =&gt; ketty )</span></span><br></pre></td></tr></table></figure><h2 id="4-2-å¯¹è±¡çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#4-2-å¯¹è±¡çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="4.2 å¯¹è±¡çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>4.2 <strong>å¯¹è±¡çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong></h2><p>ğŸ’¡ æ³¨æ„ï¼šå¯¹è±¡çš„ååºåˆ—åŒ–éœ€è¦æœ‰ç±»çš„å‚ä¸ï¼Œå¦‚æœæ²¡æœ‰ç±»åœ¨ååºåˆ—åŒ–æ—¶å€™æ— æ³•ç¡®å®šç±»</p><h1 id="5-é­”æœ¯æ–¹æ³•"><a href="#5-é­”æœ¯æ–¹æ³•" class="headerlink" title="5 é­”æœ¯æ–¹æ³•"></a>5 <strong>é­”æœ¯æ–¹æ³•</strong></h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å·²ç»å­¦è¿‡çš„é­”æœ¯æ–¹æ³•</span><br><span class="line"><span class="title function_ invoke__">__construct</span>() æ„é€ æ–¹æ³•</span><br><span class="line"><span class="title function_ invoke__">__destruct</span>() ææ„æ–¹æ³•</span><br><span class="line"><span class="title function_ invoke__">__clone</span>() å…‹éš†æ–¹æ³•</span><br></pre></td></tr></table></figure><h2 id="5-1-tostring-ã€-invoke"><a href="#5-1-tostring-ã€-invoke" class="headerlink" title="5.1 __tostring()ã€__invoke()"></a>5.1 <strong><code>__tostring()ã€__invoke()</code></strong></h2><p><code>__tostring()</code>ï¼šå°†å¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨</p><p><code>__invoke()</code>ï¼šå°†å¯¹è±¡å½“æˆå‡½æ•°ä½¿ç”¨çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"><span class="comment">//æŠŠå¯¹è±¡å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯å­—ç¬¦ä¸²&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æŠŠå¯¹è±¡å½“æˆå‡½æ•°ä½¿ç”¨çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯å‡½æ•°&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$stu</span>;<span class="comment">//å½“æˆå­—ç¬¦ä¸²ä½¿ç”¨</span></span><br><span class="line"><span class="variable">$stu</span>();<span class="comment">//å½“æˆå‡½æ•°ä½¿ç”¨</span></span><br></pre></td></tr></table></figure><h2 id="5-2-set-ã€-get-ã€-isset-ã€-unset"><a href="#5-2-set-ã€-get-ã€-isset-ã€-unset" class="headerlink" title="5.2 __set()ã€__get()ã€__isset()ã€__unset()"></a>5.2 <strong><code>__set()ã€__get()ã€__isset()ã€__unset()</code></strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">__set</span>(<span class="variable">$k</span>,<span class="variable">$v</span>)ï¼šç»™æ— æ³•è®¿é—®çš„å±æ€§èµ‹å€¼çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ</span><br><span class="line"><span class="title function_ invoke__">__get</span>(<span class="variable">$k</span>)ï¼šè·å–æ— æ³•è®¿é—®çš„å±æ€§å€¼çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨</span><br><span class="line"><span class="title function_ invoke__">__isset</span>(<span class="variable">$k</span>)ï¼šåˆ¤æ–­æ— æ³•è®¿é—®çš„å±æ€§æ˜¯å¦å­˜åœ¨è‡ªåŠ¨è°ƒç”¨</span><br><span class="line"><span class="title function_ invoke__">__unset</span>(<span class="variable">$k</span>)ï¼šé”€æ¯æ— æ³•è®¿é—®çš„å±æ€§çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ</span><br></pre></td></tr></table></figure><h2 id="5-3-call-ã€-callstatic"><a href="#5-3-call-ã€-callstatic" class="headerlink" title="5.3 __call()ã€__callstatic()"></a>5.3 <strong><code>__call()ã€__callstatic()</code></strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">__call</span>()ï¼šè°ƒç”¨æ— æ³•è®¿é—®çš„æ–¹æ³•æ—¶è‡ªåŠ¨æ‰§è¡Œ</span><br><span class="line"><span class="title function_ invoke__">__callstatic</span>()ï¼šè°ƒç”¨æ— æ³•è®¿é—®çš„é™æ€æ–¹æ³•æ—¶è‡ªåŠ¨æ‰§è¡Œ</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*ä½œç”¨ï¼šè°ƒç”¨æ— æ³•è®¿é—®çš„æ–¹æ³•æ—¶è‡ªåŠ¨æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">*<span class="doctag">@param</span> $fn_name string æ–¹æ³•å</span></span><br><span class="line"><span class="comment">*<span class="doctag">@param</span> $fn_args array å‚æ•°æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fn_name</span>,<span class="variable">$fn_args</span></span>) </span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$fn_name&#125;</span>ä¸å­˜åœ¨&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è°ƒç”¨æ— æ³•è®¿é—®çš„é™æ€æ–¹æ³•æ—¶è‡ªåŠ¨æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callstatic</span>(<span class="params"><span class="variable">$fn_name</span>,<span class="variable">$fn_args</span></span>) </span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$fn_name&#125;</span>é™æ€æ–¹æ³•ä¸å­˜åœ¨&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">show</span>(<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Student</span>::<span class="title function_ invoke__">show</span>();</span><br></pre></td></tr></table></figure><h2 id="5-4-sleep-ã€-wakeup"><a href="#5-4-sleep-ã€-wakeup" class="headerlink" title="5.4 __sleep()ã€__wakeup()"></a>5.4 <strong><code>__sleep()ã€__wakeup()</code></strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">__sleep</span>()ï¼šå½“åºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨</span><br><span class="line"><span class="title function_ invoke__">__wakeup</span>()ï¼šå½“ååºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$sex</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$add</span>=<span class="string">&#x27;ä¸­å›½&#x27;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$sex</span></span>) </span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;name=<span class="variable">$name</span>;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;sex=<span class="variable">$sex</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*åºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨</span></span><br><span class="line"><span class="comment">*<span class="doctag">@return</span> array åºåˆ—åŒ–çš„å±æ€§å</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;sex&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ååºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;type=<span class="string">&#x27;å­¦ç”Ÿ&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;ç”·&#x27;</span>);</span><br><span class="line"><span class="variable">$str</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$stu</span>);<span class="comment">//åºåˆ—åŒ–</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);<span class="comment">//ååºåˆ—åŒ–</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$stu</span>);</span><br></pre></td></tr></table></figure><h1 id="6-æ¨¡æ‹Ÿæ–¹æ³•é‡è½½"><a href="#6-æ¨¡æ‹Ÿæ–¹æ³•é‡è½½" class="headerlink" title="6 æ¨¡æ‹Ÿæ–¹æ³•é‡è½½"></a>6 <strong>æ¨¡æ‹Ÿæ–¹æ³•é‡è½½</strong></h1><p>é€šè¿‡é­”æœ¯æ–¹æ³•æ¨¡æ‹Ÿæ–¹æ³•é‡è½½</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Math</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fn_name</span>,<span class="variable">$fn_args</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$sum</span>=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$fn_args</span> <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="variable">$sum</span>+=<span class="variable">$v</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;,&#x27;</span>,<span class="variable">$fn_args</span>).<span class="string">&#x27;çš„å’Œæ˜¯ï¼š&#x27;</span>.<span class="variable">$sum</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ©ç”¨é­”æœ¯æ–¹æ³•æ¨¡æ‹Ÿæ–¹æ³•é‡è½½</span></span><br><span class="line"><span class="variable">$math</span>=<span class="keyword">new</span> <span class="title class_">Math</span>();</span><br><span class="line"><span class="variable">$math</span>-&gt;<span class="title function_ invoke__">call</span>(<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"><span class="variable">$math</span>-&gt;<span class="title function_ invoke__">call</span>(<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>);</span><br><span class="line"><span class="variable">$math</span>-&gt;<span class="title function_ invoke__">call</span>(<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>);</span><br></pre></td></tr></table></figure><h1 id="7-éå†å¯¹è±¡"><a href="#7-éå†å¯¹è±¡" class="headerlink" title="7 éå†å¯¹è±¡"></a>7 <strong>éå†å¯¹è±¡</strong></h1><p>é€šè¿‡foreachéå†å¯¹è±¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;tom&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$sex</span>=<span class="string">&#x27;ç”·&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$age</span>=<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable language_">$this</span> <span class="keyword">as</span> <span class="variable">$k</span>=&gt;<span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$k&#125;</span>-<span class="subst">&#123;$v&#125;</span>&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$stu</span> <span class="keyword">as</span> <span class="variable">$k</span>=&gt;<span class="variable">$v</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$k&#125;</span>-<span class="subst">&#123;$v&#125;</span>&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br></pre></td></tr></table></figure><p>ç»“è®ºï¼š<strong>éå†åˆ°å½“å‰ä½ç½®æ‰€èƒ½è®¿é—®åˆ°å±æ€§</strong></p><h1 id="8-å°è£…MySQLçš„å•ä¾‹"><a href="#8-å°è£…MySQLçš„å•ä¾‹" class="headerlink" title="8 å°è£…MySQLçš„å•ä¾‹"></a>8 <strong>å°è£…MySQLçš„å•ä¾‹</strong></h1><h2 id="8-1-åˆ†æ"><a href="#8-1-åˆ†æ" class="headerlink" title="8.1 åˆ†æ"></a>8.1 <strong>åˆ†æ</strong></h2><p>1ã€å®ç°å•ä¾‹</p><p>2ã€è¿æ¥æ•°æ®åº“</p><p>3ã€å¯¹æ•°æ®è¿›è¡Œæ“ä½œ</p><h2 id="8-2-æ­¥éª¤"><a href="#8-2-æ­¥éª¤" class="headerlink" title="8.2 æ­¥éª¤"></a>8.2 <strong>æ­¥éª¤</strong></h2><p>ç¬¬ä¸€æ­¥ï¼šå®ç°å•ä¾‹</p><p>ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–å‚æ•°</p><p>ç¬¬ä¸‰æ­¥ï¼šè¿æ¥æ•°æ®åº“</p><p>ç¬¬å››æ­¥ï¼šæ“ä½œæ•°æ®</p><p>1ã€æ‰§è¡Œæ•°æ®æ“ä½œè¯­å¥ï¼ˆå¢ã€åˆ ã€æ”¹ï¼‰</p><p>2ã€æ‰§è¡Œæ•°æ®æŸ¥è¯¢è¯­å¥</p><pre><code>a) è¿”å›äºŒç»´æ•°ç»„b) è¿”å›ä¸€ç»´æ•°ç»„c)è¿”å›ä¸€è¡Œä¸€åˆ—</code></pre><p>8.3 <strong>ä»£ç å®ç°</strong></p><p>ç¬¬ä¸€æ­¥ï¼šå®ç°å•ä¾‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQLDB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$instance</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">self</span>::<span class="variable">$instance</span> <span class="keyword">instanceof</span> <span class="built_in">self</span>)</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$instance</span>=<span class="keyword">new</span> <span class="built_in">self</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$instance</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$db</span>=MySQLDB::<span class="title function_ invoke__">getInstance</span>();</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$db</span>);</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šA instanceof Bï¼Œè¡¨ç¤ºAæ˜¯å¦æ˜¯Bçš„ç±»å‹ï¼Œè¿”å›boolå€¼</p><p>ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–å‚æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å°è£…MySQLå•ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQLDB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$host</span>;      <span class="comment">//ä¸»æœºåœ°å€</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$port</span>;      <span class="comment">//ç«¯å£å·</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>;      <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$pwd</span>;       <span class="comment">//å¯†ç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$dbname</span>;    <span class="comment">//æ•°æ®æ¥å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$charset</span>;   <span class="comment">//å­—ç¬¦é›†</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$link</span>;      <span class="comment">//è¿æ¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$instance</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initParam</span>(<span class="variable">$param</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–å•ä¾‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"><span class="variable">$param</span>=<span class="keyword">array</span>(<span class="params"></span>)</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">self</span>::<span class="variable">$instance</span> <span class="keyword">instanceof</span> <span class="built_in">self</span>)</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$instance</span>=<span class="keyword">new</span> <span class="built_in">self</span>(<span class="variable">$param</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$instance</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initParam</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;host=<span class="variable">$param</span>[<span class="string">&#x27;host&#x27;</span>]??<span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;port=<span class="variable">$param</span>[<span class="string">&#x27;port&#x27;</span>]??<span class="string">&#x27;3306&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="variable">$param</span>[<span class="string">&#x27;user&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pwd=<span class="variable">$param</span>[<span class="string">&#x27;pwd&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;dbname=<span class="variable">$param</span>[<span class="string">&#x27;dbname&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;charset=<span class="variable">$param</span>[<span class="string">&#x27;charset&#x27;</span>]??<span class="string">&#x27;utf8&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="comment">//é…ç½®å‚æ•°</span></span><br><span class="line"><span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;user&#x27;</span>      =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;pwd&#x27;</span>       =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dbname&#x27;</span>    =&gt;  <span class="string">&#x27;data&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//è·å–å•ä¾‹</span></span><br><span class="line"><span class="variable">$db</span>=MySQLDB::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$db</span>);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼šè¿æ¥æ•°æ®åº“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å°è£…MySQLå•ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQLDB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$host</span>;      <span class="comment">//ä¸»æœºåœ°å€</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$port</span>;      <span class="comment">//ç«¯å£å·</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>;      <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$pwd</span>;       <span class="comment">//å¯†ç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$dbname</span>;    <span class="comment">//æ•°æ®æ¥å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$charset</span>;   <span class="comment">//å­—ç¬¦é›†</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$link</span>;      <span class="comment">//è¿æ¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$instance</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initParam</span>(<span class="variable">$param</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initConnect</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–å•ä¾‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"><span class="variable">$param</span>=<span class="keyword">array</span>(<span class="params"></span>)</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">self</span>::<span class="variable">$instance</span> <span class="keyword">instanceof</span> <span class="built_in">self</span>)</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$instance</span>=<span class="keyword">new</span> <span class="built_in">self</span>(<span class="variable">$param</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$instance</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initParam</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;host=<span class="variable">$param</span>[<span class="string">&#x27;host&#x27;</span>]??<span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;port=<span class="variable">$param</span>[<span class="string">&#x27;port&#x27;</span>]??<span class="string">&#x27;3306&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="variable">$param</span>[<span class="string">&#x27;user&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pwd=<span class="variable">$param</span>[<span class="string">&#x27;pwd&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;dbname=<span class="variable">$param</span>[<span class="string">&#x27;dbname&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;charset=<span class="variable">$param</span>[<span class="string">&#x27;charset&#x27;</span>]??<span class="string">&#x27;utf8&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initConnect</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;link=@<span class="title function_ invoke__">mysqli_connect</span>(<span class="variable">$this</span>-&gt;host,<span class="variable">$this</span>-&gt;user,<span class="variable">$this</span>-&gt;pwd,<span class="variable">$this</span>-&gt;dbname);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_connect_error</span>())&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;æ•°æ®åº“è¿æ¥å¤±è´¥&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_connect_error</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ç ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_connect_errno</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">mysqli_set_charset</span>(<span class="variable">$this</span>-&gt;link,<span class="variable">$this</span>-&gt;charset);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="comment">//é…ç½®å‚æ•°</span></span><br><span class="line"><span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;user&#x27;</span>      =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;pwd&#x27;</span>       =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dbname&#x27;</span>    =&gt;  <span class="string">&#x27;data&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//è·å–å•ä¾‹</span></span><br><span class="line"><span class="variable">$db</span>=MySQLDB::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$db</span>);</span><br></pre></td></tr></table></figure><p>ç¬¬å››æ­¥ï¼šæ•°æ®æ“ä½œçš„åŠŸèƒ½</p><p>1ã€æ‰§è¡Œå¢ã€åˆ ã€æ”¹æ“ä½œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å°è£…MySQLå•ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQLDB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$host</span>;      <span class="comment">//ä¸»æœºåœ°å€</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$port</span>;      <span class="comment">//ç«¯å£å·</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>;      <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$pwd</span>;       <span class="comment">//å¯†ç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$dbname</span>;    <span class="comment">//æ•°æ®æ¥å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$charset</span>;   <span class="comment">//å­—ç¬¦é›†</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$link</span>;      <span class="comment">//è¿æ¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$instance</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initParam</span>(<span class="variable">$param</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initConnect</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–å•ä¾‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"><span class="variable">$param</span>=<span class="keyword">array</span>(<span class="params"></span>)</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">self</span>::<span class="variable">$instance</span> <span class="keyword">instanceof</span> <span class="built_in">self</span>)</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$instance</span>=<span class="keyword">new</span> <span class="built_in">self</span>(<span class="variable">$param</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$instance</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initParam</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;host=<span class="variable">$param</span>[<span class="string">&#x27;host&#x27;</span>]??<span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;port=<span class="variable">$param</span>[<span class="string">&#x27;port&#x27;</span>]??<span class="string">&#x27;3306&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="variable">$param</span>[<span class="string">&#x27;user&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pwd=<span class="variable">$param</span>[<span class="string">&#x27;pwd&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;dbname=<span class="variable">$param</span>[<span class="string">&#x27;dbname&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;charset=<span class="variable">$param</span>[<span class="string">&#x27;charset&#x27;</span>]??<span class="string">&#x27;utf8&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initConnect</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;link=@<span class="title function_ invoke__">mysqli_connect</span>(<span class="variable">$this</span>-&gt;host,<span class="variable">$this</span>-&gt;user,<span class="variable">$this</span>-&gt;pwd,<span class="variable">$this</span>-&gt;dbname);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_connect_error</span>())&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;æ•°æ®åº“è¿æ¥å¤±è´¥&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_connect_error</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ç ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_connect_errno</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">mysqli_set_charset</span>(<span class="variable">$this</span>-&gt;link,<span class="variable">$this</span>-&gt;charset);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ‰§è¡Œæ•°æ®åº“çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$sql</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$rs</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$this</span>-&gt;link,<span class="variable">$sql</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;SQLè¯­å¥æ‰§è¡Œå¤±è´¥&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$this</span>-&gt;link),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ç ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_errno</span>(<span class="variable">$this</span>-&gt;link),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯çš„SQLè¯­å¥ï¼š&#x27;</span>.<span class="variable">$sql</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$rs</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *æ‰§è¡Œå¢ã€åˆ ã€æ”¹</span></span><br><span class="line"><span class="comment">    *<span class="doctag">@return</span> bool æˆåŠŸè¿”å›true,å¤±è´¥è¿”å›false</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">exec</span>(<span class="params"><span class="variable">$sql</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$key</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$sql</span>,<span class="number">0</span>,<span class="number">6</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$key</span>,<span class="keyword">array</span>(<span class="string">&#x27;insert&#x27;</span>,<span class="string">&#x27;update&#x27;</span>,<span class="string">&#x27;delete&#x27;</span>)))</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$sql</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;éæ³•è®¿é—®&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–è‡ªåŠ¨å¢é•¿çš„ç¼–å·</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getLastInsertId</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">mysqli_insert_id</span>(<span class="variable">$this</span>-&gt;link);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="comment">//é…ç½®å‚æ•°</span></span><br><span class="line"><span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;user&#x27;</span>      =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;pwd&#x27;</span>       =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dbname&#x27;</span>    =&gt;  <span class="string">&#x27;data&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//è·å–å•ä¾‹</span></span><br><span class="line"><span class="variable">$db</span>=MySQLDB::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="comment">//æ›´æ–°</span></span><br><span class="line"><span class="comment">//$db-&gt;exec(&quot;update news set title=&#x27;é’è‰&#x27; where id=2&quot;);</span></span><br><span class="line"><span class="comment">//æ’å…¥</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$db</span>-&gt;<span class="title function_ invoke__">exec</span>(<span class="string">&quot;insert into news values (null,&#x27;aa&#x27;,&#x27;bb&#x27;,unix_timestamp())&quot;</span>))</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;ç¼–å·æ˜¯ï¼š&#x27;</span>.<span class="variable">$db</span>-&gt;<span class="title function_ invoke__">getLastInsertId</span>();</span><br></pre></td></tr></table></figure><p>2ã€æŸ¥è¯¢ç»“æœ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å°è£…MySQLå•ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQLDB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$host</span>;      <span class="comment">//ä¸»æœºåœ°å€</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$port</span>;      <span class="comment">//ç«¯å£å·</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>;      <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$pwd</span>;       <span class="comment">//å¯†ç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$dbname</span>;    <span class="comment">//æ•°æ®æ¥å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$charset</span>;   <span class="comment">//å­—ç¬¦é›†</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$link</span>;      <span class="comment">//è¿æ¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$instance</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initParam</span>(<span class="variable">$param</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">initConnect</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–å•ä¾‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"><span class="variable">$param</span>=<span class="keyword">array</span>(<span class="params"></span>)</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">self</span>::<span class="variable">$instance</span> <span class="keyword">instanceof</span> <span class="built_in">self</span>)</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$instance</span>=<span class="keyword">new</span> <span class="built_in">self</span>(<span class="variable">$param</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$instance</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initParam</span>(<span class="params"><span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;host=<span class="variable">$param</span>[<span class="string">&#x27;host&#x27;</span>]??<span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;port=<span class="variable">$param</span>[<span class="string">&#x27;port&#x27;</span>]??<span class="string">&#x27;3306&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="variable">$param</span>[<span class="string">&#x27;user&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pwd=<span class="variable">$param</span>[<span class="string">&#x27;pwd&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;dbname=<span class="variable">$param</span>[<span class="string">&#x27;dbname&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;charset=<span class="variable">$param</span>[<span class="string">&#x27;charset&#x27;</span>]??<span class="string">&#x27;utf8&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">initConnect</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;link=@<span class="title function_ invoke__">mysqli_connect</span>(<span class="variable">$this</span>-&gt;host,<span class="variable">$this</span>-&gt;user,<span class="variable">$this</span>-&gt;pwd,<span class="variable">$this</span>-&gt;dbname);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_connect_error</span>())&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;æ•°æ®åº“è¿æ¥å¤±è´¥&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_connect_error</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ç ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_connect_errno</span>(),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">mysqli_set_charset</span>(<span class="variable">$this</span>-&gt;link,<span class="variable">$this</span>-&gt;charset);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ‰§è¡Œæ•°æ®åº“çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$sql</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable">$rs</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$this</span>-&gt;link,<span class="variable">$sql</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;SQLè¯­å¥æ‰§è¡Œå¤±è´¥&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ä¿¡æ¯ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$this</span>-&gt;link),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ç ï¼š&#x27;</span>.<span class="title function_ invoke__">mysqli_errno</span>(<span class="variable">$this</span>-&gt;link),<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯çš„SQLè¯­å¥ï¼š&#x27;</span>.<span class="variable">$sql</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$rs</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *æ‰§è¡Œå¢ã€åˆ ã€æ”¹</span></span><br><span class="line"><span class="comment">    *<span class="doctag">@return</span> bool æˆåŠŸè¿”å›true,å¤±è´¥è¿”å›false</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">exec</span>(<span class="params"><span class="variable">$sql</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$key</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$sql</span>,<span class="number">0</span>,<span class="number">6</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$key</span>,<span class="keyword">array</span>(<span class="string">&#x27;insert&#x27;</span>,<span class="string">&#x27;update&#x27;</span>,<span class="string">&#x27;delete&#x27;</span>)))</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$sql</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;éæ³•è®¿é—®&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–è‡ªåŠ¨å¢é•¿çš„ç¼–å·</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getLastInsertId</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">mysqli_insert_id</span>(<span class="variable">$this</span>-&gt;link);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡ŒæŸ¥è¯¢è¯­å¥</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">query</span>(<span class="params"><span class="variable">$sql</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$sql</span>,<span class="number">0</span>,<span class="number">6</span>)==<span class="string">&#x27;select&#x27;</span> || <span class="title function_ invoke__">substr</span>(<span class="variable">$sql</span>,<span class="number">0</span>,<span class="number">4</span>)==<span class="string">&#x27;show&#x27;</span> || <span class="title function_ invoke__">substr</span>(<span class="variable">$sql</span>,<span class="number">0</span>,<span class="number">4</span>)==<span class="string">&#x27;desc&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$sql</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;éæ³•è®¿é—®&lt;br&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè¿”å›äºŒç»´æ•°ç»„</span></span><br><span class="line"><span class="comment">    *@$sql string æŸ¥è¯¢sqlè¯­å¥</span></span><br><span class="line"><span class="comment">    *<span class="doctag">@type</span> string assoc|num|both</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchAll</span>(<span class="params"><span class="variable">$sql</span>,<span class="variable">$type</span>=<span class="string">&#x27;assoc&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$rs</span>=<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">        <span class="variable">$type</span>=<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getType</span>(<span class="variable">$type</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">mysqli_fetch_all</span>(<span class="variable">$rs</span>,<span class="variable">$type</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åŒ¹é…ä¸€ç»´æ•°ç»„</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchRow</span>(<span class="params"><span class="variable">$sql</span>,<span class="variable">$type</span>=<span class="string">&#x27;assoc&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$list</span>=<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">fetchAll</span>(<span class="variable">$sql</span>,<span class="variable">$type</span>);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$list</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$list</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åŒ¹é…ä¸€è¡Œä¸€åˆ—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchColumn</span>(<span class="params"><span class="variable">$sql</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$list</span>=<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">fetchRow</span>(<span class="variable">$sql</span>,<span class="string">&#x27;num&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$list</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$list</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–åŒ¹é…ç±»å‹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">getType</span>(<span class="params"><span class="variable">$type</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span>(<span class="variable">$type</span>)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;num&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> Â MYSQLI_NUM;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;both&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> Â MYSQLI_BOTH;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> Â MYSQLI_ASSOC;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="comment">//é…ç½®å‚æ•°</span></span><br><span class="line"><span class="variable">$param</span>=<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;user&#x27;</span>      =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;pwd&#x27;</span>       =&gt;  <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dbname&#x27;</span>    =&gt;  <span class="string">&#x27;data&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//è·å–å•ä¾‹</span></span><br><span class="line"><span class="variable">$db</span>=MySQLDB::<span class="title function_ invoke__">getInstance</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="comment">//æ›´æ–°</span></span><br><span class="line"><span class="comment">//$db-&gt;exec(&quot;update news set title=&#x27;é’è‰&#x27; where id=2&quot;);</span></span><br><span class="line"><span class="comment">//æ’å…¥</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">if($db-&gt;exec(&quot;insert into news values (null,&#x27;aa&#x27;,&#x27;bb&#x27;,unix_timestamp())&quot;))</span></span><br><span class="line"><span class="comment">    echo &#x27;ç¼–å·æ˜¯ï¼š&#x27;.$db-&gt;getLastInsertId();</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">//$list=$db-&gt;fetchAll(&#x27;select * from news&#x27;,&#x27;aa&#x27;);</span></span><br><span class="line"><span class="comment">//$list=$db-&gt;fetchRow(&#x27;select * from news where id=1&#x27;,&#x27;aa&#x27;);</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$list</span>=<span class="variable">$db</span>-&gt;<span class="title function_ invoke__">fetchColumn</span>(<span class="string">&#x27;select count(*) from news&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$list</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€instanceof ç”¨æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å±äºæŸä¸ªç±»</p><p>2ã€å‚æ•°å¿…é¡»ä»å¤–éƒ¨ä¼ é€’åˆ°å†…éƒ¨ï¼Œä¸èƒ½å†™æ­»åˆ°ç±»çš„å†…éƒ¨ã€‚</p><p>3ã€ä¸ºäº†ä¿è¯ä»£ç çš„å¯é‡ç”¨æ€§ï¼Œä¸€ä¸ªæ–¹æ³•åªå®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œæ‰€ä»¥åˆå§‹åŒ–å‚æ•°å’Œè¿æ¥æ•°æ®åº“åˆ†åˆ°ä¸¤ä¸ªæ–¹æ³•ä¸­ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-è‡ªåŠ¨åŠ è½½ç±»&quot;&gt;&lt;a href=&quot;#1-è‡ªåŠ¨åŠ è½½ç±»&quot; class=&quot;headerlink&quot; title=&quot;1 è‡ªåŠ¨åŠ è½½ç±»&quot;&gt;&lt;/a&gt;&lt;strong&gt;1 è‡ªåŠ¨åŠ è½½ç±»&lt;/strong&gt;&lt;/h1&gt;&lt;h2 id=&quot;1-1-ç±»çš„è§„åˆ™&quot;&gt;&lt;a href=&quot;#1-1-ç±»çš„è§„åˆ™</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>PHPé¢å‘å¯¹è±¡-2-ä¸‰å¤§ç‰¹æ€§&amp;ç±»å¸¸é‡&amp;æ¥å£</title>
    <link href="https://gbk.cx/p/980312b6/"/>
    <id>https://gbk.cx/p/980312b6/</id>
    <published>2024-10-19T13:55:06.000Z</published>
    <updated>2024-10-19T14:19:55.209Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-å¤šæ€"><a href="#1-å¤šæ€" class="headerlink" title="1 å¤šæ€"></a>1 <strong>å¤šæ€</strong></h1><p>å¤šæ€ï¼šå¤šç§å½¢æ€ã€‚</p><p>å¤šæ€åˆ†ä¸ºä¸¤ç§ï¼šæ–¹æ³•é‡å†™å’Œæ–¹æ³•é‡è½½</p><h2 id="1-1-æ–¹æ³•é‡å†™"><a href="#1-1-æ–¹æ³•é‡å†™" class="headerlink" title="1.1 æ–¹æ³•é‡å†™"></a><strong>1.1 æ–¹æ³•é‡å†™</strong></h2><p>å­ç±»é‡å†™äº†çˆ¶ç±»çš„åŒåçš„æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//çˆ¶ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;è¿™æ˜¯çˆ¶ç±»&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å­ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å­ç±»é‡å†™äº†çˆ¶ç±»çš„åŒåæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;è¿™æ˜¯å­ç±»&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">show</span>();           <span class="comment">//è¿™æ˜¯å­ç±»</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹ï¼š</p><ol><li>å­ç±»çš„æ–¹æ³•å¿…é¡»å’Œçˆ¶ç±»çš„æ–¹æ³•åŒå</li><li>å‚æ•°ä¸ªæ•°è¦ä¸€è‡´</li><li>å­ç±»ä¿®é¥°çš„ä¸èƒ½æ¯”çˆ¶ç±»æ›´åŠ ä¸¥æ ¼</li></ol><h2 id="1-2-æ–¹æ³•é‡è½½"><a href="#1-2-æ–¹æ³•é‡è½½" class="headerlink" title="1.2 æ–¹æ³•é‡è½½"></a><strong>1.2 æ–¹æ³•é‡è½½</strong></h2><p>åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œæœ‰å¤šä¸ªåŒåçš„å‡½æ•°ï¼Œé€šè¿‡å‚æ•°çš„ä¸åŒæ¥åŒºåˆ†ä¸åŒçš„æ–¹æ³•ï¼Œç§°ä¸ºæ–¹æ³•é‡è½½</p><p>ğŸ’¡ æ³¨æ„ï¼šPHPä¸æ”¯æŒæ–¹æ³•é‡è½½ï¼Œä½†æ˜¯PHPå¯ä»¥é€šè¿‡å…¶ä»–æ–¹æ³•æ¥æ¨¡æ‹Ÿæ–¹æ³•é‡è½½ã€‚</p><h1 id="2é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§"><a href="#2é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§" class="headerlink" title="2é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§"></a>2<strong>é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§</strong></h1><ol><li>å°è£…</li><li>ç»§æ‰¿</li><li>å¤šæ€</li></ol><h1 id="3-ç§æœ‰å±æ€§ç»§æ‰¿å’Œé‡å†™"><a href="#3-ç§æœ‰å±æ€§ç»§æ‰¿å’Œé‡å†™" class="headerlink" title="3 ç§æœ‰å±æ€§ç»§æ‰¿å’Œé‡å†™"></a>3 <strong>ç§æœ‰å±æ€§ç»§æ‰¿å’Œé‡å†™</strong></h1><p>ç§æœ‰å±æ€§å¯ä»¥ç»§æ‰¿ä½†ä¸èƒ½é‡å†™ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>=<span class="string">&#x27;PHP&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showA</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//var_dump($this);  //object(B)#1 (2) &#123; [&quot;name&quot;:&quot;B&quot;:private]=&gt; string(4) &quot;Java&quot; [&quot;name&quot;:&quot;A&quot;:private]=&gt; string(3) &quot;PHP&quot; &#125;</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;    <span class="comment">//PHP</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>=<span class="string">&#x27;Java&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showB</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//var_dump($this);  //object(B)#1 (2) &#123; [&quot;name&quot;:&quot;B&quot;:private]=&gt; string(4) &quot;Java&quot; [&quot;name&quot;:&quot;A&quot;:private]=&gt; string(3) &quot;PHP&quot; &#125;</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;    <span class="comment">//Java</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$obj</span>=<span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$obj</span>-&gt;<span class="title function_ invoke__">showA</span>();</span><br><span class="line"><span class="variable">$obj</span>-&gt;<span class="title function_ invoke__">showB</span>();</span><br><span class="line"><span class="comment">/*åˆ†æï¼š</span></span><br><span class="line"><span class="comment">showA()å’ŒshowB()ä¸­çš„$thiséƒ½è¡¨ç¤ºBçš„å¯¹è±¡ï¼ŒBä¸­ç»§æ‰¿äº†Açš„ç§æœ‰å±æ€§ï¼Œæ‰€ä»¥Bä¸­æœ‰ä¸¤ä¸ª$name.</span></span><br><span class="line"><span class="comment">åœ¨showA()ä¸­åªèƒ½è®¿é—®Aä¸­çš„$nameï¼Œä¸èƒ½è®¿é—®Bä¸­çš„$name</span></span><br><span class="line"><span class="comment">åœ¨showB()ä¸­åªèƒ½è®¿é—®Bä¸­çš„$name,ä¸èƒ½è®¿é—®Aä¸­çš„$name</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h1 id="4-æ–¹æ³•ä¿®é¥°ç¬¦"><a href="#4-æ–¹æ³•ä¿®é¥°ç¬¦" class="headerlink" title="4 æ–¹æ³•ä¿®é¥°ç¬¦"></a>4 <strong>æ–¹æ³•ä¿®é¥°ç¬¦</strong></h1><p>æ–¹æ³•ä¿®é¥°ç¬¦æœ‰ï¼šstaticã€finalã€abstract</p><h2 id="4-1-staticã€é™æ€çš„ã€‘"><a href="#4-1-staticã€é™æ€çš„ã€‘" class="headerlink" title="4.1 staticã€é™æ€çš„ã€‘"></a>4.1 <strong>staticã€é™æ€çš„ã€‘</strong></h2><ol><li>staticä¿®é¥°çš„å±æ€§å«é™æ€å±æ€§ã€staticä¿®é¥°çš„æ–¹æ³•å«é™æ€æ–¹æ³•</li><li>é™æ€æˆå‘˜åŠ è½½ç±»çš„æ—¶å€™åˆ†é…ç©ºé—´ï¼Œç¨‹åºæ‰§è¡Œå®Œæ¯•åé”€æ¯</li><li>é™æ€æˆå‘˜åœ¨å†…å­˜ä¸­å°±ä¸€ä»½ã€‚</li><li>è°ƒç”¨è¯­æ³• ç±»å::å±æ€§ ç±»å::æ–¹æ³•å()</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$add</span>=<span class="string">&#x27;åŒ—äº¬&#x27;</span>; Â  Â <span class="comment">// ä¿®é¥°ç¬¦ä¹‹é—´æ²¡æœ‰é¡ºåº</span></span><br><span class="line">    <span class="built_in">static</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;è¿™æ˜¯ä¸€ä¸ªé™æ€çš„æ–¹æ³•&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title class_">Person</span>::<span class="variable">$add</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;       <span class="comment">//åŒ—äº¬</span></span><br><span class="line"><span class="title class_">Person</span>::<span class="title function_ invoke__">show</span>();                 <span class="comment">//è¿™æ˜¯ä¸€ä¸ªé™æ€çš„æ–¹æ³•</span></span><br></pre></td></tr></table></figure><p>ğŸ’¡ <strong>æ³¨æ„ï¼š</strong>selfè¡¨ç¤ºæ‰€åœ¨ç±»çš„ç±»åï¼Œä½¿ç”¨selfé™ä½è€¦åˆæ€§</p><p>é™æ€æˆå‘˜ä¹Ÿå¯ä»¥è¢«ç»§æ‰¿</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$add</span>=<span class="string">&#x27;ä¸­å›½&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;è¿™æ˜¯äººç±»&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title class_">Student</span>::<span class="variable">$add</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;      <span class="comment">//ä¸­å›½ Â  é€šè¿‡å­ç±»åç§°è®¿é—®çˆ¶ç±»çš„é™æ€æˆå‘˜</span></span><br><span class="line"><span class="title class_">Student</span>::<span class="title function_ invoke__">show</span>();                <span class="comment">//è¿™æ˜¯äººç±»</span></span><br></pre></td></tr></table></figure><p>é™æ€å»¶æ—¶ç»‘å®š</p><p>staticè¡¨ç¤ºå½“å‰å¯¹è±¡æ‰€å±çš„ç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$type</span>=<span class="string">&#x27;äººç±»&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//var_dump($this);      //object(Student)#1 (0) &#123; &#125;</span></span><br><span class="line">        <span class="comment">//echo self::$type,&#x27;&lt;br&gt;&#x27;;  //äººç±»</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="built_in">static</span>::<span class="variable">$type</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;          <span class="comment">//å­¦ç”Ÿ Â  å»¶æ—¶ç»‘å®š</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$type</span>=<span class="string">&#x27;å­¦ç”Ÿ&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//var_dump($this);      //object(Student)#1 (0) &#123; &#125;</span></span><br><span class="line">        <span class="comment">//echo self::$type,&#x27;&lt;br&gt;&#x27;;  //å­¦ç”Ÿ</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="built_in">static</span>::<span class="variable">$type</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;          <span class="comment">//å­¦ç”Ÿ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æµ‹è¯•</span></span><br><span class="line"><span class="variable">$obj</span>=<span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line"><span class="variable">$obj</span>-&gt;<span class="title function_ invoke__">show1</span>();</span><br><span class="line"><span class="variable">$obj</span>-&gt;<span class="title function_ invoke__">show2</span>();</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€staticåœ¨å†…å­˜ä¸­å°±ä¸€ä»½ï¼Œåœ¨ç±»åŠ è½½çš„æ—¶å€™åˆ†é…ç©ºé—´</p><p>2ã€å¦‚æœæœ‰å¤šä¸ªä¿®é¥°ç¬¦ï¼Œä¿®é¥°ç¬¦ä¹‹é—´æ˜¯æ²¡æœ‰é¡ºåºçš„</p><p>3ã€selfè¡¨ç¤ºæ‰€åœ¨ç±»çš„ç±»å</p><p>4ã€staticè¡¨ç¤ºå½“å‰å¯¹è±¡æ‰€å±çš„ç±»</p><p>5ã€staticæœ‰ä¸¤ä¸ªä½œç”¨ï¼Œç¬¬ä¸€è¡¨ç¤ºé™æ€çš„ï¼Œç¬¬äºŒè¡¨ç¤ºç±»å</p><h2 id="4-2-finalã€æœ€ç»ˆçš„ã€‘"><a href="#4-2-finalã€æœ€ç»ˆçš„ã€‘" class="headerlink" title="4.2 finalã€æœ€ç»ˆçš„ã€‘"></a>4.2 finalã€æœ€ç»ˆçš„ã€‘</h2><p>finalä¿®é¥°çš„æ–¹æ³•ä¸èƒ½è¢«é‡å†™</p><p>finalä¿®é¥°çš„ç±»ä¸èƒ½è¢«ç»§æ‰¿</p><h3 id="4-2-1-ä½œç”¨"><a href="#4-2-1-ä½œç”¨" class="headerlink" title="4.2.1 ä½œç”¨"></a>4.2.1 ä½œç”¨</h3><p>1ã€å¦‚æœä¸€ä¸ªç±»ç¡®å®šä¸è¢«ç»§æ‰¿ï¼Œä¸€ä¸ªæ–¹æ³•ç¡®å®šä¸ä¼šè¢«é‡å†™ï¼Œç”¨finalä¿®é¥°å¯ä»¥æé«˜æ‰§è¡Œæ•ˆç‡ã€‚</p><p>2ã€å¦‚æœä¸€ä¸ªæ–¹æ³•ä¸å…è®¸è¢«å…¶ä»–ç±»é‡å†™ï¼Œå¯ä»¥ç”¨finalä¿®é¥°ã€‚</p><h2 id="4-3-abstractã€æŠ½è±¡çš„ã€‘"><a href="#4-3-abstractã€æŠ½è±¡çš„ã€‘" class="headerlink" title="4.3 abstractã€æŠ½è±¡çš„ã€‘"></a>4.3 abstractã€æŠ½è±¡çš„ã€‘</h2><ol><li>abstractä¿®é¥°çš„æ–¹æ³•æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œä¿®é¥°çš„ç±»æ˜¯æŠ½è±¡ç±»</li><li>åªæœ‰æ–¹æ³•çš„å£°æ˜æ²¡æœ‰æ–¹æ³•çš„å®ç°ç§°ä¸ºæŠ½è±¡æ–¹æ³•</li><li>ä¸€ä¸ªç±»ä¸­åªè¦æœ‰ä¸€ä¸ªæ–¹æ³•æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œè¿™ä¸ªç±»å¿…é¡»æ˜¯æŠ½è±¡ç±»ã€‚</li><li>æŠ½è±¡ç±»çš„ç‰¹ç‚¹æ˜¯ä¸èƒ½è¢«å®ä¾‹åŒ–</li><li>å­ç±»ç»§æ‰¿äº†æŠ½è±¡ç±»ï¼Œå°±å¿…é¡»é‡æ–°å®ç°çˆ¶ç±»çš„æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•ï¼Œå¦åˆ™ä¸å…è®¸å®ä¾‹åŒ–</li><li>ç±»ä¸­æ²¡æœ‰æŠ½è±¡æ–¹æ³•ä¹Ÿå¯ä»¥å£°æ˜æˆæŠ½è±¡ç±»ï¼Œç”¨æ¥é˜»æ­¢ç±»çš„å®ä¾‹åŒ–</li></ol><h3 id="4-3-1-æŠ½è±¡ç±»çš„ä½œç”¨"><a href="#4-3-1-æŠ½è±¡ç±»çš„ä½œç”¨" class="headerlink" title="4.3.1 æŠ½è±¡ç±»çš„ä½œç”¨"></a>4.3.1 æŠ½è±¡ç±»çš„ä½œç”¨</h3><p>1ã€å®šä¹‰å‘½åè§„èŒƒ</p><p>2ã€é˜»æ­¢å®ä¾‹åŒ–ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œè¿™æ—¶å€™æ²¡æœ‰å¿…è¦å»å®ä¾‹åŒ–ï¼Œå¯ä»¥é€šè¿‡abstractæ¥é˜»æ­¢æ¥çš„å®ä¾‹åŒ–ã€‚</p><h1 id="5-ç±»å¸¸é‡"><a href="#5-ç±»å¸¸é‡" class="headerlink" title="5 ç±»å¸¸é‡"></a>5 <strong>ç±»å¸¸é‡</strong></h1><p>ç±»å¸¸é‡æ˜¯constå¸¸é‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="comment">//public const ADDï¼›     //7.1ä»¥åæ‰æ”¯æŒè®¿é—®ä¿®é¥°ç¬¦</span></span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">ADD</span>=<span class="string">&#x27;åœ°å€ä¸è¯¦&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title class_">Student</span>::<span class="variable constant_">ADD</span>;</span><br></pre></td></tr></table></figure><p>é—®é¢˜ï¼šdefineå¸¸é‡å’Œconstå¸¸é‡çš„åŒºåˆ«ï¼Ÿ</p><p>ç­”ï¼šconstå¸¸é‡å¯ä»¥åšç±»æˆå‘˜ï¼Œdefineå¸¸é‡ä¸å¯ä»¥åšç±»æˆå‘˜ã€‚</p><p>é—®é¢˜ï¼šå¸¸é‡å’Œé™æ€çš„å±æ€§çš„åŒºåˆ«ï¼Ÿ</p><p>ç­”ï¼šç›¸åŒç‚¹ï¼šéƒ½åœ¨åŠ è½½ç±»çš„æ—¶å€™åˆ†é…ç©ºé—´</p><p>ä¸åŒç‚¹ï¼šå¸¸é‡çš„å€¼ä¸å¯ä»¥æ›´æ”¹ï¼Œé™æ€å±æ€§çš„å€¼å¯ä»¥æ›´æ”¹</p><h1 id="6-æ¥å£ï¼ˆinterfaceï¼‰"><a href="#6-æ¥å£ï¼ˆinterfaceï¼‰" class="headerlink" title="6 æ¥å£ï¼ˆinterfaceï¼‰"></a>6 <strong>æ¥å£ï¼ˆinterfaceï¼‰</strong></h1><h2 id="6-1-æ¥å£"><a href="#6-1-æ¥å£" class="headerlink" title="6.1 æ¥å£"></a>6.1 æ¥å£</h2><ol><li>å¦‚æœä¸€ä¸ªç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•æ˜¯éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæŠ½è±¡ç±»å¯ä»¥å£°æ˜æˆæ¥å£</li><li>æ¥å£æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æŠ½è±¡ç±»ï¼Œæ¥å£ä¸­åªèƒ½æœ‰æŠ½è±¡æ–¹æ³•å’Œå¸¸é‡</li><li>æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•åªèƒ½æ˜¯publicï¼Œå¯ä»¥çœç•¥ï¼Œé»˜è®¤ä¹Ÿæ˜¯publicçš„</li><li>é€šè¿‡implementså…³é”®å­—æ¥å®ç°æ¥å£</li><li>ä¸èƒ½ä½¿ç”¨abstractå’Œfinalæ¥ä¿®é¥°æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•ã€‚</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å£°æ˜æ¥å£</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IPerson</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">ADD</span>=<span class="string">&#x27;ä¸­å›½&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params"></span>)</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ¥å£å®ç°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">IPerson</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è®¿é—®æ¥å£ä¸­çš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title class_">IPerson</span>::<span class="variable constant_">ADD</span>;</span><br></pre></td></tr></table></figure><h2 id="6-2-æ¥å£çš„å¤šé‡å®ç°"><a href="#6-2-æ¥å£çš„å¤šé‡å®ç°" class="headerlink" title="6.2 æ¥å£çš„å¤šé‡å®ç°"></a>6.<strong>2 æ¥å£çš„å¤šé‡å®ç°</strong></h2><p>ç±»ä¸å…è®¸å¤šé‡ç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å…è®¸å¤šé‡å®ç°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IPic1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IPic2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ¥å£å…è®¸å¤šé‡å®ç°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">IPic1</span>,<span class="title">IPic2</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š</p><p>1ã€åœ¨æ¥å£çš„å¤šé‡å®ç°ä¸­ï¼Œå¦‚æœæœ‰åŒåçš„æ–¹æ³•ï¼Œåªè¦å®ç°ä¸€æ¬¡å³å¯</p><p>2ã€ç±»å¯ä»¥ç»§æ‰¿çš„åŒæ—¶å®ç°æ¥å£</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">IPIc1</span>,<span class="title">IPic1</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="7-åŒ¿åç±»"><a href="#7-åŒ¿åç±»" class="headerlink" title="7 åŒ¿åç±»"></a>7 <strong>åŒ¿åç±»</strong></h1><p>è¿™æ˜¯äº†è§£çš„å†…å®¹ï¼ŒPHP7.0æ”¯æŒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="class"><span class="keyword">class</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;tom&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;æ„é€ å‡½æ•°&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$stu</span>-&gt;name;</span><br><span class="line"><span class="comment">/*è¿è¡Œç»“æœï¼›</span></span><br><span class="line"><span class="comment">æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">tom</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€å¦‚æœç±»åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡å°±å¯ä»¥ä½¿ç”¨åŒ¿åç±»</p><p>2ã€å¥½å¤„ï¼Œåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œç±»ä¸å ç”¨ç©ºé—´</p><h1 id="8-æ–¹æ³•ç»‘å®š"><a href="#8-æ–¹æ³•ç»‘å®š" class="headerlink" title="8 æ–¹æ³•ç»‘å®š"></a>8 <strong>æ–¹æ³•ç»‘å®š</strong></h1><p>è¿™æ˜¯äº†è§£çš„å†…å®¹ï¼ŒPHP7.0æ”¯æŒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="class"><span class="keyword">class</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;tom&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;æ„é€ å‡½æ•°&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$stu</span>-&gt;name;</span><br><span class="line"><span class="comment">/*è¿è¡Œç»“æœï¼›</span></span><br><span class="line"><span class="comment">æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="comment">tom</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€å¦‚æœç±»åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡å°±å¯ä»¥ä½¿ç”¨åŒ¿åç±»</p><p>2ã€å¥½å¤„ï¼Œåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œç±»ä¸å ç”¨ç©ºé—´</p><h1 id="9-å¼‚å¸¸å¤„ç†"><a href="#9-å¼‚å¸¸å¤„ç†" class="headerlink" title="9 å¼‚å¸¸å¤„ç†"></a>9 <strong>å¼‚å¸¸å¤„ç†</strong></h1><p>é›†ä¸­å¤„ç†åœ¨ä»£ç å—ä¸­å‘ç”Ÿçš„å¼‚å¸¸ã€‚</p><p>åœ¨ä»£ç å—ä¸­å‘ç”Ÿäº†å¼‚å¸¸ç›´æ¥æŠ›å‡ºï¼Œä»£ç å—ä¸­ä¸å¤„ç†å¼‚å¸¸ï¼Œå°†å¼‚å¸¸é›†ä¸­èµ·æ¥ä¸€èµ·å¤„ç†ã€‚</p><h2 id="9-1-ä½¿ç”¨çš„å…³é”®å­—"><a href="#9-1-ä½¿ç”¨çš„å…³é”®å­—" class="headerlink" title="9.1 ä½¿ç”¨çš„å…³é”®å­—"></a>9.1 ä½¿ç”¨çš„å…³é”®å­—</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:ç›‘æµ‹ä»£ç å—</span><br><span class="line"><span class="keyword">catch</span>:æ•è·å¼‚å¸¸</span><br><span class="line"><span class="keyword">throw</span>:æŠ›å‡ºå¼‚å¸¸</span><br><span class="line"><span class="keyword">finally</span>:æ— è®ºæœ‰æ— å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œï¼Œå¯ä»¥çœç•¥</span><br><span class="line"><span class="built_in">Exception</span>ï¼šå¼‚å¸¸ç±»</span><br></pre></td></tr></table></figure><p>è¯­æ³•ç»“æ„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"><span class="comment">//æ£€æµ‹ä»£ç </span></span><br><span class="line">&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$ex</span>)&#123;</span><br><span class="line"><span class="comment">//æ•è·å¼‚å¸¸</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="comment">//ä¸è®ºæ˜¯å¦æœ‰å¼‚å¸¸ï¼Œéƒ½è¦æ‰§è¡Œï¼Œfinallyå¯ä»¥çœç•¥</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h2 id="9-2-è‡ªå®šä¹‰å¼‚å¸¸"><a href="#9-2-è‡ªå®šä¹‰å¼‚å¸¸" class="headerlink" title="9.2 è‡ªå®šä¹‰å¼‚å¸¸"></a>9.2 è‡ªå®šä¹‰å¼‚å¸¸</h2><p>åœºæ™¯ï¼šå¦‚æœå®ç°å¼‚å¸¸çš„åˆ†ç±»å¤„ç†ï¼Ÿæ¯”å¦‚å¼‚å¸¸æœ‰ä¸‰ä¸ªçº§åˆ«å¼‚å¸¸å¯¹åº”ä¸‰ç§å¤„ç†æ–¹å¼</p><p>è‡ªå®šä¹‰ä¸‰ç§å¼‚å¸¸å³å¯</p><p>æ‰€æœ‰å¼‚å¸¸ç±»çš„çˆ¶ç±»æ˜¯Exceptionï¼ŒExceptionä¸­çš„æ–¹æ³•ä¸å…è®¸é‡å†™</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-å¤šæ€&quot;&gt;&lt;a href=&quot;#1-å¤šæ€&quot; class=&quot;headerlink&quot; title=&quot;1 å¤šæ€&quot;&gt;&lt;/a&gt;1 &lt;strong&gt;å¤šæ€&lt;/strong&gt;&lt;/h1&gt;&lt;p&gt;å¤šæ€ï¼šå¤šç§å½¢æ€ã€‚&lt;/p&gt;
&lt;p&gt;å¤šæ€åˆ†ä¸ºä¸¤ç§ï¼šæ–¹æ³•é‡å†™å’Œæ–¹æ³•é‡è½½&lt;/p&gt;
&lt;h2 id=&quot;</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>PHPé¢å‘å¯¹è±¡-1-ç±»&amp;å¯¹è±¡&amp;å±æ€§&amp;è®¿é—®ä¿®é¥°ç¬¦</title>
    <link href="https://gbk.cx/p/b78a5232/"/>
    <id>https://gbk.cx/p/b78a5232/</id>
    <published>2024-10-19T13:52:34.000Z</published>
    <updated>2024-10-19T14:19:17.390Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-é¢å‘å¯¹è±¡ä»‹ç»"><a href="#1-é¢å‘å¯¹è±¡ä»‹ç»" class="headerlink" title="1 é¢å‘å¯¹è±¡ä»‹ç»"></a>1 <strong>é¢å‘å¯¹è±¡ä»‹ç»</strong></h1><h2 id="1-1-ä»‹ç»"><a href="#1-1-ä»‹ç»" class="headerlink" title="1.1 ä»‹ç»"></a><strong>1.1 ä»‹ç»</strong></h2><p>é¢å‘å¯¹è±¡æ˜¯ä¸€ä¸ªç¼–ç¨‹æ€æƒ³ã€‚ç¼–ç¨‹æ€æƒ³æœ‰é¢å‘è¿‡ç¨‹å’Œé¢å‘å¯¹è±¡</p><p>é¢å‘è¿‡ç¨‹ï¼šç¼–ç¨‹æ€è·¯é›†ä¸­çš„æ˜¯è¿‡ç¨‹ä¸Š</p><p>é¢å‘å¯¹è±¡ï¼šç¼–ç¨‹æ€è·¯é›†ä¸­åœ¨å‚ä¸çš„å¯¹è±¡</p><p>ä»¥å»é¥­é¦†åƒé¥­ä¸ºä¾‹ï¼š</p><p>é¢å‘è¿‡ç¨‹ï¼šç‚¹èœâ€”â€”åšèœâ€”â€”ä¸Šèœâ€”â€”åƒé¥­â€”â€”ç»“è´¦â€”â€”æ”¶æ‹¾</p><p>é¢å‘å¯¹è±¡ï¼šæœåŠ¡å‘˜ï¼Œå¨å¸ˆï¼Œå®¢äºº</p><h2 id="1-2-é¢å‘å¯¹è±¡çš„å¥½å¤„"><a href="#1-2-é¢å‘å¯¹è±¡çš„å¥½å¤„" class="headerlink" title="1.2 é¢å‘å¯¹è±¡çš„å¥½å¤„"></a><strong>1.2 é¢å‘å¯¹è±¡çš„å¥½å¤„</strong></h2><ol><li>å¤šäººåˆä½œæ–¹ä¾¿</li><li>å‡å°‘ä»£ç å†—ä½™ï¼Œçµæ´»æ€§é«˜</li><li>ä»£ç çš„å¯é‡ç”¨æ€§å‘æŒ¥åˆ°æè‡´</li><li>å¯æ‰©å±•æ€§å¼º</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¤šå­¦ä¸€æ‹›ï¼š</span><br><span class="line">OOPï¼šé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject Oriented Programmingï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰</span><br><span class="line">OOA: é¢å‘å¯¹è±¡åˆ†æ(Object-Oriented Analysis,OOA)</span><br><span class="line">OOD: é¢å‘å¯¹è±¡è®¾è®¡ï¼ˆObject-Oriented Designï¼ŒOODï¼‰</span><br></pre></td></tr></table></figure><h1 id="2-ç±»å’Œå¯¹è±¡"><a href="#2-ç±»å’Œå¯¹è±¡" class="headerlink" title="2 ç±»å’Œå¯¹è±¡"></a>2 ç±»å’Œå¯¹è±¡</h1><p>1ã€å¯¹è±¡æ˜¯å…·ä½“å­˜åœ¨çš„äº‹ç‰©ï¼Œå¯¹è±¡æ˜¯ç”±å±æ€§ï¼ˆå˜é‡ï¼‰å’Œæ–¹æ³•ï¼ˆå‡½æ•°ï¼‰ç»„æˆçš„</p><p>2ã€ç±»æ˜¯å…·æœ‰ç›¸åŒå±æ€§å’Œè¡Œä¸ºçš„ä¸€ç»„å¯¹è±¡çš„é›†åˆ</p><p>åˆ†æï¼šåšèœåŠ¨ä½œâ€”â€”å¨å¸ˆå¯¹è±¡â€”â€”å¨å¸ˆç±»<br>ç»“è®ºï¼šæˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™ï¼Œå…ˆå†™ç±»ï¼Œé€šè¿‡ç±»åˆ›å»ºå¯¹è±¡ï¼Œç„¶åè°ƒç”¨å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å®ç°åŠŸèƒ½ã€‚    ç±»â€”â€”å¯¹è±¡â€”â€”è°ƒç”¨æˆå‘˜</p><p>ğŸ’¡ æ³¨æ„ï¼šä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡</p><p><strong>å°ç»“ï¼š</strong></p><p>1ã€å¯¹è±¡æ˜¯ç”±å±æ€§å’Œæ–¹æ³•ç»„æˆçš„</p><p>2ã€ç±»æ˜¯æ‰€æœ‰å¯¹è±¡çš„ç›¸åŒå±æ€§å’Œæ–¹æ³•çš„é›†åˆ</p><p>3ã€åœ¨å¼€å‘çš„æ—¶å€™å…ˆå†™ç±»ï¼Œé€šè¿‡ç±»åˆ›å»ºå¯¹è±¡ï¼Œé€šè¿‡å¯¹è±¡è°ƒç”¨æ–¹æ³•å’Œå±æ€§</p><p>4ã€ä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡</p><h1 id="3-åœ¨PHPä¸­å®ç°ç±»å’Œå¯¹è±¡"><a href="#3-åœ¨PHPä¸­å®ç°ç±»å’Œå¯¹è±¡" class="headerlink" title="3 åœ¨PHPä¸­å®ç°ç±»å’Œå¯¹è±¡"></a>3 <strong>åœ¨PHPä¸­å®ç°ç±»å’Œå¯¹è±¡</strong></h1><h2 id="3-1-åˆ›å»ºç±»"><a href="#3-1-åˆ›å»ºç±»" class="headerlink" title="3.1 åˆ›å»ºç±»"></a>3.1 åˆ›å»ºç±»</h2><p>è¯­æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> ç±»å</span>&#123;</span><br><span class="line">    <span class="comment">//å±æ€§</span></span><br><span class="line">    <span class="comment">//æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//å¸¸é‡</span></span><br><span class="line">&#125;</span><br><span class="line">ç±»æ˜¯ç”±å±æ€§ã€æ–¹æ³•ã€å¸¸é‡ç»„æˆçš„ï¼Œä¹Ÿå¯ä»¥è¯´</span><br><span class="line">ç±»æˆå‘˜æœ‰ï¼šå±æ€§ã€æ–¹æ³•ã€å¸¸é‡</span><br></pre></td></tr></table></figure><p>ç±»åçš„å‘½åè§„åˆ™ï¼š</p><ol><li>ä»¥å­—æ¯ã€ä¸‹åˆ’çº¿å¼€å¤´ï¼Œåé¢è·Ÿçš„æ˜¯å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿</li><li>ä¸èƒ½ç”¨PHPå…³é”®å­—åšç±»å</li><li>ç±»åä¸åŒºåˆ†å¤§å°å†™ï¼ˆå˜é‡ååŒºåˆ†ï¼Œå…³é”®å­—ã€ç±»åä¸åŒºåˆ†å¤§å°å†™ï¼‰</li><li>ç±»åç”¨å¸•æ–¯å¡å‘½åæ³•ï¼ˆå¤§é©¼å³° å•è¯çš„é¦–å­—æ¯å¤§å†™ï¼‰</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-2-å¯¹è±¡å®ä¾‹åŒ–"><a href="#3-2-å¯¹è±¡å®ä¾‹åŒ–" class="headerlink" title="3.2 å¯¹è±¡å®ä¾‹åŒ–"></a>3.2 å¯¹è±¡å®ä¾‹åŒ–</h2><p>é€šè¿‡newå…³é”®å­—æ¥å®ä¾‹åŒ–å¯¹è±¡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å®šä¹‰ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="variable">$stu1</span>=<span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line"><span class="variable">$stu2</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;      <span class="comment">//å°æ‹¬å·å¯ä»¥çœç•¥</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$stu1</span>,<span class="variable">$stu2</span>);  <span class="comment">//object(Student)#1 (0) &#123; &#125; object(Student)#2 (0) &#123; &#125;</span></span><br></pre></td></tr></table></figure><h2 id="3-3-å¯¹è±¡çš„æ¯”è¾ƒ"><a href="#3-3-å¯¹è±¡çš„æ¯”è¾ƒ" class="headerlink" title="3.3 å¯¹è±¡çš„æ¯”è¾ƒ"></a>3.3 å¯¹è±¡çš„æ¯”è¾ƒ</h2><p>ğŸ’¡ <strong>æ³¨æ„ï¼šå¯¹è±¡çš„ä¼ é€’æ˜¯åœ°å€ä¼ é€’</strong></p><p>ç›¸ç­‰ï¼šç»“æ„å’Œä¿å­˜çš„å€¼ä¸€æ ·å°±ç›¸ç­‰<br>å…¨ç­‰ï¼šæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡æ‰æ˜¯å…¨ç­‰ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å®šä¹‰ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="variable">$stu1</span>=<span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line"><span class="variable">$stu2</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu3</span>=<span class="variable">$stu2</span>; <span class="comment">//å¯¹è±¡ä¼ é€’çš„æ˜¯åœ°å€</span></span><br><span class="line"><span class="comment">//var_dump($stu1,$stu2,$stu3); //object(Student)#1 (0) &#123; &#125; object(Student)#2 (0) &#123; &#125; object(Student)#2 (0) &#123; &#125;</span></span><br><span class="line"><span class="comment">//å¯¹è±¡æ¯”è¾ƒ</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$stu1</span>==<span class="variable">$stu2</span>);     <span class="comment">//bool(true) ,æ¯”è¾ƒå¯¹è±¡çš„ç»“æ„</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$stu1</span>===<span class="variable">$stu2</span>);    <span class="comment">//bool(false) $stu1å’Œ$stu2æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$stu2</span>===<span class="variable">$stu3</span>);    <span class="comment">//bool(true) $stu2å’Œ$stu3æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br></pre></td></tr></table></figure><h1 id="4-å±æ€§"><a href="#4-å±æ€§" class="headerlink" title="4 å±æ€§"></a>4 <strong>å±æ€§</strong></h1><p>å±æ€§æœ¬è´¨å°±æ˜¯å˜é‡</p><p>é€šè¿‡<code>-&gt;</code>è°ƒç”¨å¯¹è±¡çš„æˆå‘˜   å¯¹è±¡å-&gt;å±æ€§å  å¯¹è±¡å-&gt;æ–¹æ³•å()</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å®šä¹‰ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;               <span class="comment">//å±æ€§</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$add</span>=<span class="string">&#x27;åœ°å€ä¸è¯¦&#x27;</span>;     <span class="comment">//å±æ€§</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line"><span class="comment">//print_r($stu);    //Student Object ( [name] =&gt; [add] =&gt; åœ°å€ä¸è¯¦ )</span></span><br><span class="line"><span class="comment">//æ“ä½œå±æ€§</span></span><br><span class="line"><span class="comment">//1ã€ç»™å±æ€§èµ‹å€¼</span></span><br><span class="line"><span class="variable">$stu</span>-&gt;name=<span class="string">&#x27;tom&#x27;</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;add=<span class="string">&#x27;åŒ—äº¬&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2ã€è·å–å±æ€§çš„å€¼</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;å§“åï¼š&#x27;</span>.<span class="variable">$stu</span>-&gt;name,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;   <span class="comment">//å§“åï¼štom</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;åœ°å€ï¼š&#x27;</span>.<span class="variable">$stu</span>-&gt;add,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;        <span class="comment">//åœ°å€ï¼šåŒ—äº¬</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3ã€æ·»åŠ å±æ€§</span></span><br><span class="line"><span class="variable">$stu</span>-&gt;age=<span class="number">20</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$stu</span>);  <span class="comment">//Student Object ( [name] =&gt; tom [add] =&gt; åŒ—äº¬ [age] =&gt; 20 )</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">//4ã€åˆ é™¤å±æ€§</span></span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$stu</span>-&gt;add);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$stu</span>);  <span class="comment">//Student Object ( [name] =&gt; tom [age] =&gt; 20 )</span></span><br></pre></td></tr></table></figure><h1 id="5-æ–¹æ³•"><a href="#5-æ–¹æ³•" class="headerlink" title="5 æ–¹æ³•"></a>5 <strong>æ–¹æ³•</strong></h1><p>æ–¹æ³•çš„æœ¬è´¨å°±æ˜¯å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;è¿™æ˜¯showæ–¹æ³•&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//publicå¯ä»¥çœç•¥ï¼Œå¦‚æœçœç•¥ï¼Œé»˜è®¤å°±æ˜¯public</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;è¿™æ˜¯testæ–¹æ³•&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">new</span> <span class="title class_">Student</span>;</span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">show</span>();   <span class="comment">//è°ƒç”¨æ–¹æ³•</span></span><br><span class="line"><span class="variable">$stu</span>-&gt;<span class="title function_ invoke__">test</span>();</span><br></pre></td></tr></table></figure><p>å¤šå­¦ä¸€æ‹›ï¼š</p><p>1ã€æ–¹æ³•å‰é¢publicæ˜¯å¯ä»¥çœç•¥çš„ï¼Œå¦‚æœçœç•¥ï¼Œé»˜è®¤å°±æ˜¯publicçš„ã€‚</p><p>2ã€å±æ€§å‰é¢çš„publicä¸èƒ½çœç•¥</p><h1 id="6-è®¿é—®ä¿®é¥°ç¬¦"><a href="#6-è®¿é—®ä¿®é¥°ç¬¦" class="headerlink" title="6 è®¿é—®ä¿®é¥°ç¬¦"></a>6 è®¿é—®ä¿®é¥°ç¬¦</h1><p>ç”¨æ¥æ§åˆ¶æˆå‘˜çš„è®¿é—®æƒé™</p><table><thead><tr><th><strong>ä¿®é¥°ç¬¦</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>publicï¼ˆå…¬æœ‰çš„ï¼‰</td><td>åœ¨ç±»çš„å†…éƒ¨å’Œå¤–éƒ¨éƒ½èƒ½è®¿é—®</td></tr><tr><td>privateï¼ˆç§æœ‰çš„ï¼‰</td><td>åªèƒ½åœ¨ç±»çš„å†…éƒ¨è®¿é—®</td></tr><tr><td>protectedï¼ˆå—ä¿æŠ¤çš„ï¼‰</td><td>åœ¨æ•´ä¸ªç»§æ‰¿é“¾ä¸Šè®¿é—®</td></tr></tbody></table><p><strong>å¤šå­¦ä¸€æ‹›ï¼š</strong>ä¸€èˆ¬æ¥è¯´ï¼Œå±æ€§éƒ½ç”¨ç§æœ‰çš„ï¼Œé€šè¿‡å…¬æœ‰çš„æ–¹æ³•å¯¹ç§æœ‰çš„å±æ€§è¿›è¡Œèµ‹å€¼å’Œå–å€¼ã€‚</p><p>ä½œç”¨ï¼šä¿è¯æ•°æ®çš„åˆæ³•æ€§</p><p>ğŸ’¡ æç¤ºï¼š$thisè¡¨ç¤ºè°ƒç”¨å½“å‰æ–¹æ³•çš„å¯¹è±¡</p><h1 id="7-ç±»å’Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒ"><a href="#7-ç±»å’Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒ" class="headerlink" title="7 ç±»å’Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒ"></a>7 <strong>ç±»å’Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åˆ†å¸ƒ</strong></h1><ol><li>å¯¹è±¡çš„æœ¬è´¨æ˜¯ä¸€ä¸ªå¤æ‚çš„å˜é‡</li><li>ç±»çš„æœ¬è´¨æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„å¤æ‚æ•°æ®ç±»å‹</li><li>æ ˆåŒºï¼šè¿è¡Œé€Ÿåº¦å¿«ï¼Œä½“ç§¯å°ï¼Œä¿å­˜åŸºæœ¬ç±»å‹</li><li>å †åŒºï¼šè¿è¡Œé€Ÿåº¦ç¨æ…¢ï¼Œä½“ç§¯å¤§ï¼Œä¿å­˜å¤æ‚ç±»å‹</li><li>å®ä¾‹åŒ–çš„è¿‡ç¨‹å°±æ˜¯åˆ†é…å†…å­˜ç©ºé—´çš„è¿‡ç¨‹</li><li>å¯¹è±¡ä¿å­˜åœ¨å †åŒºï¼Œå°†å †åŒºçš„åœ°å€ä¿å­˜åˆ°æ ˆåŒº</li></ol><h1 id="8-å°è£…"><a href="#8-å°è£…" class="headerlink" title="8 å°è£…"></a>8 <strong>å°è£…</strong></h1><p>å°è£…å°±æ˜¯æœ‰é€‰æ‹©æ€§çš„æä¾›æ•°æ®</p><p>é€šè¿‡è®¿é—®ä¿®é¥°ç¬¦æ¥å®ç°å°è£…</p><h1 id="9-æ„é€ æ–¹æ³•"><a href="#9-æ„é€ æ–¹æ³•" class="headerlink" title="9 æ„é€ æ–¹æ³•"></a>9 <strong>æ„é€ æ–¹æ³•</strong></h1><h2 id="9-1-ä»‹ç»"><a href="#9-1-ä»‹ç»" class="headerlink" title="9.1 ä»‹ç»"></a>9.1 <strong>ä»‹ç»</strong></h2><p>æ„é€ æ–¹æ³•ä¹Ÿå«æ„é€ å‡½æ•°ï¼Œå½“å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œã€‚<br>è¯­æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">æ³¨æ„ï¼šå‰é¢æ˜¯ä¸¤ä¸ªä¸‹åˆ’çº¿</span><br></pre></td></tr></table></figure><p>ğŸ’¡ æ³¨æ„ï¼šåœ¨å…¶ä»–è¯­è¨€é‡Œï¼Œä¸ç±»ååŒåçš„å‡½æ•°æ˜¯æ„é€ å‡½æ•°ï¼Œåœ¨PHPä¸­ä¸å…è®¸è¿™ç§å†™æ³•ã€‚</p><h1 id="10-ææ„æ–¹æ³•"><a href="#10-ææ„æ–¹æ³•" class="headerlink" title="10 ææ„æ–¹æ³•"></a>10 <strong>ææ„æ–¹æ³•</strong></h1><h2 id="10-1-ä»‹ç»"><a href="#10-1-ä»‹ç»" class="headerlink" title="10.1 ä»‹ç»"></a><strong>10.1 ä»‹ç»</strong></h2><p>å½“å¯¹è±¡é”€æ¯çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨</p><p>è¯­æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è„šä¸‹ç•™å¿ƒï¼šææ„å‡½æ•°ä¸å¯ä»¥å¸¦å‚æ•°</p><h1 id="11-ç»§æ‰¿"><a href="#11-ç»§æ‰¿" class="headerlink" title="11 ç»§æ‰¿"></a>11 <strong>ç»§æ‰¿</strong></h1><h2 id="11-1-ç»§æ‰¿ä»‹ç»"><a href="#11-1-ç»§æ‰¿ä»‹ç»" class="headerlink" title="11.1 ç»§æ‰¿ä»‹ç»"></a><strong>11.1 ç»§æ‰¿ä»‹ç»</strong></h2><ol><li>ç»§æ‰¿ä½¿å¾—ä»£ç å…·æœ‰å±‚æ¬¡ç»“æ„</li><li>å­ç±»ç»§æ‰¿äº†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå®ç°äº†ä»£ç çš„å¯é‡ç”¨æ€§ã€‚</li><li>ä½¿ç”¨extendså…³é”®å­—å®ç°ç»§æ‰¿</li><li>çˆ¶ç±»å’Œå­ç±»æ˜¯ç›¸å¯¹çš„</li></ol><p>è¯­æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> å­ç±» <span class="keyword">extends</span> çˆ¶ç±»</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="11-2-å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æˆå‘˜"><a href="#11-2-å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æˆå‘˜" class="headerlink" title="11.2 å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æˆå‘˜"></a><strong>11.2 å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æˆå‘˜</strong></h2><p>1ã€æ–¹æ³•ä¸€ï¼šé€šè¿‡å®ä¾‹åŒ–çˆ¶ç±»è°ƒç”¨çˆ¶ç±»çš„æˆå‘˜</p><p>2ã€æ–¹æ³•äºŒï¼šé€šè¿‡$thiså…³é”®å­—è°ƒç”¨çˆ¶ç±»çš„æˆå‘˜</p><h2 id="11-3-protected"><a href="#11-3-protected" class="headerlink" title="11.3 protected"></a>11.3 <strong>protected</strong></h2><p>protectedï¼šå—ä¿æŠ¤çš„ï¼Œåœ¨æ•´ä¸ªç»§æ‰¿é“¾ä¸Šä½¿ç”¨</p><h2 id="11-4-ç»§æ‰¿ä¸­çš„æ„é€ å‡½æ•°"><a href="#11-4-ç»§æ‰¿ä¸­çš„æ„é€ å‡½æ•°" class="headerlink" title="11.4 ç»§æ‰¿ä¸­çš„æ„é€ å‡½æ•°"></a><strong>11.4 ç»§æ‰¿ä¸­çš„æ„é€ å‡½æ•°</strong></h2><p>è§„åˆ™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1ã€å¦‚æœå­ç±»æœ‰æ„é€ å‡½æ•°å°±è°ƒç”¨å­ç±»çš„ï¼Œå¦‚æœå­ç±»æ²¡æœ‰å°±è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚</span><br><span class="line"></span><br><span class="line">2ã€å­ç±»çš„æ„é€ å‡½æ•°è°ƒç”¨åï¼Œé»˜è®¤ä¸å†è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç±»åè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç±»å::<span class="title function_ invoke__">__construct</span>()</span><br></pre></td></tr></table></figure><p>ğŸ’¡ <strong>æ³¨æ„</strong>ï¼šå¯ä»¥ç”¨parentå…³é”®å­—è¡¨ç¤ºçˆ¶ç±»çš„åå­—ï¼Œå¯ä»¥é™ä½ç¨‹åºçš„è€¦åˆæ€§</p><h2 id="11-5-thisè¯¦è§£"><a href="#11-5-thisè¯¦è§£" class="headerlink" title="11.5 $thisè¯¦è§£"></a>11.5 <strong>$thisè¯¦è§£</strong></h2><p><strong>$this</strong>è¡¨ç¤ºå½“å‰å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯æ˜¯æˆ–**$this**ä¿å­˜çš„å½“å‰å¯¹è±¡çš„åœ°å€</p><h2 id="11-6-å¤šé‡ç»§æ‰¿"><a href="#11-6-å¤šé‡ç»§æ‰¿" class="headerlink" title="11.6 å¤šé‡ç»§æ‰¿"></a>11.6 <strong>å¤šé‡ç»§æ‰¿</strong></h2><p>PHPä¸å…è®¸å¤šé‡ç»§æ‰¿ï¼Œå› ä¸ºå¤šé‡ç»§æ‰¿å®¹æ˜“äº§ç”ŸäºŒä¹‰æ€§</p><p>å¦‚ä½•å®ç°Cç»§æ‰¿Aå’ŒBï¼Œä½¿ç”¨ç»§æ‰¿é“¾</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-é¢å‘å¯¹è±¡ä»‹ç»&quot;&gt;&lt;a href=&quot;#1-é¢å‘å¯¹è±¡ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;1 é¢å‘å¯¹è±¡ä»‹ç»&quot;&gt;&lt;/a&gt;1 &lt;strong&gt;é¢å‘å¯¹è±¡ä»‹ç»&lt;/strong&gt;&lt;/h1&gt;&lt;h2 id=&quot;1-1-ä»‹ç»&quot;&gt;&lt;a href=&quot;#1-1-ä»‹ç»</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>PHPåŸºç¡€-3-æ–‡ä»¶æ“ä½œ</title>
    <link href="https://gbk.cx/p/a73ab557/"/>
    <id>https://gbk.cx/p/a73ab557/</id>
    <published>2024-10-19T13:51:34.000Z</published>
    <updated>2024-10-19T14:14:19.473Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-æ–‡ä»¶æ“ä½œ"><a href="#1-æ–‡ä»¶æ“ä½œ" class="headerlink" title="1 æ–‡ä»¶æ“ä½œ"></a>1 <strong>æ–‡ä»¶æ“ä½œ</strong></h1><h2 id="1-1-å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶"><a href="#1-1-å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶" class="headerlink" title="1.1 å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶"></a><strong>1.1</strong> å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$str</span>=<span class="string">&quot;åºŠå‰æ˜æœˆå…‰ï¼Œ\r\nç–‘æ˜¯åœ°ä¸Šéœœã€‚\r\nä¸¾å¤´æœ›æ˜æœˆï¼Œ\r\nä½å¤´æ€æ•…ä¹¡ã€‚&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;./test.txt&#x27;</span>,<span class="variable">$str</span>); Â <span class="comment">//å°†å­—ç¬¦ä¸²å†™åˆ°æ–‡æœ¬ä¸­</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€ æ‰€æœ‰çš„â€œå†™â€æ“ä½œéƒ½æ˜¯æ¸…ç©ºé‡å†™</p><p>2ã€åœ¨æ–‡æœ¬ä¸­æ¢è¡Œæ˜¯\r\n</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\r:å›è½¦ Â  å…‰æ ‡ç§»åŠ¨åˆ°å½“å‰è¡Œçš„æœ€å‰é¢</span><br><span class="line">\n:æ¢è¡Œ   å°†å…‰æ ‡ä¸‹ç§»åŠ¨ä¸€è¡Œ</span><br><span class="line">æŒ‰é”®ç›˜çš„å›è½¦é”®åšäº†ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥å°†å…‰æ ‡ç§»åŠ¨åˆ°å½“å‰è¡Œçš„æœ€å‰é¢ï¼Œç¬¬äºŒæ­¥ä¸‹ç§»ä¸€è¡Œã€‚</span><br></pre></td></tr></table></figure><p>3ã€\r\næ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œå¿…é¡»æ”¾åœ¨åŒå¼•å·å†…</p><h2 id="1-2-å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²"><a href="#1-2-å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²" class="headerlink" title="1.2 å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²"></a>1.<strong>2</strong> å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–¹æ³•ä¸€ï¼š</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./test.txt&#x27;</span>); Â  <span class="comment">//å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">//æ–¹æ³•äºŒï¼š</span></span><br><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="string">&#x27;./test.txt&#x27;</span>); <span class="comment">//è¯»å–è¾“å‡ºæ–‡ä»¶å†…å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨æ„ï¼šecho file_get_contents()==readfile()</span></span><br></pre></td></tr></table></figure><h2 id="1-3-æ‰“å¼€æ–‡ä»¶å¹¶æ“ä½œ"><a href="#1-3-æ‰“å¼€æ–‡ä»¶å¹¶æ“ä½œ" class="headerlink" title="1.3 æ‰“å¼€æ–‡ä»¶å¹¶æ“ä½œ"></a>1.<strong>3</strong> æ‰“å¼€æ–‡ä»¶å¹¶æ“ä½œ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">fopen</span>(åœ°å€,æ¨¡å¼)    æ‰“å¼€æ–‡ä»¶</span><br><span class="line">æ¨¡å¼ï¼š</span><br><span class="line">rï¼šè¯»     read</span><br><span class="line">w:å†™      write</span><br><span class="line">a:è¿½åŠ     append</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.1ã€æ‰“å¼€æ–‡ä»¶å†™å…¥</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">$fp=fopen(&#x27;./test.txt&#x27;,&#x27;w&#x27;);    //æ‰“å¼€æ–‡ä»¶è¿”å›æ–‡ä»¶æŒ‡é’ˆï¼ˆæ–‡ä»¶åœ°å€ï¼‰</span></span><br><span class="line"><span class="comment">//var_dump($fp);//resource(3) of type (stream) </span></span><br><span class="line"><span class="comment">for($i=1;$i&lt;=10;$i++)</span></span><br><span class="line"><span class="comment">fputs($fp,&#x27;å…³å…³é›é¸ &#x27;.&quot;\r\n&quot;);//å†™ä¸€è¡Œ</span></span><br><span class="line"><span class="comment">fclose($fp);//å…³é—­æ–‡ä»¶</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.2  æ‰“å¼€æ–‡ä»¶è¯»å–</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">$fp=fopen(&#x27;./test.txt&#x27;,&#x27;r&#x27;);//æ‰“å¼€æ–‡ä»¶è¯»å–</span></span><br><span class="line"><span class="comment">while($line=fgets($fp))&#123;</span></span><br><span class="line"><span class="comment">echo $line,&#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.3   æ‰“å¼€æ–‡ä»¶è¿½åŠ </span></span><br><span class="line"><span class="variable">$fp</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;./test.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);<span class="comment">//æ‰“å¼€æ–‡ä»¶è¿½åŠ </span></span><br><span class="line"><span class="title function_ invoke__">fputs</span>(<span class="variable">$fp</span>,<span class="string">&#x27;åœ¨æ²³ä¹‹æ´²&#x27;</span>);<span class="comment">//åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ </span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€æ‰“å¼€æ–‡ä»¶ï¼Œè¿”å›æ–‡ä»¶æŒ‡é’ˆï¼ˆæ–‡ä»¶æŒ‡é’ˆå°±æ˜¯æ–‡ä»¶åœ°å€ï¼‰ï¼Œèµ„æºç±»å‹</p><p>2ã€æ‰“å¼€æ–‡ä»¶å†™ã€è¿½åŠ æ“ä½œï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºæ–°çš„æ–‡ä»¶</p><p>3ã€æ‰“å¼€æ–‡ä»¶è¯»æ“ä½œï¼Œæ–‡ä»¶ä¸å­˜åœ¨å°±æŠ¥é”™</p><p>4ã€fputs()å†™ä¸€è¡Œï¼Œfgets()è¯»ä¸€è¡Œï¼Œfclose()å…³é—­æ–‡ä»¶</p><p>5ã€è¿½åŠ æ˜¯åœ¨æ–‡ä»¶çš„æœ«å°¾è¿½åŠ </p><h2 id="1-4-æ˜¯å¦æ˜¯æ–‡ä»¶ã€is-file-ã€‘"><a href="#1-4-æ˜¯å¦æ˜¯æ–‡ä»¶ã€is-file-ã€‘" class="headerlink" title="1.4 æ˜¯å¦æ˜¯æ–‡ä»¶ã€is_file()ã€‘"></a>1.<strong>4</strong> æ˜¯å¦æ˜¯æ–‡ä»¶ã€is_file()ã€‘</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">is_file</span>(<span class="string">&#x27;./test.txt&#x27;</span>)?<span class="string">&#x27;æ˜¯æ–‡ä»¶&#x27;</span>:<span class="string">&#x27;ä¸æ˜¯æ–‡ä»¶&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="1-5-åˆ¤æ–­æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ã€file-exists-ã€‘"><a href="#1-5-åˆ¤æ–­æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ã€file-exists-ã€‘" class="headerlink" title="1.5 åˆ¤æ–­æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ã€file_exists()ã€‘"></a>1.<strong>5</strong> åˆ¤æ–­æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ã€file_exists()ã€‘</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_exists</span>(<span class="string">&#x27;./test.txt&#x27;</span>)?<span class="string">&#x27;æ–‡ä»¶å­˜åœ¨&#x27;</span>:<span class="string">&#x27;æ–‡ä»¶ä¸å­˜åœ¨&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="1-6-åˆ é™¤æ–‡ä»¶ã€unlinkã€‘"><a href="#1-6-åˆ é™¤æ–‡ä»¶ã€unlinkã€‘" class="headerlink" title="1.6 åˆ é™¤æ–‡ä»¶ã€unlinkã€‘"></a>1.<strong>6</strong> åˆ é™¤æ–‡ä»¶ã€unlinkã€‘</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$path</span>=<span class="string">&#x27;./test.txt&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$path</span>))&#123;     <span class="comment">//æ–‡ä»¶å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_dir</span>(<span class="variable">$path</span>))       <span class="comment">//å¦‚æœæ˜¯æ–‡ä»¶å¤¹ç”¨rmdir()åˆ é™¤</span></span><br><span class="line">        <span class="title function_ invoke__">rmdir</span>(<span class="variable">$path</span>);</span><br><span class="line">    <span class="keyword">elseif</span>(<span class="title function_ invoke__">is_file</span>(<span class="variable">$Path</span>))  <span class="comment">//å¦‚æœæ˜¯æ–‡ä»¶ç”¨unlink()åˆ é™¤</span></span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$path</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶ä¸å­˜åœ¨&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1-7-äºŒè¿›åˆ¶è¯»å–ã€fread-æ–‡ä»¶æŒ‡é’ˆï¼Œæ–‡ä»¶å¤§å°-ã€‘"><a href="#1-7-äºŒè¿›åˆ¶è¯»å–ã€fread-æ–‡ä»¶æŒ‡é’ˆï¼Œæ–‡ä»¶å¤§å°-ã€‘" class="headerlink" title="1.7  äºŒè¿›åˆ¶è¯»å–ã€fread(æ–‡ä»¶æŒ‡é’ˆï¼Œæ–‡ä»¶å¤§å°)ã€‘"></a>1.<strong>7</strong>  äºŒè¿›åˆ¶è¯»å–ã€fread(æ–‡ä»¶æŒ‡é’ˆï¼Œæ–‡ä»¶å¤§å°)ã€‘</h2><p>æ–‡ä»¶çš„å­˜å‚¨æœ‰ä¸¤ç§ï¼šå­—ç¬¦æµå’ŒäºŒè¿›åˆ¶æµ</p><p>äºŒè¿›åˆ¶æµçš„è¯»å–æŒ‰æ–‡ä»¶å¤§å°æ¥è¯»çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$path</span>=<span class="string">&#x27;./face.jpg&#x27;</span>;</span><br><span class="line"><span class="variable">$fp</span>=<span class="title function_ invoke__">fopen</span>(<span class="variable">$path</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;content-type:image/jpeg&#x27;</span>);  <span class="comment">//å‘ŠçŸ¥æµè§ˆå™¨ä¸‹é¢çš„ä»£ç é€šè¿‡jpgå›¾ç‰‡æ–¹å¼è§£æ</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">fread</span>(<span class="variable">$fp</span>,<span class="title function_ invoke__">filesize</span>(<span class="variable">$path</span>));    <span class="comment">//äºŒè¿›åˆ¶è¯»å–</span></span><br></pre></td></tr></table></figure><p>å¤šå­¦ä¸€æ‹›ï¼šfile_get_contents()ä¹Ÿå¯ä»¥è¿›è¡ŒäºŒè¿›åˆ¶è¯»å–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;content-type:image/jpeg&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./face.jpg&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€æ–‡æœ¬æµæœ‰æ˜ç¡®çš„ç»“æŸç¬¦ï¼ŒäºŒè¿›åˆ¶æµæ²¡æœ‰æ˜ç¡®çš„ç»“æŸç¬¦ï¼Œé€šè¿‡æ–‡ä»¶å¤§å°åˆ¤æ–­æ–‡ä»¶æ˜¯å¦è¯»å–å®Œæ¯•</p><p>2ã€file_get_contents()æ—¢å¯ä»¥è¿›è¡Œå­—ç¬¦æµè¯»å–ï¼Œä¹Ÿå¯ä»¥è¿›è¡ŒäºŒè¿›åˆ¶è¯»å–ã€‚</p><h1 id="2-è¡¨å•æäº¤æ•°æ®çš„ä¸¤ç§æ–¹å¼"><a href="#2-è¡¨å•æäº¤æ•°æ®çš„ä¸¤ç§æ–¹å¼" class="headerlink" title="2 è¡¨å•æäº¤æ•°æ®çš„ä¸¤ç§æ–¹å¼"></a>2 <strong>è¡¨å•æäº¤æ•°æ®çš„ä¸¤ç§æ–¹å¼</strong></h1><h2 id="2-1-ä¸¤ç§æ–¹å¼"><a href="#2-1-ä¸¤ç§æ–¹å¼" class="headerlink" title="2.1 ä¸¤ç§æ–¹å¼"></a>2.<strong>1 ä¸¤ç§æ–¹å¼</strong></h2><p>1ã€get</p><p>2ã€post</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-2-åŒºåˆ«"><a href="#2-2-åŒºåˆ«" class="headerlink" title="2.2 åŒºåˆ«"></a>2.2 <strong>åŒºåˆ«</strong></h2><p>1ã€å¤–è§‚ä¸Šçœ‹</p><p>getæäº¤åœ¨åœ°å€ä¸Šå¯ä»¥çœ‹åˆ°å‚æ•°</p><p>postæäº¤åœ¨åœ°å€æ ä¸Šçœ‹ä¸åˆ°å‚æ•°</p><p>2ã€å®‰å…¨æ€§</p><p>getä¸å®‰å…¨</p><p>postå®‰å…¨</p><p>3ã€æäº¤åŸç†</p><p>getæäº¤æ˜¯å‚æ•°ä¸€ä¸ªä¸€ä¸ªçš„æäº¤</p><p>postæäº¤æ˜¯æ‰€æœ‰å‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“ä¸€èµ·æäº¤</p><p>4ã€æäº¤æ•°æ®å¤§å°</p><p>getæäº¤ä¸€èˆ¬ä¸è¶…è¿‡255ä¸ªå­—èŠ‚</p><p>postæäº¤çš„å¤§å°å–å†³äºæœåŠ¡å™¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨php.iniä¸­ï¼Œå¯ä»¥é…ç½®postæäº¤çš„å¤§å°</span></span><br><span class="line">post_max_size = <span class="number">8</span>M</span><br></pre></td></tr></table></figure><p>5ã€çµæ´»æ€§</p><p>getå¾ˆçµæ´»ï¼Œåªè¦æœ‰é¡µé¢çš„è·³è½¬å°±å¯ä»¥ä¼ é€’å‚æ•°</p><p>postä¸çµæ´»ï¼Œpostæäº¤éœ€è¦æœ‰è¡¨å•çš„å‚ä¸</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1ã€ htmlè·³è½¬</span><br><span class="line"> Â  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;index.php?name=tom&amp;age=20&quot;</span>&gt;</span>è·³è½¬<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">2ã€JSè·³è½¬</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    location.<span class="property">href</span>=<span class="string">&#x27;index.php?name=tom&amp;age=20&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    location.<span class="title function_">assign</span>(<span class="string">&#x27;index.php?name=tom&amp;age=20&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    location.<span class="title function_">replace</span>(<span class="string">&#x27;index.php?name=tom&amp;age=20&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">3ã€PHPè·³è½¬</span><br><span class="line">header(&#x27;location:index.php?name=tom&amp;age=22&#x27;)</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=&quot;post&quot; action=&quot;&quot;&gt;&lt;/form&gt;</span><br><span class="line">&lt;form method=&quot;get&quot; action=&quot;&quot;&gt;&lt;/form&gt;</span><br></pre></td></tr></table></figure><h1 id="3-æœåŠ¡å™¨æ¥å—æ•°æ®çš„ä¸‰ç§æ–¹å¼"><a href="#3-æœåŠ¡å™¨æ¥å—æ•°æ®çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="3 æœåŠ¡å™¨æ¥å—æ•°æ®çš„ä¸‰ç§æ–¹å¼"></a>3 <strong>æœåŠ¡å™¨æ¥å—æ•°æ®çš„ä¸‰ç§æ–¹å¼</strong></h1><p>é€šè¿‡åå­—è·å–åå­—å¯¹åº”çš„å€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_POST</span>ï¼šæ•°ç»„ç±»å‹ï¼Œä¿å­˜çš„POSTæäº¤çš„å€¼</span><br><span class="line"><span class="variable">$_GET</span>ï¼šæ•°ç»„ç±»å‹ï¼Œä¿å­˜çš„GETæäº¤çš„å€¼</span><br><span class="line"><span class="variable">$_REQUEST</span>ï¼šæ•°ç»„ç±»å‹ï¼Œä¿å­˜çš„GETå’ŒPOSTæäº¤çš„å€¼</span><br></pre></td></tr></table></figure><p>åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­ï¼Œæ—¢æœ‰getåˆæœ‰postï¼Œgetå’Œpostä¼ é€’çš„åå­—æ˜¯ä¸€æ ·çš„ï¼Œè¿™æ—¶å€™é€šè¿‡$_REQUETè·å–çš„æ•°æ®æ˜¯ä»€ä¹ˆ?</p><p>ç­”ï¼šç»“æœå–å†³äºé…ç½®æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request_order = <span class="string">&quot;GP&quot;</span> Â <span class="comment"># å…ˆè·å–GETï¼Œåœ¨è·å–POSTå€¼</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€åœ¨å¼€å‘çš„æ—¶å€™ï¼Œå¦‚æœæ˜ç¡®æ˜¯postæäº¤å°±ä½¿ç”¨<code>$_POST</code>è·å–ï¼Œå¦‚æœæ˜ç¡®getæäº¤å°±ç”¨<code>$_GET</code>è·å–</p><p>2ã€requestè·å–æ•ˆç‡ä½ï¼Œå°½å¯èƒ½ä¸è¦ä½¿ç”¨ï¼Œé™¤éæäº¤çš„ç±»å‹ä¸ç¡®å®šçš„æƒ…å†µä¸‹æ‰ä½¿ç”¨ã€‚</p><h1 id="4-å‚æ•°ä¼ é€’"><a href="#4-å‚æ•°ä¼ é€’" class="headerlink" title="4 å‚æ•°ä¼ é€’"></a>4 <strong>å‚æ•°ä¼ é€’</strong></h1><h2 id="4-1-å¤é€‰æ¡†å€¼çš„ä¼ é€’"><a href="#4-1-å¤é€‰æ¡†å€¼çš„ä¼ é€’" class="headerlink" title="4.1  å¤é€‰æ¡†å€¼çš„ä¼ é€’"></a>4.1  <strong>å¤é€‰æ¡†å€¼çš„ä¼ é€’</strong></h2><p>å¤é€‰æ¡†çš„å‘½åè¦æ³¨æ„å¸¦â€™[]â€™ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;button&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;hobby&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">    çˆ±å¥½ï¼š</span><br><span class="line">    &lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobby[]&quot;</span> value=<span class="string">&#x27;çˆ¬å±±&#x27;</span>&gt;çˆ¬å±±</span><br><span class="line">    &lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobby[]&quot;</span> value=<span class="string">&#x27;æŠ½çƒŸ&#x27;</span>&gt;æŠ½çƒŸ</span><br><span class="line">    &lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobby[]&quot;</span> value=<span class="string">&#x27;å–é…’&#x27;</span>&gt;å–é…’</span><br><span class="line">    &lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobby[]&quot;</span> value=<span class="string">&#x27;çƒ«å¤´&#x27;</span>&gt;çƒ«å¤´</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;æäº¤&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€è¡¨å•æäº¤åˆ°æœ¬é¡µé¢éœ€è¦åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦æœ‰postæäº¤</p><p>2ã€æ•°ç»„çš„æäº¤è¡¨å•å…ƒç´ çš„åå­—å¿…é¡»å¸¦æœ‰[]</p><h1 id="5-æ–‡ä»¶ä¸Šä¼ "><a href="#5-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="5 æ–‡ä»¶ä¸Šä¼ "></a>5 <strong>æ–‡ä»¶ä¸Šä¼ </strong></h1><p>å¼€å‘ä¸­éœ€è¦ä¸Šä¼ å›¾ç‰‡ã€éŸ³ä¹ã€è§†é¢‘ç­‰ç­‰ï¼Œè¿™ç§ä¸Šä¼ ä¼ é€’æ˜¯äºŒè¿›åˆ¶æ•°æ®ã€‚</p><h2 id="5-1-å®¢æˆ·ç«¯ä¸Šä¼ æ–‡ä»¶"><a href="#5-1-å®¢æˆ·ç«¯ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="5.1 å®¢æˆ·ç«¯ä¸Šä¼ æ–‡ä»¶"></a>5.1 <strong>å®¢æˆ·ç«¯ä¸Šä¼ æ–‡ä»¶</strong></h2><p>æ–‡ä»¶åŸŸ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;image&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¡¨å•çš„enctypeå±æ€§</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¡¨å•ä¼ é€’æ˜¯å­—ç¬¦æµï¼Œä¸èƒ½ä¼ é€’äºŒè¿›åˆ¶æµï¼Œé€šè¿‡è®¾ç½®è¡¨å•çš„enctypeå±æ€§ä¼ é€’å¤åˆæ•°æ®ã€‚</p><p>enctypeå±æ€§çš„å€¼æœ‰ï¼š</p><ol><li>application&#x2F;x-www-form-urlencodedï¼šã€é»˜è®¤ã€‘ï¼Œè¡¨ç¤ºä¼ é€’çš„æ˜¯å¸¦æ ¼å¼çš„æ–‡æœ¬æ•°æ®ã€‚</li><li>multipart&#x2F;form-dataï¼šå¤åˆçš„è¡¨å•æ•°æ®ï¼ˆå­—ç¬¦ä¸²ï¼Œæ–‡ä»¶ï¼‰ï¼Œæ–‡ä»¶ä¸Šä¼ å¿…é¡»è®¾ç½®æ­¤å€¼</li><li>text&#x2F;plainï¼šç”¨äºå‘æœåŠ¡å™¨ä¼ é€’æ— æ ¼å¼çš„æ–‡æœ¬æ•°æ®ï¼Œä¸»è¦ç”¨æˆ·ç”µå­é‚®ä»¶</li></ol><p>å•è¯</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">multipartï¼šå¤åˆ</span><br><span class="line">form-dataï¼šè¡¨å•æ•°ç»„</span><br></pre></td></tr></table></figure><h2 id="5-2-æœåŠ¡å™¨æ¥å—æ–‡ä»¶"><a href="#5-2-æœåŠ¡å™¨æ¥å—æ–‡ä»¶" class="headerlink" title="5.2 æœåŠ¡å™¨æ¥å—æ–‡ä»¶"></a>5.2 æœåŠ¡å™¨æ¥å—æ–‡ä»¶</h2><p>è¶…å…¨å±€å˜é‡<code>$_FILES</code>æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œç”¨æ¥ä¿å­˜å®¢æˆ·ç«¯ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æ–‡ä»¶ä¿¡æ¯ã€‚äºŒç»´æ•°ç»„çš„è¡Œæ˜¯æ–‡ä»¶åŸŸçš„åç§°ï¼Œåˆ—æœ‰5ä¸ªã€‚<br>1ã€<code>$_FILES[][â€˜nameâ€™]</code>ï¼šä¸Šä¼ çš„æ–‡ä»¶å<br>2ã€<code>$_FILES[][â€˜type]</code>ï¼šä¸Šä¼ çš„ç±»å‹ï¼Œè¿™ä¸ªç±»å‹æ˜¯MIMEç±»å‹ï¼ˆimage&#x2F;jpegã€image&#x2F;gifã€image&#x2F;pngï¼‰<br>3ã€<code>$_FILES[][â€˜sizeâ€™]</code>ï¼šæ–‡ä»¶çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½<br>4ã€<code>$_FILES[][â€˜tmp_nameâ€™]</code>ï¼šæ–‡ä»¶ä¸Šä¼ æ—¶çš„ä¸´æ—¶æ–‡ä»¶<br>5ã€<code>$_FILES[][â€˜errorâ€™]</code>ï¼šé”™è¯¯ç¼–ç (å€¼æœ‰0ã€1ã€2ã€3ã€4ã€6ã€7)0è¡¨ç¤ºæ­£ç¡®</p><p><code>$_FILES[][â€˜errorâ€™]</code>è¯¦è§£</p><table><thead><tr><th><strong>å€¼</strong></th><th><strong>é”™è¯¯æè¿°</strong></th></tr></thead><tbody><tr><td>0</td><td>æ­£ç¡®</td></tr><tr><td>1</td><td>æ–‡ä»¶å¤§å°è¶…è¿‡äº†php.iniä¸­å…è®¸çš„æœ€å¤§å€¼    upload_max_filesize &#x3D; 2M</td></tr><tr><td>2</td><td>æ–‡ä»¶å¤§å°è¶…è¿‡äº†è¡¨å•å…è®¸çš„æœ€å¤§å€¼</td></tr><tr><td>3</td><td>åªæœ‰éƒ¨åˆ†æ–‡ä»¶ä¸Šä¼ </td></tr><tr><td>4</td><td>æ²¡æœ‰æ–‡ä»¶ä¸Šä¼ </td></tr><tr><td>6</td><td>æ‰¾ä¸åˆ°ä¸´æ—¶æ–‡ä»¶</td></tr><tr><td>7</td><td>æ–‡ä»¶å†™å…¥å¤±è´¥</td></tr></tbody></table><p>æ³¨æ„ï¼šMAX_FILE_SIZEå¿…é¡»åœ¨æ–‡ä»¶åŸŸçš„ä¸Šé¢ã€‚</p><p>åªè¦æŒæ¡çš„é”™è¯¯å·ï¼š0å’Œ4</p><h2 id="5-3-å°†ä¸Šä¼ æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®"><a href="#5-3-å°†ä¸Šä¼ æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®" class="headerlink" title="5.3 å°†ä¸Šä¼ æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®"></a>5.3 <strong>å°†ä¸Šä¼ æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®</strong></h2><p>å‡½æ•°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">move_uploaded_file</span>(ä¸´æ—¶åœ°å€,ç›®æ ‡åœ°å€)</span><br></pre></td></tr></table></figure><p>ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_POST</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;face&#x27;</span>][<span class="string">&#x27;error&#x27;</span>]==<span class="number">0</span>)&#123; Â <span class="comment">//ä¸Šä¼ æ­£ç¡®</span></span><br><span class="line"> Â  Â  Â  Â <span class="comment">//æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">        <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;face&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>],<span class="string">&#x27;./&#x27;</span>.<span class="variable">$_FILES</span>[<span class="string">&#x27;face&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;ä¸Šä¼ æœ‰è¯¯&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;é”™è¯¯ç :&#x27;</span>.<span class="variable">$_FILES</span>[<span class="string">&#x27;face&#x27;</span>][<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;&quot;</span> enctype=<span class="string">&#x27;multipart/form-data&#x27;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;face&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;ä¸Šä¼ &quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼šä¸Šä¼ çš„åŒåçš„æ–‡ä»¶è¦ç»™è¦†ç›–</p><h3 id="5-4-ä¸æ–‡ä»¶ä¸Šä¼ æœ‰å…³çš„é…ç½®"><a href="#5-4-ä¸æ–‡ä»¶ä¸Šä¼ æœ‰å…³çš„é…ç½®" class="headerlink" title="5.4 ä¸æ–‡ä»¶ä¸Šä¼ æœ‰å…³çš„é…ç½®"></a>5.4 <strong>ä¸æ–‡ä»¶ä¸Šä¼ æœ‰å…³çš„é…ç½®</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">post_max_size = <span class="number">8</span>Mï¼šè¡¨å•å…è®¸çš„æœ€å¤§å€¼</span><br><span class="line"></span><br><span class="line">upload_max_filesize = <span class="number">2</span>Mï¼šå…è®¸ä¸Šä¼ çš„æ–‡ä»¶å¤§å°</span><br><span class="line"></span><br><span class="line">upload_tmp_dir =F:\wamp\tmpï¼šæŒ‡å®šä¸´æ—¶æ–‡ä»¶åœ°å€ï¼Œå¦‚æœä¸çŸ¥é“æ“ä½œç³»ç»ŸæŒ‡å®š</span><br><span class="line"></span><br><span class="line">file_uploads = Onï¼šæ˜¯å¦å…è®¸æ–‡ä»¶ä¸Šä¼ </span><br><span class="line"></span><br><span class="line">max_file_uploads = <span class="number">20</span>ï¼šå…è®¸åŒæ—¶ä¸Šä¼ <span class="number">20</span>ä¸ªæ–‡ä»¶</span><br></pre></td></tr></table></figure><h1 id="6-ä¼˜åŒ–æ–‡ä»¶ä¸Šä¼ "><a href="#6-ä¼˜åŒ–æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="6 ä¼˜åŒ–æ–‡ä»¶ä¸Šä¼ "></a>6 <strong>ä¼˜åŒ–æ–‡ä»¶ä¸Šä¼ </strong></h1><h2 id="6-1-æ›´æ”¹æ–‡ä»¶å"><a href="#6-1-æ›´æ”¹æ–‡ä»¶å" class="headerlink" title="6.1 æ›´æ”¹æ–‡ä»¶å"></a>6.1 <strong>æ›´æ”¹æ–‡ä»¶å</strong></h2><p>æ–¹æ³•ä¸€ï¼šé€šè¿‡æ—¶é—´æˆ³åšæ–‡ä»¶å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$path</span>=<span class="string">&#x27;face.stu.jpg&#x27;</span>;</span><br><span class="line"><span class="comment">//echo strrchr($path,&#x27;.&#x27;);  //ä»æœ€åä¸€ä¸ªç‚¹å¼€å§‹æˆªå–ï¼Œä¸€ç›´æˆªå–åˆ°æœ€å</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">time</span>().<span class="title function_ invoke__">rand</span>(<span class="number">100</span>,<span class="number">999</span>).<span class="title function_ invoke__">strrchr</span>(<span class="variable">$path</span>,<span class="string">&#x27;.&#x27;</span>);</span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼šé€šè¿‡uniqid()å®ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$path</span>=<span class="string">&#x27;face.stu.jpg&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">uniqid</span>().<span class="title function_ invoke__">strrchr</span>(<span class="variable">$path</span>,<span class="string">&#x27;.&#x27;</span>),<span class="string">&#x27;&lt;br&gt;&#x27;</span>; Â  <span class="comment">//ç”Ÿæˆå”¯ä¸€çš„ID</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">uniqid</span>(<span class="string">&#x27;goods_&#x27;</span>).<span class="title function_ invoke__">strrchr</span>(<span class="variable">$path</span>,<span class="string">&#x27;.&#x27;</span>),<span class="string">&#x27;&lt;br&gt;&#x27;</span>; Â  <span class="comment">//å¸¦æœ‰å‰ç¼€</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">uniqid</span>(<span class="string">&#x27;goods_&#x27;</span>,<span class="literal">true</span>).<span class="title function_ invoke__">strrchr</span>(<span class="variable">$path</span>,<span class="string">&#x27;.&#x27;</span>),<span class="string">&#x27;&lt;br&gt;&#x27;</span>; Â <span class="comment">//å”¯ä¸€ID+éšæœºæ•°</span></span><br></pre></td></tr></table></figure><h2 id="6-2-éªŒè¯æ–‡ä»¶æ ¼å¼"><a href="#6-2-éªŒè¯æ–‡ä»¶æ ¼å¼" class="headerlink" title="6.2 éªŒè¯æ–‡ä»¶æ ¼å¼"></a>6.2 <strong>éªŒè¯æ–‡ä»¶æ ¼å¼</strong></h2><p>æ–¹æ³•ä¸€ï¼šåˆ¤æ–­æ–‡ä»¶çš„æ‰©å±•åï¼ˆä¸èƒ½è¯†åˆ«æ–‡ä»¶ä¼ªè£…ï¼‰</p><p>æ“ä½œæ€è·¯ï¼šå°†æ–‡ä»¶çš„åç¼€å’Œå…è®¸çš„åç¼€å¯¹æ¯”</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_POST</span>)) &#123;</span><br><span class="line">    <span class="variable">$allow</span>=<span class="keyword">array</span>(<span class="string">&#x27;.jpg&#x27;</span>,<span class="string">&#x27;.png&#x27;</span>,<span class="string">&#x27;.gif&#x27;</span>); <span class="comment">//å…è®¸çš„æ‰©å±•å</span></span><br><span class="line">    <span class="variable">$ext</span>=<span class="title function_ invoke__">strrchr</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;face&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&#x27;.&#x27;</span>); Â <span class="comment">//ä¸Šä¼ æ–‡ä»¶æ‰©å±•å</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$ext</span>,<span class="variable">$allow</span>))</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;å…è®¸ä¸Šä¼ &#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;æ–‡ä»¶ä¸åˆæ³•&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;&quot;</span> enctype=<span class="string">&#x27;multipart/form-data&#x27;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;face&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;ä¸Šä¼ &quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæ¯”è¾ƒæ‰©å±•åä¸èƒ½é˜²æ­¢æ–‡ä»¶ä¼ªè£…ã€‚</p><p>æ–¹æ³•äºŒï¼šé€šè¿‡<code>$_FIELS[][&#39;type&#39;]</code>ç±»å‹ï¼ˆä¸èƒ½è¯†åˆ«æ–‡ä»¶ä¼ªè£…ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_POST</span>)) &#123;</span><br><span class="line">    <span class="variable">$allow</span>=<span class="keyword">array</span>(<span class="string">&#x27;image/jpeg&#x27;</span>,<span class="string">&#x27;image/png&#x27;</span>,<span class="string">&#x27;image/gif&#x27;</span>); <span class="comment">//å…è®¸çš„ç±»åˆ«</span></span><br><span class="line">    <span class="variable">$mime</span>=<span class="variable">$_FILES</span>[<span class="string">&#x27;face&#x27;</span>][<span class="string">&#x27;type&#x27;</span>]; Â <span class="comment">//ä¸Šä¼ æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$mime</span>,<span class="variable">$allow</span>))</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;å…è®¸ä¸Šä¼ &#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;æ–‡ä»¶ä¸åˆæ³•&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;&quot;</span> enctype=<span class="string">&#x27;multipart/form-data&#x27;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;face&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;ä¸Šä¼ &quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæ¯”è¾ƒ<code>$_FIELS[][&#39;type&#39;]</code>ä¸èƒ½é˜²æ­¢æ–‡ä»¶ä¼ªè£…ã€‚</p><p>æ–¹æ³•ä¸‰ï¼šphp_fileinfoæ‰©å±•ï¼ˆå¯ä»¥é˜²æ­¢æ–‡ä»¶ä¼ªè£…ï¼‰</p><p>åœ¨php.iniä¸­å¼€å¯fileinfoæ‰©å±•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extension=php_fileinfo.dll</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå¼€å¯fileinfoæ‰©å±•ä»¥åï¼Œå°±å¯ä»¥ä½¿ç”¨finfo_*çš„å‡½æ•°äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_POST</span>)) &#123;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºfinfoèµ„æº</span></span><br><span class="line">    <span class="variable">$info</span>=<span class="title function_ invoke__">finfo_open</span>(FILEINFO_MIME_TYPE);</span><br><span class="line">    <span class="comment">//var_dump($info);      //resource(2) of type (file_info)</span></span><br><span class="line">    <span class="comment">//ç¬¬äºŒæ­¥ï¼šå°†finfoèµ„æºå’Œæ–‡ä»¶åšæ¯”è¾ƒ</span></span><br><span class="line">    <span class="variable">$mime</span>=<span class="title function_ invoke__">finfo_file</span>(<span class="variable">$info</span>,<span class="variable">$_FILES</span>[<span class="string">&#x27;face&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">    <span class="comment">//ç¬¬ä¸‰æ­¥ï¼Œæ¯”è¾ƒæ˜¯å¦åˆæ³•</span></span><br><span class="line">    <span class="variable">$allow</span>=<span class="keyword">array</span>(<span class="string">&#x27;image/jpeg&#x27;</span>,<span class="string">&#x27;image/png&#x27;</span>,<span class="string">&#x27;image/gif&#x27;</span>); <span class="comment">//å…è®¸çš„ç±»åˆ«</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">in_array</span>(<span class="variable">$mime</span>,<span class="variable">$allow</span>)?<span class="string">&#x27;åˆæ³•&#x27;</span>:<span class="string">&#x27;ä¸åˆæ³•&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;&quot;</span> enctype=<span class="string">&#x27;multipart/form-data&#x27;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;face&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;ä¸Šä¼ &quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼šéªŒè¯æ–‡ä»¶æ ¼å¼æœ‰ä¸‰ç§æ–¹æ³•</p><p>1ã€å¯ä»¥éªŒè¯æ‰©å±•åï¼ˆä¸å¯ä»¥é˜²æ­¢æ–‡ä»¶ä¼ªè£…ï¼‰</p><p>2ã€é€šè¿‡<code>$_FILES[][&#39;type&#39;]</code>éªŒè¯ï¼ˆä¸å¯ä»¥é˜²æ­¢æ–‡ä»¶ä¼ªè£…ï¼‰</p><p>3ã€é€šè¿‡file_infoæ‰©å±•ï¼ˆå¯ä»¥é˜²æ­¢æ–‡ä»¶ä¼ªè£…ï¼‰</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-æ–‡ä»¶æ“ä½œ&quot;&gt;&lt;a href=&quot;#1-æ–‡ä»¶æ“ä½œ&quot; class=&quot;headerlink&quot; title=&quot;1 æ–‡ä»¶æ“ä½œ&quot;&gt;&lt;/a&gt;1 &lt;strong&gt;æ–‡ä»¶æ“ä½œ&lt;/strong&gt;&lt;/h1&gt;&lt;h2 id=&quot;1-1-å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶&quot;&gt;&lt;a href=&quot;#1-1-å°†å­—ç¬¦ä¸²</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>PHPåŸºç¡€-2-ä½œç”¨åŸŸ&amp;é€’å½’&amp;æ–‡ä»¶å¤¹æ“ä½œ</title>
    <link href="https://gbk.cx/p/f60eefa5/"/>
    <id>https://gbk.cx/p/f60eefa5/</id>
    <published>2024-10-19T13:47:09.000Z</published>
    <updated>2024-10-19T14:11:57.192Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-ä½œç”¨åŸŸ"><a href="#1-ä½œç”¨åŸŸ" class="headerlink" title="1 ä½œç”¨åŸŸ"></a>1 ä½œç”¨åŸŸ</h1><h2 id="1-1-å˜é‡ä½œç”¨åŸŸ"><a href="#1-1-å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="1.1 å˜é‡ä½œç”¨åŸŸ"></a>1.1 <strong>å˜é‡ä½œç”¨åŸŸ</strong></h2><p>1ã€å…¨å±€å˜é‡ï¼šåœ¨å‡½æ•°å¤–é¢</p><p>2ã€å±€éƒ¨å˜é‡ï¼šåœ¨å‡½æ•°é‡Œé¢ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°å†…éƒ¨æ˜¯ä¸ä¼šå»è®¿é—®å‡½æ•°å¤–éƒ¨çš„å˜é‡</p><p>3ã€è¶…å…¨å±€å˜é‡ï¼šå¯ä»¥åœ¨å‡½æ•°å†…éƒ¨å’Œå‡½æ•°å¤–éƒ¨è®¿é—®</p><p>| $GLOBALS<br> |<br>| â€” |<br>| $_SERVER |<br>| $_GET |<br>| $_POST |<br>| $_FILES |<br>| $_COOKIE |<br>| $_SESSION |<br>| $_REQUEST |<br>| $_ENV |</p><p>globalå…³é”®å­—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$num</span>=<span class="number">10</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">global</span> <span class="variable">$num</span>;   <span class="comment">//å°†å…¨å±€å˜é‡çš„$numçš„åœ°å€å¼•å…¥åˆ°å‡½æ•°å†…éƒ¨  ç›¸å½“äº$num=&amp;GLOBALS[&#x27;num&#x27;]</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num</span>;<span class="comment">//10</span></span><br><span class="line"><span class="variable">$num</span>=<span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fun</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num</span>;    <span class="comment">//100</span></span><br><span class="line">-----------------------------------</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$num</span>=<span class="number">10</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">global</span> <span class="variable">$num</span>;</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$num</span>);  <span class="comment">//é”€æ¯çš„æ˜¯å¼•ç”¨ï¼Œä¸æ˜¯å…·ä½“çš„å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fun</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num</span>;    <span class="comment">//10</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€$GLOBALSä¿å­˜çš„æ˜¯å…¨å±€å˜é‡çš„æ‰€æœ‰çš„å€¼</p><p>2ã€globalç”¨äºåˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡çš„å¼•ç”¨</p><p>ğŸ’¡ æ³¨æ„ï¼šå¸¸é‡æ²¡æœ‰ä½œç”¨åŸŸçš„æ¦‚å¿µ</p><h2 id="1-2-é™æ€å˜é‡ï¼ˆstaticï¼‰"><a href="#1-2-é™æ€å˜é‡ï¼ˆstaticï¼‰" class="headerlink" title="1.2 é™æ€å˜é‡ï¼ˆstaticï¼‰"></a>1.2 <strong>é™æ€å˜é‡ï¼ˆstaticï¼‰</strong></h2><p>é™æ€å˜é‡ä¸€èˆ¬æŒ‡çš„æ˜¯é™æ€å±€éƒ¨å˜é‡ã€‚</p><p>é™æ€å˜é‡åªåˆå§‹åŒ–ä¸€æ¬¡</p><h3 id="1-2-1-å¸¸é‡å’Œé™æ€å˜é‡çš„åŒºåˆ«"><a href="#1-2-1-å¸¸é‡å’Œé™æ€å˜é‡çš„åŒºåˆ«" class="headerlink" title="1.2.1 å¸¸é‡å’Œé™æ€å˜é‡çš„åŒºåˆ«"></a>1.2.1 å¸¸é‡å’Œé™æ€å˜é‡çš„åŒºåˆ«</h3><p>1ã€å¸¸é‡å’Œé™æ€å˜é‡éƒ½æ˜¯åˆå§‹åŒ–ä¸€æ¬¡</p><p>2ã€å¸¸é‡ä¸èƒ½æ”¹å˜å€¼ï¼Œé™æ€å˜é‡å¯ä»¥æ”¹å˜å€¼</p><p>3ã€å¸¸é‡æ²¡æœ‰ä½œç”¨åŸŸï¼Œé™æ€å˜é‡æœ‰ä½œç”¨åŸŸ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;num&#x27;</span>,<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">echo</span> num;   <span class="comment">//10</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fun1</span>();</span><br><span class="line"><span class="title function_ invoke__">fun2</span>();</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="built_in">static</span> <span class="variable">$num</span>=<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num</span>;  <span class="comment">//Notice: Undefined variable: num å› ä¸ºé™æ€å˜é‡æ˜¯æœ‰ä½œç”¨åŸŸçš„</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fun1</span>();</span><br><span class="line"><span class="title function_ invoke__">fun2</span>();</span><br></pre></td></tr></table></figure><h2 id="1-3-åŒ¿åå‡½æ•°use"><a href="#1-3-åŒ¿åå‡½æ•°use" class="headerlink" title="1.3 åŒ¿åå‡½æ•°use()"></a>1.3 <strong>åŒ¿åå‡½æ•°use()</strong></h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°å†…éƒ¨ä¸èƒ½è®¿é—®å‡½æ•°å¤–éƒ¨çš„å˜é‡ï¼Œä½†åœ¨åŒ¿åå‡½æ•°ä¸­ï¼Œå¯ä»¥é€šè¿‡useå°†å¤–éƒ¨å˜é‡å¼•å…¥åŒ¿åå‡½æ•°ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$num</span>=<span class="number">10</span>;</span><br><span class="line"><span class="variable">$fun</span>=<span class="function"><span class="keyword">function</span>(<span class="params"></span>) <span class="keyword">use</span>(<span class="params"><span class="variable">$num</span></span>) </span>&#123;  <span class="comment">//å°†$numå¼•å…¥åˆ°åŒ¿åå‡½æ•°ä¸­</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable">$fun</span>();   <span class="comment">//10</span></span><br></pre></td></tr></table></figure><p>æ€è€ƒï¼šå¦‚ä½•åœ¨å‡½æ•°å†…éƒ¨è®¿é—®å‡½æ•°å¤–éƒ¨å˜é‡</p><p>1ã€ä½¿ç”¨è¶…å…¨å±€å˜é‡</p><p>2ã€$GLOBALS</p><p>3ã€global</p><p>4ã€useå°†å‡½æ•°å¤–éƒ¨å˜é‡å¼•å…¥åˆ°åŒ¿åå‡½æ•°å†…éƒ¨</p><h1 id="2-é€’å½’"><a href="#2-é€’å½’" class="headerlink" title="2 é€’å½’"></a>2 é€’å½’</h1><p>å‡½æ•°å†…éƒ¨è‡ªå·±è°ƒç”¨è‡ªå·±</p><p>é€’å½’æœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæ˜¯é€’å½’ç‚¹ï¼ˆä»ä»€ä¹ˆåœ°æ–¹é€’å½’ï¼‰ï¼Œç¬¬äºŒé€’å½’å‡ºå£</p><h1 id="3-åŒ…å«æ–‡ä»¶"><a href="#3-åŒ…å«æ–‡ä»¶" class="headerlink" title="3 åŒ…å«æ–‡ä»¶"></a>3 åŒ…å«æ–‡ä»¶</h1><h2 id="3-1-åŒ…å«æ–‡ä»¶çš„æ–¹å¼"><a href="#3-1-åŒ…å«æ–‡ä»¶çš„æ–¹å¼" class="headerlink" title="3.1 åŒ…å«æ–‡ä»¶çš„æ–¹å¼"></a>3.1 <strong>åŒ…å«æ–‡ä»¶çš„æ–¹å¼</strong></h2><p>1ã€requireï¼šåŒ…å«å¤šæ¬¡</p><p>2ã€includeï¼šåŒ…å«å¤šæ¬¡</p><p>3ã€require_onceï¼š åŒ…å«ä¸€æ¬¡</p><p>4ã€include_onceï¼š åŒ…å«ä¸€æ¬¡</p><p>ğŸ’¡ å°ç»“ï¼š</p><p>1ã€requireé‡åˆ°é”™è¯¯æŠ›å‡ºerrorç±»åˆ«çš„é”™è¯¯ï¼Œåœæ­¢æ‰§è¡Œ</p><p>2ã€includeé‡åˆ°é”™è¯¯æŠ›å‡ºwarningç±»å‹çš„é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ</p><p>3ã€require_onceã€include_onceåªèƒ½åŒ…å«ä¸€æ¬¡</p><p>4ã€HTMLç±»å‹çš„åŒ…å«é¡µé¢ä¸­å­˜åœ¨PHPä»£ç ï¼Œå¦‚æœåŒ…å«åˆ°PHPä¸­æ˜¯å¯ä»¥è¢«æ‰§è¡Œçš„</p><p>5ã€åŒ…å«æ–‡ä»¶ç›¸å½“äºæŠŠåŒ…å«æ–‡ä»¶ä¸­çš„ä»£ç æ‹·è´åˆ°ä¸»æ–‡ä»¶ä¸­æ‰§è¡Œï¼Œé­”æœ¯å¸¸é‡é™¤å¤–ï¼Œé­”æœ¯å¸¸é‡è·å–çš„æ˜¯æ‰€åœ¨æ–‡ä»¶çš„ä¿¡æ¯ã€‚</p><p>6ã€åŒ…å«åœ¨ç¼–è¯‘æ—¶ä¸æ‰§è¡Œã€è¿è¡Œæ—¶åŠ è½½åˆ°å†…å­˜ã€ç‹¬ç«‹ç¼–è¯‘åŒ…å«æ–‡ä»¶</p><h2 id="3-2-åŒ…å«æ–‡ä»¶çš„è·¯å¾„"><a href="#3-2-åŒ…å«æ–‡ä»¶çš„è·¯å¾„" class="headerlink" title="3.2 åŒ…å«æ–‡ä»¶çš„è·¯å¾„"></a>3.2 <strong>åŒ…å«æ–‡ä»¶çš„è·¯å¾„</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./å½“å‰ç›®å½•</span><br><span class="line">../ä¸Šä¸€çº§ç›®å½•</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&#x27;./head.html&#x27;</span>;   <span class="comment">//åœ¨å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;head.html&#x27;</span>;  <span class="comment">//å—include_pathé…ç½®å½±å“</span></span><br></pre></td></tr></table></figure><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/nImlTZP7gI9wY04BSmjJ1729345712719.png" alt="1559631648089.png"></p><p>include_pathçš„ä½¿ç”¨åœºæ™¯ï¼š</p><p>å¦‚æœåŒ…å«æ–‡ä»¶çš„ç›®å½•ç»“æ„æ¯”è¾ƒå¤æ‚ï¼Œæ¯”å¦‚ï¼šåœ¨c:\aa\bb\cc\ddä¸­æœ‰å¤šä¸ªæ–‡ä»¶éœ€è¦åŒ…å«ï¼Œå¯ä»¥å°†åŒ…å«çš„è·¯å¾„è®¾ç½®æˆinclude_pathï¼Œè¿™æ ·åŒ…å«å°±åªè¦å†™æ–‡ä»¶åå°±å¯ä»¥äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">set_include_path</span>(<span class="string">&#x27;c:\aa\bb\cc\dd&#x27;</span>); Â <span class="comment">//è®¾ç½®include_path</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;head1.html&#x27;</span>;    Â <span class="comment">//å—include_pathé…ç½®å½±å“</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;head2.html&#x27;</span>;</span><br></pre></td></tr></table></figure><p>include_pathå¯ä»¥è®¾ç½®å¤šä¸ªï¼Œè·¯å¾„ä¹‹é—´ç”¨åˆ†å·éš”å¼€</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">set_include_path</span>(<span class="string">&#x27;c:\aa\bb\cc\dd;d:\\&#x27;</span>);</span><br></pre></td></tr></table></figure><h1 id="4-é”™è¯¯å¤„ç†"><a href="#4-é”™è¯¯å¤„ç†" class="headerlink" title="4 é”™è¯¯å¤„ç†"></a>4 é”™è¯¯å¤„ç†</h1><h2 id="4-1-é”™è¯¯çš„çº§åˆ«"><a href="#4-1-é”™è¯¯çš„çº§åˆ«" class="headerlink" title="4.1 é”™è¯¯çš„çº§åˆ«"></a>4.1 <strong>é”™è¯¯çš„çº§åˆ«</strong></h2><ol><li>noticeï¼šæç¤º</li><li>warningï¼šè­¦å‘Š</li><li>errorï¼šè‡´å‘½é”™è¯¯</li></ol><p>noticeå’ŒwarningæŠ¥é”™åç»§ç»­æ‰§è¡Œï¼ŒerroræŠ¥é”™ååœæ­¢æ‰§è¡Œ</p><h2 id="4-2-é”™è¯¯çš„æç¤ºæ–¹æ³•"><a href="#4-2-é”™è¯¯çš„æç¤ºæ–¹æ³•" class="headerlink" title="4.2 é”™è¯¯çš„æç¤ºæ–¹æ³•"></a>4.2 <strong>é”™è¯¯çš„æç¤ºæ–¹æ³•</strong></h2><p>æ–¹æ³•ä¸€ï¼šæ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Š</p><p>æ–¹æ³•äºŒï¼šè®°å½•åœ¨æ—¥å¿—ä¸­</p><h2 id="4-3-ä¸é”™è¯¯å¤„ç†æœ‰å…³çš„é…ç½®"><a href="#4-3-ä¸é”™è¯¯å¤„ç†æœ‰å…³çš„é…ç½®" class="headerlink" title="4.3 ä¸é”™è¯¯å¤„ç†æœ‰å…³çš„é…ç½®"></a>4.3 <strong>ä¸é”™è¯¯å¤„ç†æœ‰å…³çš„é…ç½®</strong></h2><p>åœ¨php.iniä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. error_reporting = E_ALLï¼šæŠ¥å‘Šæ‰€æœ‰çš„é”™è¯¯</span><br><span class="line">2. display_errors = Onï¼šå°†é”™è¯¯æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Š</span><br><span class="line">3. log_errors = Onï¼šå°†é”™è¯¯è®°å½•åœ¨æ—¥å¿—ä¸­</span><br><span class="line">4. error_log=â€™åœ°å€â€™ï¼šé”™è¯¯æ—¥å¿—ä¿å­˜çš„åœ°å€</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­æœ‰ä¸¤ä¸ªæ¨¡å¼ï¼Œå¼€å‘æ¨¡å¼ï¼Œè¿è¡Œæ¨¡å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¼€å‘æ¨¡å¼ï¼šé”™è¯¯æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Šï¼Œä¸è¦è®°å½•åœ¨æ—¥å¿—ä¸­</span><br><span class="line">è¿è¡Œæ¨¡å¼ï¼šé”™è¯¯ä¸æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Šï¼Œè®°å½•æ˜¯æ—¥å¿—ä¸­</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="5-æ–‡ä»¶ç¼–ç¨‹"><a href="#5-æ–‡ä»¶ç¼–ç¨‹" class="headerlink" title="5 æ–‡ä»¶ç¼–ç¨‹"></a>5 æ–‡ä»¶ç¼–ç¨‹</h1><h2 id="5-1-æ–‡ä»¶å¤¹æ“ä½œ"><a href="#5-1-æ–‡ä»¶å¤¹æ“ä½œ" class="headerlink" title="5.1 æ–‡ä»¶å¤¹æ“ä½œ"></a>5.1 <strong>æ–‡ä»¶å¤¹æ“ä½œ</strong></h2><p><strong>1 ã€</strong>åˆ›å»ºæ–‡ä»¶å¤¹ã€<code>mkdir(è·¯å¾„ï¼Œæƒé™ï¼Œæ˜¯å¦é€’å½’åˆ›å»º)</code>ã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make:åˆ›å»º</span><br><span class="line">directoryï¼šç›®å½•ï¼Œæ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure><p>ä¾‹é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//1ã€åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="comment">//mkdir(&#x27;./aa&#x27;);    //åˆ›å»ºaaæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="comment">//mkdir(&#x27;./aa/bb&#x27;); //åœ¨aaç›®å½•ä¸‹åˆ›å»ºbb(aaç›®å½•å¿…é¡»å­˜åœ¨)</span></span><br><span class="line"><span class="title function_ invoke__">mkdir</span>(<span class="string">&#x27;./aa/bb/cc/dd&#x27;</span>,<span class="number">0777</span>,<span class="literal">true</span>);   <span class="comment">//é€’å½’åˆ›å»º</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€0777è¡¨ç¤ºæ˜¯æ–‡ä»¶å¤¹çš„æƒé™ï¼Œåœ¨Linuxä¸­ä¼šè¯¦ç»†è®²è§£</p><p>2ã€trueè¡¨ç¤ºé€’å½’åˆ›å»ºï¼Œé»˜è®¤æ˜¯false</p><p><strong>2ã€</strong>åˆ é™¤æ–‡ä»¶å¤¹ã€rmdir()ã€‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//remove:ç§»é™¤</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">rmdir</span>(<span class="string">&#x27;./aa/bb/cc/dd&#x27;</span>); <span class="comment">//åˆ é™¤ddæ–‡ä»¶å¤¹</span></span><br></pre></td></tr></table></figure><p>æé†’ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1ã€åˆ é™¤çš„æ–‡ä»¶å¤¹å¿…é¡»æ˜¯ç©ºçš„</span><br><span class="line">2ã€PHPåŸºäºå®‰å…¨è€ƒè™‘ï¼Œæ²¡æœ‰æä¾›é€’å½’åˆ é™¤ã€‚</span><br></pre></td></tr></table></figure><p><strong>3ã€</strong>é‡å‘½åæ–‡ä»¶å¤¹ã€rename(æ—§åå­—ï¼Œæ–°åå­—)ã€‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">rename</span>(<span class="string">&#x27;./aa&#x27;</span>,<span class="string">&#x27;./aaa&#x27;</span>); <span class="comment">//å°†aaæ”¹ä¸ºaaa</span></span><br></pre></td></tr></table></figure><p><strong>4ã€</strong>æ˜¯å¦æ˜¯æ–‡ä»¶å¤¹ã€is_dir()ã€‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">is_dir</span>(<span class="string">&#x27;./aaa&#x27;</span>)?<span class="string">&#x27;æ˜¯æ–‡ä»¶å¤¹&#x27;</span>:<span class="string">&#x27;ä¸æ˜¯æ–‡ä»¶å¤¹&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>5ã€</strong>æ‰“å¼€æ–‡ä»¶å¤¹ã€è¯»å–æ–‡ä»¶å¤¹ã€å…³é—­æ–‡ä»¶å¤¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$folder</span>=<span class="title function_ invoke__">opendir</span>(<span class="string">&#x27;./&#x27;</span>);  <span class="comment">//æ‰“å¼€ç›®å½•</span></span><br><span class="line"><span class="comment">//var_dump($folder);        //resource(3) of type (stream)</span></span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$f</span>=<span class="title function_ invoke__">readdir</span>(<span class="variable">$folder</span>))&#123; <span class="comment">//è¯»å–æ–‡ä»¶å¤¹</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$f</span>==<span class="string">&#x27;.&#x27;</span> || <span class="variable">$f</span>==<span class="string">&#x27;..&#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">iconv</span>(<span class="string">&#x27;gbk&#x27;</span>,<span class="string">&#x27;utf-8&#x27;</span>,<span class="variable">$f</span>),<span class="string">&#x27;&lt;br&gt;&#x27;</span>; Â <span class="comment">//å°†gbkè½¬æˆutf-8</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">closedir</span>(<span class="variable">$folder</span>);      <span class="comment">//å…³é—­æ–‡ä»¶å¤¹</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€<span class="title function_ invoke__">opendir</span>()è¿”å›èµ„æºç±»å‹</span><br><span class="line"><span class="number">2</span>ã€æ¯ä¸ªæ–‡ä»¶å¤¹ä¸­éƒ½æœ‰.å’Œ..</span><br><span class="line"><span class="number">3</span>ã€<span class="title function_ invoke__">iconv</span>()ç”¨æ¥åšå­—ç¬¦ç¼–ç è½¬æ¢</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-ä½œç”¨åŸŸ&quot;&gt;&lt;a href=&quot;#1-ä½œç”¨åŸŸ&quot; class=&quot;headerlink&quot; title=&quot;1 ä½œç”¨åŸŸ&quot;&gt;&lt;/a&gt;1 ä½œç”¨åŸŸ&lt;/h1&gt;&lt;h2 id=&quot;1-1-å˜é‡ä½œç”¨åŸŸ&quot;&gt;&lt;a href=&quot;#1-1-å˜é‡ä½œç”¨åŸŸ&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>PHPåŸºç¡€-1-å˜é‡-å¸¸é‡-è¿ç®—ç¬¦-æ•°æ®ç±»å‹-åˆ¤æ–­-å¾ªç¯</title>
    <link href="https://gbk.cx/p/5b8fbc6e/"/>
    <id>https://gbk.cx/p/5b8fbc6e/</id>
    <published>2024-10-19T13:44:24.000Z</published>
    <updated>2024-10-19T14:09:40.818Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0-è¾“å‡ºè¯­å¥"><a href="#0-è¾“å‡ºè¯­å¥" class="headerlink" title="0 è¾“å‡ºè¯­å¥"></a>0 è¾“å‡ºè¯­å¥</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span>:è¾“å‡º</span><br><span class="line"><span class="keyword">print</span>:è¾“å‡ºï¼Œè¾“å‡ºæˆåŠŸè¿”å›<span class="number">1</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>()ï¼šè¾“å‡ºæ•°ç»„</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>():è¾“å‡ºæ•°æ®çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¸¦æœ‰æ•°æ®ç±»å‹å’Œæ•°æ®é•¿åº¦</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;abc&#x27;</span>);<span class="comment">//string(3) &quot;abc&quot; </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="1-å˜é‡"><a href="#1-å˜é‡" class="headerlink" title="1 å˜é‡"></a>1 å˜é‡</h1><h2 id="1-1-å˜é‡çš„å‘½åè§„åˆ™"><a href="#1-1-å˜é‡çš„å‘½åè§„åˆ™" class="headerlink" title="1.1 å˜é‡çš„å‘½åè§„åˆ™"></a>1.1 <strong>å˜é‡çš„å‘½åè§„åˆ™</strong></h2><ol><li>å˜é‡å¿…é¡»ä»¥$å¼€å¤´ï¼Œ$ç¬¦ä¸æ˜¯å˜é‡çš„ä¸€éƒ¨åˆ†ï¼Œä»…è¡¨ç¤ºåé¢çš„æ ‡è¯†ç¬¦æ˜¯å˜é‡åã€‚</li><li>é™¤äº†$ä»¥å¤–ï¼Œä»¥å­—æ¯ã€ä¸‹åˆ’çº¿å¼€å¤´ï¼Œåé¢è·Ÿç€æ•°å­—ã€å­—æ¯ã€ä¸‹åˆ’çº¿</li><li>å˜é‡ååŒºåˆ†å¤§å°å†™ï¼Œ$aaå’Œ$Aaæ˜¯ä¸¤ä¸ªç©ºé—´</li></ol><h2 id="1-2-å¯å˜å˜é‡"><a href="#1-2-å¯å˜å˜é‡" class="headerlink" title="1.2 å¯å˜å˜é‡"></a>1.2 <strong>å¯å˜å˜é‡</strong></h2><p>å˜é‡åå¯ä»¥å˜ï¼Œå°†å˜é‡åå­˜å‚¨åœ¨å¦å¤–ä¸€ä¸ªå˜é‡ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="number">10</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$$b</span>;<span class="comment">//10</span></span><br></pre></td></tr></table></figure><h2 id="1-3-å˜é‡ä¼ é€’"><a href="#1-3-å˜é‡ä¼ é€’" class="headerlink" title="1.3 å˜é‡ä¼ é€’"></a>1.3 <strong>å˜é‡ä¼ é€’</strong></h2><p>å˜é‡çš„ä¼ é€’æœ‰å€¼ä¼ é€’å’Œåœ°å€ä¼ é€’ï¼ˆå¼•ç”¨ä¼ é€’ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å€¼ä¼ é€’</span></span><br><span class="line"><span class="variable">$num1</span>=<span class="number">10</span>;<span class="comment">//å°†10ä»˜ç»™$num1</span></span><br><span class="line"><span class="variable">$num2</span>=<span class="variable">$num1</span>;<span class="comment">//å°†$num1çš„å€¼ä»˜ç»™$num2</span></span><br><span class="line"><span class="variable">$num2</span>=<span class="number">20</span>;<span class="comment">//æ›´æ”¹$num2</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num1</span>;<span class="comment">//10</span></span><br></pre></td></tr></table></figure><h2 id="1-4-é”€æ¯å˜é‡"><a href="#1-4-é”€æ¯å˜é‡" class="headerlink" title="1.4 é”€æ¯å˜é‡"></a>1.4 <strong>é”€æ¯å˜é‡</strong></h2><p>ç”¨unset()æ¥é”€æ¯å˜é‡ï¼Œé”€æ¯çš„æ˜¯å˜é‡åï¼Œå˜é‡å€¼ç”±PHPåƒåœ¾å›æ”¶æœºåˆ¶é”€æ¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$num1</span>=<span class="number">10</span>;</span><br><span class="line"><span class="variable">$num2</span>=&amp;<span class="variable">$num1</span>;</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$num1</span>);<span class="comment">//é”€æ¯çš„æ˜¯å˜é‡å</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num2</span>;<span class="comment">//10</span></span><br></pre></td></tr></table></figure><h1 id="2-å¸¸é‡"><a href="#2-å¸¸é‡" class="headerlink" title="2 å¸¸é‡"></a>2 å¸¸é‡</h1><h2 id="2-1-å®šä¹‰å¸¸é‡"><a href="#2-1-å®šä¹‰å¸¸é‡" class="headerlink" title="2.1 å®šä¹‰å¸¸é‡"></a>2.1 <strong>å®šä¹‰å¸¸é‡</strong></h2><p>1ã€ç”¨define()å‡½æ•°å®šä¹‰å¸¸é‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">define</span>(å¸¸é‡åï¼Œå€¼ï¼Œ[æ˜¯å¦åŒºåˆ«å¤§å°å†™])  <span class="literal">true</span>è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ï¼Œé»˜è®¤æ˜¯<span class="literal">false</span></span><br></pre></td></tr></table></figure><p>2ã€è¿˜å¯ä»¥ä½¿ç”¨constå…³é”®å­—å®šä¹‰å¸¸é‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">NAME</span>=<span class="string">&#x27;tom&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> NAME;<span class="comment">//tom</span></span><br></pre></td></tr></table></figure><p>å®šä¹‰å¸¸é‡æœ‰ä¸¤ç§æ–¹å¼ï¼Œdefine()å’Œconst</p><p>å¸¸é‡åœ¨æ•´ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­å€¼ä¿æŒä¸å˜ï¼Œå¸¸é‡ä¸èƒ½é‡æ–°å®šä¹‰</p><p>ä½¿ç”¨constantè·å–ç‰¹æ®Šå­—ç¬¦åšçš„å¸¸é‡åçš„å€¼</p><p>defined()ç”¨æ¥åˆ¤æ–­å¸¸é‡æ˜¯å¦è¢«å®šä¹‰</p><h2 id="2-2-é¢„å®šä¹‰å¸¸é‡"><a href="#2-2-é¢„å®šä¹‰å¸¸é‡" class="headerlink" title="2.2 é¢„å®šä¹‰å¸¸é‡"></a>2.2 <strong>é¢„å®šä¹‰å¸¸é‡</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> PHP_VERSION,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//PHPç‰ˆæœ¬å·</span></span><br><span class="line"><span class="keyword">echo</span> PHP_OS,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//PHPæ“ä½œç³»ç»Ÿ</span></span><br><span class="line"><span class="keyword">echo</span> PHP_INT_MAX,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//PHPä¸­æ•´å‹çš„æœ€å¤§å€¼</span></span><br></pre></td></tr></table></figure><h2 id="2-3-é­”æœ¯å¸¸é‡"><a href="#2-3-é­”æœ¯å¸¸é‡" class="headerlink" title="2.3 é­”æœ¯å¸¸é‡"></a>2.3 é­”æœ¯å¸¸é‡</h2><p>é­”æœ¯å¸¸é‡å®ƒä»¬çš„å€¼éšç€å®ƒä»¬åœ¨ä»£ç ä¸­çš„ä½ç½®æ”¹å˜è€Œæ”¹å˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="keyword">__LINE__</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//è·å–å½“å‰è¡Œå·</span></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">__FILE__</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//æ–‡ä»¶çš„å®Œæ•´è·¯å¾„å’Œæ–‡ä»¶å</span></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">__DIR__</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•</span></span><br></pre></td></tr></table></figure><h1 id="3-æ•°æ®ç±»å‹"><a href="#3-æ•°æ®ç±»å‹" class="headerlink" title="3 æ•°æ®ç±»å‹"></a>3 æ•°æ®ç±»å‹</h1><h2 id="3-1-åŸºæœ¬ç±»å‹ï¼ˆæ ‡é‡ç±»å‹ï¼‰"><a href="#3-1-åŸºæœ¬ç±»å‹ï¼ˆæ ‡é‡ç±»å‹ï¼‰" class="headerlink" title="3.1 åŸºæœ¬ç±»å‹ï¼ˆæ ‡é‡ç±»å‹ï¼‰"></a>3.1 <strong>åŸºæœ¬ç±»å‹ï¼ˆæ ‡é‡ç±»å‹ï¼‰</strong></h2><h3 id="3-1-1-æ•´å‹"><a href="#3-1-1-æ•´å‹" class="headerlink" title="3.1.1 æ•´å‹"></a>3.1.1 æ•´å‹</h3><p>å­˜æ•´æ•°ï¼ŒPHP_INT_MAXè·å–æ•´å½¢æœ€å¤§å€¼</p><table><thead><tr><th><strong>æœºåˆ¶</strong></th><th><strong>ç¼©å†™</strong></th><th><strong>å•è¯</strong></th></tr></thead><tbody><tr><td>åè¿›åˆ¶</td><td>dec</td><td>decimalist</td></tr><tr><td>äºŒè¿›åˆ¶</td><td>bin</td><td>binary</td></tr><tr><td>å…«è¿›åˆ¶</td><td>oct</td><td>octonary</td></tr><tr><td>åå…­è¿›åˆ¶</td><td>hex</td><td>hexdecimalist</td></tr></tbody></table><h3 id="3-1-2-æµ®ç‚¹å‹"><a href="#3-1-2-æµ®ç‚¹å‹" class="headerlink" title="3.1.2 æµ®ç‚¹å‹"></a>3.1.2 æµ®ç‚¹å‹</h3><p>æµ®ç‚¹æ•°åœ¨å†…å­˜ä¸­ä¿å­˜çš„æ˜¯è¿‘ä¼¼å€¼</p><p>æµ®ç‚¹æ•°ä¸èƒ½å‚ä¸æ¯”è¾ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="number">0.9</span>==(<span class="number">1</span>-<span class="number">0.1</span>));<span class="comment">//bool(true) </span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="number">0.1</span>==(<span class="number">1</span>-<span class="number">0.9</span>));<span class="comment">//bool(false)</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæµ®ç‚¹æ•°è¦æ¯”è¾ƒï¼Œå¿…é¡»ç¡®å®šæ¯”è¾ƒçš„ä½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="number">0.9</span>==(<span class="number">1</span>-<span class="number">0.1</span>));<span class="comment">//bool(true) </span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="number">0.1</span>==(<span class="number">1</span>-<span class="number">0.9</span>));<span class="comment">//bool(false) </span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">bccomp</span>(<span class="number">0.1</span>,<span class="number">1</span>-<span class="number">0.9</span>,<span class="number">5</span>));<span class="comment">//æ¯”è¾ƒå°æ•°ç‚¹åé¢5ä½   int(0)   0è¡¨ç¤ºç›¸ç­‰</span></span><br></pre></td></tr></table></figure><p>ğŸ’¡ æé†’ï¼šå¦‚æœä¸€ä¸ªæ•´æ•°è¶…å‡ºäº†æ•´å½¢çš„èŒƒå›´ï¼Œä¼šè‡ªåŠ¨çš„è½¬æˆæµ®ç‚¹å‹</p><h3 id="3-1-3-å¸ƒå°”å‹"><a href="#3-1-3-å¸ƒå°”å‹" class="headerlink" title="3.1.3 å¸ƒå°”å‹"></a>3.1.3 å¸ƒå°”å‹</h3><p>ä¸èƒ½ä½¿ç”¨echo å’Œprintè¾“å‡ºå¸ƒå°”å‹ï¼Œè¦ä½¿ç”¨var_dump()è¾“å‡º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$name</span>=<span class="string">&#x27;tom&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;æˆ‘çš„åå­—å«$name&#x27;</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//æˆ‘çš„åå­—å«$name</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;æˆ‘çš„åå­—å«<span class="subst">$name</span>&quot;</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//æˆ‘çš„åå­—å«tom</span></span><br></pre></td></tr></table></figure><h3 id="3-1-4-å­—ç¬¦ä¸²å‹"><a href="#3-1-4-å­—ç¬¦ä¸²å‹" class="headerlink" title="3.1.4 å­—ç¬¦ä¸²å‹"></a>3.1.4 å­—ç¬¦ä¸²å‹</h3><p>åœ¨PHPä¸­å•å¼•å·å­—ç¬¦ä¸²å’ŒåŒå¼•å·å­—ç¬¦ä¸²æ˜¯æœ‰åŒºåˆ«çš„</p><p>å•å¼•å·å­—ç¬¦ä¸²æ˜¯çœŸæ­£çš„å­—ç¬¦ä¸²</p><p>åŒå¼•å·å­—ç¬¦ä¸²è¦è§£æå­—ç¬¦ä¸²ä¸­çš„å˜é‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$name</span>=<span class="string">&#x27;tom&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;æˆ‘çš„åå­—å«$name&#x27;</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//æˆ‘çš„åå­—å«$name</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;æˆ‘çš„åå­—å«<span class="subst">$name</span>&quot;</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//æˆ‘çš„åå­—å«tom</span></span><br></pre></td></tr></table></figure><h2 id="3-2-å¤åˆç±»å‹"><a href="#3-2-å¤åˆç±»å‹" class="headerlink" title="3.2 å¤åˆç±»å‹"></a>3.2 <strong>å¤åˆç±»å‹</strong></h2><h3 id="3-2-1-æ•°ç»„"><a href="#3-2-1-æ•°ç»„" class="headerlink" title="3.2.1 æ•°ç»„"></a>3.2.1 <strong>æ•°ç»„</strong></h3><p>åœ¨PHPä¸­æ•°ç»„æœ‰ä¸¤ç§å½¢å¼ï¼Œç´¢å¼•æ•°ç»„å’Œå…³è”æ•°ç»„</p><p>ç´¢å¼•æ•°ç»„ï¼šç”¨æ•´æ•°åšä¸‹æ ‡ï¼Œé»˜è®¤ä»0å¼€å§‹ï¼Œåé¢ä¾æ¬¡åŠ ä¸€</p><p>å…³è”æ•°ç»„ï¼šç”¨å­—ç¬¦ä¸²åšä¸‹æ ‡ï¼Œé€šè¿‡&#x3D;&gt;ç¬¦å·å°†ä¸‹æ ‡å’Œå€¼å…³è”èµ·æ¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//1ã€ç´¢å¼•æ•°ç»„çš„å£°æ˜</span></span><br><span class="line"><span class="variable">$stu</span>=<span class="keyword">array</span>(<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;berry&#x27;</span>,<span class="string">&#x27;ketty&#x27;</span>);   <span class="comment">//ç´¢å¼•æ•°ç»„</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$stu</span>);<span class="comment">//è¾“å‡ºæ•°ç»„  Array ( [0] =&gt; tom [1] =&gt; berry [2] =&gt; ketty ) </span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$stu</span>[<span class="number">0</span>],<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//tom</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$stu</span>[<span class="number">1</span>],<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//berry</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$stu</span>[<span class="number">2</span>],<span class="string">&#x27;&lt;hr&gt;&#x27;</span>;<span class="comment">//ketty</span></span><br><span class="line">------------------------------------------</span><br><span class="line"><span class="comment">//2ã€å…³è”æ•°ç»„</span></span><br><span class="line"><span class="variable">$emp</span>=<span class="keyword">array</span>(<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;æç™½&#x27;</span>,<span class="string">&#x27;sex&#x27;</span>=&gt;<span class="string">&#x27;ç”·&#x27;</span>,<span class="string">&#x27;age&#x27;</span>=&gt;<span class="number">22</span>);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$emp</span>);<span class="comment">//Array ( [name] =&gt; æç™½ [sex] =&gt; ç”· [age] =&gt; 22 ) </span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$emp</span>[<span class="string">&#x27;name&#x27;</span>],<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//æç™½</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$emp</span>[<span class="string">&#x27;sex&#x27;</span>],<span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//ç”·</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$emp</span>[<span class="string">&#x27;age&#x27;</span>];<span class="comment">//22</span></span><br></pre></td></tr></table></figure><p>äºŒç»´æ•°ç»„çš„å£°æ˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$stu</span>=[</span><br><span class="line">[<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;sex&#x27;</span>=&gt;<span class="string">&#x27;ç”·&#x27;</span>,<span class="string">&#x27;age&#x27;</span>=&gt;<span class="number">22</span>],</span><br><span class="line">[<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;berry&#x27;</span>,<span class="string">&#x27;sex&#x27;</span>=&gt;<span class="string">&#x27;å¥³&#x27;</span>,<span class="string">&#x27;age&#x27;</span>=&gt;<span class="number">23</span>]</span><br><span class="line">];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>çŸ­æ•°ç»„è¯­æ³•ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ä¸­æ‹¬å·å£°æ˜æ•°ç»„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$stu</span>=[<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;berry&#x27;</span>,<span class="string">&#x27;ketty&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$stu</span>);  <span class="comment">//Array ( [0] =&gt; tom [1] =&gt; berry [2] =&gt; ketty )</span></span><br></pre></td></tr></table></figure><h3 id="3-2-2-å¯¹è±¡"><a href="#3-2-2-å¯¹è±¡" class="headerlink" title="3.2.2 å¯¹è±¡"></a>3.2.2 <strong>å¯¹è±¡</strong></h3><h2 id="3-3-ç‰¹æ®Šç±»å‹"><a href="#3-3-ç‰¹æ®Šç±»å‹" class="headerlink" title="3.3 ç‰¹æ®Šç±»å‹"></a>3.3 <strong>ç‰¹æ®Šç±»å‹</strong></h2><p>1ã€èµ„æº</p><p>2ã€null</p><h2 id="3-4-ç±»å‹è½¬æ¢"><a href="#3-4-ç±»å‹è½¬æ¢" class="headerlink" title="3.4 ç±»å‹è½¬æ¢"></a>3.4 <strong>ç±»å‹è½¬æ¢</strong></h2><p>1ã€è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼šå½“æä¾›çš„ç±»å‹å’Œéœ€è¦çš„ç±»å‹ä¸ä¸€è‡´çš„æ—¶å€™ä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$num</span>=<span class="number">10</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>)&#123;   <span class="comment">//è‡ªåŠ¨å°†æ•°å­—è½¬æˆå¸ƒå°”å‹</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;aa&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;bb&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------------</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;20&#x27;</span>-<span class="number">10</span>;<span class="comment">//è‡ªåŠ¨çš„å°†å­—ç¬¦ä¸²è½¬æˆæ•°å­—</span></span><br></pre></td></tr></table></figure><p>2ã€å¼ºåˆ¶ç±»å‹è½¬æ¢</p><p>è¯­æ³•ï¼šï¼ˆæ•°æ®ç±»å‹ï¼‰æ•°æ®</p><p>å…¶ä»–ç±»å‹å’Œå¸ƒå°”ä¹‹é—´çš„è½¬æ¢</p><p>è§„åˆ™ï¼š0ã€ç©ºä¸ºå‡ï¼Œé0éç©ºä¸ºçœŸ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>((<span class="keyword">bool</span>)<span class="string">&#x27;abc&#x27;</span>);<span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//bool(true)  </span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>((<span class="keyword">bool</span>)<span class="string">&#x27;&#x27;</span>);<span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//bool(false) </span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>((<span class="keyword">bool</span>)<span class="string">&#x27;0&#x27;</span>);<span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;<span class="comment">//bool(false)</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="4-è¿ç®—ç¬¦"><a href="#4-è¿ç®—ç¬¦" class="headerlink" title="4 è¿ç®—ç¬¦"></a>4 è¿ç®—ç¬¦</h1><h2 id="4-1-ç®—æœ¯è¿ç®—ç¬¦"><a href="#4-1-ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="4.1 ç®—æœ¯è¿ç®—ç¬¦"></a>4.1 <strong>ç®—æœ¯è¿ç®—ç¬¦</strong></h2><table><thead><tr><th><strong>ä¸€å…ƒè¿ç®—ç¬¦</strong></th><th><strong>äºŒå…ƒè¿ç®—ç¬¦</strong></th></tr></thead><tbody><tr><td>++</td><td>+</td></tr><tr><td>â€“</td><td>-</td></tr><tr><td></td><td>*</td></tr><tr><td></td><td>&#x2F;</td></tr><tr><td></td><td>%   (å–æ¨¡)</td></tr></tbody></table><h2 id="4-2-å…³ç³»è¿ç®—ç¬¦ï¼ˆæ¯”è¾ƒè¿ç®—ç¬¦ï¼‰"><a href="#4-2-å…³ç³»è¿ç®—ç¬¦ï¼ˆæ¯”è¾ƒè¿ç®—ç¬¦ï¼‰" class="headerlink" title="4.2 å…³ç³»è¿ç®—ç¬¦ï¼ˆæ¯”è¾ƒè¿ç®—ç¬¦ï¼‰"></a>4.2 <strong>å…³ç³»è¿ç®—ç¬¦ï¼ˆæ¯”è¾ƒè¿ç®—ç¬¦ï¼‰</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=</span><br><span class="line">&lt;</span><br><span class="line">&lt;=</span><br><span class="line">== <span class="comment">//å¼±ç±»å‹æ¯”è¾ƒ ä¸å¯¹æ•°æ®ç±»å‹ä½œæ¯”è¾ƒ &#x27;1&#x27;=1 true</span></span><br><span class="line">!=</span><br><span class="line">===<span class="comment">//å¼ºç±»å‹æ¯”è¾ƒ å¯¹æ•°æ®ç±»å‹å’Œå€¼éƒ½è¿›è¡Œæ¯”è¾ƒ &#x27;1&#x27;=1 false</span></span><br><span class="line">!==</span><br></pre></td></tr></table></figure><h2 id="4-3-é€»è¾‘è¿ç®—ç¬¦"><a href="#4-3-é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="4.3 é€»è¾‘è¿ç®—ç¬¦"></a>4.3 <strong>é€»è¾‘è¿ç®—ç¬¦</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&amp;ä¸ï¼šè¿ç®—ç¬¦ä¸¤è¾¹çš„è¡¨è¾¾å¼éƒ½è¦è®¡ç®—</span><br><span class="line">|æˆ–ï¼šè¿ç®—ç¬¦ä¸¤è¾¹çš„è¡¨è¾¾å¼éƒ½è¦è®¡ç®—</span><br><span class="line"></span><br><span class="line">&amp;&amp;çŸ­è·¯ä¸ï¼šå¦‚æœå‰é¢çš„æ¡ä»¶ä¸æ»¡è¶³ï¼Œåé¢çš„æ¡ä»¶å°±ä¸ç”¨è®¡ç®—äº†</span><br><span class="line">||çŸ­è·¯æˆ–</span><br><span class="line">!é</span><br></pre></td></tr></table></figure><h2 id="4-4-èµ‹å€¼è¿ç®—ç¬¦"><a href="#4-4-èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="4.4 èµ‹å€¼è¿ç®—ç¬¦"></a>4.4 èµ‹å€¼è¿ç®—ç¬¦</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">=<span class="comment">//èµ‹å€¼</span></span><br><span class="line">+=<span class="comment">//a+=b   a=a+b</span></span><br><span class="line">-=</span><br><span class="line">*=</span><br><span class="line">/=</span><br><span class="line">%=</span><br></pre></td></tr></table></figure><h2 id="4-5-å­—ç¬¦ä¸²è¿æ¥ç¬¦"><a href="#4-5-å­—ç¬¦ä¸²è¿æ¥ç¬¦" class="headerlink" title="4.5 å­—ç¬¦ä¸²è¿æ¥ç¬¦(.)"></a>4.5 å­—ç¬¦ä¸²è¿æ¥ç¬¦(.)</h2><h2 id="4-6-é”™è¯¯æŠ‘åˆ¶ç¬¦"><a href="#4-6-é”™è¯¯æŠ‘åˆ¶ç¬¦" class="headerlink" title="4.6 é”™è¯¯æŠ‘åˆ¶ç¬¦(@)"></a>4.6 <strong>é”™è¯¯æŠ‘åˆ¶ç¬¦(@)</strong></h2><p>é”™è¯¯æŠ‘åˆ¶ç¬¦åªå¯¹è¡¨è¾¾å¼æœ‰æ•ˆ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> @(<span class="variable">$aa</span>+<span class="variable">$bb</span>);<span class="comment">//é”™è¯¯æŠ‘åˆ¶</span></span><br></pre></td></tr></table></figure><h2 id="4-7-ä¸‰å…ƒè¿ç®—ç¬¦"><a href="#4-7-ä¸‰å…ƒè¿ç®—ç¬¦" class="headerlink" title="4.7 ä¸‰å…ƒè¿ç®—ç¬¦(?:)"></a>4.7 <strong>ä¸‰å…ƒè¿ç®—ç¬¦(?:)</strong></h2><p>è¡¨è¾¾å¼1 ? å€¼1 : å€¼2</p><h2 id="4-8-nullåˆå¹¶è¿ç®—ç¬¦"><a href="#4-8-nullåˆå¹¶è¿ç®—ç¬¦" class="headerlink" title="4.8 nullåˆå¹¶è¿ç®—ç¬¦(??)"></a>4.8 <strong>nullåˆå¹¶è¿ç®—ç¬¦(??)</strong></h2><p>PHP7.0ä»¥åæ‰æ”¯æŒ</p><p>ä¾‹é¢˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo $name??&#x27;å§“åä¸è¯¦&#x27;;     //å§“åä¸è¯¦</span><br></pre></td></tr></table></figure><p>å¤šå­¦ä¸€æ‹›ï¼šä¸¤ä¸ªç”¨æ¥åˆ¤æ–­çš„å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">isset()ï¼šåˆ¤æ–­å˜é‡æ˜¯å¦è¢«è®¾ç½®ï¼Œå¹¶ä¸”è®¾ç½®çš„ä¸æ˜¯null</span><br><span class="line">empty()ï¼šæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ºç©ºï¼Œèƒ½è½¬æˆfalseå…¨éƒ¨æ˜¯ç©ºï¼Œ[&#x27;&#x27;,0,0.0,array(),null]</span><br></pre></td></tr></table></figure><p>ä¾‹é¢˜</p><h1 id="5-åˆ¤æ–­"><a href="#5-åˆ¤æ–­" class="headerlink" title="5 åˆ¤æ–­"></a>5 åˆ¤æ–­</h1><h2 id="5-1-è¯­æ³•"><a href="#5-1-è¯­æ³•" class="headerlink" title="5.1 è¯­æ³•"></a>5.1 <strong>è¯­æ³•</strong></h2><p>1ã€ifè¯­å¥</p><p>2ã€ifelseè¯­å¥</p><p>3ã€switch caseè¯­å¥</p><h1 id="6-å¾ªç¯"><a href="#6-å¾ªç¯" class="headerlink" title="6 å¾ªç¯"></a>6 å¾ªç¯</h1><p>1ã€for</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(åˆå§‹å€¼;æ¡ä»¶;å¢é‡)&#123;</span><br><span class="line"><span class="comment">//å¾ªç¯ä½“</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ã€while&amp;do-while</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(æ¡ä»¶)&#123;</span><br><span class="line">&#125;</span><br><span class="line">-------------------------</span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">while</span>(æ¡ä»¶)</span><br></pre></td></tr></table></figure><p>3ã€foreach</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯­æ³•ä¸€</span></span><br><span class="line"><span class="keyword">foreach</span>(æ•°ç»„ <span class="keyword">as</span> å€¼)&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¯­æ³•äºŒ</span></span><br><span class="line"><span class="keyword">foreach</span>(æ•°ç»„ <span class="keyword">as</span> é”®=&gt;å€¼)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$stu</span>=[<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;berry&#x27;</span>,<span class="string">&#x27;ketty&#x27;</span>];</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$stu</span> <span class="keyword">as</span> <span class="variable">$v</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$v</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">tom</span></span><br><span class="line"><span class="comment">berry</span></span><br><span class="line"><span class="comment">ketty</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">-----------------------------------------------------------</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$stu</span> <span class="keyword">as</span> <span class="variable">$k</span>=&gt;<span class="variable">$v</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$k&#125;</span>:<span class="subst">&#123;$v&#125;</span>&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">0:tom</span></span><br><span class="line"><span class="comment">1:berry</span></span><br><span class="line"><span class="comment">2:ketty</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><ul><li>forã€whileã€do-whileå¯ä»¥ç›¸äº’æ›¿æ¢</li><li>å¦‚æœæ˜ç¡®çŸ¥é“å¾ªç¯å¤šå°‘æ¬¡é¦–å…ˆforå¾ªç¯ï¼Œå¦‚è¦è¦å¾ªç¯åˆ°æ¡ä»¶ä¸æˆç«‹ä¸ºæ­¢é€‰whileæˆ–do-while</li><li>å…ˆåˆ¤æ–­å†æ‰§è¡Œé€‰whileï¼Œå…ˆæ‰§è¡Œå†åˆ¤æ–­é€‰do-while</li><li>whileå¾ªç¯æ¡ä»¶ä¸æˆç«‹å°±ä¸æ‰§è¡Œï¼Œdo-whileè‡³å°‘æ‰§è¡Œä¸€æ¬¡</li></ul><h1 id="7-è·³è½¬è¯­å¥"><a href="#7-è·³è½¬è¯­å¥" class="headerlink" title="7 è·³è½¬è¯­å¥"></a>7 è·³è½¬è¯­å¥</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">break</span>ï¼šä¸­æ–­å¾ªç¯</span><br><span class="line"></span><br><span class="line"><span class="keyword">continue</span>ï¼šä¸­æ–­å½“å‰å¾ªç¯ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯</span><br></pre></td></tr></table></figure><h1 id="8-å‡½æ•°"><a href="#8-å‡½æ•°" class="headerlink" title="8 å‡½æ•°"></a>8 å‡½æ•°</h1><h2 id="8-1-å‡½æ•°å®šä¹‰"><a href="#8-1-å‡½æ•°å®šä¹‰" class="headerlink" title="8.1 å‡½æ•°å®šä¹‰"></a>8.1 <strong>å‡½æ•°å®šä¹‰</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> å‡½æ•°å(<span class="params">å‚æ•°<span class="number">1</span>ï¼Œå‚æ•°<span class="number">2</span>ï¼Œ...</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//å‡½æ•°ä½“</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><p>1ã€å˜é‡ååŒºåˆ†å¤§å°å†™</p><p>2ã€å…³é”®å­—ã€å‡½æ•°åä¸åŒºåˆ†å¤§å°å†™</p><p>8.2 <strong>å¯å˜å‡½æ•°</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"><span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$args</span>,<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$str</span>=<span class="string">&#x27;show&#x27;</span>;<span class="comment">//å°†å‡½æ•°åä¿å­˜åˆ°å˜é‡ä¸­</span></span><br><span class="line"><span class="variable">$str</span>(<span class="string">&#x27;é”„ç¦¾æ—¥å½“åˆ&#x27;</span>);</span><br></pre></td></tr></table></figure><p>8.3 <strong>åŒ¿åå‡½æ•°</strong></p><p>åŒ¿åå‡½æ•°å°±æ˜¯æ²¡æœ‰åå­—çš„å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//åŒ¿åå‡½æ•°</span></span><br><span class="line"><span class="variable">$fun</span>=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;é”„ç¦¾æ—¥å½“åˆ&lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//åŒ¿åå‡½æ•°è°ƒç”¨</span></span><br><span class="line"><span class="variable">$fun</span>();</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;0-è¾“å‡ºè¯­å¥&quot;&gt;&lt;a href=&quot;#0-è¾“å‡ºè¯­å¥&quot; class=&quot;headerlink&quot; title=&quot;0 è¾“å‡ºè¯­å¥&quot;&gt;&lt;/a&gt;0 è¾“å‡ºè¯­å¥&lt;/h1&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutte</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="PHP" scheme="https://gbk.cx/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>æ±‡ç¼–å…¥é—¨å­¦ä¹ </title>
    <link href="https://gbk.cx/p/d147e7fa/"/>
    <id>https://gbk.cx/p/d147e7fa/</id>
    <published>2024-10-19T13:25:45.000Z</published>
    <updated>2024-10-20T02:21:19.463Z</updated>
    
    <content type="html"><![CDATA[<h1>æ±‡ç¼–</h1><h1>ä¸€ã€æŒ‡ä»¤</h1><h2 id="1-mov">1 mov</h2><p>å¯ä»¥ç«‹å³æ•°åˆ°å†…å­˜ï¼Œå¯„å­˜å™¨åˆ°å†…å­˜ã€‚å†…å­˜åˆ°å¯„å­˜å™¨</p><h3 id="1-1-movæŒ‡ä»¤æ“ä½œçš„å››ç§å½¢å¼">1.1 movæŒ‡ä»¤æ“ä½œçš„å››ç§å½¢å¼</h3><ol><li>[ç«‹å³æ•°]</li><li>[reg] regä»£è¡¨å¯„å­˜å™¨ å¯ä»¥æ˜¯8ä¸ªé€šç”¨å¯„å­˜å™¨ä¸­çš„ä»»æ„ä¸€ä¸ª</li><li>[reg+ç«‹å³æ•°]</li><li>[reg+reg*{1,2,4,8}]</li></ol><h3 id="1-2-æŒ‡ä»¤æ ¼å¼">1.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>MOV r/m8,r8      ré€šç”¨å¯„å­˜å™¨</li><li>MOV r/m16,r16   mä»£è¡¨å†…å­˜</li><li>MOV r/m32,r32  r8ä»£è¡¨8ä½é€šç”¨å¯„å­˜å™¨</li><li>MOV r8,r/m8      m8ä»£è¡¨8ä¸ºå†…å­˜</li><li>MOV r16,r/m16   imm8ä»£è¡¨8ä½ç«‹å³æ•°</li><li>MOV r32,r/m32</li><li>MOV r8,imm8</li><li>MOV r16,imm16</li><li>MOV r32,imm32</li></ol><h2 id="2-movs">2 movs</h2><p>ç§»åŠ¨æ•°æ® å†…å­˜-å†…å­˜ ï¼ˆEDI-ESIï¼‰</p><p>MOVS BYTE PTR ES:[EDI],BYTE PTR DS:[ESI] ç®€å†™ä¸ºï¼šMOVSB</p><p>MOVS WORD PTR ES:[EDI],WORD PTR DS:[ESI] ç®€å†™ä¸ºï¼šMOVSW</p><p>MOVS DWORD PTR ES:[EDI],DWORD PTR DS:[ESI] ç®€å†™ä¸ºï¼šMOVSD</p><p>ğŸ’¡ é»˜è®¤DFä½æ˜¯0æ—¶ï¼Œå½“å®Œæˆmovsæ“ä½œåESIå’ŒEDIçš„å€¼ä¼šåŠ byte,word,dword{1ï¼Œ2ï¼Œ4}</p><h2 id="3-stos">3 stos</h2><p>å°†AI/AX/EAXçš„å€¼å­˜å‚¨åˆ°[EDI]æŒ‡å®šçš„å†…å­˜å•å…ƒ</p><p>STOS BYTE PRT ES:[EDI] ç®€å†™ä¸ºSTOSB</p><p>STOS WORD PRT ES:[EDI] ç®€å†™ä¸ºSTOSW</p><p>STOS DWORD PRT ES:[EDI] ç®€å†™ä¸ºSTOSD</p><p>ğŸ’¡ é»˜è®¤DFä½æ˜¯0æ—¶ï¼Œå½“å®Œæˆstosæ“ä½œåEDIçš„å€¼ä¼šåŠ byte,word,dword{1ï¼Œ2ï¼Œ4}</p><h2 id="4-rep">4 rep</h2><p>æŒ‰è®¡æ•°å¯„å­˜å™¨ECXä¸­æŒ‡å®šçš„æ¬¡æ•°é‡å¤æ‰§è¡Œå­—ç¬¦ä¸²æŒ‡ä»¤</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">MOV</span> <span class="variable constant_">ECX</span>,<span class="number">10</span></span><br><span class="line"><span class="variable constant_">REP</span> <span class="variable constant_">MOVSD</span></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">REP</span> <span class="variable constant_">STOSD</span></span><br></pre></td></tr></table></figure><h2 id="5-add">5 add</h2><h3 id="5-1-æŒ‡ä»¤æ ¼å¼">5.1 æŒ‡ä»¤æ ¼å¼</h3><ol><li>ADD r/m8,imm8</li><li>ADD r/m16,imm16</li><li>ADD r/m32,imm32</li><li>ADD r/m16,imm8</li><li>ADD r/m32,imm8</li><li>ADD r/m8,r8</li><li>ADD r/m16,r16</li><li>ADD r/m32,r32</li><li>ADD r8,r/m8</li><li>ADD r16,r/m16</li><li>ADD r32,r/m32</li></ol><h2 id="6-sub">6 sub</h2><h3 id="6-1-æŒ‡ä»¤æ ¼å¼">6.1 æŒ‡ä»¤æ ¼å¼</h3><ol><li>SUB r/m8,imm8</li><li>SUB r/m16,imm16</li><li>SUB r/m32,imm32</li><li>SUB r/m16,imm8</li><li>SUB r/m32,imm8</li><li>SUB r/m8,r8</li><li>SUB r/m16,r16</li><li>SUB r/m32,r32</li><li>SUB r8,r/m8</li><li>SUB r16,r/m16</li><li>SUB r32,r/m32</li></ol><h2 id="7-and">7 and</h2><h3 id="7-1-æŒ‡ä»¤æ ¼å¼">7.1 æŒ‡ä»¤æ ¼å¼</h3><ol><li>AND r/m8,imm8</li><li>AND r/m16,imm16</li><li>AND r/m32,imm32</li><li>AND r/m16,imm8</li><li>AND r/m32,imm8</li><li>AND r/m8,r8</li><li>AND r/m16,r16</li><li>AND r/m32,r32</li><li>AND r8,r/m8</li><li>AND r16,r/m16</li><li>AND r32,r/m32</li></ol><h2 id="8-or">8 or</h2><h3 id="8-1-æŒ‡ä»¤æ ¼å¼">8.1 æŒ‡ä»¤æ ¼å¼</h3><ol><li>OR r/m8,imm8</li><li>OR r/m16,imm16</li><li>OR r/m32,imm32</li><li>OR r/m16,imm8</li><li>OR r/m32,imm8</li><li>OR r/m8,r8</li><li>OR r/m16,r16</li><li>OR r/m32,r32</li><li>OR r8,r/m8</li><li>OR r16,r/m16</li><li>OR r32,r/m32</li></ol><h2 id="9-not">9 not</h2><h3 id="9-1-åŠŸèƒ½">9.1 åŠŸèƒ½</h3><p>è¿›è¡Œå–åæ“ä½œ</p><h3 id="9-2-æŒ‡ä»¤æ ¼å¼">9.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>NOT r32</li><li>NOT r16</li><li>NOT m16</li><li>NOT m32</li></ol><h2 id="10-xor">10 xor</h2><h3 id="10-1-æŒ‡ä»¤æ ¼å¼">10.1 æŒ‡ä»¤æ ¼å¼</h3><ol><li>XOR r/m8,imm8</li><li>XOR r/m16,imm16</li><li>XOR r/m32,imm32</li><li>XOR r/m16,imm8</li><li>XOR r/m32,imm8</li><li>XOR r/m8,r8</li><li>XOR r/m16,r16</li><li>XOR r/m32,r32</li><li>XOR r8,r/m8</li><li>XOR r16,r/m16</li><li>XOR r32,r/m32</li></ol><h2 id="11-push">11 push</h2><h3 id="11-1-åŠŸèƒ½">11.1 åŠŸèƒ½</h3><ol><li>å‘å †æ ˆä¸­å‹å…¥æ•°æ®</li><li>ç„¶åä¿®æ”¹æ ˆé¡¶æŒ‡é’ˆESPå¯„å­˜å™¨åœ°å€ï¼Œçœ‹æ•°æ®ç±»å‹byte,word,dwordåˆ†åˆ«å¯¹åº”-1ï¼Œ-2ï¼Œ-4</li></ol><h3 id="11-2-æŒ‡ä»¤æ ¼å¼">11.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>PUSH r32</li><li>PUSH r16</li><li>PUSH m16</li><li>PUSH m32</li><li>PUSH imm8/imm16/imm32</li><li>PUSHADï¼ˆæŠŠ8ä¸ªé€šç”¨å¯„å­˜å™¨çš„å€¼å­˜å…¥å †æ ˆï¼‰</li></ol><h3 id="11-3-å…¶ä»–æ–¹å¼å®ç°è¯¥åŠŸèƒ½">11.3 å…¶ä»–æ–¹å¼å®ç°è¯¥åŠŸèƒ½</h3><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/tzdTVzkA9nSuhP3vM6p01729344068916.png" alt="image"></p><h2 id="12-pop">12 pop</h2><h3 id="12-1-åŠŸèƒ½">12.1 åŠŸèƒ½</h3><ol><li>å°†æ ˆé¡¶æ•°æ®å­˜å‚¨åˆ°å¯„å­˜å™¨/å†…å­˜</li><li>ä¿®æ”¹æ ˆé¡¶æŒ‡é’ˆESPå¯„å­˜å™¨åœ°å€ï¼Œçœ‹æ•°æ®ç±»å‹byte,word,dwordåˆ†åˆ«å¯¹åº”+1ï¼Œ+2ï¼Œ+4</li></ol><h3 id="12-2-æŒ‡ä»¤æ ¼å¼">12.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>POP r16</li><li>POP r32</li><li>POP m16</li><li>POP m32</li><li>POPAD ï¼ˆæŠŠå­˜å…¥å †æ ˆçš„8ä¸ªå¯„å­˜å™¨å€¼å¼¹å‡ºï¼Œæ¢å¤8ä¸ªå¯„å­˜å™¨çš„å€¼ï¼‰</li></ol><h3 id="12-3-å…¶ä»–æ–¹å¼å®ç°è¯¥åŠŸèƒ½">12.3 å…¶ä»–æ–¹å¼å®ç°è¯¥åŠŸèƒ½</h3><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/IDqXn7QaUsncKSoprbes1729344086548.png" alt="image"></p><h2 id="13-jmp">13 jmp</h2><h3 id="13-1-åŠŸèƒ½">13.1 åŠŸèƒ½</h3><ol><li>ä¿®æ”¹å¯„å­˜å™¨EIPçš„å€¼</li></ol><h3 id="13-2-æŒ‡ä»¤æ ¼å¼">13.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>JMP å¯„å­˜å™¨/ç«‹å³æ•°/å†…å­˜</li></ol><h2 id="14-call">14 call</h2><h3 id="14-1-åŠŸèƒ½">14.1 åŠŸèƒ½</h3><ol><li>PUSHå½“å‰callæŒ‡ä»¤çš„ä¸‹ä¸€è¡Œåœ°å€è¿›å…¥å †æ ˆ</li><li>å¾€EIPå†…å­˜å…¥ç«‹å³æ•°/å¯„å­˜å™¨/å†…å­˜    ç®€å†™ï¼šjmp ç«‹å³æ•°/å¯„å­˜å™¨/å†…å­˜</li></ol><p>ğŸ’¡ ä¸JMPå”¯ä¸€çš„åŒºåˆ«ï¼šåœ¨å †æ ˆä¸­å­˜å‚¨callæŒ‡ä»¤ä¸‹ä¸€è¡Œå†…å­˜åœ°å€</p><h3 id="14-2-æŒ‡ä»¤æ ¼å¼">14.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>CALL ç«‹å³æ•°/å¯„å­˜å™¨/å†…å­˜</li></ol><h2 id="15-ret">15 ret</h2><h3 id="15-1-åŠŸèƒ½">15.1 åŠŸèƒ½</h3><ol><li>å°†å½“å‰æ ˆé¡¶æ•°æ®å€¼å­˜å…¥EIP      ADD ESP,4</li><li>ç„¶åå½“å‰æ ˆé¡¶æŒ‡é’ˆ+4ï¼Œèµ‹å€¼ç»™ESP    MOV EIP,[ESP-4]</li></ol><h3 id="15-2-æŒ‡ä»¤æ ¼å¼">15.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>RET</li></ol><h2 id="16-CMP">16 CMP</h2><h3 id="16-1-åŠŸèƒ½">16.1 åŠŸèƒ½</h3><p>è¯¥æŒ‡ä»¤æ˜¯æ¯”è¾ƒä¸¤ä¸ªæ“ä½œæ•°ã€‚</p><p>å®é™…ä¸Šï¼Œå®ƒç›¸å½“äºSUBæŒ‡ä»¤ï¼Œä½†æ˜¯ç›¸å‡çš„è®°è¿‡å¹¶ä¸ä¿å­˜åˆ°ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸­ã€‚</p><p>åªæ˜¯æ ¹æ®ç›¸å‡çš„ç»“æœæ¥æ”¹å˜é›¶æ ‡å¿—ä½çš„,å½“ä¸¤ä¸ªæ“ä½œæ•°ç›¸ç­‰çš„æ—¶å€™,é›¶æ ‡å¿—ä½ç½®1ã€‚</p><h3 id="16-2-æŒ‡ä»¤æ ¼å¼">16.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>CMP R/M,R/M/IMM</li></ol><h2 id="17-TEST">17 TEST</h2><h3 id="17-1-åŠŸèƒ½">17.1 åŠŸèƒ½</h3><p>TESTæŒ‡ä»¤ç›¸å½“äºANDæŒ‡ä»¤ï¼Œåªä¸è¿‡ä¸çš„ç»“æœå¹¶ä¸ä¿å­˜åˆ°ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸­ã€‚</p><p>è¯¥æŒ‡ä»¤åœ¨ä¸€å®šç¨‹åºä¸Šå’ŒCMPæŒ‡ä»¤æ—¶ç±»ä¼¼çš„,ä¸¤ä¸ªæ•°å€¼è¿›è¡ŒANDæ“ä½œ,ç»“æœä¸ä¿å­˜,ä½†æ˜¯ä¼šæ”¹å˜ç›¸åº”æ ‡å¿—ä½.</p><h3 id="17-2-æŒ‡ä»¤æ ¼å¼">17.2 æŒ‡ä»¤æ ¼å¼</h3><p>TEST r/m,r/m/imm</p><h2 id="18-ADC">18 ADC</h2><h3 id="18-1-åŠŸèƒ½">18.1 åŠŸèƒ½</h3><p>å¸¦è¿›ä½åŠ æ³•ï¼Œä¸¤è¾¹ä¸èƒ½åŒæ—¶ä¸ºå†…å­˜ å®½åº¦è¦ä¸€æ ·</p><h3 id="18-2-æŒ‡ä»¤æ ¼å¼">18.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>ADC r/m,r/m/imm</li></ol><h2 id="19-SBB">19 SBB</h2><h3 id="19-1-åŠŸèƒ½">19.1 åŠŸèƒ½</h3><p>å¸¦å€Ÿä½å‡æ³•ï¼Œä¸¤è¾¹ä¸èƒ½åŒæ—¶ä¸ºå†…å­˜ å®½åº¦è¦ä¸€æ ·</p><h3 id="19-2-æŒ‡ä»¤æ ¼å¼">19.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>SBB r/m,r/m</li></ol><h2 id="20-XCHG">20 XCHG</h2><h3 id="20-1-åŠŸèƒ½">20.1 åŠŸèƒ½</h3><p>äº¤æ¢æ•°æ®ï¼Œä¸¤è¾¹ä¸èƒ½åŒæ—¶ä¸ºå†…å­˜ å®½åº¦è¦ä¸€æ ·</p><h3 id="20-2-æŒ‡ä»¤æ ¼å¼">20.2 æŒ‡ä»¤æ ¼å¼</h3><ol><li>XCHG r/m,r/m</li></ol><h2 id="21-ç®—æœ¯ä½ç§»æŒ‡ä»¤">21 ç®—æœ¯ä½ç§»æŒ‡ä»¤</h2><h3 id="21-1-SALï¼ˆç®—æœ¯å·¦ç§»ï¼‰">21.1 SALï¼ˆç®—æœ¯å·¦ç§»ï¼‰</h3><p>SAR Reg/Mem, CL/Imm</p><h3 id="21-2-SARï¼ˆç®—æœ¯å³ç§»ï¼‰">21.2 SARï¼ˆç®—æœ¯å³ç§»ï¼‰</h3><p>SAR Reg/Mem, CL/Imm</p><p>æ³¨æ„ï¼šç®—æœ¯å³ç§»æ—¶å€™è¡¥æœ€é«˜ä½ç¬¦å·ä½ï¼Œæ˜¯1è¡¥1ï¼Œæ˜¯0è¡¥0</p><h2 id="22-é€»è¾‘ç§»ä½æŒ‡ä»¤">22 é€»è¾‘ç§»ä½æŒ‡ä»¤</h2><p>æ³¨æ„ï¼šä¸ç®¡æ˜¯å·¦ç§»è¿˜æ˜¯å³ç§»éƒ½æ˜¯è¡¥0</p><h3 id="22-1-SHLï¼ˆé€»è¾‘å·¦ç§»ï¼‰">22.1 SHLï¼ˆé€»è¾‘å·¦ç§»ï¼‰</h3><p>SHL Reg/Mem, CL/Imm</p><h3 id="22-2-SHRï¼ˆé€»è¾‘å³ç§»ï¼‰">22.2 SHRï¼ˆé€»è¾‘å³ç§»ï¼‰</h3><p>SHR Reg/Mem, CL/Imm</p><h2 id="23-å¾ªç¯ç§»ä½æŒ‡ä»¤">23 å¾ªç¯ç§»ä½æŒ‡ä»¤</h2><h3 id="23-1-ROLï¼ˆå¾ªç¯å·¦ç§»ï¼‰">23.1 ROLï¼ˆå¾ªç¯å·¦ç§»ï¼‰</h3><p>ROL r/m, i8</p><p>æœ€ä½ä½æ˜¯1åˆ™è¡¥1ï¼Œæœ€ä½ä½æ˜¯0åˆ™è¡¥0</p><h3 id="23-2-RORï¼ˆå¾ªç¯å³ç§»ï¼‰">23.2 RORï¼ˆå¾ªç¯å³ç§»ï¼‰</h3><p>ROR r/m, CL</p><p>æœ€é«˜ä½æ˜¯1åˆ™è¡¥1ï¼Œæœ€é«˜ä½æ˜¯0åˆ™è¡¥0</p><h2 id="24-å¸¦è¿›ä½çš„å¾ªç¯ç§»ä½æŒ‡ä»¤">24 å¸¦è¿›ä½çš„å¾ªç¯ç§»ä½æŒ‡ä»¤</h2><p>CFä½æ˜¯1åˆ™è¡¥1ï¼Œåä¹‹åˆ™è¡¥0</p><h3 id="24-1-RCLï¼ˆå¸¦è¿›ä½å¾ªç¯å·¦ç§»ï¼‰">24.1 RCLï¼ˆå¸¦è¿›ä½å¾ªç¯å·¦ç§»ï¼‰</h3><p>RCL r/m, i8</p><h3 id="24-2-RCRï¼ˆå¸¦è¿›ä½å¾ªç¯å³ç§»ï¼‰">24.2 RCRï¼ˆå¸¦è¿›ä½å¾ªç¯å³ç§»ï¼‰</h3><p>RCR r/m, CL</p><h1>äºŒã€å­˜å‚¨æ¨¡å¼</h1><p>å¤§ç«¯æ¨¡å¼ï¼šæ•°æ®é«˜ä½åœ¨ä½ä½ï¼Œæ•°æ®ä½ä½åœ¨é«˜ä½</p><p>å°ç«¯æ¨¡å¼ï¼šæ•°æ®é«˜ä½åœ¨é«˜ä½ï¼Œæ•°æ®ä½ä½åœ¨ä½ä½</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/FA7VNMp2h04dlYk2uiOY1729344094077.png" alt="image"></p><h1>ä¸‰ JCC</h1><h2 id="1-æ ‡å¿—å¯„å­˜å™¨-EFLAGS">1 æ ‡å¿—å¯„å­˜å™¨ EFLAGS</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/2jddoYVTheo4vVBfG6Pe1729344096976.png" alt="image"></p><h2 id="2-CFï¼ˆbit-0ï¼‰-Carry-flag">2 CFï¼ˆbit 0ï¼‰[Carry flag]</h2><h3 id="2-1-åŠŸèƒ½">2.1 åŠŸèƒ½</h3><p>è‹¥ç®—æœ¯æ“ä½œäº§ç”Ÿçš„ç»“æœåœ¨æœ€é«˜æœ‰æ•ˆä½å‘ç”Ÿè¿›ä½æˆ–è€…å€Ÿä½åˆ™å°†å…¶ç½®1ï¼Œåä¹‹æ¸…é›¶ã€‚è¿™ä¸ªæ ‡å¿—é€šå¸¸ç”¨æ¥åªæ˜¯æ— ç¬¦å·æ•´å‹è¿ç®—çš„æº¢å‡ºçŠ¶æ€ã€‚</p><p>ğŸ‘‰ æœ‰ç¬¦å·è¿ç®—çœ‹Oä½ï¼Œæ— ç¬¦å·è¿ç®—çœ‹Cä½</p><h3 id="2-2-ä¾‹å­">2.2 ä¾‹å­</h3><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/PwH0TLISl2GN2FgrYHIw1729344103144.png" alt="image"></p><h2 id="3-PF-ï¼ˆbit-2ï¼‰-parity-flag">3 PF ï¼ˆbit 2ï¼‰[parity flag]</h2><h3 id="3-1-åŠŸèƒ½">3.1 åŠŸèƒ½</h3><p>å¦‚æœç»“æœçš„æœ€ä½æœ‰æ•ˆå­—èŠ‚åŒ…å«å¶æ•°ä¸ª1ä½ï¼Œåˆ™è¯¥ä½ç½®1ï¼Œå¦åˆ™æ¸…é›¶ã€‚</p><p>åˆ©ç”¨PFè¯¾è¿›è¡Œå¥‡å¶æ ¡éªŒæ£€æŸ¥ï¼š</p><p>éœ€è¦ä¼ è¾“â€œ11001110â€ï¼Œæ•°æ®ä¸­å«æœ‰5ä¸ªâ€œ1â€ï¼Œæ‰€ä»¥å…¶å¥‡æ ¡éªŒä½ä¸ºâ€œ0â€ï¼ŒåŒæ—¶æŠŠâ€œ110011100â€æ•°æ®ä¼ è¾“ç»™æ¥æ”¶æ–¹ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®æ—¶åå†ä¸€æ¬¡è®¡ç®—å¥‡å¶æ€§ï¼Œâ€œ110011100â€ä¸­ä»ç„¶å«æœ‰5ä¸ªâ€œ1â€ï¼Œæ‰€ä»¥æ¥æ”¶æ–¹è®¡ç®—å‡ºçš„å¥‡æ ¡éªŒä½è¿˜æ˜¯â€œ0â€ï¼Œä¸å‘é€æ–¹ä¸€è‡´ï¼Œè¡¨ç¤ºåœ¨æ­¤æ¬¡ä¼ è¾“è¿‡ç¨‹ä¸­æœªå‘ç”Ÿé”™è¯¯</p><h2 id="4-AFï¼ˆbit-4ï¼‰-Auxiliary-carry-flag">4 AFï¼ˆbit 4ï¼‰[Auxiliary carry flag]</h2><h3 id="4-1-åŠŸèƒ½">4.1 åŠŸèƒ½</h3><ol><li>åœ¨å­—æ“ä½œæ—¶ï¼Œå‘ç”Ÿä½å­—èŠ‚å‘é«˜å­—èŠ‚è¿›ä½æˆ–å€Ÿä½æ—¶ï¼›</li><li>åœ¨å­—èŠ‚æ“ä½œæ—¶ï¼Œå‘ç”Ÿä½å››ä½å‘é«˜å››ä½è¿›ä½æˆ–å€Ÿä½æ—¶ã€‚</li></ol><p>è¾…åŠ©è¿›ä½æ ‡å¿—AFçš„å€¼è¢«ç½®ä¸º1ï¼Œå¦åˆ™å…¶å€¼ä¸º0ï¼š</p><h2 id="5-ZFï¼ˆbit-6ï¼‰-zero-flag">5 ZFï¼ˆbit 6ï¼‰[zero flag]</h2><h3 id="5-1-åŠŸèƒ½">5.1 åŠŸèƒ½</h3><p>é›¶æ ‡å¿—ZFç”¨æ¥åæ˜ è¿ç®—ç»“æœæ˜¯å¦ä¸º0ã€‚</p><p>è‹¥ç»“æœä¸º0ï¼Œåˆ™å°†å…¶ç½®1ï¼Œåä¹‹æ¸…é›¶</p><p>ç»å¸¸ä¸CMPæˆ–è€…TESTç­‰æŒ‡ä»¤ä¸€èµ·ä½¿ç”¨</p><h2 id="6-SFï¼ˆbit-7ï¼‰-Sign-flag">6 SFï¼ˆbit 7ï¼‰[Sign flag]</h2><h3 id="6-1-åŠŸèƒ½">6.1 åŠŸèƒ½</h3><p>è¯¥æ ‡å¿—è¢«è®¾ç½®ä¸ºæœ‰ç¬¦å·æ•´å‹çš„æœ€é«˜æœ‰æ•ˆä½</p><p>0æŒ‡ç¤ºç»“æœä¸ºæ­£ï¼Œåä¹‹åˆ™ä¸ºè´Ÿ</p><h2 id="7-OFï¼ˆbit-11ï¼‰-OverFlow-flag">7 OFï¼ˆbit 11ï¼‰[OverFlow flag]</h2><h3 id="7-1-åŠŸèƒ½">7.1 åŠŸèƒ½</h3><p>ä¸€å¤„æ ‡å¿—OFç”¨äºåæ˜ æœ‰ç¬¦å·æ•°åŠ å‡è¿ç®—æ‰€å¾—ç»“æœæ˜¯å¦æº¢å‡ºã€‚</p><p>å¦‚æœæ˜¯æ— ç¬¦å·æ•°è¿ç®—ï¼Œæ˜¯å¦æº¢å‡ºçœ‹CFä½ã€‚</p><p>å¦‚æœæ˜¯æœ‰ç¬¦å·æ•°è¿ç®—ï¼Œæ˜¯å¦æº¢å‡ºçœ‹OFä½ã€‚</p><h2 id="8-DFï¼ˆbit-10ï¼‰-Oirection-flag">8 DFï¼ˆbit 10ï¼‰[Oirection flag]</h2><h3 id="8-1-åŠŸèƒ½">8.1 åŠŸèƒ½</h3><p>è¿™ä¸ªæ–¹å‘æ ‡å¿—æ§åˆ¶ä¸²æŒ‡ä»¤ï¼ˆMOVS,CMPS,SCAS,LODSä»¥åŠSTOSï¼‰è®¾ç½®DFæ ‡å¿—æ˜¯çš„ä¸²æŒ‡ä»¤è‡ªåŠ¨é€’å‡ï¼ˆä»é«˜åœ°å€å‘ä½åœ°å€æ–¹å‘å¤„ç†å­—ç¬¦ä¸²ï¼‰ï¼Œæ¸…æ¥šè¯¥æ ‡å¿—åˆ™ä½¿å¾—æŒ‡ä»¤è‡ªåŠ¨é€’å¢</p><p>STDä»¥åŠCLDæŒ‡ä»¤åˆ†åˆ«ç”¨äºè®¾ç½®ä»¥åŠæ¸…æ¥šDFæ ‡å¿—</p><h2 id="9-JCCæŒ‡ä»¤">9 JCCæŒ‡ä»¤</h2><table><thead><tr><th>Index</th><th>JCCæŒ‡ä»¤</th><th>è¯´æ˜</th><th>EFLAGS</th></tr></thead><tbody><tr><td>1</td><td>JE,ï¼ŒJZ</td><td>ç»“æœä¸ºé›¶åˆ™è·³è½¬(ç›¸ç­‰æ—¶è·³è½¬)</td><td>ZF=1</td></tr><tr><td>2</td><td>JNEï¼ŒJNZ</td><td>ç»“æœä¸ä¸ºé›¶åˆ™è·³è½¬(ä¸ç›¸ç­‰æ—¶è·³è½¬)</td><td>ZF=0</td></tr><tr><td>3</td><td>JS</td><td>ç»“æœä¸ºè´Ÿåˆ™è·³è½¬</td><td>SF=1</td></tr><tr><td>4</td><td>JNS</td><td>ç»“æœä¸ºéè´Ÿåˆ™è·³è½¬</td><td>SF=0</td></tr><tr><td>5</td><td>JPï¼ŒJPE</td><td>ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬</td><td>PF=1</td></tr><tr><td>6</td><td>JNPï¼ŒJPO</td><td>ç»“æœä¸­1çš„ä¸ªæ•°ä¸ºå¶æ•°åˆ™è·³è½¬</td><td>PF=0</td></tr><tr><td>7</td><td>JO</td><td>ç»“æœæº¢å‡ºäº†åˆ™è·³è½¬</td><td>OF=1</td></tr><tr><td>8</td><td>JNO</td><td>ç»“æœæ²¡æœ‰æº¢å‡ºåˆ™è·³è½¬</td><td>OF=0</td></tr><tr><td>9</td><td>JBï¼ŒJNAE</td><td>å°äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°)</td><td>CF=1</td></tr><tr><td>10</td><td>JNBï¼ŒJAE</td><td>å¤§äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°)</td><td>CF=0</td></tr><tr><td>11</td><td>JBEï¼ŒJNA</td><td>å°äºç­‰äºåˆ™è·³è½¬ (æ— ç¬¦å·æ•°)</td><td>CF=1 or ZF=1</td></tr><tr><td>12</td><td>JNBEï¼ŒJA</td><td>å¤§äºåˆ™è·³è½¬(æ— ç¬¦å·æ•°)</td><td>CF=0 and ZF=0</td></tr><tr><td>13</td><td>JLï¼ŒJNGE</td><td>å°äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°)</td><td>SFâ‰  OF</td></tr><tr><td>14</td><td>JNLï¼ŒJGE</td><td>å¤§äºç­‰äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°)</td><td>SF=OF</td></tr><tr><td>15</td><td>JLEï¼ŒJNG</td><td>å°äºç­‰äºåˆ™è·³è½¬ (æœ‰ç¬¦å·æ•°)</td><td>ZF=1 or SFâ‰  OF</td></tr><tr><td>16</td><td>JNLEï¼ŒJG</td><td>å¤§äºåˆ™è·³è½¬(æœ‰ç¬¦å·æ•°)</td><td>ZF=0 and SF=OF</td></tr></tbody></table><p>ğŸ‘‰ åœ¨ä»»ä½•è¿ç®—ä¹‹å‰å¾—å…ˆç¡®å®šæ—¶æœ‰ç¬¦å·è¿ç®—è¿˜æ˜¯æ— ç¬¦å·è¿ç®—</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/EXei6gcBRwac3PrdL7l31729344109884.png" alt="image"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;æ±‡ç¼–&lt;/h1&gt;
&lt;h1&gt;ä¸€ã€æŒ‡ä»¤&lt;/h1&gt;
&lt;h2 id=&quot;1-mov&quot;&gt;1 mov&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ç«‹å³æ•°åˆ°å†…å­˜ï¼Œå¯„å­˜å™¨åˆ°å†…å­˜ã€‚å†…å­˜åˆ°å¯„å­˜å™¨&lt;/p&gt;
&lt;h3 id=&quot;1-1-movæŒ‡ä»¤æ“ä½œçš„å››ç§å½¢å¼&quot;&gt;1.1 movæŒ‡ä»¤æ“ä½œçš„å››ç§å½¢å¼&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;[</summary>
      
    
    
    
    <category term="Language" scheme="https://gbk.cx/categories/Language/"/>
    
    
    <category term="Assembly" scheme="https://gbk.cx/tags/Assembly/"/>
    
  </entry>
  
  <entry>
    <title>shellcodeç¼–å†™</title>
    <link href="https://gbk.cx/p/22672422/"/>
    <id>https://gbk.cx/p/22672422/</id>
    <published>2024-10-08T05:52:29.000Z</published>
    <updated>2024-10-19T13:34:09.013Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯ShellCodeï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ShellCodeï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ShellCodeï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ShellCodeï¼Ÿ</h1><p>ä¸ä¾èµ–ç¯å¢ƒï¼Œæ”¾åˆ°ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥æ‰§è¡Œçš„æœºå™¨ç </p><h1 id="shellcodeç¼–å†™åŸåˆ™"><a href="#shellcodeç¼–å†™åŸåˆ™" class="headerlink" title="shellcodeç¼–å†™åŸåˆ™"></a>shellcodeç¼–å†™åŸåˆ™</h1><ol><li>ä¸èƒ½æœ‰å…¨å±€å˜é‡</li><li>ä¸èƒ½ä½¿ç”¨å¸¸é‡å­—ç¬¦ä¸²</li><li>ä¸èƒ½ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨</li><li>ä¸èƒ½åµŒå¥—è°ƒç”¨å…¶ä»–å‡½æ•°</li></ol><h1 id="æ¡ˆä¾‹æ€è·¯"><a href="#æ¡ˆä¾‹æ€è·¯" class="headerlink" title="æ¡ˆä¾‹æ€è·¯"></a>æ¡ˆä¾‹æ€è·¯</h1><p>é€šè¿‡TEBç»“æ„ä½“æŸ¥æ‰¾PEBï¼Œç„¶ååœ¨PEBä¸­æ‰¾åˆ°<strong>_PEB_LDR_DATA</strong>ï¼Œå†ä»<strong>_PEB_LDR_DATA</strong>ä¸­æ‰¾åˆ°<strong>InLoadOrderModuleList</strong>ï¼Œè¿™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨å†…å­˜å‚¨çš„æ˜¯æœ‰å…³æ‰€æœ‰åŠ è½½dllçš„ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªç»“æ„æ¥è¿›è¡Œæ–­é“¾dlléšè—ï¼Œ<strong>_LDR_DATA_TABLE_ENTRY</strong>è¿™æ˜¯é“¾è¡¨é‡Œçš„nodeçš„ç»“æ„ä½“ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éå†æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°çš„dllï¼Œæ‹¿åˆ°DllBaseï¼Œä¹‹åé€šè¿‡PEçš„çŸ¥è¯†è§£æï¼Œä»ä¸­æ‰¾åˆ°å¯¼å‡ºè¡¨ï¼Œä»å¯¼å‡ºè¡¨ä¸­æ‹¿åˆ°<strong>GetProcAddress</strong>å’Œ<strong>LoadLibraryA</strong>å‡½æ•°ï¼Œä¹‹åå°±å¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªå‡½æ•°è¿›è¡ŒåŠ è½½dllå’Œä½¿ç”¨dllä¸­çš„å‡½æ•°ã€‚</p><p>å…¶ä¸­æœ‰å…³<strong>_LDR_DATA_TABLE_ENTRY</strong>ç»“æ„ä½“å†…å®¹å¦‚ä¸‹ï¼Œå¯ä»¥å‚è€ƒçœ‹çœ‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0x50 bytes (sizeof)</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">_LDR_DATA_TABLE_ENTRY</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_LIST_ENTRY</span> InLoadOrderLinks;                                    <span class="comment">//0x0</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_LIST_ENTRY</span> InMemoryOrderLinks;                                  <span class="comment">//0x8</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_LIST_ENTRY</span> InInitializationOrderLinks;                          <span class="comment">//0x10</span></span><br><span class="line">    VOID* DllBase;                                                          <span class="comment">//0x18</span></span><br><span class="line">    VOID* EntryPoint;                                                       <span class="comment">//0x1c</span></span><br><span class="line">    ULONG SizeOfImage;                                                      <span class="comment">//0x20</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_UNICODE_STRING</span> FullDllName;                                     <span class="comment">//0x24</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">_UNICODE_STRING</span> BaseDllName;                                     <span class="comment">//0x2c</span></span><br><span class="line">    ULONG Flags;                                                            <span class="comment">//0x34</span></span><br><span class="line">    USHORT LoadCount;                                                       <span class="comment">//0x38</span></span><br><span class="line">    USHORT TlsIndex;                                                        <span class="comment">//0x3a</span></span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">_LIST_ENTRY</span> HashLinks;                                       <span class="comment">//0x3c</span></span><br><span class="line">        <span class="keyword">struct</span></span><br><span class="line">        &#123;</span><br><span class="line">            VOID* SectionPointer;                                           <span class="comment">//0x3c</span></span><br><span class="line">            ULONG CheckSum;                                                 <span class="comment">//0x40</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">        ULONG TimeDateStamp;                                                <span class="comment">//0x44</span></span><br><span class="line">        VOID* LoadedImports;                                                <span class="comment">//0x44</span></span><br><span class="line">    &#125;;</span><br><span class="line">    VOID* EntryPointActivationContext;                                      <span class="comment">//0x48</span></span><br><span class="line">    VOID* PatchInformation;                                                 <span class="comment">//0x4c</span></span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure><h1 id="å®ä¾‹ä»£ç "><a href="#å®ä¾‹ä»£ç " class="headerlink" title="å®ä¾‹ä»£ç "></a>å®ä¾‹ä»£ç </h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo08shellcode.cpp : Defines the entry point for the console application.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="comment">//function</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">FARPROC</span> <span class="params">(WINAPI *GETPROCADDRESS)</span><span class="params">(HMODULE hModule,LPCSTR lpProcName)</span>; </span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">int</span> <span class="params">(WINAPI *MESSAGEBOXA)</span><span class="params">(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType)</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">HMODULE</span> <span class="params">(WINAPI *LOADLIBRARYA)</span><span class="params">(LPCSTR lpLibFileName)</span>;</span><br><span class="line"></span><br><span class="line">GETPROCADDRESS PGETPROCADDRESS;</span><br><span class="line">MESSAGEBOXA PMESSAGEBOX;</span><br><span class="line">LOADLIBRARYA PLOADLIBRARY;</span><br><span class="line"></span><br><span class="line"><span class="comment">//struct</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">UNICODE_STRING</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    USHORT Length;                                                          <span class="comment">//0x0</span></span><br><span class="line">    USHORT MaximumLength;                                                   <span class="comment">//0x2</span></span><br><span class="line">    PWSTR Buffer;                                                         <span class="comment">//0x4</span></span><br><span class="line">&#125;UNICODE_STRING;</span><br><span class="line"><span class="comment">//0x0 bytes (sizeof)</span></span><br><span class="line"><span class="comment">//0x28 bytes (sizeof)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">PEB_LDR_DATA</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DWORD Length;                                                           <span class="comment">//0x0</span></span><br><span class="line">    BYTE Initialized;                                                      <span class="comment">//0x4</span></span><br><span class="line">    VOID* SsHandle;                                                         <span class="comment">//0x8</span></span><br><span class="line">    LIST_ENTRY InLoadOrderModuleList;                               <span class="comment">//0xc</span></span><br><span class="line">    LIST_ENTRY InMemoryOrderModuleList;                             <span class="comment">//0x14</span></span><br><span class="line">    LIST_ENTRY InInitializationOrderModuleList;                     <span class="comment">//0x1c</span></span><br><span class="line">    VOID* EntryInProgress;                                                  <span class="comment">//0x24</span></span><br><span class="line">&#125;PEB_LDR_DATA; </span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">LDR_DATA_TABLE_ENTRY</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    LIST_ENTRY InLoadOrderLinks;                                    <span class="comment">//0x0</span></span><br><span class="line">    LIST_ENTRY InMemoryOrderLinks;                                  <span class="comment">//0x8</span></span><br><span class="line">    LIST_ENTRY InInitializationOrderLinks;                          <span class="comment">//0x10</span></span><br><span class="line">    VOID* DllBase;                                                          <span class="comment">//0x18</span></span><br><span class="line">    VOID* EntryPoint;                                                       <span class="comment">//0x1c</span></span><br><span class="line">    DWORD SizeOfImage;                                                      <span class="comment">//0x20</span></span><br><span class="line">    UNICODE_STRING FullDllName;                                     <span class="comment">//0x24</span></span><br><span class="line">    UNICODE_STRING BaseDllName;                                     <span class="comment">//0x2c</span></span><br><span class="line">    DWORD Flags;                                                            <span class="comment">//0x34</span></span><br><span class="line">    WORD LoadCount;                                                       <span class="comment">//0x38</span></span><br><span class="line">    WORD TlsIndex;                                                        <span class="comment">//0x3a</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        LIST_ENTRY HashLinks;                                       <span class="comment">//0x3c</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">            VOID* SectionPointer;                                           <span class="comment">//0x3c</span></span><br><span class="line">            DWORD CheckSum;                                                 <span class="comment">//0x40</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        DWORD TimeDateStamp;                                                <span class="comment">//0x44</span></span><br><span class="line">        VOID* LoadedImports;                                                <span class="comment">//0x44</span></span><br><span class="line">    &#125;;</span><br><span class="line">    VOID* EntryPointActivationContext;                <span class="comment">//0x48</span></span><br><span class="line">    VOID* PatchInformation;                                                 <span class="comment">//0x4c</span></span><br><span class="line">&#125;LDR_DATA_TABLE_ENTRY; </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">strcmp</span><span class="params">(<span class="type">char</span>* buf1,<span class="type">char</span>* buf2)</span>&#123;</span><br><span class="line"><span class="keyword">while</span>(*buf1 &amp;&amp; *buf2 &amp;&amp; *buf1 == *buf2)&#123;</span><br><span class="line">buf1++;</span><br><span class="line">buf2++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (*buf1 == *buf2)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">ToShellcode</span><span class="params">()</span>&#123;</span><br><span class="line">LDR_DATA_TABLE_ENTRY *pPLD = <span class="literal">NULL</span>,*pBeg = <span class="literal">NULL</span>;</span><br><span class="line">PGETPROCADDRESS = <span class="literal">NULL</span>;</span><br><span class="line">PLOADLIBRARY = <span class="literal">NULL</span>;</span><br><span class="line">PMESSAGEBOX = <span class="literal">NULL</span>;</span><br><span class="line">WORD *pFirst = <span class="literal">NULL</span>,*pLast = <span class="literal">NULL</span>;</span><br><span class="line">DWORD ret = <span class="number">0</span>,i=<span class="number">0</span>;</span><br><span class="line">DWORD dwKernelBase = <span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> szKerner32[] = &#123;<span class="string">&#x27;k&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;e&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;r&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;n&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;e&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;l&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;3&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;2&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;.&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;d&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;l&#x27;</span>,<span class="number">0</span>,<span class="string">&#x27;l&#x27;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">char</span> szUser32[] = &#123;<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> szGetProAddress[] = &#123;<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;P&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">char</span> szLoadLibrary[] = &#123;<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">char</span> szMessageBox[] = &#123;<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">char</span> lpText[] = &#123;<span class="number">0xD7</span>,<span class="number">0xA2</span>,<span class="number">0xC8</span>,<span class="number">0xEB</span>,<span class="number">0xB3</span>,<span class="number">0xC9</span>,<span class="number">0xB9</span>,<span class="number">0xA6</span>,<span class="number">0x00</span>&#125;;</span><br><span class="line"><span class="type">char</span> lpCaption[]= &#123;<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">__asm&#123;</span><br><span class="line">mov eax,fs:[<span class="number">0x30</span>] <span class="comment">//PEB</span></span><br><span class="line">mov eax,[eax+<span class="number">0xc</span>] <span class="comment">//PEB-&gt;Ldr</span></span><br><span class="line">add eax,<span class="number">0x0c</span> <span class="comment">//LDR_DATA_TABLE_ENTRY InLoadOrderModuleList</span></span><br><span class="line">mov pBeg,eax</span><br><span class="line">mov eax,[eax]</span><br><span class="line">mov pPLD,eax</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">if (strcmp(szMessageBox,name))</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">printf(&quot;%d:--%s--%x\n&quot;,t+1,name,funAddress);</span></span><br><span class="line"><span class="comment">PMESSAGEBOX = (MESSAGEBOX)funAddress;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="comment">//kernel32.dll</span></span><br><span class="line"><span class="keyword">while</span> (pPLD != pBeg)</span><br><span class="line">&#123;</span><br><span class="line">pLast = (WORD*)pPLD-&gt;BaseDllName.Buffer;</span><br><span class="line">pFirst = (WORD*)szKerner32;</span><br><span class="line"><span class="keyword">while</span>(!pLast &amp;&amp; *pLast == *pFirst)&#123;</span><br><span class="line">pLast++;</span><br><span class="line">pFirst++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (*pLast == *pFirst)</span><br><span class="line">&#123;</span><br><span class="line">dwKernelBase = (DWORD)pPLD-&gt;DllBase;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pPLD = (LDR_DATA_TABLE_ENTRY*)pPLD-&gt;InLoadOrderLinks.Flink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)dwKernelBase;</span><br><span class="line">PIMAGE_NT_HEADERS pNTHeader = (PIMAGE_NT_HEADERS)((DWORD)pDosHeader + pDosHeader-&gt;e_lfanew);</span><br><span class="line">PIMAGE_FILE_HEADER pPEHeader = (PIMAGE_FILE_HEADER)((DWORD)pNTHeader + <span class="number">4</span>);</span><br><span class="line">PIMAGE_OPTIONAL_HEADER32 pOptionHeader = (PIMAGE_OPTIONAL_HEADER32)((DWORD)pPEHeader + IMAGE_SIZEOF_FILE_HEADER);</span><br><span class="line">DWORD dataDirectorySize = <span class="keyword">sizeof</span>(pOptionHeader-&gt;DataDirectory) / <span class="keyword">sizeof</span>(IMAGE_DATA_DIRECTORY);</span><br><span class="line">PIMAGE_DATA_DIRECTORY pDataDirectory = (PIMAGE_DATA_DIRECTORY)pOptionHeader-&gt;DataDirectory;</span><br><span class="line">PIMAGE_EXPORT_DIRECTORY pExportTable = (PIMAGE_EXPORT_DIRECTORY)(dwKernelBase + pDataDirectory-&gt;VirtualAddress);</span><br><span class="line">LPVOID funNameBase = (LPVOID)(dwKernelBase + pExportTable-&gt;AddressOfNames);</span><br><span class="line">LPVOID funAddressBase = (LPVOID)(dwKernelBase + pExportTable-&gt;AddressOfFunctions);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (DWORD t = <span class="number">0</span>;t&lt;pExportTable-&gt;NumberOfNames;t++)</span><br><span class="line">&#123;</span><br><span class="line">DWORD funAddress = dwKernelBase + *(PDWORD)((DWORD)funAddressBase+(t*<span class="number">4</span>));</span><br><span class="line"><span class="type">char</span>* name = (<span class="type">char</span>*)(dwKernelBase + *(PDWORD)((DWORD)funNameBase+(t*<span class="number">4</span>)));</span><br><span class="line"><span class="comment">//printf(&quot;name:%s\n&quot;,name);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">strcmp</span>(szGetProAddress,name))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d:--%s--%x\n&quot;</span>,t+<span class="number">1</span>,name,funAddress);</span><br><span class="line">PGETPROCADDRESS = (GETPROCADDRESS)funAddress;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(szLoadLibrary,name))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d:--%s--%x\n&quot;</span>,t+<span class="number">1</span>,name,funAddress);</span><br><span class="line">PLOADLIBRARY = (LOADLIBRARYA)funAddress;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//getchar();</span></span><br><span class="line">HMODULE hmodule = PLOADLIBRARY((LPCSTR)szUser32);</span><br><span class="line">PMESSAGEBOX = (MESSAGEBOXA)PGETPROCADDRESS(hmodule,szMessageBox);</span><br><span class="line">PMESSAGEBOX(<span class="number">0</span>,lpText,lpCaption,MB_OK);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">ToShellcode();</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello World!\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä»€ä¹ˆæ˜¯ShellCodeï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯ShellCodeï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯ShellCodeï¼Ÿ&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯ShellCodeï¼Ÿ&lt;/h1&gt;&lt;p&gt;ä¸ä¾èµ–ç¯å¢ƒï¼Œæ”¾åˆ°ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥æ‰§è¡Œçš„æœºå™¨ç &lt;/p&gt;
</summary>
      
    
    
    
    <category term="é€†å‘" scheme="https://gbk.cx/categories/%E9%80%86%E5%90%91/"/>
    
    
    <category term="shellcode" scheme="https://gbk.cx/tags/shellcode/"/>
    
  </entry>
  
  <entry>
    <title>ä¿æŠ¤æ¨¡å¼</title>
    <link href="https://gbk.cx/p/6c15571f/"/>
    <id>https://gbk.cx/p/6c15571f/</id>
    <published>2024-09-26T14:05:55.000Z</published>
    <updated>2024-10-19T03:27:23.321Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¿æŠ¤æ¨¡å¼ä»‹ç»"><a href="#ä¿æŠ¤æ¨¡å¼ä»‹ç»" class="headerlink" title="ä¿æŠ¤æ¨¡å¼ä»‹ç»"></a>ä¿æŠ¤æ¨¡å¼ä»‹ç»</h1><h2 id="ä»€ä¹ˆæ˜¯ä¿æŠ¤æ¨¡å¼ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ä¿æŠ¤æ¨¡å¼ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¿æŠ¤æ¨¡å¼ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ä¿æŠ¤æ¨¡å¼ï¼Ÿ</h2><p>x86 CPUçš„3ä¸ªæ¨¡å¼ï¼šå®æ¨¡å¼ã€ä¿æŠ¤æ¨¡å¼å’Œè™šæ‹Ÿ8086æ¨¡å¼ã€‚</p><h2 id="ä¸ºä»€ä¹ˆä¸ç›´æ¥è®²x64çš„ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¸ç›´æ¥è®²x64çš„ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¸ç›´æ¥è®²x64çš„ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¸ç›´æ¥è®²x64çš„ï¼Ÿ</h2><p>x86æ˜¯ç”±Intelæ¨å‡ºçš„ä¸€ç§å¤æ‚æŒ‡ä»¤é›†,èƒ½å¤Ÿç”Ÿäº§æ”¯æŒè¿™ç§æŒ‡ä»¤é›†CPUå…¬å¸ä¸»è¦æ˜¯Intelå’ŒAMD.</p><p>AMDåœ¨1999å¹´çš„æ—¶å€™ï¼Œæ‹“å±•äº†è¿™å¥—æŒ‡ä»¤é›†ï¼Œç§°ä¸ºx86-64,åæ”¹åä¸ºAMD64,Intelä¹Ÿå…¼å®¹äº†è¿™ä¸ªäº§å“ï¼Œç§°ä¸ºIntel 64.ä½†AMD64å’ŒIntel64å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥åœ¨å¾ˆå¤šèµ„æ–™ä¸­ç»Ÿç§°ä¸ºx64.è¿™å¥—æŒ‡ä»¤é›†æ˜¯å¯¹x86çš„æ‹“å±•ï¼Œå‘ä¸‹å…¼å®¹çš„.</p><h2 id="ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ"><a href="#ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ"></a>ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</h2><p>æ®µçš„æœºåˆ¶</p><p>é¡µçš„æœºåˆ¶</p><h2 id="å­¦ä¹ ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#å­¦ä¹ ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="å­¦ä¹ ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>å­¦ä¹ ä¿æŠ¤æ¨¡å¼æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><p>çœŸæ­£ç†è§£å†…æ ¸æ˜¯å¦‚ä½•è¿ä½œçš„</p><h1 id="æ®µå¯„å­˜å™¨ç»“æ„"><a href="#æ®µå¯„å­˜å™¨ç»“æ„" class="headerlink" title="æ®µå¯„å­˜å™¨ç»“æ„"></a>æ®µå¯„å­˜å™¨ç»“æ„</h1><h2 id="1ã€ä»€ä¹ˆæ˜¯æ®µå¯„å­˜å™¨ï¼Ÿ"><a href="#1ã€ä»€ä¹ˆæ˜¯æ®µå¯„å­˜å™¨ï¼Ÿ" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯æ®µå¯„å­˜å™¨ï¼Ÿ"></a>1ã€ä»€ä¹ˆæ˜¯æ®µå¯„å­˜å™¨ï¼Ÿ</h2><p>å½“æˆ‘ä»¬ç”¨æ±‡ç¼–è¯»å†™æŸä¸€ä¸ªåœ°å€æ—¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov dword ptr ds:[0x123456]</span><br></pre></td></tr></table></figure><p>eaxæˆ‘ä»¬çœŸæ­£è¯»å†™çš„åœ°å€æ˜¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ds.base + 0x123456</span><br></pre></td></tr></table></figure><p><strong>ES CS SS DS FS GS LDTR TR</strong>  å…±8ä¸ª</p><h2 id="2ã€æ®µå¯„å­˜å™¨çš„ç»“æ„"><a href="#2ã€æ®µå¯„å­˜å™¨çš„ç»“æ„" class="headerlink" title="2ã€æ®µå¯„å­˜å™¨çš„ç»“æ„"></a>2ã€æ®µå¯„å­˜å™¨çš„ç»“æ„</h2><p><img src="C:/Users/36085/AppData/Roaming/Typora/typora-user-images/image-20240923131745478.png" alt="image-20240923131745478"></p><h2 id="3ã€æ®µå¯„å­˜å™¨çš„è¯»å†™"><a href="#3ã€æ®µå¯„å­˜å™¨çš„è¯»å†™" class="headerlink" title="3ã€æ®µå¯„å­˜å™¨çš„è¯»å†™"></a>3ã€æ®µå¯„å­˜å™¨çš„è¯»å†™</h2><h3 id="3-1-è¯»æ®µå¯„å­˜å™¨"><a href="#3-1-è¯»æ®µå¯„å­˜å™¨" class="headerlink" title="3.1 è¯»æ®µå¯„å­˜å™¨"></a>3.1 è¯»æ®µå¯„å­˜å™¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ¯”å¦‚ï¼šMOV AX,ES    åªèƒ½è¯»16ä½çš„å¯è§éƒ¨åˆ†</span><br><span class="line"></span><br><span class="line">è¯»å†™LDTRçš„æŒ‡ä»¤ä¸ºï¼šSLDT/LLDT</span><br><span class="line"></span><br><span class="line">è¯»å†™TRçš„æŒ‡ä»¤ä¸ºï¼šSTR/LTR</span><br></pre></td></tr></table></figure><h3 id="3-2-å†™æ®µå¯„å­˜å™¨"><a href="#3-2-å†™æ®µå¯„å­˜å™¨" class="headerlink" title="3.2 å†™æ®µå¯„å­˜å™¨"></a>3.2 å†™æ®µå¯„å­˜å™¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¯”å¦‚ï¼šMOV DS,AX   å†™æ—¶æ˜¯å†™96ä½  </span><br></pre></td></tr></table></figure><h1 id="æ®µå¯„å­˜å™¨å±æ€§æ¢æµ‹"><a href="#æ®µå¯„å­˜å™¨å±æ€§æ¢æµ‹" class="headerlink" title="æ®µå¯„å­˜å™¨å±æ€§æ¢æµ‹"></a>æ®µå¯„å­˜å™¨å±æ€§æ¢æµ‹</h1><h2 id="1ã€æ®µå¯„å­˜å™¨æˆå‘˜ç®€ä»‹"><a href="#1ã€æ®µå¯„å­˜å™¨æˆå‘˜ç®€ä»‹" class="headerlink" title="1ã€æ®µå¯„å­˜å™¨æˆå‘˜ç®€ä»‹"></a>1ã€æ®µå¯„å­˜å™¨æˆå‘˜ç®€ä»‹</h2><table><thead><tr><th><strong>æ®µå¯„å­˜å™¨</strong></th><th><strong>Selector</strong></th><th><strong>Attribute</strong></th><th><strong>Base</strong></th><th><strong>Limit</strong></th></tr></thead><tbody><tr><td>ES</td><td>0023</td><td>å¯è¯»ã€å¯å†™</td><td>0</td><td>0xFFFFFFFF</td></tr><tr><td>CS</td><td>001B</td><td>å¯è¯»ã€å¯æ‰§è¡Œ</td><td>0</td><td>0xFFFFFFFF</td></tr><tr><td>SS</td><td>0023</td><td>å¯è¯»ã€å¯å†™</td><td>0</td><td>0xFFFFFFFF</td></tr><tr><td>DS</td><td>0023</td><td>å¯è¯»ã€å¯å†™</td><td>0</td><td>0xFFFFFFFF</td></tr><tr><td>FS</td><td>003B</td><td>å¯è¯»ã€å¯å†™</td><td>0x7FFDE000</td><td>0xFFF</td></tr><tr><td>GS</td><td>-</td><td>-</td><td>-</td><td>-</td></tr></tbody></table><h2 id="2ã€æ¢æµ‹Attribute"><a href="#2ã€æ¢æµ‹Attribute" class="headerlink" title="2ã€æ¢æµ‹Attribute"></a>2ã€æ¢æµ‹Attribute</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">int var = 0;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">mov ax,ss//csä¸è¡Œ csæ˜¯å¯è¯» å¯æ‰§è¡Œ ä½†ä¸å¯å†™</span><br><span class="line">mov ds,ax</span><br><span class="line">mov dword ptr ds:[var],eax</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3ã€æ¢æµ‹Base"><a href="#3ã€æ¢æµ‹Base" class="headerlink" title="3ã€æ¢æµ‹Base"></a>3ã€æ¢æµ‹Base</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int var = 1;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">mov ax,fs</span><br><span class="line">mov gs,ax</span><br><span class="line">mov eax,gs:[0]//ä¸è¦ç”¨DS å¦åˆ™ç¼–è¯‘ä¸è¿‡å»</span><br><span class="line">mov dword ptr ds:[var],eax</span><br><span class="line"></span><br><span class="line">//mov edx,dword ptr ds:[0x7FFDF000]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4ã€æ¢æµ‹Limit"><a href="#4ã€æ¢æµ‹Limit" class="headerlink" title="4ã€æ¢æµ‹Limit"></a>4ã€æ¢æµ‹Limit</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int var = 1;</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">mov ax,fs</span><br><span class="line">mov gs,ax</span><br><span class="line">mov eax,gs:[0]//ä¸è¦ç”¨DS å¦åˆ™ç¼–è¯‘ä¸è¿‡å»</span><br><span class="line">mov dword ptr ds:[var],eax</span><br><span class="line"></span><br><span class="line">//mov edx,dword ptr ds:[0x7FFDF000]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ®µæè¿°ç¬¦ä¸æ®µé€‰æ‹©å­"><a href="#æ®µæè¿°ç¬¦ä¸æ®µé€‰æ‹©å­" class="headerlink" title="æ®µæè¿°ç¬¦ä¸æ®µé€‰æ‹©å­"></a>æ®µæè¿°ç¬¦ä¸æ®µé€‰æ‹©å­</h1><h2 id="æ®µæè¿°ç¬¦åˆ†ç±»"><a href="#æ®µæè¿°ç¬¦åˆ†ç±»" class="headerlink" title="æ®µæè¿°ç¬¦åˆ†ç±»"></a>æ®µæè¿°ç¬¦åˆ†ç±»</h2><p>GDT(å…¨å±€æè¿°ç¬¦è¡¨)  </p><p>LDT(å±€éƒ¨æè¿°ç¬¦è¡¨)</p><p>å½“æˆ‘ä»¬æ‰§è¡Œç±»ä¼¼MOV DS,AXæŒ‡ä»¤æ—¶ï¼ŒCPUä¼šæŸ¥è¡¨ï¼Œæ ¹æ®AXçš„å€¼æ¥å†³å®šæŸ¥æ‰¾GDTè¿˜æ˜¯LDT,æŸ¥æ‰¾è¡¨çš„ä»€ä¹ˆä½ç½®ï¼ŒæŸ¥å‡ºå¤šå°‘æ•°æ®.</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/23/451f0XYnzy9Q5q933mQn1727069019859.png" alt="image-20240923132339229"></p><h2 id="æ®µæè¿°ç¬¦"><a href="#æ®µæè¿°ç¬¦" class="headerlink" title="æ®µæè¿°ç¬¦"></a>æ®µæè¿°ç¬¦</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/23/jeVO88xnfdIXyGW35Aje1727069148863.png" alt="image-20240923132548637"></p><h2 id="æ®µé€‰æ‹©å­"><a href="#æ®µé€‰æ‹©å­" class="headerlink" title="æ®µé€‰æ‹©å­"></a>æ®µé€‰æ‹©å­</h2><p>æ®µé€‰æ‹©å­æ˜¯ä¸€ä¸ª16ä½çš„æ®µæè¿°ç¬¦ï¼Œè¯¥æè¿°ç¬¦æŒ‡å‘äº†å®šä¹‰è¯¥æ®µçš„æ®µæè¿°ç¬¦.</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/23/SNBS0LpfKl2WOYKL6Fpu1727069279346.png" alt="image-20240923132759152"></p><p><strong>RPLï¼š</strong>è¯·æ±‚ç‰¹æƒçº§åˆ«</p><p><strong>TIï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TI=0  æŸ¥GDTè¡¨</span><br><span class="line">TI=1  æŸ¥LDTè¡¨</span><br></pre></td></tr></table></figure><p><strong>Indexï¼š</strong>å¤„ç†å™¨å°†ç´¢å¼•å€¼ä¹˜ä»¥8åœ¨åŠ ä¸ŠGDTæˆ–è€…LDTçš„<strong>Baseåœ°å€</strong>ï¼Œå°±æ˜¯è¦åŠ è½½çš„æ®µæè¿°ç¬¦</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/07/otGPfgORNBUZKw1bl7ib1728276445387.png" alt="image-20241007124724810"></p><h2 id="åŠ è½½æ®µæè¿°ç¬¦è‡³æ®µå¯„å­˜å™¨"><a href="#åŠ è½½æ®µæè¿°ç¬¦è‡³æ®µå¯„å­˜å™¨" class="headerlink" title="åŠ è½½æ®µæè¿°ç¬¦è‡³æ®µå¯„å­˜å™¨"></a>åŠ è½½æ®µæè¿°ç¬¦è‡³æ®µå¯„å­˜å™¨</h2><p>é™¤äº†MOVæŒ‡ä»¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<strong>LESã€LSSã€LDSã€LFSã€LGS</strong>æŒ‡ä»¤ä¿®æ”¹å¯„å­˜å™¨</p><p>CSä¸èƒ½é€šè¿‡ä¸Šè¿°çš„æŒ‡ä»¤è¿›è¡Œä¿®æ”¹ï¼ŒCSä¸ºä»£ç æ®µï¼ŒCSçš„æ”¹å˜ä¼šå¯¼è‡´EIPçš„æ”¹å˜ï¼Œè¦æ”¹CSï¼Œå¿…é¡»è¦ä¿è¯CSä¸EIPä¸€èµ·æ”¹ï¼Œåé¢ä¼šè®²</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">char buffer[6];</span><br><span class="line">__asm</span><br><span class="line">&#123;</span><br><span class="line">les ecx,fword ptr ds:[buffer] //é«˜2ä¸ªå­—èŠ‚ç»™esï¼Œä½å››ä¸ªå­—èŠ‚ç»™ecx</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>[!NOTE]</p><p>æ³¨æ„ï¼šRPL&lt;&#x3D;DPL(åœ¨æ•°å€¼ä¸Š)</p></blockquote><h2 id="æ®µæè¿°ç¬¦å±æ€§"><a href="#æ®µæè¿°ç¬¦å±æ€§" class="headerlink" title="æ®µæè¿°ç¬¦å±æ€§"></a>æ®µæè¿°ç¬¦å±æ€§</h2><h3 id="Pä½å’ŒGä½"><a href="#Pä½å’ŒGä½" class="headerlink" title="Pä½å’ŒGä½"></a>Pä½å’ŒGä½</h3><p>1ã€Pä½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">P = 1 æ®µæè¿°ç¬¦æœ‰æ•ˆ</span><br><span class="line"></span><br><span class="line">P = 0 æ®µæè¿°ç¬¦æ— æ•ˆ</span><br></pre></td></tr></table></figure><p>2ã€Gä½ï¼ˆå½“å‰å¯»å€ä¸Šé™ï¼‰</p><p>G &#x3D; 0 Limitå•ä½æ˜¯bytes</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Limit = 000 FFFFF å‰é¢åŠ 000</span><br></pre></td></tr></table></figure><p>G &#x3D; 1 Limitå•ä½æ˜¯ä»¥4KB</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Limit = FFFFF FFF åé¢åŠ FFF</span><br></pre></td></tr></table></figure><h3 id="Sä½å’ŒTYPEåŸŸ"><a href="#Sä½å’ŒTYPEåŸŸ" class="headerlink" title="Sä½å’ŒTYPEåŸŸ"></a>Sä½å’ŒTYPEåŸŸ</h3><p><strong>1ã€Sä½</strong></p><p><strong>S &#x3D; 1</strong> ä»£ç æ®µæˆ–è€…æ•°æ®æ®µæè¿°ç¬¦</p><p><strong>S &#x3D; 0</strong> ç³»ç»Ÿæ®µæè¿°ç¬¦</p><p><strong>2ã€TYPEåŸŸ</strong></p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/23/HXEuU2qYUVnAv2baAHv61727070886381.png" alt="image-20240923135446213"></p><h4 id="åˆ†æä¸¾ä¾‹"><a href="#åˆ†æä¸¾ä¾‹" class="headerlink" title="åˆ†æä¸¾ä¾‹"></a>åˆ†æä¸¾ä¾‹</h4><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/23/qO12uvUnMZjdKXyfRJCq1727070949252.png" alt="image-20240923135549083"></p><h4 id="æ•°æ®æ®µï¼ˆDSï¼‰è¯´æ˜"><a href="#æ•°æ®æ®µï¼ˆDSï¼‰è¯´æ˜" class="headerlink" title="æ•°æ®æ®µï¼ˆDSï¼‰è¯´æ˜"></a>æ•°æ®æ®µï¼ˆDSï¼‰è¯´æ˜</h4><p>Access è®¿é—®ä½ï¼Œè¡¨ç¤ºè¯¥ä½æœ€åä¸€æ¬¡è¢«æ“ä½œç³»ç»Ÿæ¸…é›¶åï¼Œè¯¥æ®µæ˜¯å¦è¢«è®¿é—®è¿‡.æ¯å½“å¤„ç†å™¨å°†è¯¥æ®µé€‰æ‹©ç¬¦ç½®å…¥æŸä¸ªæ®µå¯„å­˜å™¨æ—¶ï¼Œå°±å°†è¯¥ä½ç½®1.</p><p>Write æ˜¯å¦å¯å†™</p><p>E æ‰©å±•æ–¹å‘ ï¼ˆå‘ä¸Šæ‹“å±•çº¢è‰²éƒ¨åˆ†å›¾ä¸€ï¼Œå‘ä¸‹æ‹“å±•çº¢è‰²éƒ¨åˆ†å›¾äºŒï¼‰</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/23/o5OU5GmVhc4yXh4awvVR1727071015823.png" alt="image-20240923135655239"></p><h4 id="ä»£ç æ®µï¼ˆCSï¼‰è¯´æ˜"><a href="#ä»£ç æ®µï¼ˆCSï¼‰è¯´æ˜" class="headerlink" title="ä»£ç æ®µï¼ˆCSï¼‰è¯´æ˜"></a>ä»£ç æ®µï¼ˆCSï¼‰è¯´æ˜</h4><p>A è®¿é—®ä½</p><p>R å¯è¯»ä½</p><p>C ä¸€è‡´ä½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C = 1 ä¸€è‡´ä»£ç æ®µ</span><br><span class="line"></span><br><span class="line">C = 0 éä¸€è‡´ä»£ç æ®µ</span><br></pre></td></tr></table></figure><h4 id="ç³»ç»Ÿæ®µï¼ˆSSï¼‰æè¿°ç¬¦"><a href="#ç³»ç»Ÿæ®µï¼ˆSSï¼‰æè¿°ç¬¦" class="headerlink" title="ç³»ç»Ÿæ®µï¼ˆSSï¼‰æè¿°ç¬¦"></a>ç³»ç»Ÿæ®µï¼ˆSSï¼‰æè¿°ç¬¦</h4><p>å½“S&#x3D;0æ—¶ï¼Œè¯¥æ®µæè¿°ç¬¦ä¸ºç³»ç»Ÿæè¿°ç¬¦.ç³»ç»Ÿæè¿°ç¬¦æœ‰åˆ†ä¸ºä»¥ä¸‹ç±»å‹</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/23/6Nz4S19QrtwLIg7SulKq1727071223376.png" alt="image-20240923140023146"></p><h3 id="DBä½"><a href="#DBä½" class="headerlink" title="DBä½"></a>DBä½</h3><p>DBä½ï¼šå½“å‰å®é™…åœ°å€æœ€å¤šå¤§å°</p><p>1ã€CSæ®µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D = 1 é‡‡ç”¨32ä½å¯»å€æ–¹å¼</span><br></pre></td></tr></table></figure><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/CVU6623mNzm5Cds5lpmY1727179769864.png" alt="image-20240924200830741"></p><p>æ•´ä¸ªåœ°å€ç©ºé—´æ˜¯4KB</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D = 0 é‡‡ç”¨16ä½å¯»å€æ–¹å¼</span><br><span class="line">å‰ç¼€67 æ”¹å˜å¯»å€æ–¹å¼</span><br></pre></td></tr></table></figure><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/quzQTBtWvaSAniiFI9ja1727179763079.png" alt="image-20240924200922757"></p><p>æ•´ä¸ªåœ°å€ç©ºé—´æ˜¯64K</p><p>2ã€SSæ®µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D = 1 éšå¼å †æ ˆè®¿é—®æŒ‡ä»¤ï¼ˆå¦‚ï¼šPUSH POP CALLï¼‰ ä½¿ç”¨32ä½å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨ESP</span><br><span class="line"></span><br><span class="line">D = 0 éšå¼å †æ ˆè®¿é—®æŒ‡ä»¤ï¼ˆå¦‚ï¼šPUSH POP CALLï¼‰ ä½¿ç”¨16ä½å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨SP</span><br></pre></td></tr></table></figure><p>3ã€å‘ä¸‹æ‹“å±•çš„æ•°æ®æ®µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D = 1 æ®µä¸Šçº¿ä¸º4GB</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D = 0 æ®µä¸Šçº¿ä¸º64KB</span><br></pre></td></tr></table></figure><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/isF11qm2OpVGW2hVbjkL1727179885987.png" alt="image-20240924201125839"></p><p><strong>æ€»ç»“</strong></p><ul><li>æ®µæè¿°ç¬¦ä¸­çš„DBä½æ§åˆ¶æ“ä½œæ•°çš„é»˜è®¤å¤§å°ï¼ŒDB&#x3D;0æ—¶é»˜è®¤æ“ä½œæ•°ä¸º16ä½ï¼ŒDB&#x3D;1æ—¶é»˜è®¤æ“ä½œæ•°ä¸º32ä½ã€‚ </li><li>å¯„å­˜å™¨å®½åº¦çš„æ”¹å˜é€šè¿‡æ”¹å˜DBä½å®ç°ï¼Œä¸å½±å“å¯„å­˜å™¨æœ¬èº«çš„å®½åº¦ã€‚ </li><li>CSæ®µæè¿°ç¬¦çš„DBä½æ§åˆ¶ä»£ç æ®µçš„é»˜è®¤æ“ä½œæ•°å¤§å°ï¼Œå½±å“pushæŒ‡ä»¤çš„é»˜è®¤æ“ä½œæ•°ã€‚ </li><li>SSæ®µæè¿°ç¬¦çš„DBä½æ”¹å˜å †æ ˆå¯„å­˜å™¨çš„å¯»å€æ–¹å¼ï¼Œä»32ä½å˜ä¸º16ä½</li></ul><h1 id="æ®µæƒé™æ£€æŸ¥"><a href="#æ®µæƒé™æ£€æŸ¥" class="headerlink" title="æ®µæƒé™æ£€æŸ¥"></a>æ®µæƒé™æ£€æŸ¥</h1><h2 id="CPUåˆ†çº§"><a href="#CPUåˆ†çº§" class="headerlink" title="CPUåˆ†çº§"></a>CPUåˆ†çº§</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/FVfBwXHWulDjzsN3HxTt1727181087996.png" alt="image-20240924203127817"></p><h2 id="å¦‚ä½•æŸ¥çœ‹ç¨‹åºå¤„äºå‡ ç¯"><a href="#å¦‚ä½•æŸ¥çœ‹ç¨‹åºå¤„äºå‡ ç¯" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹ç¨‹åºå¤„äºå‡ ç¯?"></a>å¦‚ä½•æŸ¥çœ‹ç¨‹åºå¤„äºå‡ ç¯?</h2><p>CPL(Current Privilege Level) ï¼šå½“å‰ç‰¹æƒçº§</p><p>CSå’ŒSSä¸­å­˜å‚¨çš„æ®µé€‰æ‹©å­<strong>å2ä½</strong></p><p>ä¾‹å¦‚ï¼š23 &#x3D;&#x3D; 0010 0011 2b &#x3D;&#x3D; 0010 1011  11&#x3D;&#x3D;3 é‚£ä¹ˆåœ¨ä¸‰ç¯</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/6Z0nGdhvUuNesBtJ2sSi1727181581236.png" alt="image-20240924203902095"></p><h2 id="DPL-Descriptor-Privilege-Level-æè¿°ç¬¦ç‰¹æƒçº§åˆ«"><a href="#DPL-Descriptor-Privilege-Level-æè¿°ç¬¦ç‰¹æƒçº§åˆ«" class="headerlink" title="DPL(Descriptor Privilege Level)  æè¿°ç¬¦ç‰¹æƒçº§åˆ«"></a>DPL(Descriptor Privilege Level)  æè¿°ç¬¦ç‰¹æƒçº§åˆ«</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/Ad4QrcS3lzPuduCEaidJ1727181126958.png" alt="image-20240924203206796"></p><p>DPLå­˜å‚¨åœ¨æ®µæè¿°ç¬¦ä¸­ï¼Œè§„å®šäº†è®¿é—®è¯¥æ®µæ‰€éœ€è¦çš„ç‰¹æƒçº§åˆ«æ˜¯ä»€ä¹ˆ.</p><p>é€šä¿—çš„ç†è§£ï¼šå¦‚æœä½ æƒ³è®¿é—®æˆ‘ï¼Œé‚£ä¹ˆä½ åº”è¯¥å…·å¤‡ä»€ä¹ˆç‰¹æƒ.</p><p><strong>ä¸¾ä¾‹è¯´æ˜ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov DS,AX  å¦‚æœAXæŒ‡å‘çš„æ®µDPL = 0  </span><br><span class="line"></span><br><span class="line">ä½†å½“å‰ç¨‹åºçš„CPL = 3 è¿™è¡ŒæŒ‡ä»¤æ˜¯ä¸ä¼šæˆåŠŸçš„</span><br></pre></td></tr></table></figure><h2 id="RPL-Request-Privilege-Level-è¯·æ±‚ç‰¹æƒçº§åˆ«"><a href="#RPL-Request-Privilege-Level-è¯·æ±‚ç‰¹æƒçº§åˆ«" class="headerlink" title="RPL(Request Privilege Level)  è¯·æ±‚ç‰¹æƒçº§åˆ«"></a>RPL(Request Privilege Level)  è¯·æ±‚ç‰¹æƒçº§åˆ«</h2><p>RPLæ˜¯é’ˆå¯¹æ®µé€‰æ‹©å­è€Œè¨€çš„ï¼Œæ¯ä¸ªæ®µçš„é€‰æ‹©å­éƒ½æœ‰è‡ªå·±çš„RPL</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/W6Mea376WM7nPEaMdcJX1727181187606.png" alt="image-20240924203307380"></p><p>ä¸¾ä¾‹è¯´æ˜ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mov ax,0008ä¸Mov ax,000B //æ®µé€‰æ‹©å­  </span><br><span class="line"></span><br><span class="line">Mov ds,axMov ds,ax//å°†æ®µæè¿°æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªæ®µæè¿°ç¬¦,ä½†RPLæ˜¯ä¸ä¸€æ ·çš„.</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®æ®µçš„æƒé™æ£€æŸ¥"><a href="#æ•°æ®æ®µçš„æƒé™æ£€æŸ¥" class="headerlink" title="æ•°æ®æ®µçš„æƒé™æ£€æŸ¥"></a>æ•°æ®æ®µçš„æƒé™æ£€æŸ¥</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ¯”å¦‚å½“å‰ç¨‹åºå¤„äº0ç¯ï¼Œä¹Ÿå°±æ˜¯è¯´CPL=0</span><br><span class="line"></span><br><span class="line">Mov ax,000B//1011   RPL = 3</span><br><span class="line"></span><br><span class="line">Mov ds,ax//axæŒ‡å‘çš„æ®µæè¿°ç¬¦çš„DPL = 0</span><br></pre></td></tr></table></figure><p>æ•°æ®æ®µçš„æƒé™æ£€æŸ¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CPL &lt;= DPL  å¹¶ä¸” RPL &lt;= DPL (æ•°å€¼ä¸Šçš„æ¯”è¾ƒ)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä»£ç æ®µå’Œç³»ç»Ÿæ®µæè¿°ç¬¦ä¸­çš„æ£€æŸ¥æ–¹å¼å¹¶ä¸ä¸€æ ·</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CPL  CPUå½“å‰çš„æƒé™çº§åˆ«</span><br><span class="line"></span><br><span class="line">DPL  å¦‚æœä½ æƒ³è®¿é—®æˆ‘ï¼Œä½ åº”è¯¥å…·å¤‡ä»€ä¹ˆæ ·çš„æƒé™</span><br><span class="line"></span><br><span class="line">RPL  ç”¨ä»€ä¹ˆæƒé™å»è®¿é—®ä¸€ä¸ªæ®µ</span><br></pre></td></tr></table></figure><h1 id="ä»£ç è·¨æ®µæ‰§è¡Œæµç¨‹"><a href="#ä»£ç è·¨æ®µæ‰§è¡Œæµç¨‹" class="headerlink" title="ä»£ç è·¨æ®µæ‰§è¡Œæµç¨‹"></a>ä»£ç è·¨æ®µæ‰§è¡Œæµç¨‹</h1><p>æ®µå¯„å­˜å™¨:<code>ES,CS,SS,DS,FS,GS,LDTR,TR</code></p><p>æ®µå¯„å­˜å™¨è¯»å†™ï¼šé™¤<strong>CS</strong>å¤–ï¼Œå…¶ä»–çš„æ®µå¯„å­˜å™¨éƒ½å¯ä»¥é€šè¿‡<code>MOV,LES,LSS,LDS,LFS,LGS</code>æŒ‡ä»¤è¿›è¡Œä¿®æ”¹</p><h2 id="1ã€ä»£ç é—´çš„è·³è½¬-æ®µé—´è·³è½¬-éè°ƒç”¨é—¨ä¹‹ç±»çš„"><a href="#1ã€ä»£ç é—´çš„è·³è½¬-æ®µé—´è·³è½¬-éè°ƒç”¨é—¨ä¹‹ç±»çš„" class="headerlink" title="1ã€ä»£ç é—´çš„è·³è½¬(æ®µé—´è·³è½¬  éè°ƒç”¨é—¨ä¹‹ç±»çš„)"></a>1ã€ä»£ç é—´çš„è·³è½¬(æ®µé—´è·³è½¬  éè°ƒç”¨é—¨ä¹‹ç±»çš„)</h2><p>æ®µé—´è·³è½¬ï¼Œæœ‰2ç§æƒ…å†µï¼Œå³è¦è·³è½¬çš„æ®µæ˜¯ä¸€è‡´ä»£ç æ®µè¿˜æ˜¯éä¸€è‡´ä»£ç æ®µï¼Œä¹Ÿå°±æ˜¯çœ‹Cç­‰äº0è¿˜æ˜¯1</p><p>åŒæ—¶ä¿®æ”¹CSä¸EIPçš„æŒ‡ä»¤</p><p><strong>JMP FAR</strong> &#x2F; CALL FAR &#x2F; RETF &#x2F; INT &#x2F;IRETED</p><blockquote><p>[!NOTE]</p><p>æ³¨æ„ï¼š<strong>åªæ”¹å˜EIP</strong>çš„æŒ‡ä»¤ <strong>JMP &#x2F; CALL &#x2F; JCC &#x2F; RET</strong></p></blockquote><h2 id="2ã€æ‰§è¡Œæµç¨‹"><a href="#2ã€æ‰§è¡Œæµç¨‹" class="headerlink" title="2ã€æ‰§è¡Œæµç¨‹"></a>2ã€æ‰§è¡Œæµç¨‹</h2><p>CPUå¦‚ä½•æ‰§è¡Œè¿™è¡Œä»£ç ? <strong>JMP 0x20:0x004183D7</strong> </p><p>(1) æ®µé€‰æ‹©å­æ‹†åˆ†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x20 å¯¹åº”äºŒè¿›åˆ¶å½¢å¼ 0000 0000 0010 0000</span><br><span class="line">RPL = 00   </span><br><span class="line">TI = 0</span><br><span class="line">Index = 4</span><br></pre></td></tr></table></figure><p>(2) æŸ¥è¡¨å¾—åˆ°æ®µæè¿°ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TI = 0 æ‰€ä»¥æŸ¥GDTè¡¨</span><br><span class="line"></span><br><span class="line">Index = 4 æ‰¾åˆ°å¯¹åº”çš„æ®µæè¿°ç¬¦</span><br><span class="line"></span><br><span class="line">å››ç§æƒ…å†µå¯ä»¥è·³è½¬ï¼šä»£ç æ®µã€è°ƒç”¨é—¨ã€TSSä»»åŠ¡æ®µã€ä»»åŠ¡é—¨</span><br></pre></td></tr></table></figure><p>(3) æƒé™æ£€æŸ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœæ˜¯éä¸€è‡´ä»£ç æ®µï¼Œè¦æ±‚:CPL == DPL å¹¶ä¸” RPL &lt;= DPL</span><br><span class="line"></span><br><span class="line">å¦‚æœæ˜¯ä¸€è‡´ä»£ç æ®µï¼Œè¦æ±‚:CPL &gt;= DPL</span><br></pre></td></tr></table></figure><p>(4) åŠ è½½æ®µæè¿°ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡ä¸Šé¢çš„æƒé™æ£€æŸ¥åï¼ŒCPUä¼šå°†æ®µæè¿°ç¬¦åŠ è½½åˆ°CSæ®µå¯„å­˜å™¨ä¸­.</span><br></pre></td></tr></table></figure><p>(5) ä»£ç æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CPUå°† CS.Base + Offset çš„å€¼å†™å…¥EIP ç„¶åæ‰§è¡ŒCS:EIPå¤„çš„ä»£ç ï¼Œæ®µé—´è·³è½¬ç»“æŸ.</span><br></pre></td></tr></table></figure><p>3ã€æ€»ç»“</p><p>å¯¹äºä¸€è‡´ä»£ç æ®µ:ä¹Ÿå°±æ˜¯å…±äº«çš„æ®µ</p><ul><li>ç‰¹æƒçº§é«˜çš„ç¨‹åºä¸å…è®¸è®¿é—®ç‰¹æƒçº§ä½çš„æ•°æ®ï¼šæ ¸å¿ƒæ€ä¸å…è®¸è®¿é—®ç”¨æˆ·æ€çš„æ•°æ®</li><li>ç‰¹æƒçº§ä½çš„ç¨‹åºå¯ä»¥è®¿é—®åˆ°ç‰¹æƒçº§é«˜çš„æ•°æ®ï¼Œä½†ç‰¹æƒçº§ä¸ä¼šæ”¹å˜ï¼šç”¨æˆ·æ€è¿˜æ˜¯ç”¨æˆ·æ€</li></ul><p>å¯¹äºæ™®é€šä»£ç æ®µï¼šä¹Ÿå°±æ˜¯éä¸€è‡´ä»£ç æ®µ</p><ul><li>åªå…è®¸åŒçº§è®¿é—®</li><li>ç»å¯¹ç¦æ­¢ä¸åŒçº§åˆ«çš„è®¿é—®ï¼šæ ¸å¿ƒæ€ä¸æ˜¯ç”¨æˆ·æ€ï¼Œç”¨æˆ·æ€ä¹Ÿä¸æ˜¯æ ¸å¿ƒæ€.</li></ul><p>ç›´æ¥å¯¹ä»£ç æ®µè¿›è¡ŒJMP æˆ–è€… CALLçš„æ“ä½œï¼Œæ— è®ºç›®æ ‡æ˜¯ä¸€è‡´ä»£ç æ®µè¿˜æ˜¯éä¸€è‡´ä»£ç æ®µï¼ŒCPLéƒ½ä¸ä¼šå‘ç”Ÿæ”¹å˜.å¦‚æœè¦æå‡CPLçš„æƒé™ï¼Œåªèƒ½é€šè¿‡<strong>è°ƒç”¨é—¨</strong>.</p><h2 id="3ã€å®éªŒ"><a href="#3ã€å®éªŒ" class="headerlink" title="3ã€å®éªŒ"></a>3ã€å®éªŒ</h2><h3 id="3-1-æ„é€ æ®µæè¿°ç¬¦"><a href="#3-1-æ„é€ æ®µæè¿°ç¬¦" class="headerlink" title="3.1 æ„é€ æ®µæè¿°ç¬¦"></a>3.1 æ„é€ æ®µæè¿°ç¬¦</h3><p>æ‰¾ä¸€ä¸ªéä¸€è‡´ä»£ç æ®µæè¿°ç¬¦,å¤åˆ¶ä¸€ä»½ï¼Œå†™å…¥åˆ°GDTè¡¨ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kd&gt; r gdtr</span><br><span class="line">gdtr=8003f000</span><br><span class="line">kd&gt; dq 8003f000</span><br><span class="line">8003f000  00000000`00000000 00cf9b00`0000ffff</span><br><span class="line">8003f010  00cf9300`0000ffff 00cffb00`0000ffff</span><br><span class="line">8003f020  00cff300`0000ffff 80008b04`200020ab</span><br><span class="line">8003f030  ffc093df`f0000001 0040f300`00000fff</span><br><span class="line">8003f040  0000f200`0400ffff 00000000`00000000</span><br><span class="line">8003f050  80008954`b1000068 80008954`b1680068</span><br><span class="line">8003f060  00009302`2f40ffff 0000920b`80003fff</span><br><span class="line">8003f070  ff0092ff`700003ff 80009a40`0000ffff</span><br></pre></td></tr></table></figure><p>å°† <strong>00cffb00&#96;0000ffff</strong> æ•°æ®å†™å¦‚æŸä¸ªPä½ä¸º0çš„ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kd&gt; eq 8003f048 00cffb00`0000ffff(ç”¨å†…æ ¸å·¥å…·æŸ¥çœ‹æ–°å¢æ˜¯å¦æˆåŠŸï¼‰</span><br></pre></td></tr></table></figure><h3 id="3-2-ODä¸­è¿›è¡Œæµ‹è¯•"><a href="#3-2-ODä¸­è¿›è¡Œæµ‹è¯•" class="headerlink" title="3.2 ODä¸­è¿›è¡Œæµ‹è¯•"></a>3.2 ODä¸­è¿›è¡Œæµ‹è¯•</h3><p>åœ¨ODä¸­ï¼Œæ‰§è¡Œè·¨æ®µè·³è½¬  JMP FAR 004B:0041840D</p><p>æˆåŠŸçš„è¯ï¼ŒCSæ®µå¯„å­˜å™¨å°±ä¼šä¿®æ”¹æˆ4B</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/27/vOK03qIJuFb3wCZy7sMf1727442637455.png" alt="image-20240927211027897"></p><h3 id="3-3-ä¿®æ”¹æ®µæè¿°ç¬¦çš„æƒé™çº§åˆ«-å¹¶å†æ¬¡åœ¨ODä¸­è¿›è¡Œæµ‹è¯•"><a href="#3-3-ä¿®æ”¹æ®µæè¿°ç¬¦çš„æƒé™çº§åˆ«-å¹¶å†æ¬¡åœ¨ODä¸­è¿›è¡Œæµ‹è¯•" class="headerlink" title="3.3 ä¿®æ”¹æ®µæè¿°ç¬¦çš„æƒé™çº§åˆ«,å¹¶å†æ¬¡åœ¨ODä¸­è¿›è¡Œæµ‹è¯•"></a>3.3 ä¿®æ”¹æ®µæè¿°ç¬¦çš„æƒé™çº§åˆ«,å¹¶å†æ¬¡åœ¨ODä¸­è¿›è¡Œæµ‹è¯•</h3><p>å°†00cffb00`0000ffff æ”¹ä¸º00cf9b00`0000ffffåœ¨ODä¸­ï¼Œæ‰§è¡Œè·¨æ®µè·³è½¬  JMP FAR 004B:0041840D</p><h3 id="3-4-å°†è¯¥æ®µæè¿°ç¬¦çš„å±æ€§æ›´æ”¹ä¸ºä¸€è‡´ä»£ç æ®µ"><a href="#3-4-å°†è¯¥æ®µæè¿°ç¬¦çš„å±æ€§æ›´æ”¹ä¸ºä¸€è‡´ä»£ç æ®µ" class="headerlink" title="3.4 å°†è¯¥æ®µæè¿°ç¬¦çš„å±æ€§æ›´æ”¹ä¸ºä¸€è‡´ä»£ç æ®µ."></a>3.4 å°†è¯¥æ®µæè¿°ç¬¦çš„å±æ€§æ›´æ”¹ä¸ºä¸€è‡´ä»£ç æ®µ.</h3><p>å°†00cffb00`0000ffff æ”¹ä¸º00cf9f00`0000ffffåœ¨ODä¸­ï¼Œæ‰§è¡Œè·¨æ®µè·³è½¬  JMP FAR 004B:0041840D</p><p>å¦‚æœæ˜¯ä¸€è‡´ä»£ç æ®µï¼Œè¦æ±‚:CPL &gt;&#x3D; DPL (<strong>å½“å‰åŒæ ·å¯ä»¥è®¿é—®</strong>)</p><p>CPL:3</p><p>DPL:0</p><h2 id="4ã€æ€»ç»“"><a href="#4ã€æ€»ç»“" class="headerlink" title="4ã€æ€»ç»“"></a>4ã€æ€»ç»“</h2><p>1ã€ä¸ºäº†å¯¹æ•°æ®è¿›è¡Œä¿æŠ¤ï¼Œæ™®é€šä»£ç æ®µæ˜¯ç¦æ­¢ä¸åŒçº§åˆ«è¿›è¡Œè®¿é—®çš„ã€‚ç”¨æˆ·æ€çš„ä»£ç ä¸èƒ½è®¿é—®å†…æ ¸çš„æ•°æ®ï¼ŒåŒæ ·ï¼Œå†…æ ¸æ€çš„ä»£ç ä¹Ÿä¸èƒ½è®¿é—®ç”¨æˆ·æ€çš„æ•°æ®.</p><p>2ã€å¦‚æœæƒ³æä¾›ä¸€äº›é€šç”¨çš„åŠŸèƒ½ï¼Œè€Œä¸”è¿™äº›åŠŸèƒ½å¹¶ä¸ä¼šç ´åå†…æ ¸æ•°æ®ï¼Œé‚£ä¹ˆå¯ä»¥é€‰æ‹©ä¸€è‡´ä»£ç æ®µï¼Œè¿™æ ·ä½çº§åˆ«çš„ç¨‹åºå¯ä»¥åœ¨ä¸æå‡CPLæƒé™ç­‰çº§çš„æƒ…å†µä¸‹å³å¯ä»¥è®¿é—®.</p><p>3ã€å¦‚æœæƒ³è®¿é—®æ™®é€šä»£ç æ®µï¼Œåªæœ‰é€šè¿‡â€œè°ƒç”¨é—¨â€ç­‰æç¤ºCPLæƒé™ï¼Œæ‰èƒ½è®¿é—®ã€‚</p><h1 id="é•¿è°ƒç”¨ä¸çŸ­è°ƒç”¨"><a href="#é•¿è°ƒç”¨ä¸çŸ­è°ƒç”¨" class="headerlink" title="é•¿è°ƒç”¨ä¸çŸ­è°ƒç”¨"></a>é•¿è°ƒç”¨ä¸çŸ­è°ƒç”¨</h1><p>æˆ‘ä»¬é€šè¿‡<strong>JMP FAR</strong>å¯ä»¥<strong>å®ç°æ®µé—´</strong>çš„è·³è½¬ï¼Œå¦‚æœè¦å®ç°è·¨æ®µçš„è°ƒç”¨å°±å¿…é¡»è¦å­¦ä¹ <strong>CALL FAR</strong>ï¼Œä¹Ÿå°±æ˜¯<strong>é•¿è°ƒç”¨</strong>.</p><p><strong>CALL FAR</strong>æ¯”<strong>JMP FAR</strong>è¦å¤æ‚ï¼ŒJMPå¹¶<strong>ä¸å½±å“å †æ ˆ</strong>,ä½†CALLæŒ‡ä»¤ä¼šå½±å“.</p><h2 id="1ã€çŸ­è°ƒç”¨"><a href="#1ã€çŸ­è°ƒç”¨" class="headerlink" title="1ã€çŸ­è°ƒç”¨"></a>1ã€çŸ­è°ƒç”¨</h2><p>æŒ‡ä»¤æ ¼å¼ï¼šCALL  ç«‹å³æ•°&#x2F;å¯„å­˜å™¨&#x2F;å†…å­˜</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/26/H0ZwWZk6Jpe6yRZRNNcK1727361345620.png" alt="image-20240926223503339"></p><p>å‘ç”Ÿæ”¹å˜çš„å¯„å­˜å™¨ï¼šESP EIP</p><h2 id="2ã€é•¿è°ƒç”¨-è·¨æ®µä¸ææƒ"><a href="#2ã€é•¿è°ƒç”¨-è·¨æ®µä¸ææƒ" class="headerlink" title="2ã€é•¿è°ƒç”¨(è·¨æ®µä¸ææƒ)"></a>2ã€é•¿è°ƒç”¨(è·¨æ®µä¸ææƒ)</h2><p>æŒ‡ä»¤æ ¼å¼ï¼šCALL  CS:EIP(EIPæ˜¯åºŸå¼ƒçš„)</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/26/NMPihSWSaCmDWoeer6uv1727361361024.png" alt="image-20240926223600844"></p><p>å‘ç”Ÿæ”¹å˜çš„å¯„å­˜å™¨ï¼šESP EIP  CS</p><h2 id="3ã€é•¿è°ƒç”¨-è·¨æ®µå¹¶ææƒ"><a href="#3ã€é•¿è°ƒç”¨-è·¨æ®µå¹¶ææƒ" class="headerlink" title="3ã€é•¿è°ƒç”¨(è·¨æ®µå¹¶ææƒ)"></a>3ã€é•¿è°ƒç”¨(è·¨æ®µå¹¶ææƒ)</h2><p>æŒ‡ä»¤æ ¼å¼ï¼šCALL  CS:EIP(EIPæ˜¯åºŸå¼ƒçš„)</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/26/clDOXb1AIUYYohoICGDg1727361380630.png" alt="image-20240926223620406"></p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/26/4UFV97QwOwh5C5hWbqRU1727361399616.png" alt="image-20240926223639418"></p><p>å‘ç”Ÿæ”¹å˜çš„å¯„å­˜å™¨ï¼šESP EIP  CS SS</p><h2 id="4ã€æ€»ç»“-1"><a href="#4ã€æ€»ç»“-1" class="headerlink" title="4ã€æ€»ç»“"></a>4ã€æ€»ç»“</h2><ol><li>è·¨æ®µè°ƒç”¨æ—¶ï¼Œä¸€æ—¦æœ‰æƒé™åˆ‡æ¢ï¼Œå°±ä¼šåˆ‡æ¢å †æ ˆ.</li><li>CSçš„æƒé™ä¸€æ—¦æ”¹å˜ï¼ŒSSçš„æƒé™ä¹Ÿè¦éšç€æ”¹å˜ï¼ŒCSä¸SSçš„ç­‰çº§å¿…é¡»ä¸€æ ·.</li><li>JMP FAR åªèƒ½è·³è½¬åˆ°åŒçº§<strong>éä¸€è‡´ä»£ç æ®µ</strong>ï¼Œä½†CALL FARå¯ä»¥é€šè¿‡è°ƒç”¨é—¨ææƒï¼Œæå‡CPLçš„æƒé™.</li></ol><h1 id="è°ƒç”¨é—¨"><a href="#è°ƒç”¨é—¨" class="headerlink" title="è°ƒç”¨é—¨"></a>è°ƒç”¨é—¨</h1><h2 id="1ã€è°ƒç”¨é—¨æ‰§è¡Œæµç¨‹"><a href="#1ã€è°ƒç”¨é—¨æ‰§è¡Œæµç¨‹" class="headerlink" title="1ã€è°ƒç”¨é—¨æ‰§è¡Œæµç¨‹"></a>1ã€è°ƒç”¨é—¨æ‰§è¡Œæµç¨‹</h2><p>æŒ‡ä»¤æ ¼å¼ï¼šCALL  CS:EIP(EIPæ˜¯åºŸå¼ƒçš„)</p><p>æ‰§è¡Œæ­¥éª¤ï¼š</p><ol><li>æ ¹æ®CSçš„å€¼ æŸ¥GDTè¡¨ï¼Œæ‰¾åˆ°å¯¹åº”çš„æ®µæè¿°ç¬¦  è¿™ä¸ªæè¿°ç¬¦æ˜¯ä¸€ä¸ªè°ƒç”¨é—¨.</li><li>åœ¨è°ƒç”¨é—¨æè¿°ç¬¦ä¸­å­˜å‚¨å¦ä¸€ä¸ªä»£ç æ®µæ®µçš„é€‰æ‹©å­.</li><li>é€‰æ‹©å­æŒ‡å‘çš„æ®µ  <strong>æ®µ.Base + åç§»åœ°å€</strong> å°±æ˜¯çœŸæ­£è¦æ‰§è¡Œçš„åœ°å€.</li></ol><h2 id="2ã€é—¨æè¿°ç¬¦"><a href="#2ã€é—¨æè¿°ç¬¦" class="headerlink" title="2ã€é—¨æè¿°ç¬¦"></a>2ã€é—¨æè¿°ç¬¦</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/17/Wr6DYYDdWiPGLz6xE55W1729174532995.png" alt="image-20240928111147890"></p><p>ï¼ˆ16-31ä½ï¼‰offset+ï¼ˆ0-15ä½ï¼‰offset &#x3D; è·³è½¬åˆ°å‡½æ•°æ‰§è¡Œçš„ä½ç½®</p><h2 id="3ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæ— å‚-ææƒï¼‰"><a href="#3ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæ— å‚-ææƒï¼‰" class="headerlink" title="3ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæ— å‚  ææƒï¼‰"></a>3ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæ— å‚  ææƒï¼‰</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç¬¬ä¸€æ­¥ï¼šæ„é€ å¤§æ¦‚çš„å€¼</span><br><span class="line">DPL:3ç¯ == 11</span><br><span class="line">0000 0000 0000 0000 1110 1100(è°ƒç”¨é—¨å›ºå®šå€¼) 0000 0000 == 0000ec00</span><br><span class="line">0000 0000 0000 1000 0000 0000 0000 0000 == 00080000</span><br><span class="line">0000ec00`00080000</span><br><span class="line">ç¬¬äºŒæ­¥ï¼šæ‹¿åˆ°æ–¹æ³•åœ°å€</span><br><span class="line">401000</span><br><span class="line">0040ec00`00081000</span><br><span class="line">ç¬¬ä¸‰æ­¥ï¼šeq 80b99048 0040ec00`00081000</span><br><span class="line">ç¬¬å››æ­¥ï¼šè¿è¡Œç¨‹åº</span><br></pre></td></tr></table></figure><h3 id="3-1-ä»£ç æµ‹è¯•"><a href="#3-1-ä»£ç æµ‹è¯•" class="headerlink" title="3.1 ä»£ç æµ‹è¯•"></a>3.1 ä»£ç æµ‹è¯•</h3><p>æ­¥éª¤ä¸€ï¼šä»£ç æµ‹è¯•ï¼Œå¹¶è§‚å¯Ÿå †æ ˆä¸å¯„å­˜å™¨çš„å˜åŒ–è®°å½•æ‰§è¡Œå‰çš„å¯„å­˜å™¨å€¼ï¼šSS   ESP CS </p><p><strong>æ‰§è¡Œå‰ï¼š</strong></p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/29/yDdxxb3jn4PQUPdk70Cu1727576118622.png" alt="image-20240929101518189"></p><p><strong>æ‰§è¡Œåï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">eax=00000048 ebx=7ffd9000 ecx=00000000 </span><br><span class="line">edx=00000001 esi=00000000 edi=0012fe5c</span><br><span class="line">eip=00401000 esp=a69f5ca0 ebp=0012fe5c iopl=0         </span><br><span class="line">nv up ei pl nz na pe nc</span><br><span class="line"></span><br><span class="line">cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00000206</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å˜åŒ–ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CS:1b-&gt;08 </span><br><span class="line"></span><br><span class="line">ESP:12fd7c-&gt;a682bca0(é«˜åœ°å€)</span><br><span class="line"></span><br><span class="line">SS:23-&gt;10 </span><br></pre></td></tr></table></figure><p><strong>å †æ ˆï¼š</strong></p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/29/gEUPyj7DpBodvihUdqwq1727576828262.png" alt="image-20240929102708081"></p><p>æ­¥éª¤äºŒï¼šåœ¨æµ‹è¯•ä»£ç ä¸­åŠ å…¥ç‰¹æƒæŒ‡ä»¤å¹¶è¯»å–é«˜2Gå†…å­˜</p><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">BYTE GDT[<span class="number">6</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">DWORD dwH2Gvalue;</span><br><span class="line"><span class="type">void</span> _declspec(naked) <span class="built_in">getRegister</span>()&#123;</span><br><span class="line">__asm&#123;</span><br><span class="line">pushad</span><br><span class="line">pushfd</span><br><span class="line"></span><br><span class="line">mov eax,<span class="number">0x80b9900c</span></span><br><span class="line">mov ebx,[eax]</span><br><span class="line">mov dwH2Gvalue,ebx</span><br><span class="line">sgdt GDT <span class="comment">//è·å–GDTè¡¨åœ°å€</span></span><br><span class="line"></span><br><span class="line">popfd</span><br><span class="line">popad</span><br><span class="line"></span><br><span class="line">retf</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printfRegister</span><span class="params">()</span></span>&#123;</span><br><span class="line">DWORD GDT_ADDR = *(PDWORD)(&amp;GDT[<span class="number">2</span>]);</span><br><span class="line">WORD GDT_LIMIT = *(PWORD)(&amp;GDT[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x %x %x\n&quot;</span>,dwH2Gvalue,GDT_ADDR,GDT_LIMIT);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">testfun1</span><span class="params">()</span></span>&#123;</span><br><span class="line">__asm&#123;</span><br><span class="line">mov ebx,ebx</span><br><span class="line">mov ebx,ebx</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> buf[<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line">*(DWORD*)&amp;buf[<span class="number">0</span>] = <span class="number">0x12345678</span>;</span><br><span class="line">*(WORD*)&amp;buf[<span class="number">4</span>] = <span class="number">0x48</span>;</span><br><span class="line"></span><br><span class="line">__asm&#123;</span><br><span class="line">call fword ptr[buf]</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printfRegister</span>();</span><br><span class="line"><span class="built_in">getchar</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> _tmain(<span class="type">int</span> argc, _TCHAR* argv[])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">testfun1</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/29/xDB3Wymf8q1IxdeCNyh71727577654131.png" alt="image-20240929104053905"></p><h2 id="4ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæœ‰å‚-ææƒï¼‰"><a href="#4ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæœ‰å‚-ææƒï¼‰" class="headerlink" title="4ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæœ‰å‚  ææƒï¼‰"></a>4ã€æ„é€ ä¸€ä¸ªè°ƒç”¨é—¨ï¼ˆæœ‰å‚  ææƒï¼‰</h2><p>è°ƒç”¨é—¨æè¿°ç¬¦ï¼š</p><p>0040EC0<strong>3</strong>&#96;00081030 ï¼ˆä¸‰ä¸ªå‚æ•°ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kd&gt;eq 8003f048 0040EC03`00081030</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo03.cpp : å®šä¹‰æ§åˆ¶å°åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">DWORD x,y,z;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> _declspec(naked) <span class="built_in">getRegister</span>()&#123;</span><br><span class="line">__asm&#123;</span><br><span class="line">pushad</span><br><span class="line">pushfd</span><br><span class="line"></span><br><span class="line">mov eax,[esp<span class="number">+0x24</span><span class="number">+0x8</span><span class="number">+0x8</span>]</span><br><span class="line">mov dword ptr ds:[x],eax</span><br><span class="line"></span><br><span class="line">mov eax,[esp<span class="number">+0x24</span><span class="number">+0x8</span><span class="number">+0x4</span>]</span><br><span class="line">mov dword ptr ds:[y],eax</span><br><span class="line"></span><br><span class="line">mov eax,[esp<span class="number">+0x24</span><span class="number">+0x8</span><span class="number">+0x0</span>]</span><br><span class="line">mov dword ptr ds:[z],eax</span><br><span class="line">        </span><br><span class="line">popfd</span><br><span class="line">popad</span><br><span class="line"></span><br><span class="line">retf <span class="number">0xc</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printfRegister</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x %x %x\n&quot;</span>,x,y,z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">testfun1</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> buf[<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line">*(DWORD*)&amp;buf[<span class="number">0</span>] = <span class="number">0x12345678</span>;</span><br><span class="line">*(WORD*)&amp;buf[<span class="number">4</span>] = <span class="number">0x68</span>;</span><br><span class="line"></span><br><span class="line">__asm&#123;</span><br><span class="line">push <span class="number">1</span></span><br><span class="line">push <span class="number">2</span></span><br><span class="line">push <span class="number">3</span></span><br><span class="line">call fword ptr[buf]</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printfRegister</span>();</span><br><span class="line"><span class="built_in">getchar</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> _tmain(<span class="type">int</span> argc, _TCHAR* argv[])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">testfun1</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆåŠŸè·å–åˆ°3ä¸ªä¼ å…¥çš„å‚æ•°</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/30/Kt8jetaX0fvdstqzSYUT1727665410690.png" alt="image-20240930110250565"></p><h2 id="5ã€æ€»ç»“"><a href="#5ã€æ€»ç»“" class="headerlink" title="5ã€æ€»ç»“"></a>5ã€æ€»ç»“</h2><ol><li>å½“é€šè¿‡é—¨ï¼Œ<strong>æƒé™ä¸å˜</strong>çš„æ—¶å€™ï¼Œåªä¼šPUSH<strong>ä¸¤ä¸ªå€¼</strong>ï¼š<strong>CSå’Œè¿”å›åœ°å€</strong>æ–°çš„CSçš„å€¼ç”±è°ƒç”¨é—¨å†³å®š</li><li>å½“é€šè¿‡é—¨ï¼Œ<strong>æƒé™æ”¹å˜</strong>çš„æ—¶å€™ï¼Œä¼šPUSH<strong>å››ä¸ªå€¼</strong>ï¼š<strong>SSã€ESPã€CSå’Œè¿”å›åœ°å€</strong>   æ–°çš„<strong>CSçš„å€¼ç”±è°ƒç”¨é—¨</strong>å†³å®š  æ–°çš„<strong>SSå’ŒESP</strong>ç”±<strong>TSS</strong>æä¾›</li><li>é€šè¿‡é—¨è°ƒç”¨æ—¶ï¼Œè¦æ‰§è¡Œå“ªè¡Œä»£ç æœ‰è°ƒç”¨é—¨å†³å®šï¼Œä½†ä½¿ç”¨RETFè¿”å›æ—¶ï¼Œç”±å †æ ˆä¸­å‹å…¥çš„å€¼å†³å®šï¼Œè¿™å°±æ˜¯è¯´ï¼Œè¿›é—¨æ—¶åªèƒ½æŒ‰æŒ‡å®šè·¯çº¿èµ°ï¼Œå‡ºé—¨æ—¶å¯ä»¥ç¿»å¢™(åªè¦æ”¹å˜å †æ ˆé‡Œé¢çš„å€¼å°±å¯ä»¥æƒ³å»å“ªå»å“ª)</li><li>å¯ä¸å¯ä»¥å†å»ºä¸ªé—¨å‡ºå»å‘¢?ä¹Ÿå°±æ˜¯ç”¨Call  å½“ç„¶å¯ä»¥äº† å‰é—¨è¿› åé—¨å‡º</li></ol><p></p><h1 id="ä¸­æ–­é—¨"><a href="#ä¸­æ–­é—¨" class="headerlink" title="ä¸­æ–­é—¨"></a>ä¸­æ–­é—¨</h1><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul><li>ç³»ç»Ÿè°ƒç”¨</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¤§å®¶åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶éƒ½ä¼šä½¿ç”¨åˆ°Windowsæä¾›çš„APIï¼Œè¿™äº›APIåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­éœ€è¦ä»3ç¯ä¸€æ­¥ä¸€æ­¥è¿›å…¥åˆ°0ç¯ï¼Œè¿™ä¸€è¿‡ç¨‹å°±æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿç”¨åˆ°äº†ä¸­æ–­é—¨ï¼ˆä¸€äº›æ¯”è¾ƒè€çš„APIä½¿ç”¨çš„æ˜¯ä¸­æ–­é—¨ï¼Œä½†æ˜¯æ–°APIä¸­ä½¿ç”¨çš„éƒ½æ˜¯å¿«é€Ÿè°ƒç”¨ï¼‰</span><br></pre></td></tr></table></figure><ul><li>è°ƒè¯•</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¤§å®¶ä½¿ç”¨ODè°ƒè¯•ç¨‹åºæ—¶å€™ä¼šä½¿ç”¨æ–­ç‚¹ï¼Œæ–­ç‚¹æœ¬è´¨ä¸Šå°±æ˜¯åœ¨ä½ é€‰ä¸­çš„è¿™ä¸€è¡Œä¸­å†™å…¥ä¸€ä¸ªå­—èŠ‚0xCCï¼Œä¹Ÿå°±æ˜¯INT 3æŒ‡ä»¤ï¼Œè¿™ä¸ªæŒ‡ä»¤å°±æ˜¯ç”¨æ¥æ‰§è¡Œä¸­æ–­é—¨çš„ã€‚ä¸­æ–­é—¨ä¹Ÿæœ‰ä¸€å¼ è¡¨ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºIDTï¼ˆä¸­æ–­æè¿°ç¬¦è¡¨ï¼‰ï¼Œä¸GDTä¸€æ ·ï¼ŒIDTä¹Ÿæ˜¯ç”±ä¸€ç³»åˆ—æè¿°ç¬¦ç»„æˆçš„ï¼Œæ¯ä¸ªæè¿°ç¬¦å 8å­—èŠ‚ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯IDTè¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸æ˜¯NULLï¼ˆGDTæ˜¯ï¼‰</span><br></pre></td></tr></table></figure><h2 id="1ã€IDT"><a href="#1ã€IDT" class="headerlink" title="1ã€IDT"></a>1ã€IDT</h2><p>IDTå³ä¸­æ–­æè¿°ç¬¦è¡¨,åŒGDTä¸€æ ·ï¼ŒIDTä¹Ÿæ˜¯ç”±ä¸€ç³»åˆ—æè¿°ç¬¦ç»„æˆçš„ï¼Œæ¯ä¸ªæè¿°ç¬¦å 8ä¸ªå­—èŠ‚ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼ŒIDTè¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸æ˜¯NULLã€‚åœ¨windbgä¸­æŸ¥çœ‹IDTè¡¨çš„åŸºå€å’Œé•¿åº¦</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/30/lXbPi73p6xbUDvXFmwb01727672653729.png" alt="image-20240930130413487"></p><h2 id="2ã€IDTè¡¨çš„æ„æˆ"><a href="#2ã€IDTè¡¨çš„æ„æˆ" class="headerlink" title="2ã€IDTè¡¨çš„æ„æˆ"></a>2ã€IDTè¡¨çš„æ„æˆ</h2><p>IDTè¡¨å¯ä»¥åŒ…å«3ç§é—¨æè¿°ç¬¦ï¼š</p><ul><li>ä»»åŠ¡é—¨æè¿°ç¬¦</li><li>ä¸­æ–­é—¨æè¿°ç¬¦</li><li>é™·é˜±é—¨æè¿°ç¬¦</li></ul><h2 id="3ã€ä¸­æ–­é—¨æè¿°ç¬¦ç»“æ„"><a href="#3ã€ä¸­æ–­é—¨æè¿°ç¬¦ç»“æ„" class="headerlink" title="3ã€ä¸­æ–­é—¨æè¿°ç¬¦ç»“æ„"></a>3ã€ä¸­æ–­é—¨æè¿°ç¬¦ç»“æ„</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/30/FBiQhnxsDRtKLOyDNhKN1727672735493.png" alt="image-20240930130535215"></p><p>å½“<strong>8-12ä½</strong>çš„å€¼æ˜¯<strong>01110</strong>åˆ™æ˜¯ä¸€ä¸ª<strong>ä¸­æ–­é—¨</strong></p><p>å‡½æ•°æ‰§è¡Œï¼š401030</p><p>0040ee00&#96;00081030</p><h2 id="4ã€æ„é€ ä¸€ä¸ªä¸­æ–­é—¨"><a href="#4ã€æ„é€ ä¸€ä¸ªä¸­æ–­é—¨" class="headerlink" title="4ã€æ„é€ ä¸€ä¸ªä¸­æ–­é—¨"></a>4ã€æ„é€ ä¸€ä¸ªä¸­æ–­é—¨</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//INT index æŒ‡ä»¤è§¦å‘å¯»æ‰¾ä¸­æ–­é—¨</span></span><br><span class="line"><span class="comment">//å½“å‰ï¼ˆå†™å…¥çš„åœ°å€-idté¦–åœ°å€ï¼‰/ 8 = indexç´¢å¼• 16è¿›åˆ¶ </span></span><br><span class="line">__asm&#123;</span><br><span class="line">    push fs</span><br><span class="line">    INT <span class="number">0x22</span></span><br><span class="line">    pop fs</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5ã€ä¸­æ–­æ‰§è¡Œ"><a href="#5ã€ä¸­æ–­æ‰§è¡Œ" class="headerlink" title="5ã€ä¸­æ–­æ‰§è¡Œ"></a>5ã€ä¸­æ–­æ‰§è¡Œ</h2><p>INTX<br>å…¶ä¸­ï¼ŒXæ˜¯ç´¢å¼•ï¼Œ<strong>X*8+IDTçš„åŸºå€</strong>å°±æ˜¯å…·ä½“çš„ä¸­æ–­é—¨æè¿°ç¬¦</p><h2 id="6ã€ä¸­æ–­è¿”å›"><a href="#6ã€ä¸­æ–­è¿”å›" class="headerlink" title="6ã€ä¸­æ–­è¿”å›"></a>6ã€ä¸­æ–­è¿”å›</h2><p>INT NæŒ‡ä»¤ï¼š</p><ol><li><p>åœ¨<strong>æ²¡æœ‰æƒé™åˆ‡æ¢æ—¶</strong>ï¼Œä¼šå‘å †æ ˆ<strong>PUSH 3</strong>ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ï¼š<strong>CS EFLAG EIP</strong>ï¼ˆè¿”å›åœ°å€ï¼‰</p></li><li><p>åœ¨<strong>æœ‰æƒé™åˆ‡æ¢æ—¶</strong>ï¼Œä¼šå‘å †æ ˆ<strong>PUSH 5</strong>ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ï¼š<strong>SS ESP EFLAG CS EIP</strong>ï¼ˆè¿”å›åœ°å€ï¼‰</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/02/KWvP6brQkxNkfez6mEC51727873709073.png" alt="image-20241002205508651"></p></li></ol><p>åœ¨ä¸­æ–­é—¨ä¸­ï¼Œ<strong>ä¸èƒ½é€šè¿‡RETFè¿”å›</strong>ï¼Œè€Œåº”è¯¥é€šè¿‡<strong>IRET&#x2F;IRETD</strong>æŒ‡ä»¤è¿”å›</p><h1 id="é™·é˜±é—¨"><a href="#é™·é˜±é—¨" class="headerlink" title="é™·é˜±é—¨"></a>é™·é˜±é—¨</h1><h2 id="1ã€é™·é˜±é—¨æè¿°ç¬¦ç»“æ„"><a href="#1ã€é™·é˜±é—¨æè¿°ç¬¦ç»“æ„" class="headerlink" title="1ã€é™·é˜±é—¨æè¿°ç¬¦ç»“æ„"></a>1ã€é™·é˜±é—¨æè¿°ç¬¦ç»“æ„</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/30/TtzQriS89EmV91AhknSR1727672874147.png" alt="image-20240930130753905"></p><p>å½“<strong>8-12ä½</strong>çš„å€¼æ˜¯<strong>01111</strong>åˆ™æ˜¯ä¸€ä¸ª<strong>é™·é˜±é—¨</strong></p><h2 id="2ã€æ„é€ ä¸€ä¸ªé™·é˜±é—¨"><a href="#2ã€æ„é€ ä¸€ä¸ªé™·é˜±é—¨" class="headerlink" title="2ã€æ„é€ ä¸€ä¸ªé™·é˜±é—¨"></a>2ã€æ„é€ ä¸€ä¸ªé™·é˜±é—¨</h2><p>æ„é€ ä¸€ä¸ªé™·é˜±é—¨ï¼ˆ0040EF00 00081030ï¼‰</p><p>0000ef00 00080000</p><p>0000 0000 0000 0000 1110 1111 0000 0000</p><p>å†™å…¥åˆ°IDTè¡¨ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eq&gt;8003f500 0040EF00`0008103</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œé™·é˜±é—¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__asm&#123;</span><br><span class="line">    INT 0x32</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3ã€é™·é˜±é—¨ä¸ä¸­æ–­é—¨çš„åŒºåˆ«"><a href="#3ã€é™·é˜±é—¨ä¸ä¸­æ–­é—¨çš„åŒºåˆ«" class="headerlink" title="3ã€é™·é˜±é—¨ä¸ä¸­æ–­é—¨çš„åŒºåˆ«"></a>3ã€é™·é˜±é—¨ä¸ä¸­æ–­é—¨çš„åŒºåˆ«</h2><p>ä¸­æ–­é—¨æ‰§è¡Œæ—¶ï¼Œå°†IFä½ï¼ˆä¸­æ–­æ ‡å¿—ï¼‰æ¸…é›¶,ä½†é™·é˜±é—¨ä¸ä¼šã€‚</p><h1 id="ä»»åŠ¡æ®µ"><a href="#ä»»åŠ¡æ®µ" class="headerlink" title="ä»»åŠ¡æ®µ"></a>ä»»åŠ¡æ®µ</h1><p>åœ¨è°ƒç”¨é—¨ã€ä¸­æ–­é—¨ä¸é™·é˜±é—¨ä¸­ï¼Œä¸€æ—¦å‡ºç°æƒé™åˆ‡æ¢ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰å †æ ˆçš„åˆ‡æ¢ã€‚è€Œä¸”ï¼Œç”±äºCSçš„CPLå‘ç”Ÿæ”¹å˜ï¼Œä¹Ÿå¯¼è‡´äº†SSä¹Ÿå¿…é¡»è¦åˆ‡æ¢ã€‚</p><p>åˆ‡æ¢æ—¶ï¼Œä¼šæœ‰æ–°çš„ESPå’ŒSS(CSæ˜¯ç”±ä¸­æ–­é—¨æˆ–è€…è°ƒç”¨é—¨æŒ‡å®š)è¿™2ä¸ªå€¼ä»å“ªé‡Œæ¥çš„å‘¢ï¼Ÿ<strong>TSS (Task-state segment )ï¼Œä»»åŠ¡çŠ¶æ€æ®µ.</strong></p><h2 id="1ã€TSSçš„ç»“æ„"><a href="#1ã€TSSçš„ç»“æ„" class="headerlink" title="1ã€TSSçš„ç»“æ„"></a>1ã€TSSçš„ç»“æ„</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/30/zFWvIRU2iyFyxWS9Ad7v1727701379679.png" alt="image-20240930210259383"></p><p>å¤§å°104å­—èŠ‚</p><h2 id="2ã€TSSçš„ä½œç”¨"><a href="#2ã€TSSçš„ä½œç”¨" class="headerlink" title="2ã€TSSçš„ä½œç”¨"></a>2ã€TSSçš„ä½œç”¨</h2><p>ä¸è¦æŠŠTSSä¸â€œä»»åŠ¡åˆ‡æ¢â€è”ç³»åˆ°ä¸€èµ·</p><p>TSSçš„æ„ä¹‰å°±åœ¨äº<strong>å¯ä»¥åŒæ—¶æ¢æ‰â€ä¸€å †â€å¯„å­˜å™¨</strong></p><h2 id="3ã€TRæ®µå¯„å­˜å™¨å–å€¼"><a href="#3ã€TRæ®µå¯„å­˜å™¨å–å€¼" class="headerlink" title="3ã€TRæ®µå¯„å­˜å™¨å–å€¼"></a>3ã€TRæ®µå¯„å­˜å™¨å–å€¼</h2><p>CPUå¦‚ä½•æ‰¾åˆ°TSSå‘¢?  é€šè¿‡<strong>TRæ®µå¯„å­˜å™¨</strong>ï¼Œbaseæ‰¾åˆ°TSSå†…å­˜ LimitæŒ‡çš„æ˜¯TSSå†…å­˜å¤§å°ï¼ŒTRæ®µå¯„å­˜å™¨å€¼æ¥è‡ªäºGDTè¡¨ï¼ŒGDTè¡¨é‡Œçš„TSSæ®µæè¿°ç¬¦</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/30/BnuP5qcHZBwLYcgSi9NJ1727701491032.png" alt="image-20240930210450817"></p><h2 id="4ã€TSSæ®µæè¿°ç¬¦-TSS-Descriptor"><a href="#4ã€TSSæ®µæè¿°ç¬¦-TSS-Descriptor" class="headerlink" title="4ã€TSSæ®µæè¿°ç¬¦(TSS Descriptor)"></a>4ã€TSSæ®µæè¿°ç¬¦(TSS Descriptor)</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/30/Ds8KSWImUOVrDsg0fZ5h1727701602037.png" alt="image-20240930210641733"></p><h2 id="5ã€TRå¯„å­˜å™¨è¯»å†™"><a href="#5ã€TRå¯„å­˜å™¨è¯»å†™" class="headerlink" title="5ã€TRå¯„å­˜å™¨è¯»å†™"></a>5ã€TRå¯„å­˜å™¨è¯»å†™</h2><ol><li>å°†TSSæ®µæè¿°ç¬¦åŠ è½½åˆ°TRå¯„å­˜å™¨</li></ol><p>æŒ‡ä»¤ï¼šLTR</p><p>è¯´æ˜ï¼š</p><ul><li><p>ç”¨LTRæŒ‡ä»¤å»è£…è½½çš„è¯ä»…ä»…æ˜¯æ”¹å˜TRå¯„å­˜å™¨çš„å€¼(96ä½) å¹¶æ²¡æœ‰çœŸæ­£æ”¹å˜TSS  </p></li><li><p>LTRæŒ‡ä»¤åªèƒ½åœ¨ç³»ç»Ÿå±‚ä½¿ç”¨</p></li><li><p>åŠ è½½åTSSæ®µæè¿°ç¬¦ä¼šçŠ¶æ€ä½ä¼šå‘ç”Ÿæ”¹å˜</p></li></ul><h2 id="6ã€ä¿®æ”¹TRå¯„å­˜å™¨"><a href="#6ã€ä¿®æ”¹TRå¯„å­˜å™¨" class="headerlink" title="6ã€ä¿®æ”¹TRå¯„å­˜å™¨"></a>6ã€ä¿®æ”¹TRå¯„å­˜å™¨</h2><ul><li>åœ¨Ring0 æˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>LTRæŒ‡ä»¤</strong>å»ä¿®æ”¹TRå¯„å­˜å™¨</li><li>åœ¨Ring3 æˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>CALL FAR</strong> æˆ–è€… <strong>JMP FAR</strong>æŒ‡ä»¤æ¥ä¿®æ”¹</li></ul><p>ç”¨JMPå»è®¿é—®ä¸€ä¸ªä»£ç æ®µçš„æ—¶å€™ï¼Œæ”¹å˜çš„æ˜¯CSå’ŒEIP ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JMP 0x48:0x123456  å¦‚æœ0x48æ˜¯ä»£ç æ®µ  </span><br><span class="line">æ‰§è¡Œåï¼šCS--&gt;0x48  EIP--&gt;0x123456</span><br></pre></td></tr></table></figure><p>ç”¨JMPå»è®¿é—®ä¸€ä¸ªä»»åŠ¡æ®µçš„æ—¶å€™ï¼š</p><p>å¦‚æœ0x48æ˜¯TSSæ®µæè¿°ç¬¦ï¼Œå…ˆä¿®æ”¹TRå¯„å­˜å™¨ï¼Œåœ¨ç”¨TR.BaseæŒ‡å‘çš„TSSä¸­çš„å€¼ä¿®æ”¹å½“å‰çš„å¯„å­˜å™¨</p><p><strong>æ³¨æ„ï¼š</strong></p><p>å¦‚æœä½ ç”¨<strong>JMP</strong>çš„è¯<strong>Previous Task Linkçš„å€¼ä¸å˜</strong>å’Œ<strong>NTä½ä¸å˜</strong>ï¼Œæ²¡æœ‰äººç»™ä½ å¡«å……åˆå§‹å€¼å¤šå°‘ç°åœ¨å°±å¤šå°‘ï¼Œå¦‚æœç”¨<strong>Call</strong>é‚£å°±ä¼šå†™æˆåŸæ¥é‚£ä¸ª<strong>TSSæ®µçš„é€‰æ‹©å­</strong>å’Œ<strong>NTä½ç½®1</strong></p><p>NT &#x3D; 0 IRETï¼ˆå †æ ˆå– ä¸­æ–­è¿”å›ï¼‰</p><p>NT &#x3D; 1 IRET ï¼ˆTSS:PTL ä¸æ˜¯ä¸­æ–­è¿”å›ï¼‰</p><h2 id="7ã€å®ç°ä»»åŠ¡åˆ‡æ¢"><a href="#7ã€å®ç°ä»»åŠ¡åˆ‡æ¢" class="headerlink" title="7ã€å®ç°ä»»åŠ¡åˆ‡æ¢"></a>7ã€å®ç°ä»»åŠ¡åˆ‡æ¢</h2><ol><li>æ„é€ å®Œæ•´çš„TSS</li><li>æ„é€ TSSæ®µæè¿°ç¬¦</li><li>ä½¿ç”¨CALL FAR&#x2F;JMP FARæŒ‡ä»¤ä¿®æ”¹TRå¯„å­˜å™¨</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> o_eax, n_esp;</span><br><span class="line"><span class="type">short</span> n_cs, n_ss;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> __declspec(naked) <span class="built_in">GetValue</span>() &#123;</span><br><span class="line">    <span class="comment">// å°†å¯„å­˜å™¨ä¿å­˜åˆ°å…¨å±€å˜é‡ä¸­</span></span><br><span class="line">    _asm &#123;</span><br><span class="line">        mov o_eax, eax</span><br><span class="line">        mov n_esp, esp</span><br><span class="line">        mov ax, cs</span><br><span class="line">        mov n_cs, ax</span><br><span class="line">        mov ax, ss</span><br><span class="line">        mov n_ss, ax</span><br><span class="line">        mov eax, o_eax</span><br><span class="line">        iretd</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> stack[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;; <span class="comment">// æ ˆ</span></span><br><span class="line">    <span class="type">char</span> buffer[<span class="number">6</span>] = &#123;<span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x4B</span>, <span class="number">0x0</span>&#125;; <span class="comment">// é€‰æ‹©å­</span></span><br><span class="line">    <span class="type">int</span> iCr3 = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Input: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%x&quot;</span>, &amp;iCr3);</span><br><span class="line">    <span class="built_in">getchar</span>();</span><br><span class="line"> </span><br><span class="line">    DWORD tss[<span class="number">0x68</span>] = &#123;</span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// Previous Task Link</span></span><br><span class="line">        <span class="comment">// ä¸åŒæƒé™å¯¹åº”çš„ESPã€SSï¼Œå¦‚æœä¸æ¶‰åŠåˆ°æƒé™åˆ‡æ¢æ‰€ä»¥å¯ä»¥å°†è¿™äº›å¯„å­˜å™¨çš„å€¼å…¨éƒ¨å¡«0</span></span><br><span class="line">        <span class="number">0x00000000</span>, <span class="comment">// ESP0</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// SS0</span></span><br><span class="line">        <span class="number">0x00000000</span>, <span class="comment">// ESP1</span></span><br><span class="line">        <span class="number">0x00000000</span>, <span class="comment">// SS1</span></span><br><span class="line">        <span class="number">0x00000000</span>, <span class="comment">// ESP2</span></span><br><span class="line">        <span class="number">0x00000000</span>, <span class="comment">// SS2</span></span><br><span class="line">        (DWORD)iCr3, <span class="comment">// Cr3ï¼Œä¸é¡µçš„çŸ¥è¯†æœ‰å…³ï¼Œå¿…é¡»è¦èµ‹å€¼</span></span><br><span class="line">        <span class="number">0x00401020</span>,    <span class="comment">// EIPï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œä»£ç çš„ä½ç½®ï¼Œå¿…é¡»è¦èµ‹å€¼ï¼Œåœ¨ä»£ç ä¸­å°±æ˜¯GetValueå‡½æ•°çš„åœ°å€</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// EFLAGS</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// EAX</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// ECX</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// EDX</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// EBX</span></span><br><span class="line">        (DWORD)stack, <span class="comment">// ESPï¼Œä»»åŠ¡åˆ‡æ¢æ—¶ä¹Ÿéœ€è¦åˆ‡æ¢æ ˆï¼Œæ‰€ä»¥åœ¨ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥å£°æ˜ä¸€ä¸ªæ•°ç»„ï¼Œå°†å…¶åœ°å€ä½œä¸ºä¸€å—æ ˆ</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// EBP</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// ESI</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// EDI</span></span><br><span class="line">        <span class="number">0x00000023</span>,    <span class="comment">// ES</span></span><br><span class="line">        <span class="number">0x00000008</span>, <span class="comment">// CSï¼Œåˆ‡åˆ°0ç¯çš„ä»£ç æ®µæè¿°ç¬¦</span></span><br><span class="line">        <span class="number">0x00000010</span>,    <span class="comment">// SSï¼ŒCSä¸SSéœ€è¦ä¿æŒä¸€è‡´</span></span><br><span class="line">        <span class="number">0x00000023</span>,    <span class="comment">// DS</span></span><br><span class="line">        <span class="number">0x00000030</span>,    <span class="comment">// FSï¼Œåˆ‡åˆ°0ç¯å°±æ˜¯0x30ï¼Œ3ç¯å°±æ˜¯0x3B</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// GSï¼ŒWindowsæ²¡æœ‰ä½¿ç”¨è¿™ä¸ªæ®µå¯„å­˜å™¨æ‰€ä»¥æ°¸è¿œæ˜¯0</span></span><br><span class="line">        <span class="number">0x00000000</span>,    <span class="comment">// LDTï¼Œå¡«0</span></span><br><span class="line">        <span class="number">0x20ac0000</span>    <span class="comment">// IO_MAPï¼ŒWindows2000ä»¥åä¸ç”¨äº†ï¼Œé»˜è®¤å€¼</span></span><br><span class="line">    &#125;;</span><br><span class="line"> </span><br><span class="line">    _asm &#123;</span><br><span class="line">        push fs</span><br><span class="line">        call far fword ptr[buffer] <span class="comment">// é•¿è°ƒç”¨</span></span><br><span class="line">        pop fs</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// è¾“å‡ºå¯„å­˜å™¨çš„å€¼è¯æ˜å®Œæˆäº†ä»»åŠ¡åˆ‡æ¢</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ESP: %x, CS: %x, SS: %x \n&quot;</span>, n_esp, n_cs, n_ss);</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">getchar</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®TSSæ®µæè¿°ç¬¦çš„ç»“æ„æ„é€ æè¿°ç¬¦ï¼Œé¦–å…ˆè·å–TSSçš„åœ°å€ï¼Œåœ¨ä»£ç ä¸­ä¸‹æ–­ç‚¹ç„¶åæŸ¥çœ‹åœ°å€å³å¯ï¼šå…¶åœ°å€ä¸º0x0012fd70</p><p>æˆ‘ä»¬å°±å¾—å‡ºå¯¹åº”TSSæ®µæè¿°ç¬¦ä¸­Baseçš„å€¼ï¼Œæ¥ç€Limitå°±æ˜¯TSSçš„å¤§å°0x68ï¼ŒDPLä¸º3ï¼ˆ3ç¯ç¨‹åºè®¿é—®ï¼‰</p><p>TypeåŸŸä¸º0x9å³è¡¨ç¤ºå½“å‰æè¿°ç¬¦æ²¡æœ‰è¢«åŠ è½½è¿‡ã€‚</p><p>åœ¨Windbgä¸­æ–­ç‚¹è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kd&gt; !process 0 0</span><br></pre></td></tr></table></figure><p>æŒ‡ä»¤æ‰¾åˆ°å½“å‰çš„ç¨‹åºè·å–Cr3çš„å€¼å¡«å…¥åˆ°ç¨‹åºä¸­</p><p>æœ€ç»ˆå¾—å‡ºTSSæ®µæè¿°ç¬¦ä¸ºï¼š</p><p>æ„é€ TSSæ®µæè¿°ç¬¦ï¼šXX00e9XX&#96;XXXX0068</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tss:0x0012fc2c</span><br><span class="line">eq 8003f0c0 0000e912`fc2c0068</span><br><span class="line"></span><br><span class="line">cr3:bf3915e0 getValue 4113d0</span><br></pre></td></tr></table></figure><p>æ¥ç€æˆ‘ä»¬ä½¿ç”¨eqæŒ‡ä»¤åœ¨Windbgä¸­å‘GDTè¡¨ä¸­å†™å…¥æˆ‘ä»¬æ„é€ å¥½çš„TSSæ®µæè¿°ç¬¦ï¼š</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/07/KVPM6rvgNMFV4RVM17IW1728277738860.png" alt="image-20241007130858507"></p><p>é€šè¿‡windbgå¯„å­˜å™¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<strong>EIP,ESP,CS,SS</strong>å˜æˆäº†æˆ‘ä»¬è®¾ç½®çš„å€¼</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/06/6KYUZZx4ktu1GyYWmOak1728229374094.png" alt="image-20241006233017065"></p><h1 id="ä»»åŠ¡é—¨"><a href="#ä»»åŠ¡é—¨" class="headerlink" title="ä»»åŠ¡é—¨"></a>ä»»åŠ¡é—¨</h1><h2 id="1ã€ä»»åŠ¡é—¨æè¿°ç¬¦"><a href="#1ã€ä»»åŠ¡é—¨æè¿°ç¬¦" class="headerlink" title="1ã€ä»»åŠ¡é—¨æè¿°ç¬¦"></a>1ã€ä»»åŠ¡é—¨æè¿°ç¬¦</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/07/8U3GIHx0xIIpIhNHfYQq1728268454890.png" alt="image-20241007103357569"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ„é€ ä»»åŠ¡é—¨ï¼š0000 e500 00c3 0000</span><br><span class="line">&gt;eq 8003f500 0000e500`00c30000</span><br></pre></td></tr></table></figure><h2 id="2ã€ä»»åŠ¡é—¨æ‰§è¡Œè¿‡ç¨‹ï¼š"><a href="#2ã€ä»»åŠ¡é—¨æ‰§è¡Œè¿‡ç¨‹ï¼š" class="headerlink" title="2ã€ä»»åŠ¡é—¨æ‰§è¡Œè¿‡ç¨‹ï¼š"></a>2ã€ä»»åŠ¡é—¨æ‰§è¡Œè¿‡ç¨‹ï¼š</h2><ol><li><p>INT N</p></li><li><p>æŸ¥IDTè¡¨ï¼Œæ‰¾åˆ°ä¸­æ–­é—¨æè¿°ç¬¦</p></li><li><p>é€šè¿‡ä¸­æ–­é—¨æè¿°ç¬¦ï¼ŒæŸ¥GDTè¡¨ï¼Œæ‰¾åˆ°ä»»åŠ¡æ®µæè¿°ç¬¦</p></li><li><p>ä½¿ç”¨TSSæ®µä¸­çš„å€¼ä¿®æ”¹å¯„å­˜å™¨</p></li><li><p>IRETDè¿”å›</p></li></ol><h2 id="3ã€ä»£ç "><a href="#3ã€ä»£ç " class="headerlink" title="3ã€ä»£ç "></a>3ã€ä»£ç </h2><p>æ®µé€‰æ‹©å­ä¸€å®šè¦è®¡ç®—æ­£ç¡®</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">idt <span class="number">0x20</span> æ„é€ ä¸­æ–­é—¨</span><br><span class="line">eq <span class="number">8003</span>f500 <span class="number">0000e500</span>`<span class="number">004</span>b0000</span><br><span class="line">gdt <span class="number">0x4b</span> æ„é€ ä»»åŠ¡é—¨ <span class="number">0100</span> <span class="number">1011</span> RPLï¼š<span class="number">3</span>   </span><br><span class="line">eq <span class="number">8003</span>f048 <span class="number">0000e912</span>`fd700068 </span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo07.cpp : Defines the entry point for the console application.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line">DWORD dwOK,dwESP,dwCS;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> __declspec(naked) <span class="built_in">GetValue</span>() &#123;</span><br><span class="line">    <span class="comment">// å°†å¯„å­˜å™¨ä¿å­˜åˆ°å…¨å±€å˜é‡ä¸­</span></span><br><span class="line">dwOK = <span class="number">1</span>;</span><br><span class="line">_asm &#123;</span><br><span class="line">mov eax,esp</span><br><span class="line">mov dwESP,eax</span><br><span class="line">mov ax,cs</span><br><span class="line">mov word ptr[dwCS],ax</span><br><span class="line"></span><br><span class="line">iretd</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> stack[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;; <span class="comment">// æ ˆ</span></span><br><span class="line">    <span class="type">char</span> buffer[<span class="number">6</span>] = &#123;<span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xC0</span>, <span class="number">0x0</span>&#125;; <span class="comment">// é€‰æ‹©å­</span></span><br><span class="line">    <span class="type">int</span> iCr3 = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Input: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%x&quot;</span>, &amp;iCr3);</span><br><span class="line">    <span class="built_in">getchar</span>();</span><br><span class="line"></span><br><span class="line">DWORD tss[<span class="number">0x68</span>] = &#123;</span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// Previous Task Link</span></span><br><span class="line"><span class="comment">// ä¸åŒæƒé™å¯¹åº”çš„ESPã€SSï¼Œå¦‚æœä¸æ¶‰åŠåˆ°æƒé™åˆ‡æ¢æ‰€ä»¥å¯ä»¥å°†è¿™äº›å¯„å­˜å™¨çš„å€¼å…¨éƒ¨å¡«0</span></span><br><span class="line"><span class="number">0x00000000</span>, <span class="comment">// ESP0</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// SS0</span></span><br><span class="line"><span class="number">0x00000000</span>, <span class="comment">// ESP1</span></span><br><span class="line"><span class="number">0x00000000</span>, <span class="comment">// SS1</span></span><br><span class="line"><span class="number">0x00000000</span>, <span class="comment">// ESP2</span></span><br><span class="line"><span class="number">0x00000000</span>, <span class="comment">// SS2</span></span><br><span class="line">(DWORD)iCr3, <span class="comment">// Cr3ï¼Œä¸é¡µçš„çŸ¥è¯†æœ‰å…³ï¼Œå¿…é¡»è¦èµ‹å€¼</span></span><br><span class="line">(ULONG)GetValue,    <span class="comment">// EIPï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œä»£ç çš„ä½ç½®ï¼Œå¿…é¡»è¦èµ‹å€¼ï¼Œåœ¨ä»£ç ä¸­å°±æ˜¯GetValueå‡½æ•°çš„åœ°å€</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// EFLAGS</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// EAX</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// ECX</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// EDX</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// EBX</span></span><br><span class="line">(DWORD)stack, <span class="comment">// ESPï¼Œä»»åŠ¡åˆ‡æ¢æ—¶ä¹Ÿéœ€è¦åˆ‡æ¢æ ˆï¼Œæ‰€ä»¥åœ¨ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥å£°æ˜ä¸€ä¸ªæ•°ç»„ï¼Œå°†å…¶åœ°å€ä½œä¸ºä¸€å—æ ˆ</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// EBP</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// ESI</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// EDI</span></span><br><span class="line"><span class="number">0x00000023</span>,    <span class="comment">// ES</span></span><br><span class="line"><span class="number">0x00000008</span>, <span class="comment">// CSï¼Œåˆ‡åˆ°0ç¯çš„ä»£ç æ®µæè¿°ç¬¦</span></span><br><span class="line"><span class="number">0x00000010</span>,    <span class="comment">// SSï¼ŒCSä¸SSéœ€è¦ä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="number">0x00000023</span>,    <span class="comment">// DS</span></span><br><span class="line"><span class="number">0x00000030</span>,    <span class="comment">// FSï¼Œåˆ‡åˆ°0ç¯å°±æ˜¯0x30ï¼Œ3ç¯å°±æ˜¯0x3B</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// GSï¼ŒWindowsæ²¡æœ‰ä½¿ç”¨è¿™ä¸ªæ®µå¯„å­˜å™¨æ‰€ä»¥æ°¸è¿œæ˜¯0</span></span><br><span class="line"><span class="number">0x00000000</span>,    <span class="comment">// LDTï¼Œå¡«0</span></span><br><span class="line"><span class="number">0x20ac0000</span>    <span class="comment">// IO_MAPï¼ŒWindows2000ä»¥åä¸ç”¨äº†ï¼Œé»˜è®¤å€¼</span></span><br><span class="line">    &#125;;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;TSS:%x\n&quot;</span>,&amp;tss);</span><br><span class="line"><span class="built_in">getchar</span>();</span><br><span class="line">_asm &#123;</span><br><span class="line">PUSH fs</span><br><span class="line">        INT <span class="number">0X20</span> <span class="comment">// é•¿è°ƒç”¨</span></span><br><span class="line">POP fs</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºå¯„å­˜å™¨çš„å€¼è¯æ˜å®Œæˆäº†ä»»åŠ¡åˆ‡æ¢</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ESP: %x, CS: %x, dwOK: %x \n&quot;</span>, dwESP, dwCS, dwOK);</span><br><span class="line"><span class="built_in">getchar</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/07/8bKiXthV3rimrarhDWpU1728275715272.png" alt="image-20241007123514913"></p><h1 id="åˆ†é¡µ"><a href="#åˆ†é¡µ" class="headerlink" title="åˆ†é¡µ"></a>åˆ†é¡µ</h1><h2 id="1ã€4GBç©ºé—´"><a href="#1ã€4GBç©ºé—´" class="headerlink" title="1ã€4GBç©ºé—´"></a>1ã€4GBç©ºé—´</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/08/5Z5pnViAPg3J2BOweGCM1728390412723.png" alt="image-20241008202635838"></p><h2 id="2ã€ç‰©ç†åœ°å€"><a href="#2ã€ç‰©ç†åœ°å€" class="headerlink" title="2ã€ç‰©ç†åœ°å€"></a>2ã€ç‰©ç†åœ°å€</h2><p>åœ°å€åˆ†ä¸ºï¼šçº¿æ€§åœ°å€ã€æœ‰æ•ˆåœ°å€ã€ç‰©ç†åœ°å€</p><p>æŒ‡ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOV eax,dword ptr ds:[0x12345678]</span><br></pre></td></tr></table></figure><p>0x12345678æ˜¯å±äº<strong>æœ‰æ•ˆåœ°å€</strong></p><p>ds.base+0x12345678 &#x3D; <strong>çº¿æ€§åœ°å€</strong></p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/08/LKXCn1fsd7zd5qKDjvyr1728390530624.png" alt="image-20241008202850335"></p><h2 id="3ã€ç‰©ç†åœ¨å“ª"><a href="#3ã€ç‰©ç†åœ¨å“ª" class="headerlink" title="3ã€ç‰©ç†åœ¨å“ª"></a>3ã€ç‰©ç†åœ¨å“ª</h2><p>æ¯ä¸ªè¿›ç¨‹<strong>éƒ½æœ‰</strong>ä¸€ä¸ªCR3ï¼Œ(å‡†ç¡®çš„è¯´æ˜¯éƒ½ä¸€ä¸ªCR3çš„å€¼ï¼ŒCR3æœ¬èº«æ˜¯ä¸ªå¯„å­˜å™¨ï¼Œä¸€ä¸ªæ ¸ï¼Œåªæœ‰ä¸€å¥—å¯„å­˜å™¨)</p><p>CR3æŒ‡å‘<strong>ä¸€ä¸ªç‰©ç†é¡µ</strong>ï¼Œä¸€å…±<strong>4096å­—èŠ‚</strong></p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/08/n8OTgsBNZHoo6Mnf1kXc1728390608743.png" alt="image-20241008203008475"></p><h2 id="4ã€è®¾ç½®åˆ†é¡µæ–¹å¼"><a href="#4ã€è®¾ç½®åˆ†é¡µæ–¹å¼" class="headerlink" title="4ã€è®¾ç½®åˆ†é¡µæ–¹å¼"></a>4ã€è®¾ç½®åˆ†é¡µæ–¹å¼</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/08/IELhIlCFpMemfDTyLMOS1728390680467.png" alt="image-20241008203120205"></p><p>å°†<strong>noexecute</strong> æ”¹æˆ <strong>execute</strong></p><h2 id="5ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ10-10-12ä¸ºä¾‹ï¼‰"><a href="#5ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ10-10-12ä¸ºä¾‹ï¼‰" class="headerlink" title="5ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ10-10-12ä¸ºä¾‹ï¼‰"></a>5ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ10-10-12ä¸ºä¾‹ï¼‰</h2><p>10-10-12 ä¸€å…±32ä½ï¼ŒæŠŠä¸€æ®µåœ°å€æ‹†åˆ†æˆä¸‰æ®µ10ä½ 10ä½ 12ä½</p><p>ç”¨notepadä¸ºä¾‹</p><p>ç¬¬ä¸€æ­¥å…ˆåœ¨notepadä¸­å†™å…¥ä¸€ä¸ªhello worldå­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨CEè¿›è¡Œæœç´¢æ‹¿åˆ°å­—ç¬¦ä¸²åœ¨è¿›ç¨‹ä¸­çš„åœ°å€</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/08/DILMxADdzyK8ixm2nJRD1728395216103.png" alt="image-20241008214655861"></p><p>ç¬¬äºŒæ­¥æ‹†åˆ†åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">000AA750 hello worldå­—ç¬¦ä¸²åœ¨è¿›ç¨‹ä¸­åœ°å€</span><br><span class="line">ç¬¬ä¸€çº§ï¼š0000 0000 00     0</span><br><span class="line">ç¬¬äºŒçº§ï¼š00 1010 1010     AA * 4 = 2A8</span><br><span class="line">ç¬¬ä¸‰çº§ï¼š750</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥windbgè¿›è¡ŒæŸ¥çœ‹æ‰¾åˆ°cr3çš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DirBase:314b7000</span><br><span class="line">ç¬¬ä¸€çº§ï¼š!dd cr3+0 = 314b7000+0</span><br><span class="line">ç¬¬äºŒçº§ï¼š!dd 3192d067+2A8 åé¢ä¸‰ä½æ˜¯å±æ€§ä½¿ç”¨æ—¶æ”¹æˆ000</span><br><span class="line">ç¬¬ä¸‰çº§ï¼š!dd 319ed000+750</span><br><span class="line">!db 319ed000+750 å¯éªŒè¯</span><br></pre></td></tr></table></figure><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/08/n0Fqj6QeO61jV0UAt96v1728395638354.png" alt="image-20241008215310139"></p><h1 id="PDE-PTE"><a href="#PDE-PTE" class="headerlink" title="PDE&#x2F;PTE"></a>PDE&#x2F;PTE</h1><h2 id="PDEå’ŒPTEä»‹ç»"><a href="#PDEå’ŒPTEä»‹ç»" class="headerlink" title="PDEå’ŒPTEä»‹ç»"></a>PDEå’ŒPTEä»‹ç»</h2><h3 id="1ã€PDEä¸PTE"><a href="#1ã€PDEä¸PTE" class="headerlink" title="1ã€PDEä¸PTE"></a>1ã€PDEä¸PTE</h3><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/08/EjZKLDijGZbnrSOdBkU61728396699049.png" alt="image-20241008221138790"></p><h3 id="2ã€æŒ‡å‘ç›¸åŒç‰©ç†é¡µ"><a href="#2ã€æŒ‡å‘ç›¸åŒç‰©ç†é¡µ" class="headerlink" title="2ã€æŒ‡å‘ç›¸åŒç‰©ç†é¡µ"></a>2ã€æŒ‡å‘ç›¸åŒç‰©ç†é¡µ</h3><ol><li>PTEå¯ä»¥æ²¡æœ‰ç‰©ç†é¡µï¼Œä¸”åªèƒ½å¯¹åº”ä¸€ä¸ªç‰©ç†é¡µ</li><li>å¤šä¸ªPTEä¹Ÿå¯ä»¥æŒ‡å‘åŒä¸€ä¸ªç‰©ç†é¡µ</li></ol><h3 id="3ã€å®éªŒ-1"><a href="#3ã€å®éªŒ-1" class="headerlink" title="3ã€å®éªŒ"></a>3ã€å®éªŒ</h3><p>æŸ¥åˆ†0åœ°å€ï¼Œè§‚å¯ŸPTEæ˜¯å¦æœ‰ç‰©ç†é¡µ</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/10/oFPnasTRJaT0o3mZTDWj1728560982174.png" alt="image-20241010194913603"></p><p>å‘0åœ°å€è¯»å†™æ•°æ®</p><p>æ²¡æœ‰æŒ‚ç‰©ç†é¡µä¹‹å‰å‘0åœ°å€å†™å…¥ä¸äº†æ•°æ®</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/10/Q9MSk8uXQly3SxtL4xX21728561255881.png" alt="image-20241010195415642"></p><p>æ‰‹åŠ¨æŒ‚ç‰©ç†é¡µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">xçš„çº¿æ€§åœ°å€ï¼š0x1245052</span><br><span class="line">å…ˆæ‹†åˆ†</span><br><span class="line">0000 0001 00 10</span><br><span class="line">10 0100 0101 245 * 4 = 914</span><br><span class="line">052</span><br><span class="line"></span><br><span class="line">DirBase: 553aa000</span><br><span class="line">ç¬¬ä¸€çº§ï¼š</span><br><span class="line">kd&gt; !dd 553aa000</span><br><span class="line">#553aa000 54ad6067 54a95067 00000000 00000000</span><br><span class="line">#553aa010 00000000 00000000 00000000 00000000</span><br><span class="line">#553aa020 00000000 00000000 00000000 00000000</span><br><span class="line">#553aa030 00000000 00000000 00000000 00000000</span><br><span class="line">#553aa040 00000000 00000000 00000000 00000000</span><br><span class="line">#553aa050 00000000 00000000 00000000 00000000</span><br><span class="line">#553aa060 00000000 00000000 00000000 00000000</span><br><span class="line">#553aa070 00000000 00000000 00000000 00000000</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒçº§ï¼š</span><br><span class="line">kd&gt; !dd 54ad6000 + 914</span><br><span class="line">#54ad6914 54df5067 00000000 00000000 00000000</span><br><span class="line">#54ad6924 00000000 00000000 00000000 00000000</span><br><span class="line">#54ad6934 00000000 00000000 00000000 5576d067</span><br><span class="line">#54ad6944 5556f067 553b0067 00000000 00000000</span><br><span class="line">#54ad6954 00000000 00000000 00000000 00000000</span><br><span class="line">#54ad6964 00000000 00000000 00000000 00000000</span><br><span class="line">#54ad6974 00000000 00000000 00000000 0bb31025</span><br><span class="line">#54ad6984 0bb32025 00000000 00000000 00000000</span><br><span class="line"></span><br><span class="line">æŸ¥è¯¢ä¸‹0åœ°å€</span><br><span class="line">kd&gt; !dd 54ad6000</span><br><span class="line">#54ad6000 00000000 00000000 00000000 00000000</span><br><span class="line">#54ad6010 00000000 00000000 00000000 00000000</span><br><span class="line">#54ad6020 00000000 00000000 00000000 00000000</span><br><span class="line">#54ad6030 00000000 00000000 00000000 00000000</span><br><span class="line">#54ad6040 54e97067 00000000 00000000 00000000</span><br><span class="line">#54ad6050 00000000 00000000 00000000 00000000</span><br><span class="line">#54ad6060 00000000 00000000 00000000 00000000</span><br><span class="line">#54ad6070 00000000 00000000 00000000 00000000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æŠŠå½“å‰xå˜é‡çš„ç‰©ç†é¡µæŒ‚åˆ°0åœ°å€ä¸Š</span><br><span class="line">kd&gt; !ed 54ad6000 54df5067</span><br></pre></td></tr></table></figure><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/10/FsSU6DnjN4Z7Ds622Wg81728562002027.png" alt="image-20241010200641755"></p><h2 id="PDE-PTE-å±æ€§"><a href="#PDE-PTE-å±æ€§" class="headerlink" title="PDE&#x2F;PTE å±æ€§"></a>PDE&#x2F;PTE å±æ€§</h2><h3 id="1ã€ç‰©ç†é¡µçš„å±æ€§"><a href="#1ã€ç‰©ç†é¡µçš„å±æ€§" class="headerlink" title="1ã€ç‰©ç†é¡µçš„å±æ€§"></a>1ã€ç‰©ç†é¡µçš„å±æ€§</h3><p>ç‰©ç†é¡µçš„å±æ€§ &#x3D; PDEå±æ€§ &amp; PTEå±æ€§</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/10/vtQpUVZN57SBHaANIgUL1728566338534.png" alt="image-20241010211858304"></p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/10/zkjSN56LctzrSPqnSDvv1728566358327.png" alt="image-20241010211917981"></p><h3 id="2ã€Pä½"><a href="#2ã€Pä½" class="headerlink" title="2ã€Pä½"></a>2ã€Pä½</h3><p>PDEå’ŒPTEçš„Pä½<strong>å¦‚æœä¸º0</strong>ï¼Œåˆ™å½“å‰çš„ç‰©ç†é¡µæ˜¯<strong>æ— æ•ˆçš„</strong>ï¼Œåä¹‹</p><h3 id="3ã€R-Wä½"><a href="#3ã€R-Wä½" class="headerlink" title="3ã€R&#x2F;Wä½"></a>3ã€R&#x2F;Wä½</h3><p>R&#x2F;W &#x3D; 0 åªè¯»</p><p>R&#x2F;W &#x3D; 1 å¯è¯»å¯å†™</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span>* str = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>,str);</span><br><span class="line">getchar();</span><br><span class="line"></span><br><span class="line">DWORD dwAddr = (DWORD)str;</span><br><span class="line"></span><br><span class="line">*(<span class="type">char</span>*)dwAddr = <span class="string">&#x27;M&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,str);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å·²çŸ¥ä¸Šé¢ä»£ç åœ¨æ­£å¸¸æƒ…å†µä¸‹stræ˜¯åªè¯»çš„ï¼Œåç»­æ˜¯æ— æ³•å¯¹å®ƒè¿›è¡Œä»»ä½•çš„ä¿®æ”¹æ“ä½œçš„ã€‚ä¼šæŠ¥é”™å†…å­˜è®¿é—®å¼‚å¸¸</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/10/EukWg5CVN7ypP6QawaLB1728566675871.png" alt="image-20241010212435527"></p><p>ç°åœ¨æˆ‘ä»¬å¯¹R&#x2F;Wä½è¿›è¡ŒæŸ¥è¯¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">0x420f94</span><br><span class="line">Dirbase:7f4fd000</span><br><span class="line">0000 0000 01 </span><br><span class="line">00 0010 0000 20*4=80</span><br><span class="line">f94</span><br><span class="line">ç¬¬ä¸€çº§ï¼š</span><br><span class="line">kd&gt; !dd 7f4fd000</span><br><span class="line">#7f4fd000 7f57b067 7f7ba067 00000000 00000000</span><br><span class="line">#7f4fd010 00000000 00000000 00000000 00000000</span><br><span class="line">#7f4fd020 00000000 00000000 00000000 00000000</span><br><span class="line">#7f4fd030 00000000 00000000 00000000 00000000</span><br><span class="line">#7f4fd040 00000000 00000000 00000000 00000000</span><br><span class="line">#7f4fd050 00000000 00000000 00000000 00000000</span><br><span class="line">#7f4fd060 00000000 00000000 00000000 00000000</span><br><span class="line">#7f4fd070 00000000 00000000 00000000 00000000</span><br><span class="line">ç¬¬äºŒçº§ï¼š</span><br><span class="line">kd&gt; !dd 7f7ba000 + 80</span><br><span class="line">#7f7ba080 7c7e9025 00000000 00de4067 7f895067</span><br><span class="line">#7f7ba090 7fe65067 7eb52027 00000000 00000000</span><br><span class="line">#7f7ba0a0 00000000 00000000 00000000 00000000</span><br><span class="line">#7f7ba0b0 00000000 00000000 00000000 00000000</span><br><span class="line">#7f7ba0c0 7f8dc067 7f7dd067 7f5de067 7f8df067</span><br><span class="line">#7f7ba0d0 7f960067 7fe61067 00de2067 7fbe3067</span><br><span class="line">#7f7ba0e0 00000000 00000000 00000000 00000000</span><br><span class="line">#7f7ba0f0 00000000 00000000 00000000 00000000</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°<code>7c7e9025</code>å¯¹åº”çš„äºŒè¿›åˆ¶æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0111 1100 0111 1110 1001 0000 0010 0101  è€Œç¬¬äºŒä½R/Wï¼š0 è¯´æ˜æ˜¯åªè¯»æƒé™</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬ä¿®æ”¹<code>7c7e9025</code>-&gt;<code>7c7e9027</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0111 1100 0111 1110 1001 0000 0010 0111</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">kd&gt; !dd 7f7ba000 + 80</span><br><span class="line">#7f7ba080 7c7e9025 00000000 00de4067 7f895067</span><br><span class="line">#7f7ba090 7fe65067 7eb52027 00000000 00000000</span><br><span class="line">#7f7ba0a0 00000000 00000000 00000000 00000000</span><br><span class="line">#7f7ba0b0 00000000 00000000 00000000 00000000</span><br><span class="line">#7f7ba0c0 7f8dc067 7f7dd067 7f5de067 7f8df067</span><br><span class="line">#7f7ba0d0 7f960067 7fe61067 00de2067 7fbe3067</span><br><span class="line">#7f7ba0e0 00000000 00000000 00000000 00000000</span><br><span class="line">#7f7ba0f0 00000000 00000000 00000000 00000000</span><br><span class="line">kd&gt; !ed 7f7ba080 7c7e9027</span><br><span class="line">kd&gt; !dd 7f7ba000 + 80</span><br><span class="line">#7f7ba080 7c7e9027 00000000 00de4067 7f895067</span><br><span class="line">#7f7ba090 7fe65067 7eb52027 00000000 00000000</span><br><span class="line">#7f7ba0a0 00000000 00000000 00000000 00000000</span><br><span class="line">#7f7ba0b0 00000000 00000000 00000000 00000000</span><br><span class="line">#7f7ba0c0 7f8dc067 7f7dd067 7f5de067 7f8df067</span><br><span class="line">#7f7ba0d0 7f960067 7fe61067 00de2067 7fbe3067</span><br><span class="line">#7f7ba0e0 00000000 00000000 00000000 00000000</span><br><span class="line">#7f7ba0f0 00000000 00000000 00000000 00000000</span><br></pre></td></tr></table></figure><p>ç°åœ¨çœ‹çœ‹æ•ˆæœ</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/10/5rUlUtc4KVv6ScBKCYCj1728567369260.png" alt="image-20241010213609008"></p><p>å·²ç»æˆåŠŸï¼ï¼ï¼ï¼</p><h3 id="4ã€U-S-ä½"><a href="#4ã€U-S-ä½" class="headerlink" title="4ã€U&#x2F;S ä½"></a>4ã€U&#x2F;S ä½</h3><p>U&#x2F;S &#x3D; 0 ç‰¹æƒç”¨æˆ·</p><p>U&#x2F;S &#x3D; 1 æ™®é€šç”¨æˆ·</p><h3 id="5ã€P-Sä½"><a href="#5ã€P-Sä½" class="headerlink" title="5ã€P&#x2F;Sä½"></a>5ã€P&#x2F;Sä½</h3><p>åªå¯¹<strong>PDEæœ‰æ„ä¹‰</strong>ï¼ŒPS &#x3D;&#x3D; PageSizeçš„æ„æ€</p><p>å½“PS&#x3D;&#x3D;1çš„æ—¶å€™ PDEç›´æ¥æŒ‡å‘ç‰©ç†é¡µ æ— PTE,ä½22ä½æ˜¯é¡µå†…åç§»ã€‚ä¹Ÿå°±æ˜¯è¯´å°‘ä¸€çº§åç§»ã€‚</p><h3 id="6ã€Aä½"><a href="#6ã€Aä½" class="headerlink" title="6ã€Aä½"></a>6ã€Aä½</h3><p>æ˜¯å¦è¢«è®¿é—®ï¼ˆè¯»æˆ–è€…å†™ï¼‰è¿‡  </p><p>A&#x3D;1 è®¿é—®è¿‡ </p><blockquote><p>[!NOTE]</p><p>å³ä½¿åªè®¿é—®ä¸€ä¸ªå­—èŠ‚ä¹Ÿä¼šå¯¼è‡´PDEæˆ–è€…PTEç½®1</p></blockquote><h3 id="7ã€Dä½"><a href="#7ã€Dä½" class="headerlink" title="7ã€Dä½"></a>7ã€Dä½</h3><p>è„ä½ï¼šæ˜¯å¦è¢«å†™è¿‡   </p><p>0ï¼šæ²¡æœ‰è¢«å†™è¿‡   </p><p>1ï¼šè¢«å†™è¿‡</p><h1 id="é¡µç›®å½•è¡¨åŸºå€"><a href="#é¡µç›®å½•è¡¨åŸºå€" class="headerlink" title="é¡µç›®å½•è¡¨åŸºå€"></a>é¡µç›®å½•è¡¨åŸºå€</h1><h2 id="1ã€æ‹†åˆ†C0300000"><a href="#1ã€æ‹†åˆ†C0300000" class="headerlink" title="1ã€æ‹†åˆ†C0300000"></a>1ã€æ‹†åˆ†C0300000</h2><p>å½“å‰æˆ‘ä»¬ç”¨DbgViewç¨‹åºä¸ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">DirBase: 238ef000</span><br><span class="line"></span><br><span class="line">1100 0000 00 00 300 * 4 = C00</span><br><span class="line">11 0000 0000 300 * 4 = C00</span><br><span class="line">000</span><br><span class="line"></span><br><span class="line">kd&gt; !dd 238ef000   </span><br><span class="line">#238ef000 237e3067 2365a067 23a2e067 23a1c067 </span><br><span class="line">#238ef010 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef020 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef030 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef040 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef050 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef060 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef070 00000000 00000000 00000000 00000000</span><br><span class="line"></span><br><span class="line">kd&gt; !dd 238ef000 + C00 PDT</span><br><span class="line">#238efc00 238ef063 236f0063 00000000 09f55163 //PDE</span><br><span class="line">#238efc10 09f56163 09f57163 09f58163 09f59163</span><br><span class="line">#238efc20 09f5a163 09f5b163 09f5c163 09f5d163</span><br><span class="line">#238efc30 09f5e163 09f5f163 09f60163 09f61163</span><br><span class="line">#238efc40 09f62163 09f63163 09f64163 09f65163</span><br><span class="line">#238efc50 09f66163 09f67163 09f68163 09f69163</span><br><span class="line">#238efc60 09f6a163 09f6b163 09f2c163 09f2d163</span><br><span class="line">#238efc70 09f2e163 09f2f163 09f30163 09f31163</span><br><span class="line"></span><br><span class="line">kd&gt; !dd 238ef000 + C00 PTT</span><br><span class="line">#238efc00 238ef063 236f0063 00000000 09f55163 //PTE</span><br><span class="line">#238efc10 09f56163 09f57163 09f58163 09f59163</span><br><span class="line">#238efc20 09f5a163 09f5b163 09f5c163 09f5d163</span><br><span class="line">#238efc30 09f5e163 09f5f163 09f60163 09f61163</span><br><span class="line">#238efc40 09f62163 09f63163 09f64163 09f65163</span><br><span class="line">#238efc50 09f66163 09f67163 09f68163 09f69163</span><br><span class="line">#238efc60 09f6a163 09f6b163 09f2c163 09f2d163</span><br><span class="line">#238efc70 09f2e163 09f2f163 09f30163 09f31163</span><br><span class="line"></span><br><span class="line">kd&gt; !dd 238ef000</span><br><span class="line">#238ef000 237e3067 2365a067 23a2e067 23a1c067</span><br><span class="line">#238ef010 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef020 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef030 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef040 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef050 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef060 00000000 00000000 00000000 00000000</span><br><span class="line">#238ef070 00000000 00000000 00000000 00000000</span><br></pre></td></tr></table></figure><p><strong>ç»“è®ºï¼šC0300000å­˜å‚¨çš„å€¼å°±æ˜¯PDT</strong></p><p>å¦‚æœæˆ‘ä»¬è¦è®¿é—®ç¬¬Nä¸ªPDEï¼Œé‚£ä¹ˆæœ‰å¦‚ä¸‹<strong>å…¬å¼ï¼š0xC0300000 + N*4</strong></p><h2 id="2ã€é¡µç›®å½•è¡¨åŸºå€-XPç³»ç»Ÿ-10-10-12åˆ†é¡µæ¨¡å¼"><a href="#2ã€é¡µç›®å½•è¡¨åŸºå€-XPç³»ç»Ÿ-10-10-12åˆ†é¡µæ¨¡å¼" class="headerlink" title="2ã€é¡µç›®å½•è¡¨åŸºå€(XPç³»ç»Ÿ 10-10-12åˆ†é¡µæ¨¡å¼)"></a>2ã€é¡µç›®å½•è¡¨åŸºå€(XPç³»ç»Ÿ 10-10-12åˆ†é¡µæ¨¡å¼)</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/11/HgPnOhamozV6l5oGK3Ea1728637589862.png" alt="image-20241011170520641"></p><h2 id="3ã€æ€»ç»“"><a href="#3ã€æ€»ç»“" class="headerlink" title="3ã€æ€»ç»“"></a>3ã€æ€»ç»“</h2><ol><li>é€šè¿‡<strong>0xC0300000</strong>æ‰¾åˆ°çš„<strong>ç‰©ç†é¡µå°±æ˜¯é¡µç›®å½•è¡¨</strong></li><li>è¿™ä¸ªç‰©ç†é¡µå³æ˜¯<strong>é¡µç›®å½•è¡¨æœ¬èº«ä¹Ÿæ˜¯é¡µè¡¨</strong></li><li>é¡µç›®å½•è¡¨æ˜¯ä¸€å¼ <strong>ç‰¹æ®Šçš„é¡µè¡¨</strong>ï¼Œæ¯ä¸€é¡¹PTEæŒ‡å‘çš„<strong>ä¸æ˜¯æ™®é€šçš„ç‰©ç†é¡µ</strong>ï¼Œè€Œæ˜¯<strong>æŒ‡å‘å…¶ä»–çš„é¡µè¡¨</strong></li><li>å¦‚æœæˆ‘ä»¬è¦<strong>è®¿é—®ç¬¬Nä¸ªPDE</strong>ï¼Œé‚£ä¹ˆæœ‰å¦‚ä¸‹å…¬å¼ï¼š<strong>0xC0300000 + N*4</strong></li></ol><h1 id="é¡µè¡¨åŸºå€"><a href="#é¡µè¡¨åŸºå€" class="headerlink" title="é¡µè¡¨åŸºå€"></a>é¡µè¡¨åŸºå€</h1><h2 id="1ã€æ‹†åˆ†C0000000-C0001000"><a href="#1ã€æ‹†åˆ†C0000000-C0001000" class="headerlink" title="1ã€æ‹†åˆ†C0000000 &#x2F; C0001000"></a>1ã€æ‹†åˆ†C0000000 &#x2F; C0001000</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/11/oARaKWKx3PJEATdWyNeZ1728638528527.png" alt="image-20241011172208229"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">DirBase: 238ef000</span><br><span class="line">ç¬¬ä¸€ä¸ªPTT</span><br><span class="line">kd&gt; !dd 237e3000</span><br><span class="line">#237e3000 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3010 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3020 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3030 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3040 23764067 00000000 00000000 00000000</span><br><span class="line">#237e3050 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3060 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3070 00000000 00000000 00000000 00000000</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒä¸ªPTT</span><br><span class="line">kd&gt; !dd 2365a000 </span><br><span class="line">#2365a000 238ee025 23951025 23b08025 239c9025</span><br><span class="line">#2365a010 23b0a025 23b8b025 23b4c025 2388d025</span><br><span class="line">#2365a020 2398e025 238cf025 00000000 238ad025</span><br><span class="line">#2365a030 00000000 239ef025 23830025 23931025</span><br><span class="line">#2365a040 00000000 23833025 23734025 237f5025</span><br><span class="line">#2365a050 236f6025 23677025 00000000 00000000</span><br><span class="line">#2365a060 00000000 00000000 00000000 00000000</span><br><span class="line">#2365a070 00000000 235a5025 23666025 00000000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C0000000</span><br><span class="line">11 0000 0000 300 * 4 = C00</span><br><span class="line">00 0000 0000 0</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">kd&gt; !dd 238ef000 + C00</span><br><span class="line">kd&gt; !dd 238ef000 + 0</span><br><span class="line">kd&gt; !dd 237e3000 </span><br><span class="line">#237e3000 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3010 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3020 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3030 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3040 23764067 00000000 00000000 00000000</span><br><span class="line">#237e3050 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3060 00000000 00000000 00000000 00000000</span><br><span class="line">#237e3070 00000000 00000000 00000000 00000000</span><br><span class="line">ç”¨0xC0000000æŸ¥å‡ºæ¥çš„æ˜¯ç¬¬ä¸€å¼ PTTè¡¨</span><br><span class="line"></span><br><span class="line">C0001000 </span><br><span class="line">11 0000 0000 300 * 4 = C00</span><br><span class="line">00 0000 0001 1 * 4 = 0</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">kd&gt; !dd 238ef000 + C00</span><br><span class="line">kd&gt; !dd 238ef000 + 4</span><br><span class="line">kd&gt; !dd 2365a000</span><br><span class="line">#2365a000 238ee025 23951025 23b08025 239c9025</span><br><span class="line">#2365a010 23b0a025 23b8b025 23b4c025 2388d025</span><br><span class="line">#2365a020 2398e025 238cf025 00000000 238ad025</span><br><span class="line">#2365a030 00000000 239ef025 23830025 23931025</span><br><span class="line">#2365a040 00000000 23833025 23734025 237f5025</span><br><span class="line">#2365a050 236f6025 23677025 00000000 00000000</span><br><span class="line">#2365a060 00000000 00000000 00000000 00000000</span><br><span class="line">#2365a070 00000000 235a5025 23666025 00000000</span><br><span class="line">ç”¨0xC0001000æŸ¥å‡ºæ¥çš„æ˜¯ç¬¬äºŒå¼ PTTè¡¨</span><br></pre></td></tr></table></figure><p>çº¿æ€§åœ°å€0xc0000000æ˜ å°„åˆ°ç¬¬ä¸€ä¸ªPTTè¡¨ï¼Œ0xC0000000åˆ°0xC0001000åˆšå¥½ç›¸å·®0x1000ç›¸å½“äºä¸€ä¸ªé¡µï¼Œåç»­åœ°å€å¢é‡ä¸º4KBï¼Œå¯¹åº”ä¸åŒçš„PTTè¡¨ã€‚ 0xc0300000çº¿æ€§åœ°å€ç”¨äºè®¿é—®é¡µç›®å½•è¡¨æœ¬èº«ã€‚æŒæ¡0xc0000000å’Œ0xc0300000ä¸¤ä¸ªåœ°å€ç­‰äºæŒæ¡äº†è¿›ç¨‹å†…å­˜çš„è¯»å†™æƒé™</p><p><strong>æ€»ç»“ï¼š</strong></p><ul><li>é¡µè¡¨è¢«æ˜ å°„åˆ°äº†ä»<strong>0xC0000000</strong>åˆ°<strong>0xC03FFFFF</strong>çš„<strong>4Måœ°å€</strong>ç©ºé—´</li><li>åœ¨è¿™<strong>1024</strong>ä¸ªè¡¨ä¸­æœ‰ä¸€å¼ ç‰¹æ®Šçš„è¡¨ï¼š<strong>é¡µç›®å½•è¡¨</strong></li><li>é¡µç›®å½•è¢«æ˜ å°„åˆ°äº†<strong>0xC0300000å¼€å§‹å¤„çš„4Kåœ°å€</strong>ç©ºé—´</li></ul><h2 id="2ã€æ€»ç»“"><a href="#2ã€æ€»ç»“" class="headerlink" title="2ã€æ€»ç»“"></a>2ã€æ€»ç»“</h2><p>PDIä¸PTIï¼š10-10-12  ï¼ˆIå°±æ˜¯Indexï¼‰</p><p>è®¿é—®é¡µç›®å½•è¡¨çš„å…¬å¼ï¼š0xC0300000 + PDI*4</p><p>è®¿é—®é¡µè¡¨çš„å…¬å¼ï¼š0xC0000000 + PDI*4096 + PTI*4</p><h2 id="2-9-9-12åˆ†é¡µ"><a href="#2-9-9-12åˆ†é¡µ" class="headerlink" title="2-9-9-12åˆ†é¡µ"></a>2-9-9-12åˆ†é¡µ</h2><p>éšç€ç¡¬ä»¶çš„å‘å±•ï¼Œè¿™æ—¶å€™10-10-12åˆ†é¡µçš„ç‰©ç†åœ°å€æ˜¾ç„¶ä¸å¤Ÿç”¨ï¼Œå› æ­¤2-9-9-12åˆ†é¡µéšä¹‹äº§ç”Ÿã€‚</p><h3 id="1ã€10-10-12åˆ†é¡µåˆ’åˆ†"><a href="#1ã€10-10-12åˆ†é¡µåˆ’åˆ†" class="headerlink" title="1ã€10-10-12åˆ†é¡µåˆ’åˆ†"></a>1ã€10-10-12åˆ†é¡µåˆ’åˆ†</h3><ul><li>å…ˆç¡®å®šäº†é¡µçš„å¤§å° 4K  æ‰€ä»¥åé¢çš„12ä½çš„åŠŸèƒ½å°±ç¡®å®šäº†ã€‚(4096 &#x3D; 2^12)</li><li>å½“åˆçš„ç‰©ç†å†…å­˜æ¯”è¾ƒå°ï¼Œæ‰€ä»¥4ä¸ªå­—èŠ‚çš„PTEå°±å¤Ÿäº†ï¼ŒåŠ ä¸Šé¡µçš„å°ºå¯¸æ˜¯4K æ‰€ä»¥ä¸€ä¸ªé¡µèƒ½å­˜å‚¨1024ä¸ª PTE ä¹Ÿå°±æ˜¯2çš„10æ¬¡æ–¹ ç¬¬äºŒä¸ª10ä¹Ÿå°±ç¡®å®šäº†ã€‚(4096&#x2F;4 &#x3D; 1024 &#x3D; 2^10)</li></ul><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/13/JrTI7hLQKgTmAb3TISHA1728824934503.png" alt="image-20241013210854043"></p><ul><li>å‰©ä¸‹çš„10ä¸ºPDI  10+10+12åˆšå¥½32ä½</li></ul><h3 id="2ã€2-9-9-12åˆ†é¡µåˆ’åˆ†"><a href="#2ã€2-9-9-12åˆ†é¡µåˆ’åˆ†" class="headerlink" title="2ã€2-9-9-12åˆ†é¡µåˆ’åˆ†"></a>2ã€2-9-9-12åˆ†é¡µåˆ’åˆ†</h3><ul><li>é¡µçš„å¤§å°æ˜¯ç¡®å®šçš„ï¼Œ4KBä¸èƒ½éšä¾¿æ”¹ï¼Œæ‰€ä»¥12ç¡®å®šäº†</li><li>å¦‚æœæƒ³å¢å¤§ç‰©ç†å†…å­˜çš„è®¿é—®èŒƒå›´ï¼Œå°±éœ€è¦å¢å¤§PTEï¼Œè€ƒè™‘å¯¹é½çš„å› ç´ ï¼Œå¢åŠ åˆ°8ä¸ªå­—èŠ‚</li></ul><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/13/0FoRASR5hqxrTI91KGua1728826070179.png" alt="image-20241013212749894"></p><ul><li>åŒç†PDIä¹Ÿæ˜¯2çš„9æ¬¡æ–¹32ï¼Œ2-9-9-12 è¿˜å·®2ä½ æ‰€ä»¥å°±å†åšä¸€çº§ å«PDPI</li></ul><h3 id="3ã€2-9-9-12åˆ†é¡µç»“æ„"><a href="#3ã€2-9-9-12åˆ†é¡µç»“æ„" class="headerlink" title="3ã€2-9-9-12åˆ†é¡µç»“æ„"></a>3ã€2-9-9-12åˆ†é¡µç»“æ„</h3><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/13/AtcWHzl3KwcymIHccf701728826495790.png" alt="image-20241013213455559"></p><p>PDPTEï¼šPage-Directory-Point-Table  Entryé¡µç›®å½•æŒ‡é’ˆè¡¨é¡¹ æ¯é¡¹å 8ä¸ªå­—èŠ‚</p><h3 id="4ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ2-9-9-12ä¸ºä¾‹ï¼‰"><a href="#4ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ2-9-9-12ä¸ºä¾‹ï¼‰" class="headerlink" title="4ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ2-9-9-12ä¸ºä¾‹ï¼‰"></a>4ã€å¦‚ä½•å¯»æ‰¾ç‰©ç†åœ°å€ï¼ˆ2-9-9-12ä¸ºä¾‹ï¼‰</h3><p>2-9-9-12 ä¸€å…±32ä½ï¼ŒæŠŠä¸€æ®µåœ°å€æ‹†åˆ†æˆä¸‰æ®µ2ä½ 9ä½ 9ä½ 12ä½</p><p>ç”¨notepadä¸ºä¾‹</p><p>ç¬¬ä¸€æ­¥å…ˆåœ¨notepadä¸­å†™å…¥ä¸€ä¸ªhello worldå­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨CEè¿›è¡Œæœç´¢æ‹¿åˆ°å­—ç¬¦ä¸²åœ¨è¿›ç¨‹ä¸­çš„åœ°å€</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/13/bun9GbE6RWztqGKoggzl1728826626971.png" alt="image-20241008214655861"></p><p>ç¬¬äºŒæ­¥æ‹†åˆ†åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">000AA750 hello worldå­—ç¬¦ä¸²åœ¨è¿›ç¨‹ä¸­åœ°å€</span><br><span class="line">ç¬¬ä¸€éƒ¨åˆ†ï¼š00     0*8</span><br><span class="line">ç¬¬ä¸€éƒ¨åˆ†ï¼š00 0000 000  0*8</span><br><span class="line">ç¬¬ä¸€éƒ¨åˆ†ï¼š0 1010 1010 AA * 8 = 550</span><br><span class="line">ç¬¬å››éƒ¨åˆ†ï¼š750</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥windbgè¿›è¡ŒæŸ¥çœ‹æ‰¾åˆ°cr3çš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">DirBase:123402a0</span><br><span class="line">ç¬¬ä¸€çº§ï¼š!dd 123402a0</span><br><span class="line">kd&gt; !dd 123402a0</span><br><span class="line">#123402a0 288a8001 00000000 28729001 00000000</span><br><span class="line">#123402b0 2886a001 00000000 287a7001 00000000</span><br><span class="line">#123402c0 1d083001 00000000 1cf44001 00000000</span><br><span class="line">#123402d0 1cec5001 00000000 1d142001 00000000</span><br><span class="line">#123402e0 1d402001 00000000 1d383001 00000000</span><br><span class="line">#123402f0 1d1c4001 00000000 1d301001 00000000</span><br><span class="line">#12340300 1cc20001 00000000 1cce1001 00000000</span><br><span class="line">#12340310 1cc62001 00000000 1cb5f001 00000000</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒçº§ï¼š!dd 288a8000+0 åé¢ä¸‰ä½æ˜¯å±æ€§ä½¿ç”¨æ—¶æ”¹æˆ000</span><br><span class="line">kd&gt; !dd 288a8000</span><br><span class="line">#288a8000 285e4067 00000000 28b43067 00000000</span><br><span class="line">#288a8010 28696067 00000000 00000000 00000000</span><br><span class="line">#288a8020 285e5067 00000000 2885e067 00000000</span><br><span class="line">#288a8030 28ca1067 00000000 29088067 00000000</span><br><span class="line">#288a8040 28757067 00000000 00000000 00000000</span><br><span class="line">#288a8050 00000000 00000000 00000000 00000000</span><br><span class="line">#288a8060 00000000 00000000 00000000 00000000</span><br><span class="line">#288a8070 00000000 00000000 00000000 00000000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰çº§ï¼š!dd 285e4000+550</span><br><span class="line">kd&gt; !dd 285e4000+550</span><br><span class="line">#285e4550 2892b067 80000000 28821067 80000000</span><br><span class="line">#285e4560 28922067 80000000 286e4067 80000000</span><br><span class="line">#285e4570 28625067 80000000 28866067 80000000</span><br><span class="line">#285e4580 288e7067 80000000 28a68067 80000000</span><br><span class="line">#285e4590 288e9067 80000000 00000200 00000000</span><br><span class="line">#285e45a0 00000200 00000000 00000200 00000000</span><br><span class="line">#285e45b0 29142067 80000000 28c8d067 80000000</span><br><span class="line">#285e45c0 28ed1067 80000000 28d94067 80000000</span><br><span class="line"></span><br><span class="line">ç¬¬å››çº§ï¼š!dd 2892b000 + 750</span><br><span class="line">kd&gt; !dd 2892b000 + 750</span><br><span class="line">#2892b750 00650068 006c006c 0020006f 006f0077</span><br><span class="line">#2892b760 006c0072 00000064 00000000 00000000</span><br><span class="line">#2892b770 00000000 00000000 00000000 00000000</span><br><span class="line">#2892b780 00000000 00000000 00000000 00000000</span><br><span class="line">#2892b790 00000000 0088000c 000a0005 0008014a</span><br><span class="line">#2892b7a0 00000000 000350ac 000aaec8 000aa3e0</span><br><span class="line">#2892b7b0 00000000 00000000 00000000 00000000</span><br><span class="line">#2892b7c0 0005002e 00102341 000800cc 00000000</span><br><span class="line"></span><br><span class="line">!db 2892b000 + 750 å¯éªŒè¯</span><br></pre></td></tr></table></figure><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/13/8IaJhgOOdFs5MUgH0tj51728826881104.png" alt="image-20241013214120803"></p><p>å¼€å¯2-9-9-12ï¼šå°†C:\boot.iniæ–‡ä»¶ä¸­çš„executeæ”¹ä¸ºnoexecute é‡å¯</p><h3 id="5ã€PDPTEç»“æ„"><a href="#5ã€PDPTEç»“æ„" class="headerlink" title="5ã€PDPTEç»“æ„"></a>5ã€PDPTEç»“æ„</h3><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/13/vqU1F4LaD69wRO6PBMRW1728827704407.png" alt="image-20241013215504128"></p><ul><li>PDPTEå…±æœ‰å››é¡¹ï¼ˆ4 &#x3D; 2^2ï¼‰</li><li>35-12 å­˜å‚¨çš„æ˜¯é¡µç›®å½•è¡¨çš„åŸºå€ï¼Œä½12ä½è¡¥0ï¼Œå…±36ä½ï¼Œå³é¡µç›®å½•åŸºå€ã€‚</li></ul><h3 id="6ã€PDEç»“æ„"><a href="#6ã€PDEç»“æ„" class="headerlink" title="6ã€PDEç»“æ„"></a>6ã€PDEç»“æ„</h3><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/14/EUvbwdgM5XdePwyyq7Sh1728874672666.png" alt="image-20241014105554938"></p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/14/5DdAdCyGpeseJffH5SSt1728874573241.png" alt="image-20241014105612693"></p><ul><li>å½“<strong>PS&#x3D;1</strong>æ—¶æ˜¯å¤§é¡µï¼Œ<strong>35-21</strong>ä½æ˜¯<strong>å¤§é¡µ</strong>çš„ç‰©ç†åœ°å€ï¼Œè¿™æ ·36ä½çš„ç‰©ç†åœ°å€çš„<strong>ä½21ä½ä¸º0</strong>ï¼Œè¿™å°±æ„å‘³ç€é¡µçš„<strong>å¤§å°ä¸º2MB</strong>ï¼Œä¸”éƒ½æ˜¯2MBå¯¹é½ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2^21 = 2MB</span><br></pre></td></tr></table></figure><ul><li>å½“<strong>PS&#x3D;0</strong>æ—¶ï¼Œ<strong>35-12ä½</strong>æ˜¯<strong>é¡µè¡¨åŸºå€</strong>ï¼Œ<strong>ä½12ä½è¡¥0</strong>ï¼Œå…±36ä½</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2^12 = 4KB</span><br></pre></td></tr></table></figure><p>åœ¨æ‰€æœ‰çš„è¡¨é¡¹ä¸­ï¼ˆé™¤äº†æŒ‡å‘2MBé¡µçš„é¡µç›®å½•é¡¹ï¼‰ï¼ŒåŸºåœ°å€éƒ½è¢«è§†ä¸º36ä½ç‰©ç†åœ°å€çš„é«˜24ä½ï¼Œè¿™å°±è¿«ä½¿é¡µè¡¨å’Œé¡µéƒ½æ˜¯4KBå¯¹é½çš„ï¼ˆè¿™æ ·ï¼Œ36ä½ç‰©ç†åœ°å€çš„ä½12ä½éƒ½ä¸º0ï¼‰ã€‚å½“é¡µç›®å½•é¡¹æŒ‡å‘ä¸€ä¸ª2MBçš„é¡µæ—¶ï¼ŒåŸºåœ°å€è¢«è§†ä¸º36ä½ç‰©ç†åœ°å€çš„é«˜15ä½ï¼Œè¿™å°±è¿«ä½¿2MBçš„é¡µéƒ½æ˜¯2MBå¯¹é½çš„ï¼ˆè¿™æ ·ï¼Œ36ä½ç‰©ç†åœ°å€çš„ä½21ä½ä¸º0ï¼‰</p><h3 id="7ã€PTEç»“æ„"><a href="#7ã€PTEç»“æ„" class="headerlink" title="7ã€PTEç»“æ„"></a>7ã€PTEç»“æ„</h3><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/14/2iG4rk7bkuvblZczskD41728883346644.png" alt="image-20241014132226411"></p><p>PTEä¸­35-12æ˜¯ç‰©ç†é¡µåŸºå€ï¼Œ24ä½ï¼Œä½12ä½è¡¥0</p><p>ç‰©ç†é¡µåŸºå€+12ä½çš„é¡µå†…åç§»æŒ‡å‘å…·ä½“æ•°æ®</p><h3 id="8ã€XDæ ‡å¿—ä½"><a href="#8ã€XDæ ‡å¿—ä½" class="headerlink" title="8ã€XDæ ‡å¿—ä½"></a>8ã€XDæ ‡å¿—ä½</h3><p>AMDä¸­ç§°ä¸º<strong>NX,å³No Excetion</strong></p><p><strong>PDE&#x2F;PTE</strong>ç»“æ„ï¼š</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/14/PiNTt0pQTCaB3UxSdo5s1728883493201.png" alt="image-20241014132452904"></p><p>æ®µçš„å±æ€§ï¼šæœ‰å¯è¯»ã€å¯å†™å’Œå¯æ‰§è¡Œ</p><p>é¡µçš„å±æ€§ï¼šæœ‰å¯è¯»ã€å¯å†™</p><p>å½“RETæ‰§è¡Œè¿”å›çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä¿®æ”¹å †æ ˆé‡Œé¢çš„æ•°æ®æŒ‡å‘ä¸€ä¸ªæˆ‘æå‰å‡†å¤‡å¥½çš„æ•°æ®ï¼ˆæŠŠæ•°æ®å½“ä½œä»£ç æ¥æ‰§è¡Œï¼Œæ¼æ´éƒ½æ˜¯ä¾èµ–è¿™ç‚¹ï¼Œæ¯”å¦‚SQLæ³¨å…¥ä¹Ÿæ˜¯ï¼‰æ‰€ä»¥ï¼ŒIntelå°±åšäº†ç¡¬ä»¶ä¿æŠ¤ï¼Œåšäº†ä¸€ä¸ªä¸å¯æ‰§è¡Œä½ï¼ŒXD&#x3D;1æ—¶ã€‚é‚£ä¹ˆä½ çš„è½¯ä»¶æº¢å‡ºäº†ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå³ä½¿ä½ çš„EIPè¹¦åˆ°äº†å±é™©çš„<strong>â€œæ•°æ®åŒºâ€</strong>ï¼Œä¹Ÿæ˜¯ä¸å¯ä»¥æ‰§è¡Œçš„ï¼åœ¨<strong>PAEåˆ†é¡µæ¨¡å¼</strong>ä¸‹ï¼ŒPDEä¸PTEçš„<strong>æœ€é«˜ä½ä¸ºXD&#x2F;NXä½</strong></p><h1 id="TLB"><a href="#TLB" class="headerlink" title="TLB"></a>TLB</h1><h2 id="1ã€åœ°å€è§£æ"><a href="#1ã€åœ°å€è§£æ" class="headerlink" title="1ã€åœ°å€è§£æ"></a>1ã€åœ°å€è§£æ</h2><ul><li>é€šè¿‡ä¸€ä¸ªçº¿æ€§åœ°å€è®¿é—®ä¸€ä¸ªç‰©ç†é¡µã€‚æ¯”å¦‚ï¼šä¸€ä¸ªDWORDï¼Œå…¶å®æœªå¿…çœŸæ­£è¯»çš„æ˜¯4ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬<strong>å…ˆè¯»çš„PDEå†è¯»PTE</strong>ï¼Œæœ€åæ‰è¯»çš„<strong>4ä¸ªå­—èŠ‚</strong>çš„é¡µã€‚</li><li>åœ¨2-9-9-12ä¼šè¯»24ä¸ªå­—èŠ‚ï¼Œå¦‚æœè·¨é¡µå¯èƒ½æ›´å¤šã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œåªèƒ½åšè®°å½•ã€‚CPUå†…éƒ¨åšäº†ä¸€ä¸ªè¡¨ï¼Œæ¥è®°å½•è¿™äº›ä¸œè¥¿ï¼Œè¿™ä¸ªè¡¨æ ¼æ˜¯CPUå†…éƒ¨çš„ï¼Œå’Œå¯„å­˜å™¨ä¸€æ ·å¿«ï¼Œè¿™ä¸ªè¡¨æ ¼ï¼šTLB</li></ul><h2 id="2ã€TLBç»“æ„"><a href="#2ã€TLBç»“æ„" class="headerlink" title="2ã€TLBç»“æ„"></a>2ã€TLBç»“æ„</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/14/OgG8JZ66X8nm6AP6i8tX1728907964378.png" alt="image-20241014201244043"></p><ol><li>ATTRï¼ˆå±æ€§ï¼‰ï¼šå±æ€§æ˜¯<strong>PDPE PDE PTEä¸‰ä¸ªå±æ€§AND</strong>èµ·æ¥çš„. å¦‚æœæ˜¯10-10-12 å°±æ˜¯PDE and PTE</li><li>ä¸åŒçš„CPU è¿™ä¸ªè¡¨çš„å¤§å°ä¸ä¸€æ ·</li><li>åªè¦Cr3å˜äº†ï¼ŒTLBç«‹é©¬åˆ·æ–°ï¼Œä¸€æ ¸ä¸€å¥—TLB.</li></ol><p>æ“ä½œç³»ç»Ÿçš„<strong>é«˜2Gæ˜ å°„åŸºæœ¬ä¸å˜</strong>ï¼Œå¦‚æœCr3æ”¹äº†ï¼ŒTLBåˆ·æ–° é‡å»ºé«˜2Gä»¥ä¸Šå¾ˆæµªè´¹ã€‚æ‰€ä»¥PDEå’ŒPTEä¸­æœ‰ä¸ª<strong>Gæ ‡å¿—ä½</strong>ï¼Œå¦‚æœ<strong>Gä½ä¸º1åˆ·æ–°TLBæ—¶</strong>å°†<strong>ä¸ä¼šåˆ·æ–° PDE&#x2F;PTEçš„Gä½ä¸º1çš„é¡µ</strong>ï¼Œå½“<strong>TLBæ»¡äº†</strong>ï¼Œæ ¹æ®ç»Ÿè®¡ä¿¡æ¯<strong>å°†ä¸å¸¸ç”¨çš„åœ°å€åºŸå¼ƒ</strong>ï¼Œæœ€è¿‘æœ€å¸¸ç”¨çš„ä¿ç•™</p><h2 id="3ã€TLBç§ç±»"><a href="#3ã€TLBç§ç±»" class="headerlink" title="3ã€TLBç§ç±»"></a>3ã€TLBç§ç±»</h2><p>TLBåœ¨X86ä½“ç³»çš„CPUé‡Œçš„å®é™…åº”ç”¨æœ€æ—©æ˜¯ä»Intelçš„486CPUå¼€å§‹çš„ï¼Œåœ¨X86ä½“ç³»çš„CPUé‡Œè¾¹ï¼Œä¸€èˆ¬éƒ½è®¾æœ‰å¦‚ä¸‹4ç»„TLB:</p><p>ç¬¬ä¸€ç»„ï¼šç¼“å­˜<strong>ä¸€èˆ¬é¡µè¡¨</strong>ï¼ˆ4Kå­—èŠ‚é¡µé¢ï¼‰çš„<strong>æŒ‡ä»¤é¡µè¡¨ç¼“å­˜</strong>ï¼ˆInstruction-TLBï¼‰</p><p>ç¬¬äºŒç»„ï¼šç¼“å­˜<strong>ä¸€èˆ¬é¡µè¡¨</strong>ï¼ˆ4Kå­—èŠ‚é¡µé¢ï¼‰çš„<strong>æ•°æ®é¡µè¡¨ç¼“å­˜</strong>ï¼ˆData-TLBï¼‰</p><p>ç¬¬ä¸‰ç»„ï¼šç¼“å­˜<strong>å¤§å°ºå¯¸é¡µè¡¨</strong>ï¼ˆ2M&#x2F;4Må­—èŠ‚é¡µé¢ï¼‰çš„<strong>æŒ‡ä»¤é¡µè¡¨ç¼“å­˜</strong>ï¼ˆInstruction-TLBï¼‰</p><p>ç¬¬å››ç»„ï¼šç¼“å­˜<strong>å¤§å°ºå¯¸é¡µè¡¨</strong>ï¼ˆ2M&#x2F;4Må­—èŠ‚é¡µé¢ï¼‰çš„<strong>æ•°æ®é¡µè¡¨ç¼“å­˜</strong>ï¼ˆData-TLBï¼‰</p><h1 id="ä¸­æ–­ä¸å¼‚å¸¸"><a href="#ä¸­æ–­ä¸å¼‚å¸¸" class="headerlink" title="ä¸­æ–­ä¸å¼‚å¸¸"></a>ä¸­æ–­ä¸å¼‚å¸¸</h1><h2 id="1ã€ä»€ä¹ˆæ˜¯ä¸­æ–­"><a href="#1ã€ä»€ä¹ˆæ˜¯ä¸­æ–­" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯ä¸­æ–­"></a>1ã€ä»€ä¹ˆæ˜¯ä¸­æ–­</h2><ol><li>ä¸­æ–­é€šå¸¸æ˜¯ç”±CPUå¤–éƒ¨çš„è¾“å…¥è¾“å‡ºè®¾å¤‡(ç¡¬ä»¶)æ‰€è§¦å‘çš„ï¼Œä¾›å¤–éƒ¨è®¾å¤‡é€šçŸ¥CPUâ€œæœ‰äº‹æƒ…éœ€è¦å¤„ç†â€ï¼Œå› æ­¤åˆå«<strong>ä¸­æ–­è¯·æ±‚</strong>(Interrupt Request)</li><li>ä¸­æ–­è¯·æ±‚çš„ç›®çš„æ˜¯å¸Œæœ›CPUæš‚æ—¶åœæ­¢æ‰§è¡Œå½“å‰æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºï¼Œè½¬å»æ‰§è¡Œä¸­æ–­è¯·æ±‚æ‰€å¯¹åº”çš„ä¸­æ–­å¤„ç†ä¾‹ç¨‹(ä¸­æ–­å¤„ç†ç¨‹åºåœ¨å“ªæœ‰IDTè¡¨å†³å®š)</li><li>80x86æœ‰<strong>ä¸¤æ¡ä¸­æ–­</strong>è¯·æ±‚çº¿</li></ol><ul><li><strong>éå±è”½ä¸­æ–­çº¿</strong>ï¼Œç§°ä¸ºNMIï¼ˆNonMaskable Interruptï¼‰</li><li><strong>å¯å±è”½ä¸­æ–­çº¿</strong>ï¼Œç§°ä¸ºINTRï¼ˆInterrupt Requireï¼‰</li></ul><h2 id="2ã€éå¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç†"><a href="#2ã€éå¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç†" class="headerlink" title="2ã€éå¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç†"></a>2ã€éå¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç†</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/14/Ay0s3FbUcyHkb6HzkWPf1728908293592.png" alt="image-20241014201812991"></p><p>å½“<strong>éå¯å±è”½ä¸­æ–­äº§ç”Ÿ</strong>æ—¶ï¼ŒCPUåœ¨æ‰§è¡Œå®Œå½“å‰æŒ‡ä»¤åä¼šé‡Œé¢è¿›å…¥<strong>ä¸­æ–­å¤„ç†ç¨‹åºéå¯å±è”½ä¸­æ–­ä¸å—EFLAGå¯„å­˜å™¨ä¸­IFä½çš„å½±å“</strong>ï¼Œä¸€æ—¦å‘ç”Ÿï¼ŒCPUå¿…é¡»å¤„ç†<strong>éå¯å±è”½ä¸­æ–­å¤„ç†ç¨‹åºä½äºIDTè¡¨ä¸­çš„2å·ä½ç½®</strong></p><h2 id="3ã€å¯å±è”½ä¸­æ–­"><a href="#3ã€å¯å±è”½ä¸­æ–­" class="headerlink" title="3ã€å¯å±è”½ä¸­æ–­"></a>3ã€å¯å±è”½ä¸­æ–­</h2><p>åœ¨ç¡¬ä»¶çº§ï¼Œå¯å±è”½ä¸­æ–­æ˜¯ç”±ä¸€å—ä¸“é—¨çš„èŠ¯ç‰‡æ¥ç®¡ç†çš„ï¼Œé€šå¸¸ç§°ä¸º<strong>ä¸­æ–­æ§åˆ¶å™¨</strong>.å®ƒè´Ÿè´£åˆ†é…ä¸­æ–­èµ„æºå’Œç®¡ç†å„ä¸ªä¸­æ–­æºå‘å‡ºçš„ä¸­æ–­è¯·æ±‚.ä¸ºäº†ä¾¿äºæ ‡è¯†å„ä¸ªä¸­æ–­è¯·æ±‚ï¼Œä¸­æ–­ç®¡ç†å™¨é€šå¸¸ç”¨IRQ(Interrupt Request)åé¢åŠ ä¸Šæ•°å­—æ¥è¡¨ç¤ºä¸åŒçš„ä¸­æ–­</p><p>æ¯”å¦‚ï¼š<strong>åœ¨Windowsä¸­ æ—¶é’Ÿä¸­æ–­çš„IRQç¼–å·ä¸º0  ä¹Ÿå°±æ˜¯ï¼šIRQ0</strong></p><h2 id="4ã€æ—¶é’Ÿä¸­æ–­"><a href="#4ã€æ—¶é’Ÿä¸­æ–­" class="headerlink" title="4ã€æ—¶é’Ÿä¸­æ–­"></a>4ã€æ—¶é’Ÿä¸­æ–­</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/14/KutN7NpiQIv7m0T6x4lA1728908581780.png" alt="image-20241014202301365"></p><p>å¤§å¤šæ•°æ“ä½œç³»ç»Ÿæ—¶é’Ÿä¸­æ–­åœ¨10-100MSä¹‹é—´ï¼Œ<strong>Windowsç³»åˆ—</strong>ä¸º10-20MS</p><h2 id="5ã€å¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç†"><a href="#5ã€å¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç†" class="headerlink" title="5ã€å¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç†"></a>5ã€å¯å±è”½ä¸­æ–­å¦‚ä½•å¤„ç†</h2><table><thead><tr><th>ï¼ˆIDTè¡¨ï¼‰ä¸­æ–­å·</th><th><strong>IRQ</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>0x30</td><td>IRQ0</td><td>æ—¶é’Ÿä¸­æ–­</td></tr><tr><td>0x31-0x3F</td><td>IRQ1-IRQ15</td><td>å…¶ä»–ç¡¬ä»¶è®¾å¤‡çš„ä¸­æ–­</td></tr></tbody></table><p>å¦‚æœè‡ªå·±çš„ç¨‹åºæ‰§è¡Œæ—¶<strong>ä¸å¸Œæœ›CPUå»å¤„ç†è¿™äº›ä¸­æ–­</strong></p><ul><li>ç”¨<strong>CLIæŒ‡ä»¤æ¸…ç©ºEFLAGå¯„å­˜å™¨ä¸­çš„IFä½</strong></li><li>ç”¨<strong>STIæŒ‡ä»¤è®¾ç½®EFLAGå¯„å­˜å™¨ä¸­çš„IFä½</strong></li></ul><p><strong>ç¡¬ä»¶ä¸­æ–­ä¸IDTè¡¨ä¸­çš„å¯¹åº”å…³ç³»å¹¶éå›ºå®šä¸å˜</strong>çš„ï¼Œå‚è§ï¼šAPICï¼ˆé«˜çº§å¯ç¼–ç¨‹ä¸­æ–­æ§åˆ¶å™¨ï¼‰</p><h2 id="6ã€å¼‚å¸¸"><a href="#6ã€å¼‚å¸¸" class="headerlink" title="6ã€å¼‚å¸¸"></a>6ã€å¼‚å¸¸</h2><p>å¼‚å¸¸é€šå¸¸æ˜¯<strong>CPUåœ¨æ‰§è¡ŒæŒ‡ä»¤æ—¶æ£€æµ‹åˆ°çš„æŸäº›é”™è¯¯</strong>ï¼Œæ¯”å¦‚é™¤0ã€è®¿é—®æ— æ•ˆé¡µé¢ç­‰</p><p><strong>ä¸­æ–­ä¸å¼‚å¸¸çš„åŒºåˆ«ï¼š</strong></p><p>1ã€<strong>ä¸­æ–­</strong>æ¥è‡ªäº<strong>å¤–éƒ¨è®¾å¤‡</strong>ï¼Œæ˜¯ä¸­æ–­æºï¼ˆæ¯”å¦‚é”®ç›˜ï¼‰å‘èµ·çš„ï¼ŒCPUæ˜¯è¢«åŠ¨çš„.</p><p>2ã€<strong>å¼‚å¸¸</strong>æ¥è‡ªäº<strong>CPUæœ¬èº«</strong>ï¼Œæ˜¯CPUä¸»åŠ¨äº§ç”Ÿçš„</p><p>3ã€INT Nè™½ç„¶è¢«ç§°ä¸ºâ€œè½¯ä»¶ä¸­æ–­â€ï¼Œä½†å…¶<strong>æœ¬è´¨æ˜¯å¼‚å¸¸</strong>ã€‚EFLAGçš„<strong>IFä½</strong>å¯¹<strong>INT Næ— æ•ˆ</strong>ã€‚</p><h2 id="7ã€å¼‚å¸¸å¤„ç†"><a href="#7ã€å¼‚å¸¸å¤„ç†" class="headerlink" title="7ã€å¼‚å¸¸å¤„ç†"></a>7ã€å¼‚å¸¸å¤„ç†</h2><p>æ— è®ºæ˜¯ç”±ç¡¬ä»¶è®¾å¤‡è§¦å‘çš„<strong>ä¸­æ–­è¯·æ±‚</strong>è¿˜æ˜¯ç”±CPUäº§ç”Ÿçš„<strong>å¼‚å¸¸</strong>ï¼Œ<strong>å¤„ç†ç¨‹åºéƒ½åœ¨IDTè¡¨</strong>ã€‚</p><p>å¸¸è§çš„å¼‚å¸¸å¤„ç†ç¨‹åºï¼š</p><table><thead><tr><th><strong>é”™è¯¯ç±»å‹</strong></th><th>ï¼ˆIDTè¡¨ï¼‰ä¸­æ–­å·</th></tr></thead><tbody><tr><td>é¡µé”™è¯¯</td><td>0xE</td></tr><tr><td>æ®µé”™è¯¯</td><td>0xD</td></tr><tr><td>é™¤é›¶é”™è¯¯</td><td>0x0</td></tr><tr><td>åŒé‡é”™è¯¯</td><td>0x8</td></tr></tbody></table><h2 id="8ã€ç¼ºé¡µå¼‚å¸¸"><a href="#8ã€ç¼ºé¡µå¼‚å¸¸" class="headerlink" title="8ã€ç¼ºé¡µå¼‚å¸¸"></a>8ã€ç¼ºé¡µå¼‚å¸¸</h2><p>ç¼ºé¡µå¼‚å¸¸çš„äº§ç”Ÿï¼š</p><p>1ã€å½“PDE&#x2F;PTEçš„P&#x3D;0æ—¶ã€‚</p><p>2ã€å½“PDE&#x2F;PTEçš„<strong>å±æ€§ä¸ºåªè¯»</strong>ï¼Œä½†ç¨‹åº<strong>è¯•å›¾å†™å…¥</strong>çš„æ—¶ä¸€æ—¦<strong>å‘ç”Ÿç¼ºé¡µå¼‚å¸¸</strong>ï¼ŒCPUä¼šæ‰§è¡Œ<strong>IDTè¡¨</strong>ä¸­çš„<strong>0xEå·ä¸­æ–­å¤„ç†ç¨‹åº</strong>ï¼Œç”±æ“ä½œç³»ç»Ÿæ¥æ¥ç®¡ã€‚</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/19/mMrSmHzDS2xEasyGk0KZ1729308433756.png" alt="image-20241019112656885"></p><h1 id="æ§åˆ¶å¯„å­˜å™¨"><a href="#æ§åˆ¶å¯„å­˜å™¨" class="headerlink" title="æ§åˆ¶å¯„å­˜å™¨"></a>æ§åˆ¶å¯„å­˜å™¨</h1><h2 id="1ã€æ§åˆ¶å¯„å­˜å™¨"><a href="#1ã€æ§åˆ¶å¯„å­˜å™¨" class="headerlink" title="1ã€æ§åˆ¶å¯„å­˜å™¨"></a>1ã€æ§åˆ¶å¯„å­˜å™¨</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/18/VpXhN7I6RktNdrXMWDJ91729224760020.png" alt="image-20241018121239756"></p><p>æ§åˆ¶å¯„å­˜å™¨ç”¨äº<strong>æ§åˆ¶å’Œç¡®å®šCPUçš„æ“ä½œæ¨¡å¼</strong></p><p>æ§åˆ¶å¯„å­˜å™¨ç±»å‹ï¼š<strong>Cr0ã€Cr1ã€Cr2ã€Cr3ã€Cr4ã€Cr8</strong></p><p>Cr0ï¼šåŒ…å«ç³»ç»Ÿæ§åˆ¶æ ‡å¿—ï¼Œç”¨äºæ§åˆ¶å¤„ç†å™¨çš„å·¥ä½œæ¨¡å¼å’ŒçŠ¶æ€</p><p>Cr1ï¼šä¿ç•™</p><p>Cr2ï¼šåŒ…å«é¡µé¢é”™è¯¯çº¿æ€§åœ°å€ï¼ˆå¯¼è‡´é¡µé¢é”™è¯¯çš„çº¿æ€§åœ°å€ï¼‰</p><p>Cr3ï¼šé¡µç›®å½•è¡¨åŸºå€</p><p>Cr4ï¼šåŒ…å«ä¸€ç»„æ ‡å¿—ä½ï¼Œç”¨äºå¯ç”¨ä¸€äº›ä½“ç³»ç»“æ„æ‰©å±•åŠŸèƒ½ï¼Œå¹¶æŒ‡ç¤ºæ“ä½œç³»ç»Ÿæˆ–æ‰§è¡Œç¨‹åºå¯¹ç‰¹å®šå¤„ç†å™¨åŠŸèƒ½çš„æ”¯æŒæƒ…å†µã€‚</p><p>Cr8ï¼šä»…64ä½ä¸‹ä½¿ç”¨</p><h2 id="2ã€Cr0"><a href="#2ã€Cr0" class="headerlink" title="2ã€Cr0"></a>2ã€Cr0</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/18/oSdkNbfPyhh8Edc9xEDq1729224065374.png" alt="image-20241018120049371"></p><p><strong>PEä½</strong>ï¼šCR0çš„ä½0æ˜¯å¯ç”¨ä¿æŠ¤ï¼ˆProtection Enableï¼‰æ ‡å¿—ã€‚</p><p>PE&#x3D;1ä¿æŠ¤æ¨¡å¼  </p><p>PE&#x3D;0 å®åœ°å€æ¨¡å¼ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸ªæ ‡å¿—ä»…å¼€å¯æ®µçº§ä¿æŠ¤ï¼Œè€Œå¹¶æ²¡æœ‰å¯ç”¨åˆ†é¡µæœºåˆ¶ã€‚è‹¥è¦å¯ç”¨åˆ†é¡µæœºåˆ¶ï¼Œé‚£ä¹ˆPEå’ŒPGæ ‡å¿—éƒ½è¦ç½®ä½ã€‚</span><br></pre></td></tr></table></figure><p><strong>PGä½</strong>ï¼šå½“è®¾ç½®è¯¥ä½æ—¶å³å¼€å¯äº†åˆ†é¡µæœºåˆ¶ã€‚åœ¨å¼€å¯è¿™ä¸ªæ ‡å¿—ä¹‹å‰å¿…é¡»å·²ç»æˆ–è€…åŒæ—¶å¼€å¯PEæ ‡å¿—ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PG=0ä¸”PE=0  å¤„ç†å™¨å·¥ä½œåœ¨å®åœ°å€æ¨¡å¼ä¸‹</span><br><span class="line">PG=0ä¸”PE=1  å¤„ç†å™¨å·¥ä½œåœ¨æ²¡æœ‰å¼€å¯åˆ†é¡µæœºåˆ¶çš„ä¿æŠ¤æ¨¡å¼ä¸‹</span><br><span class="line"></span><br><span class="line">PG=1ä¸”PE=0  åœ¨PEæ²¡æœ‰å¼€å¯çš„æƒ…å†µä¸‹  æ— æ³•å¼€å¯PG</span><br><span class="line">PG=1ä¸”PE=1  å¤„ç†å™¨å·¥ä½œåœ¨å¼€å¯äº†åˆ†é¡µæœºåˆ¶çš„ä¿æŠ¤æ¨¡å¼ä¸‹</span><br></pre></td></tr></table></figure><p><strong>WPä½</strong>ï¼šå¯¹äºIntel 80486æˆ–ä»¥ä¸Šçš„CPUï¼ŒCR0çš„ä½16æ˜¯å†™ä¿æŠ¤ï¼ˆWrite Proctectï¼‰æ ‡å¿—å½“è®¾ç½®è¯¥æ ‡å¿—æ—¶ï¼Œå¤„ç†å™¨ä¼šç¦æ­¢è¶…çº§ç”¨æˆ·ç¨‹åºï¼ˆä¾‹å¦‚ç‰¹æƒçº§0çš„ç¨‹åºï¼‰å‘ç”¨æˆ·çº§åªè¯»é¡µé¢æ‰§è¡Œå†™æ“ä½œï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å½“CPL&lt;3çš„æ—¶å€™ï¼š</span><br><span class="line"></span><br><span class="line">å¦‚æœ WP=0 å¯ä»¥è¯»å†™ä»»æ„ç”¨æˆ·çº§ç‰©ç†é¡µï¼Œåªè¦çº¿æ€§åœ°å€æœ‰æ•ˆ.</span><br><span class="line">å¦‚æœ WP=1 å¯ä»¥è¯»å–ä»»æ„ç”¨æˆ·çº§ç‰©ç†é¡µï¼Œä½†å¯¹äºåªè¯»çš„ç‰©ç†é¡µï¼Œåˆ™ä¸èƒ½å†™.</span><br></pre></td></tr></table></figure><h2 id="3ã€Cr2"><a href="#3ã€Cr2" class="headerlink" title="3ã€Cr2"></a>3ã€Cr2</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/18/Cz6z4p0yHTIkXbfwqMtx1729224485261.png" alt="image-20241018120805029"></p><p>å½“CPUè®¿é—®æŸä¸ªæ— æ•ˆé¡µé¢æ—¶ï¼Œä¼šäº§ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œæ­¤æ—¶ï¼ŒCPUä¼šå°†å¼•èµ·å¼‚å¸¸çš„çº¿æ€§åœ°å€å­˜æ”¾åœ¨CR2ä¸­ã€‚</p><h2 id="4ã€Cr4"><a href="#4ã€Cr4" class="headerlink" title="4ã€Cr4"></a>4ã€Cr4</h2><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/18/V49dlb5xr1alIgO2GlO51729224547079.png" alt="image-20241018120906772"></p><p>PAEï¼š<strong>1 æ˜¯2-9-9-12åˆ†é¡µ</strong> ï¼Œ<strong>0 æ˜¯10-10-12åˆ†é¡µ</strong></p><p>PSEï¼š</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/10/18/TFZXsSJnemit3JrWgI5E1729225049948.png" alt="image-20241018120946600"></p><h1 id="PWT-PCD"><a href="#PWT-PCD" class="headerlink" title="PWT&#x2F;PCD"></a>PWT&#x2F;PCD</h1><h2 id="1ã€CPUç¼“å­˜"><a href="#1ã€CPUç¼“å­˜" class="headerlink" title="1ã€CPUç¼“å­˜"></a>1ã€CPUç¼“å­˜</h2><ol><li><strong>CPUç¼“å­˜</strong>æ˜¯ä½äºCPUä¸ç‰©ç†å†…å­˜ä¹‹é—´çš„<strong>ä¸´æ—¶å­˜å‚¨å™¨</strong>ï¼Œå®ƒçš„å®¹é‡æ¯”å†…å­˜å°çš„å¤šä½†æ˜¯äº¤æ¢é€Ÿåº¦å´æ¯”å†…å­˜è¦å¿«å¾—å¤šã€‚</li><li>CPUç¼“å­˜å¯ä»¥åšçš„å¾ˆå¤§ï¼Œæœ‰å‡ Kã€å‡ åKã€å‡ ç™¾K ç”šè‡³ä¸ŠMçš„ä¹Ÿæœ‰ã€‚</li></ol><p>CPUç¼“å­˜ä¸TLBçš„åŒºåˆ«ï¼š</p><p>TLBï¼šçº¿æ€§åœ°å€  &lt;â€”â€“&gt;  ç‰©ç†åœ°å€</p><p>CPUç¼“å­˜ï¼šç‰©ç†åœ°å€  &lt;â€”â€“&gt;  å†…å®¹</p><p>æ‰€ä»¥å½“æ‹¿åˆ°ä¸€ä¸ªç¨‹åºçš„çº¿æ€§åœ°å€æŸ¥è¯¢æ—¶ï¼Œå…ˆä¼šä½¿ç”¨TLBï¼Œç„¶ååœ¨ä½¿ç”¨CPUç¼“å­˜</p><h2 id="2ã€å…³äºPWT-PCDå±æ€§"><a href="#2ã€å…³äºPWT-PCDå±æ€§" class="headerlink" title="2ã€å…³äºPWT&#x2F;PCDå±æ€§"></a>2ã€å…³äºPWT&#x2F;PCDå±æ€§</h2><p>PWTï¼šPage Write Through</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PWT =  1 æ—¶ å†™Cacheçš„æ—¶å€™ä¹Ÿè¦å°†æ•°æ®å†™å…¥å†…å­˜ä¸­ã€‚</span><br></pre></td></tr></table></figure><p>PCDï¼šPage Cache Disable</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PCD = 1æ—¶ï¼Œç¦æ­¢æŸä¸ªé¡µå†™å…¥ç¼“å­˜ï¼Œç›´æ¥å†™å†…å­˜ã€‚æ¯”å¦‚ï¼Œåšé¡µè¡¨ç”¨çš„é¡µï¼Œå·²ç»å­˜å‚¨åœ¨TLBä¸­äº†ï¼Œå¯èƒ½ä¸éœ€è¦å†ç¼“å­˜äº†</span><br></pre></td></tr></table></figure><p>å…·ä½“ç»†èŠ‚å‚è€ƒIntelç™½çš®ä¹¦</p><h1 id="è°ƒè¯•è¸©å‘"><a href="#è°ƒè¯•è¸©å‘" class="headerlink" title="è°ƒè¯•è¸©å‘"></a>è°ƒè¯•è¸©å‘</h1><p>1ã€32ä½çš„ç³»ç»Ÿå°±å¾—ç”¨è€ç‰ˆæœ¬çš„32ä½windbgï¼Œä¸è¦ç”¨windbg perview æš‚æ—¶ä¸çŸ¥é“æ€ä¹ˆè§£å†³</p><p>2ã€windbgè€ç‰ˆæœ¬é‡åˆ°å¯„å­˜å™¨å†…å®¹æ— æ³•æ˜¾ç¤º</p><p> <strong>WingDbg.dll</strong>æ’ä»¶æ”¾windbgç›¸åŒç›®å½•ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!WingDbg.regfix</span><br></pre></td></tr></table></figure><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/mbikovitsky/WingDbg">https://github.com/mbikovitsky/WingDbg</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¿æŠ¤æ¨¡å¼ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä¿æŠ¤æ¨¡å¼ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä¿æŠ¤æ¨¡å¼ä»‹ç»&quot;&gt;&lt;/a&gt;ä¿æŠ¤æ¨¡å¼ä»‹ç»&lt;/h1&gt;&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯ä¿æŠ¤æ¨¡å¼ï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯ä¿æŠ¤æ¨¡å¼ï¼Ÿ&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="é€†å‘" scheme="https://gbk.cx/categories/%E9%80%86%E5%90%91/"/>
    
    
    <category term="æ»´æ°´ä¸­çº§" scheme="https://gbk.cx/tags/%E6%BB%B4%E6%B0%B4%E4%B8%AD%E7%BA%A7/"/>
    
    <category term="winå†…æ ¸" scheme="https://gbk.cx/tags/win%E5%86%85%E6%A0%B8/"/>
    
  </entry>
  
  <entry>
    <title>github actions äº‘ç¼–è¯‘</title>
    <link href="https://gbk.cx/p/2d289b78/"/>
    <id>https://gbk.cx/p/2d289b78/</id>
    <published>2024-09-26T14:00:27.000Z</published>
    <updated>2024-10-19T14:47:01.104Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚ä½•ä½¿ç”¨Github Actions</p><p>å¦‚æœä½ æƒ³è¦ç¼–è¯‘åˆ«äººçš„è½¯ä»¶ï¼Œåœ¨githubä¸Šã€‚</p><p>1ã€forké¡¹ç›®åˆ°è‡ªå·±ä»“åº“</p><p>2ã€ç‚¹å‡»å½“å‰é¡¹ç›®çš„ActionåŠŸèƒ½</p><p>3ã€æ–°å»ºä¸€ä¸ªå·¥ä½œæµNew workflow</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/TmfwQI40iS8TZKf3VSmC1727154845966.png" alt="image-20240924131404902"></p><p>4ã€é€‰æ‹©ä½ å½“å‰é¡¹ç›®æ˜¯ä»€ä¹ˆè¯­è¨€ï¼Œcã€javaã€goç­‰ã€‚</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/kKzhj6uv12PC3UE3stYC1727155325725.png" alt="image-20240924132205440"></p><p>ä¹‹åå°±ä¼šç”Ÿæˆä¸€ä¸ªymlæ–‡ä»¶ç»™ä½ ç¼–è¾‘</p><p><img src="https://pic.gitlab.cx/gh/RuntimeBroker/pic-bed/img/2024/09/24/Zk3RxdAK6YD1rzdVck0u1727155350540.png" alt="image-20240924132230354"></p><p>ä½ æŠŠä¸‹é¢çš„æ¨¡æ¿ç²˜è´´è¿›å»ä¿®æ”¹ä¸€ä¸‹å°±ç›´æ¥ç¼–è¯‘å³å¯</p><p>å¦‚æœåŸé¡¹ç›®ç”±github&#x2F;workflowsé‚£å°±ç›´æ¥ç”¨ä»–çš„ï¼Œæ²¡æœ‰åˆ™å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªæ¨¡æ¿</p><h2 id="goé¡¹ç›®ç¼–è¯‘"><a href="#goé¡¹ç›®ç¼–è¯‘" class="headerlink" title="goé¡¹ç›®ç¼–è¯‘"></a>goé¡¹ç›®ç¼–è¯‘</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This workflow will build a golang project</span></span><br><span class="line"><span class="comment"># For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-go</span></span><br><span class="line"></span><br><span class="line"><span class="attr">name:</span> <span class="string">Go</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">&quot;main&quot;</span> ]</span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">&quot;main&quot;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">up</span> <span class="string">Go</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/setup-go@v4</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">go-version:</span> <span class="string">&#x27;1.20&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">goreleaser/goreleaser-action@v4</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">args:</span> <span class="string">&quot;release --rm-dist --snapshot&quot;</span></span><br><span class="line">        <span class="attr">version:</span> <span class="number">1.23</span><span class="number">.0</span></span><br><span class="line">      <span class="attr">env:</span></span><br><span class="line">        <span class="attr">GITHUB_TOKEN:</span> <span class="string">&quot;$<span class="template-variable">&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">./</span> <span class="comment"># å¯æ ¹æ®ä½ çš„é¡¹ç›®ç»“æ„é€‰æ‹©ç¼–è¯‘äº§ç‰©è·¯å¾„</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Zip</span> <span class="string">files</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">zip</span> <span class="string">-r</span> <span class="string">dist/VcenterKiller_archive.zip</span> <span class="string">dist/VcenterKiller*</span> <span class="comment">#ç¼–è¯‘åçš„åå­— ï¼Œåœ¨è™šæ‹Ÿæœºé»˜è®¤æ–‡ä»¶ä¼šåœ¨distç›®å½•ä¸‹</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">binaries</span> <span class="string">to</span> <span class="string">release</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">svenstaro/upload-release-action@v2</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">         <span class="attr">repo_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">         <span class="attr">file:</span> <span class="string">dist/VcenterKiller*</span></span><br><span class="line">         <span class="attr">tag:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.ref</span> <span class="string">&#125;&#125;</span></span><br><span class="line">         <span class="attr">overwrite:</span> <span class="literal">true</span></span><br><span class="line">         <span class="attr">file_glob:</span> <span class="literal">true</span></span><br><span class="line">         <span class="attr">draft:</span> <span class="literal">false</span> <span class="comment">#ç¼–è¯‘å®Œæˆå ä¼šè‡ªåŠ¨å‘å¸ƒåˆ°release</span></span><br></pre></td></tr></table></figure><h2 id="javaé¡¹ç›®ç¼–è¯‘"><a href="#javaé¡¹ç›®ç¼–è¯‘" class="headerlink" title="javaé¡¹ç›®ç¼–è¯‘"></a>javaé¡¹ç›®ç¼–è¯‘</h2><h3 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This workflow will build a Java project with Maven, and cache/restore any dependencies to improve the workflow execution time</span></span><br><span class="line"><span class="comment"># For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-java-with-maven</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This workflow uses actions that are not certified by GitHub.</span></span><br><span class="line"><span class="comment"># They are provided by a third-party and are governed by</span></span><br><span class="line"><span class="comment"># separate terms of service, privacy policy, and support</span></span><br><span class="line"><span class="comment"># documentation.</span></span><br><span class="line"></span><br><span class="line"><span class="attr">name:</span> <span class="string">Java</span> <span class="string">CI</span> <span class="string">with</span> <span class="string">Maven</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">&quot;main&quot;</span> ]</span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">&quot;main&quot;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">up</span> <span class="string">JDK</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/setup-java@v4</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">java-version:</span> <span class="string">&#x27;8&#x27;</span></span><br><span class="line">        <span class="attr">distribution:</span> <span class="string">&#x27;temurin&#x27;</span></span><br><span class="line">        <span class="attr">cache:</span> <span class="string">maven</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">with</span> <span class="string">Maven</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        mvn package assembly:single</span></span><br><span class="line"><span class="string"></span>    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">binaries</span> <span class="string">to</span> <span class="string">release</span>    </span><br><span class="line">     </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">binaries</span> <span class="string">to</span> <span class="string">release</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">svenstaro/upload-release-action@v2</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">          <span class="attr">repo_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">file:</span> &#123;<span class="string">è·¯å¾„</span>&#125;<span class="string">/&#123;é¡¹ç›®å&#125;*</span></span><br><span class="line">          <span class="attr">tag:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.ref</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">overwrite:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">file_glob:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">draft:</span> <span class="literal">false</span> <span class="comment">#ç¼–è¯‘å®Œæˆå ä¼šè‡ªåŠ¨å‘å¸ƒåˆ°release</span></span><br></pre></td></tr></table></figure><h3 id="gradle"><a href="#gradle" class="headerlink" title="gradle"></a>gradle</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This workflow uses actions that are not certified by GitHub.</span></span><br><span class="line"><span class="comment"># They are provided by a third-party and are governed by</span></span><br><span class="line"><span class="comment"># separate terms of service, privacy policy, and support</span></span><br><span class="line"><span class="comment"># documentation.</span></span><br><span class="line"><span class="comment"># This workflow will build a Java project with Gradle and cache/restore any dependencies to improve the workflow execution time</span></span><br><span class="line"><span class="comment"># For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-java-with-gradle</span></span><br><span class="line"></span><br><span class="line"><span class="attr">name:</span> <span class="string">Java</span> <span class="string">CI</span> <span class="string">with</span> <span class="string">Gradle</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">&quot;main&quot;</span> ]</span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">&quot;main&quot;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">up</span> <span class="string">JDK</span> <span class="number">8</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/setup-java@v4</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">java-version:</span> <span class="string">&#x27;8&#x27;</span></span><br><span class="line">        <span class="attr">distribution:</span> <span class="string">&#x27;temurin&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Configure Gradle for optimal use in GitHub Actions, including caching of downloaded dependencies.</span></span><br><span class="line">    <span class="comment"># See: https://github.com/gradle/actions/blob/main/setup-gradle/README.md</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Gradle</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">gradle/actions/setup-gradle@af1da67850ed9a4cedd57bfd976089dd991e2582</span> <span class="comment"># v4.0.0</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">gradle-version:</span> <span class="string">&#x27;8.7&#x27;</span></span><br><span class="line">        </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">with</span> <span class="string">Gradle</span> <span class="string">Wrapper</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">./gradlew</span> <span class="string">shadowJar</span></span><br><span class="line">      </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">binaries</span> <span class="string">to</span> <span class="string">release</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">svenstaro/upload-release-action@v2</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">          <span class="attr">repo_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">file:</span> <span class="string">build/libs/&#123;é¡¹ç›®å&#125;*</span> <span class="comment">#è¿™é‡Œéœ€è¦ä¿®æ”¹</span></span><br><span class="line">          <span class="attr">tag:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.ref</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">overwrite:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">file_glob:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">draft:</span> <span class="literal">false</span> <span class="comment">#ç¼–è¯‘å®Œæˆå ä¼šè‡ªåŠ¨å‘å¸ƒåˆ°release</span></span><br></pre></td></tr></table></figure><p>å…·ä½“ä¿å­˜å¾—çœ‹æ„å»ºçš„æ—¶å€™æ—¥å¿—é—®é¢˜</p><h2 id="rusté¡¹ç›®ç¼–è¯‘"><a href="#rusté¡¹ç›®ç¼–è¯‘" class="headerlink" title="rusté¡¹ç›®ç¼–è¯‘"></a>rusté¡¹ç›®ç¼–è¯‘</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Release</span> <span class="bullet">-</span> <span class="string">Distribute</span> <span class="string">binaries</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="comment"># If we want to make release using github interface.</span></span><br><span class="line">  <span class="comment"># release:</span></span><br><span class="line">  <span class="comment">#   types: [published]</span></span><br><span class="line">  <span class="comment"># If we want to make release by pushing new tag.</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">tags:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;[0-9]+.[0-9]+.[0-9]+&#x27;</span></span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line">    <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;Cargo.toml&#x27;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;Cargo.lock&#x27;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;.github/workflows/test.yml&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">env:</span></span><br><span class="line">  <span class="attr">BIN_NAME:</span> <span class="string">legba</span></span><br><span class="line">  <span class="attr">PROJECT_NAME:</span> <span class="string">legba</span></span><br><span class="line">  <span class="attr">REPO_NAME:</span> <span class="string">Legba/Legba</span></span><br><span class="line">  <span class="attr">BREW_TAP:</span> <span class="string">Legba/homebrew-tap</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Build</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.os</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="attr">strategy:</span></span><br><span class="line">      <span class="attr">fail-fast:</span> <span class="literal">false</span> <span class="comment"># don&#x27;t fail other jobs if one fails</span></span><br><span class="line">      <span class="attr">matrix:</span></span><br><span class="line">        <span class="comment"># aarch64-linux is failing due to python3 missing issues during tests. I&#x27;m removing it for now.</span></span><br><span class="line">        <span class="comment"># build: [x86_64-linux, aarch64-linux, x86_64-macos, aarch64-macos, x86_64-windows, x86_64-win-gnu]</span></span><br><span class="line">        <span class="attr">build:</span> [<span class="string">x86_64-linux</span>, <span class="string">x86_64-macos</span>, <span class="string">aarch64-macos</span>, <span class="string">x86_64-windows</span>, <span class="string">x86_64-win-gnu</span>]</span><br><span class="line">        <span class="attr">include:</span></span><br><span class="line">          <span class="comment"># - build: aarch64-linux</span></span><br><span class="line">          <span class="comment">#   os: ubuntu-20.04</span></span><br><span class="line">          <span class="comment">#   rust: stable</span></span><br><span class="line">          <span class="comment">#   target: aarch64-unknown-linux-gnu</span></span><br><span class="line">          <span class="comment">#   cross: true</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">build:</span> <span class="string">aarch64-macos</span></span><br><span class="line">            <span class="attr">os:</span> <span class="string">macos-latest</span></span><br><span class="line">            <span class="attr">rust:</span> <span class="string">stable</span></span><br><span class="line">            <span class="attr">target:</span> <span class="string">aarch64-apple-darwin</span></span><br><span class="line">            <span class="attr">cross:</span> <span class="literal">true</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">build:</span> <span class="string">x86_64-linux</span></span><br><span class="line">            <span class="attr">os:</span> <span class="string">ubuntu-20.04</span></span><br><span class="line">            <span class="attr">rust:</span> <span class="string">stable</span></span><br><span class="line">            <span class="attr">target:</span> <span class="string">x86_64-unknown-linux-gnu</span></span><br><span class="line">            <span class="attr">cross:</span> <span class="literal">false</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">build:</span> <span class="string">x86_64-macos</span></span><br><span class="line">            <span class="attr">os:</span> <span class="string">macos-latest</span></span><br><span class="line">            <span class="attr">rust:</span> <span class="string">stable</span></span><br><span class="line">            <span class="attr">target:</span> <span class="string">x86_64-apple-darwin</span></span><br><span class="line">            <span class="attr">cross:</span> <span class="literal">false</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">build:</span> <span class="string">x86_64-windows</span></span><br><span class="line">            <span class="attr">os:</span> <span class="string">windows-2019</span></span><br><span class="line">            <span class="attr">rust:</span> <span class="string">stable</span></span><br><span class="line">            <span class="attr">target:</span> <span class="string">x86_64-pc-windows-msvc</span></span><br><span class="line">            <span class="attr">cross:</span> <span class="literal">false</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">build:</span> <span class="string">x86_64-win-gnu</span></span><br><span class="line">            <span class="attr">os:</span> <span class="string">windows-2019</span></span><br><span class="line">            <span class="attr">rust:</span> <span class="string">stable-x86_64-gnu</span></span><br><span class="line">            <span class="attr">target:</span> <span class="string">x86_64-pc-windows-gnu</span></span><br><span class="line">            <span class="attr">cross:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">Git</span> <span class="string">config</span> <span class="string">(windows</span> <span class="string">only)</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">contains(matrix.os,</span> <span class="string">&#x27;windows&#x27;</span><span class="string">)</span> <span class="comment"># Windows is missing some dependencies</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          git config --global pack.windowMemory &quot;100m&quot;</span></span><br><span class="line"><span class="string">          git config --global pack.packSizeLimit &quot;100m&quot;</span></span><br><span class="line"><span class="string">          git config --global pack.threads &quot;1&quot;</span></span><br><span class="line"><span class="string">          git config --global pack.deltaCacheSize &quot;512m&quot;</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="comment">#- name: Windows Install dependencies</span></span><br><span class="line">      <span class="comment">#  if: contains(matrix.os, &#x27;windows&#x27;)</span></span><br><span class="line">      <span class="comment">#  run: |</span></span><br><span class="line">      <span class="comment">#      powershell.exe -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command &quot;iex ((New-Object System.Net.WebClient).DownloadString(&#x27;https://chocolatey.org/install.ps1&#x27;))&quot;</span></span><br><span class="line">      <span class="comment">#      SET &quot;PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin&quot;</span></span><br><span class="line">      <span class="comment">#      choco install openssl -y</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">dependencies</span> <span class="comment">#(æŒ‰å®é™…æƒ…å†µä¿®æ”¹)</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">contains(matrix.build,</span> <span class="string">&#x27;x86_64-linux&#x27;</span><span class="string">)</span> <span class="comment"># Windows is missing some dependencies</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">sudo</span> <span class="string">apt-get</span> <span class="string">update</span> <span class="string">&amp;&amp;</span> <span class="string">sudo</span> <span class="string">apt-get</span> <span class="string">install</span> <span class="string">-y</span> <span class="string">gcc-aarch64-linux-gnu</span> <span class="string">python3</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">python</span> <span class="number">3.10</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-python@v5</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">python-version:</span> <span class="string">&#x27;3.10&#x27;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">sources</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">submodules:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.rust</span> <span class="string">&#125;&#125;</span> <span class="string">toolchain</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions-rs/toolchain@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">profile:</span> <span class="string">minimal</span></span><br><span class="line">          <span class="attr">toolchain:</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.rust</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">target:</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.target</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">override:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">cargo</span> <span class="string">test</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions-rs/cargo@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">use-cross:</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.cross</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">command:</span> <span class="string">test</span></span><br><span class="line">          <span class="attr">args:</span> <span class="string">--release</span> <span class="string">--locked</span> <span class="string">--target</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.target</span> <span class="string">&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">release</span> <span class="string">binary</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions-rs/cargo@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">use-cross:</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.cross</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">command:</span> <span class="string">build</span></span><br><span class="line">          <span class="attr">args:</span> <span class="string">--release</span> <span class="string">--locked</span> <span class="string">--target</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.target</span> <span class="string">&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Calculate</span> <span class="string">tag</span> <span class="string">name</span></span><br><span class="line">        <span class="comment"># if: contains(matrix.build, &#x27;linux&#x27;)</span></span><br><span class="line">        <span class="attr">shell:</span> <span class="string">bash</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          name=dev</span></span><br><span class="line"><span class="string">          if [[ $&#123;GITHUB_REF&#125; =~ refs/tags/[0-9]+.[0-9]+.[0-9]+ ]]; then</span></span><br><span class="line"><span class="string">            name=$&#123;GITHUB_REF#refs/tags/&#125;</span></span><br><span class="line"><span class="string">          fi</span></span><br><span class="line"><span class="string">          echo &quot;TAG=$name&quot; &gt;&gt; $GITHUB_ENV</span></span><br><span class="line"><span class="string"></span>        <span class="attr">id:</span> <span class="string">tagname</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">and</span> <span class="string">package</span> <span class="string">artifacts</span></span><br><span class="line">        <span class="attr">shell:</span> <span class="string">bash</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          mkdir dist</span></span><br><span class="line"><span class="string">          if [[ &quot;$&#123;&#123; matrix.build &#125;&#125;&quot; =~ &quot;windows&quot; ]]; then</span></span><br><span class="line"><span class="string">            cp &quot;target/$&#123;&#123; matrix.target &#125;&#125;/release/$BIN_NAME.exe&quot; &quot;dist/&quot;</span></span><br><span class="line"><span class="string">          else</span></span><br><span class="line"><span class="string">            cp &quot;target/$&#123;&#123; matrix.target &#125;&#125;/release/$BIN_NAME&quot; &quot;dist/&quot;</span></span><br><span class="line"><span class="string">          fi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">          <span class="string">if</span> [[ <span class="string">&quot;$<span class="template-variable">&#123;&#123; matrix.build &#125;&#125;</span>&quot;</span> <span class="string">=~</span> <span class="string">&quot;linux&quot;</span> ]]<span class="string">;</span> <span class="string">then</span></span><br><span class="line">            <span class="string">cargo</span> <span class="string">install</span> <span class="string">cargo-deb</span></span><br><span class="line">            <span class="string">cargo</span> <span class="string">deb</span> <span class="string">--target</span> <span class="string">$&#123;&#123;</span> <span class="string">matrix.target</span> <span class="string">&#125;&#125;</span> <span class="string">--deb-version</span> <span class="string">$&#123;TAG&#125;</span></span><br><span class="line">            <span class="string">cp</span> <span class="string">&quot;target/$<span class="template-variable">&#123;&#123; matrix.target &#125;&#125;</span>/debian/legba_$&#123;TAG&#125;_amd64.deb&quot;</span> <span class="string">&quot;dist/&quot;</span> <span class="string">||</span> <span class="literal">true</span></span><br><span class="line">          <span class="string">fi</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/upload-artifact@v4.3.4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">bins-$&#123;&#123;</span> <span class="string">matrix.build</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">dist</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">package:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Package</span></span><br><span class="line">    <span class="attr">needs:</span> [<span class="string">build</span>]</span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">sources</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">submodules:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/download-artifact@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">dist</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Calculate</span> <span class="string">tag</span> <span class="string">name</span></span><br><span class="line">        <span class="comment"># if: contains(matrix.build, &#x27;linux&#x27;)</span></span><br><span class="line">        <span class="attr">shell:</span> <span class="string">bash</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          name=dev</span></span><br><span class="line"><span class="string">          if [[ $&#123;GITHUB_REF&#125; =~ refs/tags/[0-9]+.[0-9]+.[0-9]+ ]]; then</span></span><br><span class="line"><span class="string">            name=$&#123;GITHUB_REF#refs/tags/&#125;</span></span><br><span class="line"><span class="string">          fi</span></span><br><span class="line"><span class="string">          echo &quot;TAG=$name&quot; &gt;&gt; $GITHUB_ENV</span></span><br><span class="line"><span class="string"></span>        <span class="attr">id:</span> <span class="string">tagname</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">archive</span></span><br><span class="line">        <span class="attr">shell:</span> <span class="string">bash</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          set -ex</span></span><br><span class="line"><span class="string">          rm -rf tmp</span></span><br><span class="line"><span class="string">          mkdir tmp</span></span><br><span class="line"><span class="string">          for dir in dist/bins-* ; do</span></span><br><span class="line"><span class="string">              platform=$&#123;dir#&quot;dist/bins-&quot;&#125;</span></span><br><span class="line"><span class="string">              unset exe</span></span><br><span class="line"><span class="string">              if [[ $platform =~ &quot;win&quot; ]]; then</span></span><br><span class="line"><span class="string">                  exe=&quot;.exe&quot;</span></span><br><span class="line"><span class="string">              fi</span></span><br><span class="line"><span class="string">              pkgname=$PROJECT_NAME-$TAG-$platform</span></span><br><span class="line"><span class="string">              mkdir tmp/$pkgname</span></span><br><span class="line"><span class="string">              cp $dir/$BIN_NAME$exe dist/ || true</span></span><br><span class="line"><span class="string">              mv $dir/$BIN_NAME$exe tmp/$pkgname</span></span><br><span class="line"><span class="string">              chmod +x tmp/$pkgname/$BIN_NAME$exe</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">              <span class="string">if</span> [[ <span class="string">$platform</span> <span class="string">=~</span> <span class="string">&quot;linux&quot;</span> ]]<span class="string">;</span> <span class="string">then</span></span><br><span class="line">                  <span class="string">mv</span> <span class="string">&quot;$dir/legba_$&#123;TAG&#125;_amd64.deb&quot;</span> <span class="string">dist/</span> <span class="string">||</span> <span class="literal">true</span></span><br><span class="line">              <span class="string">fi</span></span><br><span class="line"></span><br><span class="line">              <span class="string">tar</span> <span class="string">cJf</span> <span class="string">dist/$pkgname.tar.xz</span> <span class="string">-C</span> <span class="string">tmp</span> <span class="string">$pkgname</span></span><br><span class="line">              <span class="string">7z</span> <span class="string">a</span> <span class="string">dist/$pkgname.zip</span> <span class="string">tmp/$pkgname</span></span><br><span class="line">          <span class="string">done</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">binaries</span> <span class="string">to</span> <span class="string">release</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">(github.event_name</span> <span class="string">==</span> <span class="string">&#x27;push&#x27;</span> <span class="string">&amp;&amp;</span> <span class="string">startsWith(github.ref,</span> <span class="string">&#x27;refs/tags/&#x27;</span><span class="string">))</span> <span class="string">||</span> <span class="string">github.event_name</span> <span class="string">==</span> <span class="string">&#x27;release&#x27;</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">svenstaro/upload-release-action@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">repo_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">file:</span> <span class="string">dist/*</span></span><br><span class="line">          <span class="attr">file_glob:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">tag:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.ref</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">overwrite:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¦‚ä½•ä½¿ç”¨Github Actions&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³è¦ç¼–è¯‘åˆ«äººçš„è½¯ä»¶ï¼Œåœ¨githubä¸Šã€‚&lt;/p&gt;
&lt;p&gt;1ã€forké¡¹ç›®åˆ°è‡ªå·±ä»“åº“&lt;/p&gt;
&lt;p&gt;2ã€ç‚¹å‡»å½“å‰é¡¹ç›®çš„ActionåŠŸèƒ½&lt;/p&gt;
&lt;p&gt;3ã€æ–°å»ºä¸€ä¸ªå·¥ä½œæµNew workflow&lt;/p&gt;
&lt;p&gt;&lt;img s</summary>
      
    
    
    
    <category term="å¼€å‘" scheme="https://gbk.cx/categories/%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="github-actions" scheme="https://gbk.cx/tags/github-actions/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://gbk.cx/p/4a17b156/"/>
    <id>https://gbk.cx/p/4a17b156/</id>
    <published>2024-08-31T12:55:28.664Z</published>
    <updated>2024-09-01T02:46:30.686Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
